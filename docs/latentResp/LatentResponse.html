<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.475">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="author" content="Magnus Johansson">
<meta name="dcterms.date" content="2023-02-24">
<title>R, Rasch, etc - What’s in a latent trait score?</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script><script src="../site_libs/kePrint-0.0.1/kePrint.js"></script><link href="../site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<link rel="stylesheet" href="../styles.css">
<meta property="og:title" content="R, Rasch, etc - What’s in a latent trait score?">
<meta property="og:description" content="We frequently use questionnaires to measure latent variables based on multiple items/indicators, but the connection between item responses and a latent trait score is often unclear.">
<meta property="og:site-name" content="R, Rasch, etc">
<meta name="twitter:title" content="R, Rasch, etc - What’s in a latent trait score?">
<meta name="twitter:description" content="We frequently use questionnaires to measure latent variables based on multiple items/indicators, but the connection between item responses and a latent trait score is often unclear.">
<meta name="twitter:image" content="https://pgmj.github.io/latentResp/LatentResponse_files/figure-html/unnamed-chunk-26-1.png">
<meta name="twitter:card" content="summary_large_image">
<meta name="citation_title" content="What&amp;amp;#039;s in a latent trait score?">
<meta name="citation_author" content="Magnus Johansson">
<meta name="citation_publication_date" content="2023-02-24">
<meta name="citation_cover_date" content="2023-02-24">
<meta name="citation_year" content="2023">
<meta name="citation_online_date" content="2023-02-24">
<meta name="citation_language" content="en">
<meta name="citation_reference" content="citation_title=Psychological Well-Being Revisited: Advances in the Science and Practice of Eudaimonia;,citation_author=Carol D. Ryff;,citation_publication_date=2014;,citation_cover_date=2014;,citation_year=2014;,citation_fulltext_html_url=https://www.karger.com/Article/FullText/353263;,citation_issue=1;,citation_doi=10.1159/000353263;,citation_volume=83;,citation_language=en;,citation_journal_title=Psychotherapy and Psychosomatics;">
<meta name="citation_reference" content="citation_title=Happiness Is Everything, or Is It? Explorations on the Meaning of Psychological Well-Being;,citation_author=Carol D Ryff;,citation_publication_date=1989;,citation_cover_date=1989;,citation_year=1989;,citation_fulltext_html_url=https://psycnet.apa.org/fulltext/1990-12288-001.html;,citation_issue=6;,citation_doi=http://dx.doi.org/10.1037/0022-3514.57.6.1069;,citation_volume=57;,citation_language=en;,citation_journal_title=Journal of Personality and Social Psychology;">
<meta name="citation_reference" content="citation_title=Arrow: Integration to ’apache’ ’arrow’;,citation_author=Neal Richardson;,citation_author=Ian Cook;,citation_author=Nic Crane;,citation_author=Dewey Dunnington;,citation_author=Romain François;,citation_author=Jonathan Keane;,citation_author=Dragoș Moldovan-Grünfeld;,citation_author=Jeroen Ooms;,citation_author=Apache Arrow;,citation_publication_date=2022;,citation_cover_date=2022;,citation_year=2022;,citation_fulltext_html_url=https://CRAN.R-project.org/package=arrow;">
<meta name="citation_reference" content="citation_title=R: A language and environment for statistical computing;,citation_author=R Core Team;,citation_publication_date=2022;,citation_cover_date=2022;,citation_year=2022;,citation_fulltext_html_url=https://www.R-project.org/;">
<meta name="citation_reference" content="citation_title=An R companion to applied regression;,citation_author=John Fox;,citation_author=Sanford Weisberg;,citation_publication_date=2019;,citation_cover_date=2019;,citation_year=2019;,citation_fulltext_html_url=https://socialsciences.mcmaster.ca/jfox/Books/Companion/;">
<meta name="citation_reference" content="citation_title=Formattable: Create ’formattable’ data structures;,citation_author=Kun Ren;,citation_author=Kenton Russell;,citation_publication_date=2021;,citation_cover_date=2021;,citation_year=2021;,citation_fulltext_html_url=https://CRAN.R-project.org/package=formattable;">
<meta name="citation_reference" content="citation_title=ggdist: Visualizations of distributions and uncertainty;,citation_author=Matthew Kay;,citation_publication_date=2022;,citation_cover_date=2022;,citation_year=2022;,citation_fulltext_html_url=https://mjskay.github.io/ggdist/;,citation_doi=10.5281/zenodo.3879620;">
<meta name="citation_reference" content="citation_title=Ggpp: Grammar extensions to ’ggplot2’;,citation_author=Pedro J. Aphalo;,citation_publication_date=2022;,citation_cover_date=2022;,citation_year=2022;,citation_fulltext_html_url=https://CRAN.R-project.org/package=ggpp;">
<meta name="citation_reference" content="citation_title=Grateful: Facilitate citation of r packages;,citation_author=Francisco Rodríguez-Sánchez;,citation_author=Connor P. Jackson;,citation_author=Shaurita D. Hutchins;,citation_publication_date=2022;,citation_cover_date=2022;,citation_year=2022;,citation_fulltext_html_url=https://github.com/Pakillo/grateful;">
<meta name="citation_reference" content="citation_title=RISEkbmRasch: Psychometric analysis in r with rasch measurement theory;,citation_author=Magnus Johansson;,citation_publication_date=2023;,citation_cover_date=2023;,citation_year=2023;,citation_fulltext_html_url=https://github.com/pgmj/RISEkbmRasch;">
<meta name="citation_reference" content="citation_title=Rmarkdown: Dynamic documents for r;,citation_author=JJ Allaire;,citation_author=Yihui Xie;,citation_author=Jonathan McPherson;,citation_author=Javier Luraschi;,citation_author=Kevin Ushey;,citation_author=Aron Atkins;,citation_author=Hadley Wickham;,citation_author=Joe Cheng;,citation_author=Winston Chang;,citation_author=Richard Iannone;,citation_publication_date=2023;,citation_cover_date=2023;,citation_year=2023;,citation_fulltext_html_url=https://github.com/rstudio/rmarkdown;">
<meta name="citation_reference" content="citation_title=R markdown: The definitive guide;,citation_author=Yihui Xie;,citation_author=J. J. Allaire;,citation_author=Garrett Grolemund;,citation_publication_date=2018;,citation_cover_date=2018;,citation_year=2018;,citation_fulltext_html_url=https://bookdown.org/yihui/rmarkdown;">
<meta name="citation_reference" content="citation_title=R markdown cookbook;,citation_author=Yihui Xie;,citation_author=Christophe Dervieux;,citation_author=Emily Riederer;,citation_publication_date=2020;,citation_cover_date=2020;,citation_year=2020;,citation_fulltext_html_url=https://bookdown.org/yihui/rmarkdown-cookbook;">
<meta name="citation_reference" content="citation_title=Welcome to the tidyverse;,citation_author=Hadley Wickham;,citation_author=Mara Averick;,citation_author=Jennifer Bryan;,citation_author=Winston Chang;,citation_author=Lucy D’Agostino McGowan;,citation_author=Romain François;,citation_author=Garrett Grolemund;,citation_author=Alex Hayes;,citation_author=Lionel Henry;,citation_author=Jim Hester;,citation_author=Max Kuhn;,citation_author=Thomas Lin Pedersen;,citation_author=Evan Miller;,citation_author=Stephan Milton Bache;,citation_author=Kirill Müller;,citation_author=Jeroen Ooms;,citation_author=David Robinson;,citation_author=Dana Paige Seidel;,citation_author=Vitalie Spinu;,citation_author=Kohske Takahashi;,citation_author=Davis Vaughan;,citation_author=Claus Wilke;,citation_author=Kara Woo;,citation_author=Hiroaki Yutani;,citation_publication_date=2019;,citation_cover_date=2019;,citation_year=2019;,citation_issue=43;,citation_doi=10.21105/joss.01686;,citation_volume=4;,citation_journal_title=Journal of Open Source Software;">
</head>
<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="navbar navbar-expand-lg navbar-dark "><div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">R, Rasch, etc</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
<li class="nav-item">
    <a class="nav-link" href="../index.html">
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../raschrvignette/RaschRvign.html">
 <span class="menu-text">RISEkbmRasch vignette</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../about.html">
 <span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-blog" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Blog</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-blog">
<li>
    <a class="dropdown-item" href="../parameterizedQ.html">
 <span class="dropdown-text">Automating reports with Quarto</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../latentResp/LatentResponse.html">
 <span class="dropdown-text">What’s in a latent trait score?</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../SkolverketAPI/skolverketapi.html">
 <span class="dropdown-text">Data retrieval with R using API calls</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../powerviz.html">
 <span class="dropdown-text">Power analysis for multilevel models</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../datawrangling.html">
 <span class="dropdown-text">Data wrangling for psychometrics in R</span></a>
  </li>  
    </ul>
</li>
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/pgmj/pgmj.github.io"><i class="bi bi-github" role="img" aria-label="GitHub">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
<div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">On this page</h2>
   
  <ul>
<li><a href="#background" id="toc-background" class="nav-link active" data-scroll-target="#background"><span class="toc-section-number">1</span>  Background</a></li>
  <li><a href="#sec-rasch" id="toc-sec-rasch" class="nav-link" data-scroll-target="#sec-rasch"><span class="toc-section-number">2</span>  Rasch analysis summary</a></li>
  <li>
<a href="#estimating-latent-scores" id="toc-estimating-latent-scores" class="nav-link" data-scroll-target="#estimating-latent-scores"><span class="toc-section-number">3</span>  Estimating latent scores</a>
  <ul class="collapse">
<li><a href="#plotting-the-distribution" id="toc-plotting-the-distribution" class="nav-link" data-scroll-target="#plotting-the-distribution"><span class="toc-section-number">3.1</span>  Plotting the distribution</a></li>
  </ul>
</li>
  <li><a href="#preparing-visualization" id="toc-preparing-visualization" class="nav-link" data-scroll-target="#preparing-visualization"><span class="toc-section-number">4</span>  Preparing visualization</a></li>
  <li><a href="#sec-visualization" id="toc-sec-visualization" class="nav-link" data-scroll-target="#sec-visualization"><span class="toc-section-number">5</span>  Visualization</a></li>
  <li>
<a href="#other-visualizations" id="toc-other-visualizations" class="nav-link" data-scroll-target="#other-visualizations"><span class="toc-section-number">6</span>  Other visualizations</a>
  <ul class="collapse">
<li><a href="#targeting-example" id="toc-targeting-example" class="nav-link" data-scroll-target="#targeting-example"><span class="toc-section-number">6.1</span>  Targeting example</a></li>
  </ul>
</li>
  <li><a href="#software-used" id="toc-software-used" class="nav-link" data-scroll-target="#software-used"><span class="toc-section-number">7</span>  Software used</a></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references"><span class="toc-section-number">8</span>  References</a></li>
  </ul></nav>
    </div>
<!-- main -->
<main class="content page-columns page-full column-page-left" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">What’s in a latent trait score?</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
</div>


<div class="quarto-title-meta-author">
  <div class="quarto-title-meta-heading">Author</div>
  <div class="quarto-title-meta-heading">Affiliation</div>
  
    <div class="quarto-title-meta-contents">
    Magnus Johansson <a href="https://orcid.org/0000-0003-1669-592X" class="quarto-title-author-orcid"> <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg=="></a>
  </div>
    <div class="quarto-title-meta-contents">
        <p class="affiliation">
            <a href="https://www.ri.se/sv/vad-vi-gor/expertiser/kategoriskt-baserade-matningar">
            RISE Research Institutes of Sweden
            </a>
          </p>
      </div>
    </div>

<div class="quarto-title-meta">

      
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">February 24, 2023</p>
    </div>
  </div>
  
    
  </div>
  

</header><p>We frequently use questionnaires to measure latent variables based on multiple items/indicators, but the connection between item responses and a latent trait score is often unclear. Here, I will present a way to visualize item responses and their corresponding latent score and measurement uncertainty that hopefully makes what lies behind the latent score much easier to understand.</p>
<p>It should be noted that the term “latent trait score” is not entirely established. The intent is to refer to what in Item Response Theory and Rasch modeling is labelled “theta” - 𝜃 (also known as “person ability”, “person location”, or “person score”). For each participant, IRT/Rasch models make it possible to both estimate a latent trait score on an interval scale and a measurement error specific for each participant’s score. The measurement error depends on the item properties and is not a constant value that is the same for all participants/scores.</p>
<p>In classical test theory, latent trait scores may be estimated using factor analysis and used in structural equation models. However, I have never seen anyone “export” the actual latent trait scores for each participant in a dataset, based on a confirmatory factor analysis (CFA). What is usually done, based on classical test theory/CFA, is to use the raw ordinal sum score as a representation of the latent variable.</p>
<p>Jump ahead to <a href="#sec-visualization">Section&nbsp;5</a> to see the visualization and skip the psychometric background.</p>
<section id="background" class="level2" data-number="1"><h2 data-number="1" class="anchored" data-anchor-id="background">
<span class="header-section-number">1</span> Background</h2>
<p>The Mental Health Continuum Short Form <span class="citation" data-cites="ryff1989 ryff2014">(<a href="#ref-ryff1989" role="doc-biblioref">Ryff, 1989</a>; <a href="#ref-ryff2014" role="doc-biblioref">Ryff, 2014</a>)</span> will be used as an example. I have conducted a Rasch analysis and preliminary results indicate that some modifications are needed for the response categories, and some items need to be removed. This will be reported elsewhere in greater detail. Here, only a summary of the changes and the measurement properties of the final set of items will be reported.</p>
<p>The analysis makes use of my R package for Rasch psychometric analysis, which in turn depends on (and automatically loads) a lot of packages. See the <a href="https://pgmj.github.io/raschrvignette/RaschRvign.html">RISEkbmRasch vignette</a> and <a href="https://github.com/pgmj/RISEkbmRasch">GitHub package repository</a> for more details.</p>
<div class="cell" data-hash="LatentResponse_cache/html/unnamed-chunk-1_0a017a6d20310c523d2137cc060934b1">
<details><summary>Code</summary><div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/pgmj/RISEkbmRasch">RISEkbmRasch</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/apache/arrow/">arrow</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://mjskay.github.io/ggdist/">ggdist</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://docs.r4photobiology.info/ggpp/">ggpp</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co">### some commands exist in multiple packages, here we define preferred ones that are frequently used</span></span>
<span><span class="va">select</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="va"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span></span>
<span><span class="va">count</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="va"><a href="https://dplyr.tidyverse.org/reference/count.html">count</a></span></span>
<span><span class="va">recode</span> <span class="op">&lt;-</span> <span class="fu">car</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/car/man/recode.html">recode</a></span></span>
<span><span class="va">rename</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="va"><a href="https://dplyr.tidyverse.org/reference/rename.html">rename</a></span></span>
<span></span>
<span><span class="co"># import item information</span></span>
<span><span class="va">itemlabels</span> <span class="op">&lt;-</span> <span class="fu">read_excel</span><span class="op">(</span><span class="st">"/Volumes/magnuspjo/RegionUppsala/data/RegUaItemlabelsEng.xls"</span>, sheet <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="fu">str_detect</span><span class="op">(</span><span class="va">itemnr</span>,<span class="st">"mhc"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">itemresponses</span> <span class="op">&lt;-</span> <span class="fu">read_excel</span><span class="op">(</span><span class="st">"/Volumes/magnuspjo/RegionUppsala/data/RegUaItemlabelsEng.xls"</span>, sheet <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">rename</span><span class="op">(</span>`How often during the past month did you feel...` <span class="op">=</span> <span class="va">item</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># import recoded data</span></span>
<span><span class="va">df.all</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://arrow.apache.org/docs/r/reference/read_parquet.html">read_parquet</a></span><span class="op">(</span><span class="st">"/Volumes/magnuspjo/RegionUppsala/data/RegUaLHUdata.parquet"</span><span class="op">)</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="va">df.all</span></span>
<span></span>
<span><span class="co"># recode response categories to numerics</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="va">df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span><span class="fu">across</span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html">starts_with</a></span><span class="op">(</span><span class="st">"I1_"</span><span class="op">)</span>, <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/pkg/car/man/recode.html">recode</a></span><span class="op">(</span><span class="va">.x</span>,<span class="st">"'Aldrig'=0;</span></span>
<span><span class="st">                    'En eller två gånger'=1;</span></span>
<span><span class="st">                    '1 gång/vecka'=2;</span></span>
<span><span class="st">                    '2-3 gånger/vecka'=3;</span></span>
<span><span class="st">                    'Nästan dagligen'=4;</span></span>
<span><span class="st">                    'Dagligen'=5"</span>,</span>
<span>                    as.factor <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span>  <span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="va">df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">inars</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2019</span>,<span class="fl">2021</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>Age <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/car/man/recode.html">recode</a></span><span class="op">(</span><span class="va">arskurs</span>,<span class="st">"1='13 yo';2='15 yo';3=' 17 yo';9=NA;99=NA"</span>, as.factor <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>         Gender <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/car/man/recode.html">recode</a></span><span class="op">(</span><span class="va">kon</span>,<span class="st">"99=NA;9=NA;2='Girls';1='Boys'"</span>, as.factor <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>,</span>
<span>         <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">Age</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"15 yo"</span>,<span class="st">"17 yo"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html">starts_with</a></span><span class="op">(</span><span class="st">"I1_"</span><span class="op">)</span>,<span class="va">Age</span>,<span class="va">Gender</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html">na.omit</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># create variables for analysis of Differential Item Functioning</span></span>
<span><span class="va">dif.age</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">$</span><span class="va">Age</span></span>
<span><span class="va">dif.gender</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">$</span><span class="va">Gender</span></span>
<span><span class="va">df</span><span class="op">$</span><span class="va">Age</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span><span class="va">df</span><span class="op">$</span><span class="va">Gender</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span></span>
<span><span class="co"># set variable names to match</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">itemlabels</span><span class="op">$</span><span class="va">itemnr</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Questions in the MHC-SF are prefixed with <strong><em>How often during the past month did you feel…</em></strong>, and the items are listed below in <a href="#sec-rasch">Section&nbsp;2</a> in the right-hand side margin.</p>
<p>Six response categories were used, as specified in the original MHC-SF: <strong><em>every day, almost every day, about 2 or 3 times a week, about once a week, once or twice, never</em></strong> and the Rasch analysis found them disordered for all items. This means that some response categories do not contribute meaningful differential information to the latent score, compared to an adjacent response category - the categories are too similar to the respondents. After merging <strong><em>never</em></strong> with <strong><em>once or twice</em></strong>, and <strong><em>about once a week</em></strong> with <strong><em>about 2 or 3 times a week</em></strong>, the disordering was resolved. However, there are still quite small distances between item category thresholds, as shown in the ICC plots. This leaves us with 4 response categories for each item.</p>
<p>The sample consists of 4243 respondents.</p>
<div class="cell" data-hash="LatentResponse_cache/html/unnamed-chunk-2_1d20d6b32e68b291138896ed9a87004d">
<details><summary>Code</summary><div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="va">itemlabels</span><span class="op">$</span><span class="va">itemnr</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">df</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/car/man/recode.html">recode</a></span><span class="op">(</span><span class="va">df</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span>,<span class="st">"1=0;2=1;3=1;4=2;5=3"</span>,</span>
<span>                    as.factor <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true">Tileplot</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">ICC plots</a></li>
</ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<div class="cell" data-hash="LatentResponse_cache/html/unnamed-chunk-3_a47316b3003b20eedb8b65ea2a065130">
<details><summary>Code</summary><div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/RISEkbmRasch/man/RItileplot.html">RItileplot</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="LatentResponse_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid" width="1050"></p>
</div>
</div>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<div>
<details><summary>Code</summary><div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">ermOut</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/eRm/man/PCM.html">PCM</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/eRm/man/plotICC.html">plotICC</a></span><span class="op">(</span><span class="va">ermOut</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell quarto-layout-panel" data-hash="LatentResponse_cache/html/unnamed-chunk-4_0ad2169ca5b9a27beb8454d2da2ed0e9">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 33.3%;justify-content: center;">
<p><img src="LatentResponse_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid" width="1050"></p>
</div>
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 33.3%;justify-content: center;">
<p><img src="LatentResponse_files/figure-html/unnamed-chunk-4-2.png" class="img-fluid" width="1050"></p>
</div>
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 33.3%;justify-content: center;">
<p><img src="LatentResponse_files/figure-html/unnamed-chunk-4-3.png" class="img-fluid" width="1050"></p>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 33.3%;justify-content: center;">
<p><img src="LatentResponse_files/figure-html/unnamed-chunk-4-4.png" class="img-fluid" width="1050"></p>
</div>
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 33.3%;justify-content: center;">
<p><img src="LatentResponse_files/figure-html/unnamed-chunk-4-5.png" class="img-fluid" width="1050"></p>
</div>
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 33.3%;justify-content: center;">
<p><img src="LatentResponse_files/figure-html/unnamed-chunk-4-6.png" class="img-fluid" width="1050"></p>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 33.3%;justify-content: center;">
<p><img src="LatentResponse_files/figure-html/unnamed-chunk-4-7.png" class="img-fluid" width="1050"></p>
</div>
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 33.3%;justify-content: center;">
<p><img src="LatentResponse_files/figure-html/unnamed-chunk-4-8.png" class="img-fluid" width="1050"></p>
</div>
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 33.3%;justify-content: center;">
<p><img src="LatentResponse_files/figure-html/unnamed-chunk-4-9.png" class="img-fluid" width="1050"></p>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 33.3%;justify-content: center;">
<p><img src="LatentResponse_files/figure-html/unnamed-chunk-4-10.png" class="img-fluid" width="1050"></p>
</div>
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 33.3%;justify-content: center;">
<p><img src="LatentResponse_files/figure-html/unnamed-chunk-4-11.png" class="img-fluid" width="1050"></p>
</div>
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 33.3%;justify-content: center;">
<p><img src="LatentResponse_files/figure-html/unnamed-chunk-4-12.png" class="img-fluid" width="1050"></p>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 33.3%;justify-content: center;">
<p><img src="LatentResponse_files/figure-html/unnamed-chunk-4-13.png" class="img-fluid" width="1050"></p>
</div>
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 33.3%;justify-content: center;">
<p><img src="LatentResponse_files/figure-html/unnamed-chunk-4-14.png" class="img-fluid" width="1050"></p>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</section><section id="sec-rasch" class="level2 page-columns page-full" data-number="2"><h2 data-number="2" class="anchored" data-anchor-id="sec-rasch">
<span class="header-section-number">2</span> Rasch analysis summary</h2>
<p>Five items were removed, mostly due to issues of multidimensionality and large residual correlations. Here, the analysis of remaining items is presented.</p>
<div class="cell" data-hash="LatentResponse_cache/html/unnamed-chunk-5_aa179b2e43bdfa14c645ca3300e464db">
<details><summary>Code</summary><div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">removed.items</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"mhc2"</span>,<span class="st">"mhc3"</span>,<span class="st">"mhc4"</span>,<span class="st">"mhc8"</span>,<span class="st">"mhc7"</span><span class="op">)</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="va">df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="op">!</span><span class="fu">any_of</span><span class="op">(</span><span class="va">removed.items</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell page-columns page-full" data-hash="LatentResponse_cache/html/unnamed-chunk-6_c0d4cea214324cb622a884f9128809ef">

<div class="no-row-height column-margin column-container"><div class="cell-output-display">

<table class="table table-striped" style="font-size: 12px; font-family: Lato">
<thead><tr>
<th style="text-align:center;">
itemnr
</th>
<th style="text-align:left;">
item
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:center;">
<span style="color: grey; font-weight: bold">mhc1 </span>
</td>
<td style="text-align:left;">
happy
</td>
</tr>
<tr>
<td style="text-align:center;">
<span style="color: grey; font-weight: bold">mhc5 </span>
</td>
<td style="text-align:left;">
hat you belonged to a community
</td>
</tr>
<tr>
<td style="text-align:center;">
<span style="color: grey; font-weight: bold">mhc6 </span>
</td>
<td style="text-align:left;">
that our society is becoming a better place for people like you
</td>
</tr>
<tr>
<td style="text-align:center;">
<span style="color: grey; font-weight: bold">mhc9 </span>
</td>
<td style="text-align:left;">
that you liked most parts of your personality
</td>
</tr>
<tr>
<td style="text-align:center;">
<span style="color: grey; font-weight: bold">mhc10</span>
</td>
<td style="text-align:left;">
good at managing the responsibilities of your daily life
</td>
</tr>
<tr>
<td style="text-align:center;">
<span style="color: grey; font-weight: bold">mhc11</span>
</td>
<td style="text-align:left;">
that you had warm and trusting relationships with others
</td>
</tr>
<tr>
<td style="text-align:center;">
<span style="color: grey; font-weight: bold">mhc12</span>
</td>
<td style="text-align:left;">
that you had experiences that challenged you to grow and become a better person
</td>
</tr>
<tr>
<td style="text-align:center;">
<span style="color: grey; font-weight: bold">mhc13</span>
</td>
<td style="text-align:left;">
confident to think or express your own ideas and opinions
</td>
</tr>
<tr>
<td style="text-align:center;">
<span style="color: grey; font-weight: bold">mhc14</span>
</td>
<td style="text-align:left;">
that your life has a sense of direction or meaning to it
</td>
</tr>
</tbody>
</table>
</div></div></div>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true">Item fit</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false">PCA</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-3" role="tab" aria-controls="tabset-2-3" aria-selected="false">Residual correlations</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-4" role="tab" aria-controls="tabset-2-4" aria-selected="false">1st contrast loadings</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-5" role="tab" aria-controls="tabset-2-5" aria-selected="false">Targeting</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-6-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-6" role="tab" aria-controls="tabset-2-6" aria-selected="false">Item hierarchy</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-7-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-7" role="tab" aria-controls="tabset-2-7" aria-selected="false">DIF</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-8-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-8" role="tab" aria-controls="tabset-2-8" aria-selected="false">Reliability</a></li>
</ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<div class="cell" data-hash="LatentResponse_cache/html/unnamed-chunk-7_6332c889d124f53e9e5467fffc85e5fb">
<details><summary>Code</summary><div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/RISEkbmRasch/man/RIitemfitPCM2.html">RIitemfitPCM2</a></span><span class="op">(</span><span class="va">df</span>, <span class="fl">300</span>, <span class="fl">32</span>, <span class="fl">8</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">

<table class="table table-striped table-hover lightable-classic table" style="font-size: 15px; width: auto !important;  font-family: Lato; margin-left: auto; margin-right: auto; margin-left: auto; margin-right: auto;">
<thead><tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">   </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"> OutfitMSQ </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"> InfitMSQ </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"> OutfitZSTD </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"> InfitZSTD </th>
  </tr></thead>
<tbody>
<tr>
<td style="text-align:left;font-weight: bold;"> mhc1 </td>
   <td style="text-align:left;"> <span style="     color: black !important;">1.025</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0.996</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0.416</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0.069</span> </td>
  </tr>
<tr>
<td style="text-align:left;font-weight: bold;"> mhc5 </td>
   <td style="text-align:left;"> <span style="     color: black !important;">1.192</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">1.125</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">1.889</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">1.604</span> </td>
  </tr>
<tr>
<td style="text-align:left;font-weight: bold;"> mhc6 </td>
   <td style="text-align:left;"> <span style="     color: red !important;">1.336</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">1.228</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">1.757</span> </td>
   <td style="text-align:left;"> <span style="     color: red !important;">2.222</span> </td>
  </tr>
<tr>
<td style="text-align:left;font-weight: bold;"> mhc9 </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0.727</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0.746</span> </td>
   <td style="text-align:left;"> <span style="     color: red !important;">-3.542</span> </td>
   <td style="text-align:left;"> <span style="     color: red !important;">-3.697</span> </td>
  </tr>
<tr>
<td style="text-align:left;font-weight: bold;"> mhc10 </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0.974</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0.95</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">-0.092</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">-0.562</span> </td>
  </tr>
<tr>
<td style="text-align:left;font-weight: bold;"> mhc11 </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0.779</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0.794</span> </td>
   <td style="text-align:left;"> <span style="     color: red !important;">-2.439</span> </td>
   <td style="text-align:left;"> <span style="     color: red !important;">-2.94</span> </td>
  </tr>
<tr>
<td style="text-align:left;font-weight: bold;"> mhc12 </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0.947</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0.927</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">-0.805</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">-1.026</span> </td>
  </tr>
<tr>
<td style="text-align:left;font-weight: bold;"> mhc13 </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0.882</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0.876</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">-1.466</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">-1.678</span> </td>
  </tr>
<tr>
<td style="text-align:left;font-weight: bold;"> mhc14 </td>
   <td style="text-align:left;"> <span style="     color: red !important;">0.693</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0.704</span> </td>
   <td style="text-align:left;"> <span style="     color: red !important;">-3.497</span> </td>
   <td style="text-align:left;"> <span style="     color: red !important;">-3.964</span> </td>
  </tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<div class="cell" data-hash="LatentResponse_cache/html/unnamed-chunk-8_a6c5028fad80d5fed0848ea7daf3a94e">
<details><summary>Code</summary><div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/RISEkbmRasch/man/RIpcmPCA.html">RIpcmPCA</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">

<table style="width:25%; font-size: 15px;  font-family: Lato; margin-left: auto; margin-right: auto; margin-left: auto; margin-right: auto;" class="table table-striped table-hover lightable-classic table">
<caption>PCA of Rasch model residuals</caption>
 <thead><tr>
<th style="text-align:right;"> Eigenvalues </th>
  </tr></thead>
<tbody>
<tr>
<td style="text-align:right;font-weight: bold;"> 1.51 </td>
  </tr>
<tr>
<td style="text-align:right;font-weight: bold;"> 1.27 </td>
  </tr>
<tr>
<td style="text-align:right;font-weight: bold;"> 1.20 </td>
  </tr>
<tr>
<td style="text-align:right;font-weight: bold;"> 1.13 </td>
  </tr>
<tr>
<td style="text-align:right;font-weight: bold;"> 1.09 </td>
  </tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="tabset-2-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-3-tab">
<div class="cell" data-hash="LatentResponse_cache/html/unnamed-chunk-9_8bec480dc44e83f02887f0df9810e1a9">
<details><summary>Code</summary><div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/RISEkbmRasch/man/RIresidcorr.html">RIresidcorr</a></span><span class="op">(</span><span class="va">df</span>, cutoff <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">

<table style="width:70%; font-size: 15px; width: auto !important;  font-family: Lato; margin-left: auto; margin-right: auto; margin-left: auto; margin-right: auto;border-bottom: 0;" class="table table-striped table-hover lightable-classic table">
<thead><tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">   </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"> mhc1 </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"> mhc5 </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"> mhc6 </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"> mhc9 </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"> mhc10 </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"> mhc11 </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"> mhc12 </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"> mhc13 </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"> mhc14 </th>
  </tr></thead>
<tbody>
<tr>
<td style="text-align:left;font-weight: bold;"> mhc1 </td>
   <td style="text-align:left;"> <span style="     color: black !important;"></span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;"></span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;"></span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;"></span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;"></span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;"></span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;"></span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;"></span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;"></span> </td>
  </tr>
<tr>
<td style="text-align:left;font-weight: bold;"> mhc5 </td>
   <td style="text-align:left;"> <span style="     color: black !important;">-0.02</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;"></span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;"></span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;"></span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;"></span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;"></span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;"></span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;"></span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;"></span> </td>
  </tr>
<tr>
<td style="text-align:left;font-weight: bold;"> mhc6 </td>
   <td style="text-align:left;"> <span style="     color: black !important;">-0.11</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">-0.05</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;"></span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;"></span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;"></span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;"></span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;"></span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;"></span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;"></span> </td>
  </tr>
<tr>
<td style="text-align:left;font-weight: bold;"> mhc9 </td>
   <td style="text-align:left;"> <span style="     color: black !important;">-0.07</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">-0.23</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">-0.11</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;"></span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;"></span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;"></span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;"></span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;"></span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;"></span> </td>
  </tr>
<tr>
<td style="text-align:left;font-weight: bold;"> mhc10 </td>
   <td style="text-align:left;"> <span style="     color: black !important;">-0.19</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">-0.22</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">-0.12</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">-0.07</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;"></span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;"></span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;"></span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;"></span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;"></span> </td>
  </tr>
<tr>
<td style="text-align:left;font-weight: bold;"> mhc11 </td>
   <td style="text-align:left;"> <span style="     color: black !important;">-0.04</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0.01</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">-0.19</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">-0.13</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">-0.07</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;"></span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;"></span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;"></span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;"></span> </td>
  </tr>
<tr>
<td style="text-align:left;font-weight: bold;"> mhc12 </td>
   <td style="text-align:left;"> <span style="     color: black !important;">-0.24</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">-0.26</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">-0.11</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">-0.15</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">-0.04</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">-0.08</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;"></span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;"></span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;"></span> </td>
  </tr>
<tr>
<td style="text-align:left;font-weight: bold;"> mhc13 </td>
   <td style="text-align:left;"> <span style="     color: black !important;">-0.16</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">-0.18</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">-0.17</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0.01</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">-0.15</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">-0.21</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">-0.04</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;"></span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;"></span> </td>
  </tr>
<tr>
<td style="text-align:left;font-weight: bold;"> mhc14 </td>
   <td style="text-align:left;"> <span style="     color: black !important;">-0.07</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">-0.24</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">-0.14</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">-0.04</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">-0.09</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">-0.16</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">-0.02</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">-0.04</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;"></span> </td>
  </tr>
</tbody>
<tfoot>
<tr><td style="padding: 0; " colspan="100%"><span style="font-style: italic;">Note: </span></td></tr>
<tr><td style="padding: 0; " colspan="100%">
<sup></sup> Relative cut-off value (highlighted in red) is 0.084, which is 0.2 above the average correlation.</td></tr>
</tfoot>
</table>
</div>
</div>
</div>
<div id="tabset-2-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-4-tab">
<div class="cell" data-hash="LatentResponse_cache/html/unnamed-chunk-10_96078994b6f14b774ab4b03f3374bc6c">
<details><summary>Code</summary><div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/RISEkbmRasch/man/RIloadLoc.html">RIloadLoc</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="LatentResponse_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid" width="1050"></p>
</div>
</div>
</div>
<div id="tabset-2-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-5-tab">
<div class="cell" data-hash="LatentResponse_cache/html/unnamed-chunk-11_83c574be81a9c5032f57d73397cae8c3">
<details><summary>Code</summary><div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># increase fig-height above as needed, if you have many items</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/RISEkbmRasch/man/RItargeting.html">RItargeting</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="LatentResponse_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid" width="1050"></p>
</div>
</div>
</div>
<div id="tabset-2-6" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-6-tab">
<div class="cell" data-hash="LatentResponse_cache/html/unnamed-chunk-12_fb7b944c0ce8195a4d9134fbd25b9fd9">
<details><summary>Code</summary><div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/RISEkbmRasch/man/RIitemHierarchy.html">RIitemHierarchy</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="LatentResponse_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid" width="1050"></p>
</div>
</div>
</div>
<div id="tabset-2-7" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-7-tab">
<p>Interaction between age and gender.</p>
<div class="cell" data-hash="LatentResponse_cache/html/unnamed-chunk-13_ec1c7d27b22e4174a4b90d3f70671083">
<details><summary>Code</summary><div class="sourceCode" id="cb12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">df.tree</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span>ncol <span class="op">=</span> <span class="fl">0</span>, nrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">df.tree</span><span class="op">$</span><span class="va">difdata</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span>
<span><span class="va">df.tree</span><span class="op">$</span><span class="va">dif.gender</span> <span class="op">&lt;-</span> <span class="va">dif.gender</span></span>
<span><span class="va">df.tree</span><span class="op">$</span><span class="va">dif.age</span><span class="op">&lt;-</span> <span class="va">dif.age</span></span>
<span></span>
<span><span class="va">pctree.out</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/psychotree/man/pctree.html">pctree</a></span><span class="op">(</span><span class="va">difdata</span> <span class="op">~</span> <span class="va">dif.gender</span> <span class="op">+</span> <span class="va">dif.age</span>, data <span class="op">=</span> <span class="va">df.tree</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">pctree.out</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="LatentResponse_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid" width="1050"></p>
</div>
</div>
<div class="cell" data-hash="LatentResponse_cache/html/unnamed-chunk-14_911f8eef6b23d22b95bca2fba01f50b0">
<details><summary>Code</summary><div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">cutoff</span> <span class="op">&lt;-</span> <span class="fl">0.5</span></span>
<span><span class="va">diffig</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/psychotools/man/itempar.html">itempar</a></span><span class="op">(</span><span class="va">pctree.out</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span></span>
<span>    `Mean location` <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html">rowMeans</a></span><span class="op">(</span><span class="va">.</span><span class="op">)</span>,</span>
<span>    StDev <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/matrixStats/man/rowSds.html">rowSds</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">.</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">rowwise</span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>MaxDiff <span class="op">=</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="fu">c_across</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">.</span><span class="op">)</span> <span class="op">-</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">-</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="fu">c_across</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">.</span><span class="op">)</span> <span class="op">-</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">ungroup</span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span><span class="fu">across</span><span class="op">(</span><span class="fu">where</span><span class="op">(</span><span class="va">is.numeric</span><span class="op">)</span>, <span class="va">round</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">rownames_to_column</span><span class="op">(</span>var <span class="op">=</span> <span class="st">"Item"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>Item <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">relocate</span><span class="op">(</span><span class="va">MaxDiff</span>, .after <span class="op">=</span> <span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html">last_col</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span>  <span class="fu"><a href="https://renkun-ken.github.io/formattable/reference/formattable.html">formattable</a></span><span class="op">(</span><span class="va">diffig</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>MaxDiff <span class="op">=</span> <span class="fu"><a href="https://renkun-ken.github.io/formattable/reference/formatter.html">formatter</a></span><span class="op">(</span><span class="st">"span"</span>,</span>
<span>      style <span class="op">=</span> <span class="op">~</span> <span class="fu"><a href="https://renkun-ken.github.io/formattable/reference/style.html">style</a></span><span class="op">(</span>color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">MaxDiff</span> <span class="op">&lt;</span> <span class="op">-</span><span class="va">cutoff</span>,</span>
<span>        <span class="st">"red"</span>, <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">MaxDiff</span> <span class="op">&gt;</span> <span class="va">cutoff</span>, <span class="st">"red"</span>, <span class="st">"black"</span><span class="op">)</span></span>
<span>      <span class="op">)</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>    <span class="op">)</span>,</span>
<span>    table.attr <span class="op">=</span> <span class="st">"class=\"table table-striped\" style=\"font-size: 15px; font-family: Lato\""</span></span>
<span>  <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">

<table class="table table-striped" style="font-size: 15px; font-family: Lato">
<thead><tr>
<th style="text-align:right;">
Item
</th>
<th style="text-align:right;">
2
</th>
<th style="text-align:right;">
3
</th>
<th style="text-align:right;">
Mean location
</th>
<th style="text-align:right;">
StDev
</th>
<th style="text-align:right;">
MaxDiff
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:right;">
mhc1
</td>
<td style="text-align:right;">
-0.836
</td>
<td style="text-align:right;">
-0.770
</td>
<td style="text-align:right;">
-0.803
</td>
<td style="text-align:right;">
0.047
</td>
<td style="text-align:right;">
<span style="color: black">0.067</span>
</td>
</tr>
<tr>
<td style="text-align:right;">
mhc5
</td>
<td style="text-align:right;">
-0.276
</td>
<td style="text-align:right;">
-0.390
</td>
<td style="text-align:right;">
-0.333
</td>
<td style="text-align:right;">
0.081
</td>
<td style="text-align:right;">
<span style="color: black">0.114</span>
</td>
</tr>
<tr>
<td style="text-align:right;">
mhc6
</td>
<td style="text-align:right;">
1.774
</td>
<td style="text-align:right;">
2.021
</td>
<td style="text-align:right;">
1.897
</td>
<td style="text-align:right;">
0.175
</td>
<td style="text-align:right;">
<span style="color: black">0.247</span>
</td>
</tr>
<tr>
<td style="text-align:right;">
mhc9
</td>
<td style="text-align:right;">
-0.148
</td>
<td style="text-align:right;">
0.109
</td>
<td style="text-align:right;">
-0.019
</td>
<td style="text-align:right;">
0.182
</td>
<td style="text-align:right;">
<span style="color: black">0.257</span>
</td>
</tr>
<tr>
<td style="text-align:right;">
mhc10
</td>
<td style="text-align:right;">
-0.010
</td>
<td style="text-align:right;">
-0.275
</td>
<td style="text-align:right;">
-0.143
</td>
<td style="text-align:right;">
0.187
</td>
<td style="text-align:right;">
<span style="color: black">0.265</span>
</td>
</tr>
<tr>
<td style="text-align:right;">
mhc11
</td>
<td style="text-align:right;">
-0.356
</td>
<td style="text-align:right;">
-0.718
</td>
<td style="text-align:right;">
-0.537
</td>
<td style="text-align:right;">
0.256
</td>
<td style="text-align:right;">
<span style="color: black">0.362</span>
</td>
</tr>
<tr>
<td style="text-align:right;">
mhc12
</td>
<td style="text-align:right;">
0.238
</td>
<td style="text-align:right;">
0.103
</td>
<td style="text-align:right;">
0.170
</td>
<td style="text-align:right;">
0.096
</td>
<td style="text-align:right;">
<span style="color: black">0.135</span>
</td>
</tr>
<tr>
<td style="text-align:right;">
mhc13
</td>
<td style="text-align:right;">
-0.299
</td>
<td style="text-align:right;">
-0.127
</td>
<td style="text-align:right;">
-0.213
</td>
<td style="text-align:right;">
0.122
</td>
<td style="text-align:right;">
<span style="color: black">0.172</span>
</td>
</tr>
<tr>
<td style="text-align:right;">
mhc14
</td>
<td style="text-align:right;">
-0.086
</td>
<td style="text-align:right;">
0.047
</td>
<td style="text-align:right;">
-0.020
</td>
<td style="text-align:right;">
0.094
</td>
<td style="text-align:right;">
<span style="color: black">0.133</span>
</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Only DIF between genders found, and none large enough to cause problems.</p>
</div>
<div id="tabset-2-8" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-8-tab">
<div class="cell" data-hash="LatentResponse_cache/html/unnamed-chunk-15_38f362fad67bacee576827f7f951f446">
<details><summary>Code</summary><div class="sourceCode" id="cb14"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/RISEkbmRasch/man/RItif.html">RItif</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="LatentResponse_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid" width="1050"></p>
</div>
</div>
</div>
</div>
</div>
<p>Item fit shows some minor issues, but we’ll leave them as good enough for the primary goal of visualization. Do have a look at the item hierarchy and give it some thought?</p>
</section><section id="estimating-latent-scores" class="level2" data-number="3"><h2 data-number="3" class="anchored" data-anchor-id="estimating-latent-scores">
<span class="header-section-number">3</span> Estimating latent scores</h2>
<p>First, we need the item threshold locations to later estimate person scores.</p>
<div class="cell" data-hash="LatentResponse_cache/html/unnamed-chunk-16_a6a033acea95c4032ed1d67f423aab45">
<details><summary>Code</summary><div class="sourceCode" id="cb15"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/RISEkbmRasch/man/RIitemparams.html">RIitemparams</a></span><span class="op">(</span><span class="va">df</span>, <span class="st">"mhcItemParams.csv"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">

<table class="table table-striped table-hover lightable-classic table" style="font-size: 15px; width: auto !important;  font-family: Lato; margin-left: auto; margin-right: auto; margin-left: auto; margin-right: auto;">
<thead><tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">   </th>
   <th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;"> Threshold 1 </th>
   <th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;"> Threshold 2 </th>
   <th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;"> Threshold 3 </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"> Item location </th>
  </tr></thead>
<tbody>
<tr>
<td style="text-align:left;font-weight: bold;"> mhc1 </td>
   <td style="text-align:right;"> -2.17 </td>
   <td style="text-align:right;"> -0.38 </td>
   <td style="text-align:right;"> 1.19 </td>
   <td style="text-align:left;"> <span style=" font-weight: bold;    text-align: right;">-0.45</span> </td>
  </tr>
<tr>
<td style="text-align:left;font-weight: bold;"> mhc5 </td>
   <td style="text-align:right;"> -0.60 </td>
   <td style="text-align:right;"> -0.01 </td>
   <td style="text-align:right;"> 0.66 </td>
   <td style="text-align:left;"> <span style=" font-weight: bold;    text-align: right;">0.02</span> </td>
  </tr>
<tr>
<td style="text-align:left;font-weight: bold;"> mhc6 </td>
   <td style="text-align:right;"> 1.17 </td>
   <td style="text-align:right;"> 2.34 </td>
   <td style="text-align:right;"> 3.14 </td>
   <td style="text-align:left;"> <span style=" font-weight: bold;    text-align: right;">2.22</span> </td>
  </tr>
<tr>
<td style="text-align:left;font-weight: bold;"> mhc9 </td>
   <td style="text-align:right;"> -0.78 </td>
   <td style="text-align:right;"> 0.55 </td>
   <td style="text-align:right;"> 1.25 </td>
   <td style="text-align:left;"> <span style=" font-weight: bold;    text-align: right;">0.34</span> </td>
  </tr>
<tr>
<td style="text-align:left;font-weight: bold;"> mhc10 </td>
   <td style="text-align:right;"> -1.16 </td>
   <td style="text-align:right;"> 0.49 </td>
   <td style="text-align:right;"> 1.30 </td>
   <td style="text-align:left;"> <span style=" font-weight: bold;    text-align: right;">0.21</span> </td>
  </tr>
<tr>
<td style="text-align:left;font-weight: bold;"> mhc11 </td>
   <td style="text-align:right;"> -1.49 </td>
   <td style="text-align:right;"> 0.11 </td>
   <td style="text-align:right;"> 0.82 </td>
   <td style="text-align:left;"> <span style=" font-weight: bold;    text-align: right;">-0.19</span> </td>
  </tr>
<tr>
<td style="text-align:left;font-weight: bold;"> mhc12 </td>
   <td style="text-align:right;"> -0.81 </td>
   <td style="text-align:right;"> 1.06 </td>
   <td style="text-align:right;"> 1.32 </td>
   <td style="text-align:left;"> <span style=" font-weight: bold;    text-align: right;">0.52</span> </td>
  </tr>
<tr>
<td style="text-align:left;font-weight: bold;"> mhc13 </td>
   <td style="text-align:right;"> -1.00 </td>
   <td style="text-align:right;"> 0.53 </td>
   <td style="text-align:right;"> 0.91 </td>
   <td style="text-align:left;"> <span style=" font-weight: bold;    text-align: right;">0.15</span> </td>
  </tr>
<tr>
<td style="text-align:left;font-weight: bold;"> mhc14 </td>
   <td style="text-align:right;"> -0.57 </td>
   <td style="text-align:right;"> 0.64 </td>
   <td style="text-align:right;"> 0.92 </td>
   <td style="text-align:left;"> <span style=" font-weight: bold;    text-align: right;">0.33</span> </td>
  </tr>
</tbody>
</table>
</div>
<details><summary>Code</summary><div class="sourceCode" id="cb16"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">MHCitemParameters</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.csv</a></span><span class="op">(</span><span class="st">"mhcItemParams.csv"</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Actually, the function used to estimate person scores can automatically estimate the item parameters. But since this is just a practical use case, and you might be interested in applying the item parameters on your own dataset (since I cannot share this data), I thought it worth mentioning and displaying the parameters.</p>
<div class="cell" data-hash="LatentResponse_cache/html/unnamed-chunk-17_bc76138b6c14d66f1c7ed0c9806fd1a6">
<details><summary>Code</summary><div class="sourceCode" id="cb17"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">df</span><span class="op">$</span><span class="va">MHCscore</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/RISEkbmRasch/man/RIestThetas2.html">RIestThetas2</a></span><span class="op">(</span><span class="va">df</span>, itemParams <span class="op">=</span> <span class="va">MHCitemParameters</span>, cpu <span class="op">=</span> <span class="fl">8</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="plotting-the-distribution" class="level3" data-number="3.1"><h3 data-number="3.1" class="anchored" data-anchor-id="plotting-the-distribution">
<span class="header-section-number">3.1</span> Plotting the distribution</h3>
<div class="cell" data-hash="LatentResponse_cache/html/unnamed-chunk-18_9bce349ed8756a3af6df7cf79c54055d">
<details><summary>Code</summary><div class="sourceCode" id="cb18"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># for visualization, we add Gender back to the df</span></span>
<span><span class="va">df</span><span class="op">$</span><span class="va">Gender</span> <span class="op">&lt;-</span> <span class="va">dif.gender</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">df</span>,<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">MHCscore</span>, y <span class="op">=</span> <span class="va">Gender</span>, fill <span class="op">=</span> <span class="va">Gender</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="http://mjskay.github.io/ggdist/reference/stat_slab.html">stat_slab</a></span><span class="op">(</span></span>
<span>    side <span class="op">=</span> <span class="st">"right"</span>, show.legend <span class="op">=</span> <span class="cn">F</span>,</span>
<span>    scale <span class="op">=</span> <span class="fl">0.7</span>, </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>fill_ramp <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html">after_stat</a></span><span class="op">(</span><span class="va">level</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    .width <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">.50</span>, <span class="fl">.75</span>, <span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/stat_summary.html">stat_summary</a></span><span class="op">(</span>fun.data <span class="op">=</span> <span class="st">"mean_cl_normal"</span>,show.legend <span class="op">=</span> <span class="cn">F</span>, size <span class="op">=</span> <span class="fl">.4</span>,</span>
<span>               position <span class="op">=</span> <span class="fu"><a href="https://docs.r4photobiology.info/ggpp/reference/position_dodgenudge.html">position_dodge2nudge</a></span><span class="op">(</span>x<span class="op">=</span><span class="fl">.05</span>,width <span class="op">=</span> <span class="fl">.8</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span><span class="fu"><a href="http://mjskay.github.io/ggdist/reference/scale_colour_ramp.html">scale_fill_ramp_discrete</a></span><span class="op">(</span>from<span class="op">=</span><span class="st">'black'</span>, aesthetics <span class="op">=</span> <span class="st">"fill_ramp"</span><span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html">scale_fill_viridis_d</a></span><span class="op">(</span>begin <span class="op">=</span> <span class="fl">0.4</span>, direction <span class="op">=</span> <span class="op">-</span><span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="st">"MHC-SF latent scores"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="st">""</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/RISEkbmRasch/man/theme_rise.html">theme_rise</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>axis.text.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">13</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="LatentResponse_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid" width="1050"></p>
</div>
</div>
</section></section><section id="preparing-visualization" class="level2" data-number="4"><h2 data-number="4" class="anchored" data-anchor-id="preparing-visualization">
<span class="header-section-number">4</span> Preparing visualization</h2>
<p>Let’s use some sample values, based on distribution quintiles, as a starting point.</p>
<div class="cell" data-hash="LatentResponse_cache/html/unnamed-chunk-19_43a9621bbc0506cc46d442d9f2d554cf">
<details><summary>Code</summary><div class="sourceCode" id="cb19"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">quintiles</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">MHCscore</span>, probs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.2</span>,<span class="fl">0.4</span>,<span class="fl">0.6</span>,<span class="fl">0.8</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">quintiles</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>       20%        40%        60%        80% 
-0.5148720  0.1545279  0.7598396  1.6389371 </code></pre>
</div>
</div>
<p>Now we find the mode responses for each item based on the respondents in each quintile.</p>
<p>First, lets make groupings based on the quintile cutoff values.</p>
<div class="cell" data-hash="LatentResponse_cache/html/unnamed-chunk-20_6c06c46dc72829cf7d7b05227791158d">
<details><summary>Code</summary><div class="sourceCode" id="cb21"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="va">df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>Q_group <span class="op">=</span> <span class="fu">case_when</span><span class="op">(</span><span class="va">MHCscore</span> <span class="op">&lt;</span> <span class="va">quintiles</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">~</span> <span class="st">"0-20"</span>,</span>
<span>                             <span class="va">MHCscore</span> <span class="op">&gt;=</span> <span class="va">quintiles</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">&amp;</span> <span class="va">MHCscore</span> <span class="op">&lt;</span> <span class="va">quintiles</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">~</span> <span class="st">"20-40"</span>,</span>
<span>                             <span class="va">MHCscore</span> <span class="op">&gt;=</span> <span class="va">quintiles</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">&amp;</span> <span class="va">MHCscore</span> <span class="op">&lt;</span> <span class="va">quintiles</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span> <span class="op">~</span> <span class="st">"40-60"</span>,</span>
<span>                             <span class="va">MHCscore</span> <span class="op">&gt;=</span> <span class="va">quintiles</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span> <span class="op">&amp;</span> <span class="va">MHCscore</span> <span class="op">&lt;</span> <span class="va">quintiles</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span> <span class="op">~</span> <span class="st">"60-80"</span>,</span>
<span>                             <span class="va">MHCscore</span> <span class="op">&gt;=</span> <span class="va">quintiles</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span> <span class="op">~</span> <span class="st">"80-100"</span>,</span>
<span>                             <span class="cn">TRUE</span> <span class="op">~</span> <span class="cn">NA</span><span class="op">)</span></span>
<span>         <span class="op">)</span></span>
<span></span>
<span><span class="va">df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/matrixStats/man/rowCounts.html">count</a></span><span class="op">(</span><span class="va">Q_group</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Q_group</span>, y <span class="op">=</span> <span class="va">n</span>, fill <span class="op">=</span> <span class="va">Q_group</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_col</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html">scale_fill_viridis_d</a></span><span class="op">(</span>begin <span class="op">=</span> <span class="fl">0.4</span>, direction <span class="op">=</span> <span class="op">-</span><span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/RISEkbmRasch/man/theme_rise.html">theme_rise</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="LatentResponse_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid" width="1050"></p>
</div>
</div>
<p>Identifying mode response categories for each item for each group is the next step</p>
<div class="cell" data-hash="LatentResponse_cache/html/unnamed-chunk-21_8a1435da8686805f102f91f51d67131c">
<details><summary>Code</summary><div class="sourceCode" id="cb22"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">Mode</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">ux</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span>  <span class="va">ux</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.min.html">which.max</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/tabulate.html">tabulate</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/match.html">match</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">ux</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># a df with one row per group and one column per item</span></span>
<span><span class="va">modeResponses</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span>ncol <span class="op">=</span> <span class="fl">9</span>, nrow <span class="op">=</span> <span class="fl">5</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">modeResponses</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html">starts_with</a></span><span class="op">(</span><span class="st">"mhc"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="op">!</span><span class="va">MHCscore</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">modeResponses</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">q0</span> <span class="op">&lt;-</span> <span class="fu"><a href="http://mjskay.github.io/ggdist/reference/point_interval.html">Mode</a></span><span class="op">(</span><span class="va">df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">Q_group</span> <span class="op">==</span> <span class="st">"0-20"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu">select</span><span class="op">(</span><span class="va">i</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html">na.omit</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu">pull</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">q1</span> <span class="op">&lt;-</span> <span class="fu"><a href="http://mjskay.github.io/ggdist/reference/point_interval.html">Mode</a></span><span class="op">(</span><span class="va">df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">Q_group</span> <span class="op">==</span> <span class="st">"20-40"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu">select</span><span class="op">(</span><span class="va">i</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html">na.omit</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu">pull</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">q2</span> <span class="op">&lt;-</span> <span class="fu"><a href="http://mjskay.github.io/ggdist/reference/point_interval.html">Mode</a></span><span class="op">(</span><span class="va">df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">Q_group</span> <span class="op">==</span> <span class="st">"40-60"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu">select</span><span class="op">(</span><span class="va">i</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html">na.omit</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu">pull</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">q3</span> <span class="op">&lt;-</span> <span class="fu"><a href="http://mjskay.github.io/ggdist/reference/point_interval.html">Mode</a></span><span class="op">(</span><span class="va">df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">Q_group</span> <span class="op">==</span> <span class="st">"60-80"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu">select</span><span class="op">(</span><span class="va">i</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html">na.omit</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu">pull</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">q4</span> <span class="op">&lt;-</span> <span class="fu"><a href="http://mjskay.github.io/ggdist/reference/point_interval.html">Mode</a></span><span class="op">(</span><span class="va">df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">Q_group</span> <span class="op">==</span> <span class="st">"80-100"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu">select</span><span class="op">(</span><span class="va">i</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html">na.omit</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu">pull</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">modeResponses</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="va">q0</span>,<span class="va">q1</span>,<span class="va">q2</span>,<span class="va">q3</span>,<span class="va">q4</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># transform to dataframe with numeric variables for later extraction as vectors</span></span>
<span><span class="va">modeResponses</span> <span class="op">&lt;-</span> <span class="va">modeResponses</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Estimating the latent score and SEM for each group’s mode response pattern.</p>
<div class="cell" data-hash="LatentResponse_cache/html/unnamed-chunk-22_12d65fac89b7a5a3061b16a7e3d6c794">
<details><summary>Code</summary><div class="sourceCode" id="cb23"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># sorry for the copy+paste code here...</span></span>
<span><span class="va">avg1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/catR/man/thetaEst.html">thetaEst</a></span><span class="op">(</span><span class="va">MHCitemParameters</span>, <span class="va">modeResponses</span><span class="op">$</span><span class="va">V1</span>, model <span class="op">=</span> <span class="st">"PCM"</span>, method <span class="op">=</span> <span class="st">"WL"</span><span class="op">)</span></span>
<span><span class="va">sem1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/catR/man/semTheta.html">semTheta</a></span><span class="op">(</span>thEst <span class="op">=</span> <span class="va">avg1</span>, it <span class="op">=</span> <span class="va">MHCitemParameters</span>, x <span class="op">=</span> <span class="va">modeResponses</span><span class="op">$</span><span class="va">V1</span>, model <span class="op">=</span> <span class="st">"PCM"</span>, method <span class="op">=</span> <span class="st">"WL"</span><span class="op">)</span></span>
<span><span class="va">avg2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/catR/man/thetaEst.html">thetaEst</a></span><span class="op">(</span><span class="va">MHCitemParameters</span>, <span class="va">modeResponses</span><span class="op">$</span><span class="va">V2</span>, model <span class="op">=</span> <span class="st">"PCM"</span>, method <span class="op">=</span> <span class="st">"WL"</span><span class="op">)</span></span>
<span><span class="va">sem2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/catR/man/semTheta.html">semTheta</a></span><span class="op">(</span>thEst <span class="op">=</span> <span class="va">avg2</span>, it <span class="op">=</span> <span class="va">MHCitemParameters</span>, x <span class="op">=</span> <span class="va">modeResponses</span><span class="op">$</span><span class="va">V2</span>, model <span class="op">=</span> <span class="st">"PCM"</span>, method <span class="op">=</span> <span class="st">"WL"</span><span class="op">)</span></span>
<span><span class="va">avg3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/catR/man/thetaEst.html">thetaEst</a></span><span class="op">(</span><span class="va">MHCitemParameters</span>, <span class="va">modeResponses</span><span class="op">$</span><span class="va">V3</span>, model <span class="op">=</span> <span class="st">"PCM"</span>, method <span class="op">=</span> <span class="st">"WL"</span><span class="op">)</span></span>
<span><span class="va">sem3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/catR/man/semTheta.html">semTheta</a></span><span class="op">(</span>thEst <span class="op">=</span> <span class="va">avg3</span>, it <span class="op">=</span> <span class="va">MHCitemParameters</span>, x <span class="op">=</span> <span class="va">modeResponses</span><span class="op">$</span><span class="va">V3</span>, model <span class="op">=</span> <span class="st">"PCM"</span>, method <span class="op">=</span> <span class="st">"WL"</span><span class="op">)</span></span>
<span><span class="va">avg4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/catR/man/thetaEst.html">thetaEst</a></span><span class="op">(</span><span class="va">MHCitemParameters</span>, <span class="va">modeResponses</span><span class="op">$</span><span class="va">V4</span>, model <span class="op">=</span> <span class="st">"PCM"</span>, method <span class="op">=</span> <span class="st">"WL"</span><span class="op">)</span></span>
<span><span class="va">sem4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/catR/man/semTheta.html">semTheta</a></span><span class="op">(</span>thEst <span class="op">=</span> <span class="va">avg4</span>, it <span class="op">=</span> <span class="va">MHCitemParameters</span>, x <span class="op">=</span> <span class="va">modeResponses</span><span class="op">$</span><span class="va">V4</span>, model <span class="op">=</span> <span class="st">"PCM"</span>, method <span class="op">=</span> <span class="st">"WL"</span><span class="op">)</span></span>
<span><span class="va">avg5</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/catR/man/thetaEst.html">thetaEst</a></span><span class="op">(</span><span class="va">MHCitemParameters</span>, <span class="va">modeResponses</span><span class="op">$</span><span class="va">V5</span>, model <span class="op">=</span> <span class="st">"PCM"</span>, method <span class="op">=</span> <span class="st">"WL"</span><span class="op">)</span></span>
<span><span class="va">sem5</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/catR/man/semTheta.html">semTheta</a></span><span class="op">(</span>thEst <span class="op">=</span> <span class="va">avg5</span>, it <span class="op">=</span> <span class="va">MHCitemParameters</span>, x <span class="op">=</span> <span class="va">modeResponses</span><span class="op">$</span><span class="va">V5</span>, model <span class="op">=</span> <span class="st">"PCM"</span>, method <span class="op">=</span> <span class="st">"WL"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section><section id="sec-visualization" class="level2" data-number="5"><h2 data-number="5" class="anchored" data-anchor-id="sec-visualization">
<span class="header-section-number">5</span> Visualization</h2>
<div class="cell" data-hash="LatentResponse_cache/html/unnamed-chunk-23_f485fd89f60d292acfc7f49cfc173a54">
<details><summary>Code</summary><div class="sourceCode" id="cb24"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">respTable</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">qLevel</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="co"># typical response patterns for different risk levels</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="va">qLevel</span> <span class="op">==</span> <span class="st">"0-20"</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="va">p.resp</span> <span class="op">&lt;-</span> <span class="va">modeResponses</span><span class="op">$</span><span class="va">V1</span> </span>
<span>    <span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span> <span class="op">(</span><span class="va">qLevel</span> <span class="op">==</span> <span class="st">"20-40"</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="va">p.resp</span> <span class="op">&lt;-</span> <span class="va">modeResponses</span><span class="op">$</span><span class="va">V2</span> </span>
<span>    <span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span> <span class="op">(</span><span class="va">qLevel</span> <span class="op">==</span> <span class="st">"40-60"</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="va">p.resp</span> <span class="op">&lt;-</span> <span class="va">modeResponses</span><span class="op">$</span><span class="va">V3</span> </span>
<span>    <span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span> <span class="op">(</span><span class="va">qLevel</span> <span class="op">==</span> <span class="st">"60-80"</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="va">p.resp</span> <span class="op">&lt;-</span> <span class="va">modeResponses</span><span class="op">$</span><span class="va">V4</span> </span>
<span>    <span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span> <span class="op">(</span><span class="va">qLevel</span> <span class="op">==</span> <span class="st">"80-100"</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="va">p.resp</span> <span class="op">&lt;-</span> <span class="va">modeResponses</span><span class="op">$</span><span class="va">V5</span> </span>
<span>    <span class="op">}</span></span>
<span></span>
<span>    <span class="va">itemresponses</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>      <span class="fu"><a href="https://renkun-ken.github.io/formattable/reference/formattable.html">formattable</a></span><span class="op">(</span><span class="va">.</span>,</span>
<span>        align <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"r"</span>, <span class="st">"l"</span>, <span class="st">"c"</span>, <span class="st">"c"</span>, <span class="st">"c"</span>, <span class="st">"c"</span>, <span class="st">"c"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>          <span class="fu">formattable</span><span class="fu">::</span><span class="fu"><a href="https://renkun-ken.github.io/formattable/reference/area.html">area</a></span><span class="op">(</span>row <span class="op">=</span> <span class="fl">1</span>, col <span class="op">=</span> <span class="fl">3</span> <span class="op">+</span> <span class="va">p.resp</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span> <span class="op">~</span> <span class="fu"><a href="https://renkun-ken.github.io/formattable/reference/color_tile.html">color_tile</a></span><span class="op">(</span><span class="st">"lightblue"</span>, <span class="st">"lightpink"</span><span class="op">)</span>,</span>
<span>          <span class="fu">formattable</span><span class="fu">::</span><span class="fu"><a href="https://renkun-ken.github.io/formattable/reference/area.html">area</a></span><span class="op">(</span>row <span class="op">=</span> <span class="fl">2</span>, col <span class="op">=</span> <span class="fl">3</span> <span class="op">+</span> <span class="va">p.resp</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span> <span class="op">~</span> <span class="fu"><a href="https://renkun-ken.github.io/formattable/reference/color_tile.html">color_tile</a></span><span class="op">(</span><span class="st">"lightblue"</span>, <span class="st">"lightpink"</span><span class="op">)</span>,</span>
<span>          <span class="fu">formattable</span><span class="fu">::</span><span class="fu"><a href="https://renkun-ken.github.io/formattable/reference/area.html">area</a></span><span class="op">(</span>row <span class="op">=</span> <span class="fl">3</span>, col <span class="op">=</span> <span class="fl">3</span> <span class="op">+</span> <span class="va">p.resp</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span> <span class="op">~</span> <span class="fu"><a href="https://renkun-ken.github.io/formattable/reference/color_tile.html">color_tile</a></span><span class="op">(</span><span class="st">"lightblue"</span>, <span class="st">"lightpink"</span><span class="op">)</span>,</span>
<span>          <span class="fu">formattable</span><span class="fu">::</span><span class="fu"><a href="https://renkun-ken.github.io/formattable/reference/area.html">area</a></span><span class="op">(</span>row <span class="op">=</span> <span class="fl">4</span>, col <span class="op">=</span> <span class="fl">3</span> <span class="op">+</span> <span class="va">p.resp</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span><span class="op">)</span> <span class="op">~</span> <span class="fu"><a href="https://renkun-ken.github.io/formattable/reference/color_tile.html">color_tile</a></span><span class="op">(</span><span class="st">"lightblue"</span>, <span class="st">"lightpink"</span><span class="op">)</span>,</span>
<span>          <span class="fu">formattable</span><span class="fu">::</span><span class="fu"><a href="https://renkun-ken.github.io/formattable/reference/area.html">area</a></span><span class="op">(</span>row <span class="op">=</span> <span class="fl">5</span>, col <span class="op">=</span> <span class="fl">3</span> <span class="op">+</span> <span class="va">p.resp</span><span class="op">[</span><span class="fl">5</span><span class="op">]</span><span class="op">)</span> <span class="op">~</span> <span class="fu"><a href="https://renkun-ken.github.io/formattable/reference/color_tile.html">color_tile</a></span><span class="op">(</span><span class="st">"lightblue"</span>, <span class="st">"lightpink"</span><span class="op">)</span>,</span>
<span>          <span class="fu">formattable</span><span class="fu">::</span><span class="fu"><a href="https://renkun-ken.github.io/formattable/reference/area.html">area</a></span><span class="op">(</span>row <span class="op">=</span> <span class="fl">6</span>, col <span class="op">=</span> <span class="fl">3</span> <span class="op">+</span> <span class="va">p.resp</span><span class="op">[</span><span class="fl">6</span><span class="op">]</span><span class="op">)</span> <span class="op">~</span> <span class="fu"><a href="https://renkun-ken.github.io/formattable/reference/color_tile.html">color_tile</a></span><span class="op">(</span><span class="st">"lightblue"</span>, <span class="st">"lightpink"</span><span class="op">)</span>,</span>
<span>          <span class="fu">formattable</span><span class="fu">::</span><span class="fu"><a href="https://renkun-ken.github.io/formattable/reference/area.html">area</a></span><span class="op">(</span>row <span class="op">=</span> <span class="fl">7</span>, col <span class="op">=</span> <span class="fl">3</span> <span class="op">+</span> <span class="va">p.resp</span><span class="op">[</span><span class="fl">7</span><span class="op">]</span><span class="op">)</span> <span class="op">~</span> <span class="fu"><a href="https://renkun-ken.github.io/formattable/reference/color_tile.html">color_tile</a></span><span class="op">(</span><span class="st">"lightblue"</span>, <span class="st">"lightpink"</span><span class="op">)</span>,</span>
<span>          <span class="fu">formattable</span><span class="fu">::</span><span class="fu"><a href="https://renkun-ken.github.io/formattable/reference/area.html">area</a></span><span class="op">(</span>row <span class="op">=</span> <span class="fl">8</span>, col <span class="op">=</span> <span class="fl">3</span> <span class="op">+</span> <span class="va">p.resp</span><span class="op">[</span><span class="fl">8</span><span class="op">]</span><span class="op">)</span> <span class="op">~</span> <span class="fu"><a href="https://renkun-ken.github.io/formattable/reference/color_tile.html">color_tile</a></span><span class="op">(</span><span class="st">"lightblue"</span>, <span class="st">"lightpink"</span><span class="op">)</span>,</span>
<span>          <span class="fu">formattable</span><span class="fu">::</span><span class="fu"><a href="https://renkun-ken.github.io/formattable/reference/area.html">area</a></span><span class="op">(</span>row <span class="op">=</span> <span class="fl">9</span>, col <span class="op">=</span> <span class="fl">3</span> <span class="op">+</span> <span class="va">p.resp</span><span class="op">[</span><span class="fl">9</span><span class="op">]</span><span class="op">)</span> <span class="op">~</span> <span class="fu"><a href="https://renkun-ken.github.io/formattable/reference/color_tile.html">color_tile</a></span><span class="op">(</span><span class="st">"lightblue"</span>, <span class="st">"lightpink"</span><span class="op">)</span></span>
<span>        <span class="op">)</span>,</span>
<span>        table.attr <span class="op">=</span> <span class="st">'class=\"table table-striped\" style="font-size: 15px; font-family: Lato"'</span></span>
<span>      <span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">respDist</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">qLevel</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">qLevel</span> <span class="op">==</span> <span class="st">"0-20"</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="va">score</span> <span class="op">&lt;-</span> <span class="va">avg1</span></span>
<span>      <span class="va">sem</span> <span class="op">&lt;-</span> <span class="va">sem1</span></span>
<span>    <span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span> <span class="op">(</span><span class="va">qLevel</span> <span class="op">==</span> <span class="st">"20-40"</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="va">score</span> <span class="op">&lt;-</span> <span class="va">avg2</span></span>
<span>      <span class="va">sem</span> <span class="op">&lt;-</span> <span class="va">sem2</span></span>
<span>    <span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span> <span class="op">(</span><span class="va">qLevel</span> <span class="op">==</span> <span class="st">"40-60"</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="va">score</span> <span class="op">&lt;-</span> <span class="va">avg3</span></span>
<span>      <span class="va">sem</span> <span class="op">&lt;-</span> <span class="va">sem3</span></span>
<span>    <span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span> <span class="op">(</span><span class="va">qLevel</span> <span class="op">==</span> <span class="st">"60-80"</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="va">score</span> <span class="op">&lt;-</span> <span class="va">avg4</span></span>
<span>      <span class="va">sem</span> <span class="op">&lt;-</span> <span class="va">sem4</span></span>
<span>    <span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span> <span class="op">(</span><span class="va">qLevel</span> <span class="op">==</span> <span class="st">"80-100"</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="va">score</span> <span class="op">&lt;-</span> <span class="va">avg5</span></span>
<span>      <span class="va">sem</span> <span class="op">&lt;-</span> <span class="va">sem5</span></span>
<span>    <span class="op">}</span></span>
<span></span>
<span>  <span class="va">qlabel</span> <span class="op">&lt;-</span> <span class="va">qLevel</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">MHCscore</span>, y <span class="op">=</span> <span class="va">Gender</span>, fill <span class="op">=</span> <span class="va">Gender</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="http://mjskay.github.io/ggdist/reference/stat_slab.html">stat_slab</a></span><span class="op">(</span></span>
<span>    side <span class="op">=</span> <span class="st">"right"</span>, show.legend <span class="op">=</span> <span class="cn">F</span>,</span>
<span>    scale <span class="op">=</span> <span class="fl">0.8</span>, justification <span class="op">=</span> <span class="fl">0</span>,</span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>fill_ramp <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html">after_stat</a></span><span class="op">(</span><span class="va">level</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    .width <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">.50</span>, <span class="fl">.75</span>, <span class="fl">1</span><span class="op">)</span></span>
<span>    </span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/stat_summary.html">stat_summary</a></span><span class="op">(</span></span>
<span>    fun.data <span class="op">=</span> <span class="st">"mean_cl_normal"</span>, show.legend <span class="op">=</span> <span class="cn">F</span>, size <span class="op">=</span> <span class="fl">.4</span>,</span>
<span>    position <span class="op">=</span> <span class="fu"><a href="https://docs.r4photobiology.info/ggpp/reference/position_dodgenudge.html">position_dodge2nudge</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">.05</span>, width <span class="op">=</span> <span class="fl">.8</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="http://mjskay.github.io/ggdist/reference/scale_colour_ramp.html">scale_fill_ramp_discrete</a></span><span class="op">(</span>from <span class="op">=</span> <span class="st">"black"</span>, aesthetics <span class="op">=</span> <span class="st">"fill_ramp"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html">scale_fill_viridis_d</a></span><span class="op">(</span>begin <span class="op">=</span> <span class="fl">0.4</span>, direction <span class="op">=</span> <span class="op">-</span><span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="va">score</span>, color <span class="op">=</span> <span class="st">"red"</span>, linetype <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">annotate</span><span class="op">(</span><span class="st">"rect"</span>, ymin <span class="op">=</span> <span class="fl">0</span>, ymax <span class="op">=</span> <span class="cn">Inf</span>, xmin <span class="op">=</span> <span class="va">score</span> <span class="op">-</span> <span class="va">sem</span>, xmax <span class="op">=</span> <span class="va">score</span> <span class="op">+</span> <span class="va">sem</span>, alpha <span class="op">=</span> <span class="fl">.15</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co">#annotate("text", label = qlabel, x = score-0.12, y = 1.5, </span></span>
<span>  <span class="co">#         angle = 90, size = 4, family = "Lato") +</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="st">"MHC-SF latent scores"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="st">""</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/RISEkbmRasch/man/theme_rise.html">theme_rise</a></span><span class="op">(</span>axissize <span class="op">=</span> <span class="fl">11</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>axis.text.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">11</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_discrete.html">scale_y_discrete</a></span><span class="op">(</span>expand <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-3-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-1" role="tab" aria-controls="tabset-3-1" aria-selected="true">0-20</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-2" role="tab" aria-controls="tabset-3-2" aria-selected="false">20-40</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-3" role="tab" aria-controls="tabset-3-3" aria-selected="false">40-60</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-4" role="tab" aria-controls="tabset-3-4" aria-selected="false">60-80</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-5" role="tab" aria-controls="tabset-3-5" aria-selected="false">80-100</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-6-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-6" role="tab" aria-controls="tabset-3-6" aria-selected="false">All together</a></li>
</ul>
<div class="tab-content">
<div id="tabset-3-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-3-1-tab">
<div class="cell" data-hash="LatentResponse_cache/html/unnamed-chunk-24_3e7dddf2848b742960eab808b78a70db">
<details><summary>Code</summary><div class="sourceCode" id="cb25"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">respTable</span><span class="op">(</span><span class="st">"0-20"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">

<table class="table table-striped" style="font-size: 15px; font-family: Lato">
<thead><tr>
<th style="text-align:right;">
itemnr
</th>
<th style="text-align:left;">
How often during the past month did you feel…
</th>
<th style="text-align:center;">
Category0
</th>
<th style="text-align:center;">
Category1
</th>
<th style="text-align:center;">
Category2
</th>
<th style="text-align:center;">
Category3
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:right;">
mhc1
</td>
<td style="text-align:left;">
happy
</td>
<td style="text-align:center;">
Never/once or twice
</td>
<td style="text-align:center;">
<span style="display: block; padding: 0 4px; border-radius: 4px; background-color: #add8e6">1-3 times a week</span>
</td>
<td style="text-align:center;">
Almost every day
</td>
<td style="text-align:center;">
Every day
</td>
</tr>
<tr>
<td style="text-align:right;">
mhc5
</td>
<td style="text-align:left;">
that you belonged to a community
</td>
<td style="text-align:center;">
<span style="display: block; padding: 0 4px; border-radius: 4px; background-color: #add8e6">Never/once or twice</span>
</td>
<td style="text-align:center;">
1-3 times a week
</td>
<td style="text-align:center;">
Almost every day
</td>
<td style="text-align:center;">
Every day
</td>
</tr>
<tr>
<td style="text-align:right;">
mhc6
</td>
<td style="text-align:left;">
that our society is becoming a better place for people like you
</td>
<td style="text-align:center;">
<span style="display: block; padding: 0 4px; border-radius: 4px; background-color: #add8e6">Never/once or twice</span>
</td>
<td style="text-align:center;">
1-3 times a week
</td>
<td style="text-align:center;">
Almost every day
</td>
<td style="text-align:center;">
Every day
</td>
</tr>
<tr>
<td style="text-align:right;">
mhc9
</td>
<td style="text-align:left;">
that you liked most parts of your personality
</td>
<td style="text-align:center;">
<span style="display: block; padding: 0 4px; border-radius: 4px; background-color: #add8e6">Never/once or twice</span>
</td>
<td style="text-align:center;">
1-3 times a week
</td>
<td style="text-align:center;">
Almost every day
</td>
<td style="text-align:center;">
Every day
</td>
</tr>
<tr>
<td style="text-align:right;">
mhc10
</td>
<td style="text-align:left;">
good at managing the responsibilities of your daily life
</td>
<td style="text-align:center;">
<span style="display: block; padding: 0 4px; border-radius: 4px; background-color: #add8e6">Never/once or twice</span>
</td>
<td style="text-align:center;">
1-3 times a week
</td>
<td style="text-align:center;">
Almost every day
</td>
<td style="text-align:center;">
Every day
</td>
</tr>
<tr>
<td style="text-align:right;">
mhc11
</td>
<td style="text-align:left;">
that you had warm and trusting relationships with others
</td>
<td style="text-align:center;">
<span style="display: block; padding: 0 4px; border-radius: 4px; background-color: #add8e6">Never/once or twice</span>
</td>
<td style="text-align:center;">
1-3 times a week
</td>
<td style="text-align:center;">
Almost every day
</td>
<td style="text-align:center;">
Every day
</td>
</tr>
<tr>
<td style="text-align:right;">
mhc12
</td>
<td style="text-align:left;">
that you had experiences that challenged you to grow and become a better person
</td>
<td style="text-align:center;">
<span style="display: block; padding: 0 4px; border-radius: 4px; background-color: #add8e6">Never/once or twice</span>
</td>
<td style="text-align:center;">
1-3 times a week
</td>
<td style="text-align:center;">
Almost every day
</td>
<td style="text-align:center;">
Every day
</td>
</tr>
<tr>
<td style="text-align:right;">
mhc13
</td>
<td style="text-align:left;">
confident to think or express your own ideas and opinions
</td>
<td style="text-align:center;">
<span style="display: block; padding: 0 4px; border-radius: 4px; background-color: #add8e6">Never/once or twice</span>
</td>
<td style="text-align:center;">
1-3 times a week
</td>
<td style="text-align:center;">
Almost every day
</td>
<td style="text-align:center;">
Every day
</td>
</tr>
<tr>
<td style="text-align:right;">
mhc14
</td>
<td style="text-align:left;">
that your life has a sense of direction or meaning to it
</td>
<td style="text-align:center;">
<span style="display: block; padding: 0 4px; border-radius: 4px; background-color: #add8e6">Never/once or twice</span>
</td>
<td style="text-align:center;">
1-3 times a week
</td>
<td style="text-align:center;">
Almost every day
</td>
<td style="text-align:center;">
Every day
</td>
</tr>
</tbody>
</table>
</div>
<details><summary>Code</summary><div class="sourceCode" id="cb26"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">respDist</span><span class="op">(</span><span class="st">"0-20"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="LatentResponse_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid" width="1050"></p>
</div>
</div>
</div>
<div id="tabset-3-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-2-tab">
<div class="cell" data-hash="LatentResponse_cache/html/unnamed-chunk-25_6d2da16c009893ed6a1f3dad29245613">
<details><summary>Code</summary><div class="sourceCode" id="cb27"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">respTable</span><span class="op">(</span><span class="st">"20-40"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">

<table class="table table-striped" style="font-size: 15px; font-family: Lato">
<thead><tr>
<th style="text-align:right;">
itemnr
</th>
<th style="text-align:left;">
How often during the past month did you feel…
</th>
<th style="text-align:center;">
Category0
</th>
<th style="text-align:center;">
Category1
</th>
<th style="text-align:center;">
Category2
</th>
<th style="text-align:center;">
Category3
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:right;">
mhc1
</td>
<td style="text-align:left;">
happy
</td>
<td style="text-align:center;">
Never/once or twice
</td>
<td style="text-align:center;">
1-3 times a week
</td>
<td style="text-align:center;">
<span style="display: block; padding: 0 4px; border-radius: 4px; background-color: #add8e6">Almost every day</span>
</td>
<td style="text-align:center;">
Every day
</td>
</tr>
<tr>
<td style="text-align:right;">
mhc5
</td>
<td style="text-align:left;">
that you belonged to a community
</td>
<td style="text-align:center;">
Never/once or twice
</td>
<td style="text-align:center;">
<span style="display: block; padding: 0 4px; border-radius: 4px; background-color: #add8e6">1-3 times a week</span>
</td>
<td style="text-align:center;">
Almost every day
</td>
<td style="text-align:center;">
Every day
</td>
</tr>
<tr>
<td style="text-align:right;">
mhc6
</td>
<td style="text-align:left;">
that our society is becoming a better place for people like you
</td>
<td style="text-align:center;">
<span style="display: block; padding: 0 4px; border-radius: 4px; background-color: #add8e6">Never/once or twice</span>
</td>
<td style="text-align:center;">
1-3 times a week
</td>
<td style="text-align:center;">
Almost every day
</td>
<td style="text-align:center;">
Every day
</td>
</tr>
<tr>
<td style="text-align:right;">
mhc9
</td>
<td style="text-align:left;">
that you liked most parts of your personality
</td>
<td style="text-align:center;">
Never/once or twice
</td>
<td style="text-align:center;">
<span style="display: block; padding: 0 4px; border-radius: 4px; background-color: #add8e6">1-3 times a week</span>
</td>
<td style="text-align:center;">
Almost every day
</td>
<td style="text-align:center;">
Every day
</td>
</tr>
<tr>
<td style="text-align:right;">
mhc10
</td>
<td style="text-align:left;">
good at managing the responsibilities of your daily life
</td>
<td style="text-align:center;">
Never/once or twice
</td>
<td style="text-align:center;">
<span style="display: block; padding: 0 4px; border-radius: 4px; background-color: #add8e6">1-3 times a week</span>
</td>
<td style="text-align:center;">
Almost every day
</td>
<td style="text-align:center;">
Every day
</td>
</tr>
<tr>
<td style="text-align:right;">
mhc11
</td>
<td style="text-align:left;">
that you had warm and trusting relationships with others
</td>
<td style="text-align:center;">
Never/once or twice
</td>
<td style="text-align:center;">
<span style="display: block; padding: 0 4px; border-radius: 4px; background-color: #add8e6">1-3 times a week</span>
</td>
<td style="text-align:center;">
Almost every day
</td>
<td style="text-align:center;">
Every day
</td>
</tr>
<tr>
<td style="text-align:right;">
mhc12
</td>
<td style="text-align:left;">
that you had experiences that challenged you to grow and become a better person
</td>
<td style="text-align:center;">
Never/once or twice
</td>
<td style="text-align:center;">
<span style="display: block; padding: 0 4px; border-radius: 4px; background-color: #add8e6">1-3 times a week</span>
</td>
<td style="text-align:center;">
Almost every day
</td>
<td style="text-align:center;">
Every day
</td>
</tr>
<tr>
<td style="text-align:right;">
mhc13
</td>
<td style="text-align:left;">
confident to think or express your own ideas and opinions
</td>
<td style="text-align:center;">
Never/once or twice
</td>
<td style="text-align:center;">
<span style="display: block; padding: 0 4px; border-radius: 4px; background-color: #add8e6">1-3 times a week</span>
</td>
<td style="text-align:center;">
Almost every day
</td>
<td style="text-align:center;">
Every day
</td>
</tr>
<tr>
<td style="text-align:right;">
mhc14
</td>
<td style="text-align:left;">
that your life has a sense of direction or meaning to it
</td>
<td style="text-align:center;">
Never/once or twice
</td>
<td style="text-align:center;">
<span style="display: block; padding: 0 4px; border-radius: 4px; background-color: #add8e6">1-3 times a week</span>
</td>
<td style="text-align:center;">
Almost every day
</td>
<td style="text-align:center;">
Every day
</td>
</tr>
</tbody>
</table>
</div>
<details><summary>Code</summary><div class="sourceCode" id="cb28"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">respDist</span><span class="op">(</span><span class="st">"20-40"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="LatentResponse_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid" width="1050"></p>
</div>
</div>
</div>
<div id="tabset-3-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-3-tab">
<div class="cell" data-hash="LatentResponse_cache/html/unnamed-chunk-26_47214ce57f45851e832fca99858a09d0">
<details><summary>Code</summary><div class="sourceCode" id="cb29"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">respTable</span><span class="op">(</span><span class="st">"40-60"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">

<table class="table table-striped" style="font-size: 15px; font-family: Lato">
<thead><tr>
<th style="text-align:right;">
itemnr
</th>
<th style="text-align:left;">
How often during the past month did you feel…
</th>
<th style="text-align:center;">
Category0
</th>
<th style="text-align:center;">
Category1
</th>
<th style="text-align:center;">
Category2
</th>
<th style="text-align:center;">
Category3
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:right;">
mhc1
</td>
<td style="text-align:left;">
happy
</td>
<td style="text-align:center;">
Never/once or twice
</td>
<td style="text-align:center;">
1-3 times a week
</td>
<td style="text-align:center;">
<span style="display: block; padding: 0 4px; border-radius: 4px; background-color: #add8e6">Almost every day</span>
</td>
<td style="text-align:center;">
Every day
</td>
</tr>
<tr>
<td style="text-align:right;">
mhc5
</td>
<td style="text-align:left;">
that you belonged to a community
</td>
<td style="text-align:center;">
Never/once or twice
</td>
<td style="text-align:center;">
1-3 times a week
</td>
<td style="text-align:center;">
<span style="display: block; padding: 0 4px; border-radius: 4px; background-color: #add8e6">Almost every day</span>
</td>
<td style="text-align:center;">
Every day
</td>
</tr>
<tr>
<td style="text-align:right;">
mhc6
</td>
<td style="text-align:left;">
that our society is becoming a better place for people like you
</td>
<td style="text-align:center;">
<span style="display: block; padding: 0 4px; border-radius: 4px; background-color: #add8e6">Never/once or twice</span>
</td>
<td style="text-align:center;">
1-3 times a week
</td>
<td style="text-align:center;">
Almost every day
</td>
<td style="text-align:center;">
Every day
</td>
</tr>
<tr>
<td style="text-align:right;">
mhc9
</td>
<td style="text-align:left;">
that you liked most parts of your personality
</td>
<td style="text-align:center;">
Never/once or twice
</td>
<td style="text-align:center;">
1-3 times a week
</td>
<td style="text-align:center;">
<span style="display: block; padding: 0 4px; border-radius: 4px; background-color: #add8e6">Almost every day</span>
</td>
<td style="text-align:center;">
Every day
</td>
</tr>
<tr>
<td style="text-align:right;">
mhc10
</td>
<td style="text-align:left;">
good at managing the responsibilities of your daily life
</td>
<td style="text-align:center;">
Never/once or twice
</td>
<td style="text-align:center;">
<span style="display: block; padding: 0 4px; border-radius: 4px; background-color: #add8e6">1-3 times a week</span>
</td>
<td style="text-align:center;">
Almost every day
</td>
<td style="text-align:center;">
Every day
</td>
</tr>
<tr>
<td style="text-align:right;">
mhc11
</td>
<td style="text-align:left;">
that you had warm and trusting relationships with others
</td>
<td style="text-align:center;">
Never/once or twice
</td>
<td style="text-align:center;">
1-3 times a week
</td>
<td style="text-align:center;">
<span style="display: block; padding: 0 4px; border-radius: 4px; background-color: #add8e6">Almost every day</span>
</td>
<td style="text-align:center;">
Every day
</td>
</tr>
<tr>
<td style="text-align:right;">
mhc12
</td>
<td style="text-align:left;">
that you had experiences that challenged you to grow and become a better person
</td>
<td style="text-align:center;">
Never/once or twice
</td>
<td style="text-align:center;">
<span style="display: block; padding: 0 4px; border-radius: 4px; background-color: #add8e6">1-3 times a week</span>
</td>
<td style="text-align:center;">
Almost every day
</td>
<td style="text-align:center;">
Every day
</td>
</tr>
<tr>
<td style="text-align:right;">
mhc13
</td>
<td style="text-align:left;">
confident to think or express your own ideas and opinions
</td>
<td style="text-align:center;">
Never/once or twice
</td>
<td style="text-align:center;">
<span style="display: block; padding: 0 4px; border-radius: 4px; background-color: #add8e6">1-3 times a week</span>
</td>
<td style="text-align:center;">
Almost every day
</td>
<td style="text-align:center;">
Every day
</td>
</tr>
<tr>
<td style="text-align:right;">
mhc14
</td>
<td style="text-align:left;">
that your life has a sense of direction or meaning to it
</td>
<td style="text-align:center;">
Never/once or twice
</td>
<td style="text-align:center;">
<span style="display: block; padding: 0 4px; border-radius: 4px; background-color: #add8e6">1-3 times a week</span>
</td>
<td style="text-align:center;">
Almost every day
</td>
<td style="text-align:center;">
Every day
</td>
</tr>
</tbody>
</table>
</div>
<details><summary>Code</summary><div class="sourceCode" id="cb30"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">respDist</span><span class="op">(</span><span class="st">"40-60"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="LatentResponse_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid" width="1050"></p>
</div>
</div>
</div>
<div id="tabset-3-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-4-tab">
<div class="cell" data-hash="LatentResponse_cache/html/unnamed-chunk-27_46adfd86e5859ca79451e25801220b3a">
<details><summary>Code</summary><div class="sourceCode" id="cb31"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">respTable</span><span class="op">(</span><span class="st">"60-80"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">

<table class="table table-striped" style="font-size: 15px; font-family: Lato">
<thead><tr>
<th style="text-align:right;">
itemnr
</th>
<th style="text-align:left;">
How often during the past month did you feel…
</th>
<th style="text-align:center;">
Category0
</th>
<th style="text-align:center;">
Category1
</th>
<th style="text-align:center;">
Category2
</th>
<th style="text-align:center;">
Category3
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:right;">
mhc1
</td>
<td style="text-align:left;">
happy
</td>
<td style="text-align:center;">
Never/once or twice
</td>
<td style="text-align:center;">
1-3 times a week
</td>
<td style="text-align:center;">
<span style="display: block; padding: 0 4px; border-radius: 4px; background-color: #add8e6">Almost every day</span>
</td>
<td style="text-align:center;">
Every day
</td>
</tr>
<tr>
<td style="text-align:right;">
mhc5
</td>
<td style="text-align:left;">
that you belonged to a community
</td>
<td style="text-align:center;">
Never/once or twice
</td>
<td style="text-align:center;">
1-3 times a week
</td>
<td style="text-align:center;">
Almost every day
</td>
<td style="text-align:center;">
<span style="display: block; padding: 0 4px; border-radius: 4px; background-color: #add8e6">Every day</span>
</td>
</tr>
<tr>
<td style="text-align:right;">
mhc6
</td>
<td style="text-align:left;">
that our society is becoming a better place for people like you
</td>
<td style="text-align:center;">
<span style="display: block; padding: 0 4px; border-radius: 4px; background-color: #add8e6">Never/once or twice</span>
</td>
<td style="text-align:center;">
1-3 times a week
</td>
<td style="text-align:center;">
Almost every day
</td>
<td style="text-align:center;">
Every day
</td>
</tr>
<tr>
<td style="text-align:right;">
mhc9
</td>
<td style="text-align:left;">
that you liked most parts of your personality
</td>
<td style="text-align:center;">
Never/once or twice
</td>
<td style="text-align:center;">
1-3 times a week
</td>
<td style="text-align:center;">
<span style="display: block; padding: 0 4px; border-radius: 4px; background-color: #add8e6">Almost every day</span>
</td>
<td style="text-align:center;">
Every day
</td>
</tr>
<tr>
<td style="text-align:right;">
mhc10
</td>
<td style="text-align:left;">
good at managing the responsibilities of your daily life
</td>
<td style="text-align:center;">
Never/once or twice
</td>
<td style="text-align:center;">
1-3 times a week
</td>
<td style="text-align:center;">
<span style="display: block; padding: 0 4px; border-radius: 4px; background-color: #add8e6">Almost every day</span>
</td>
<td style="text-align:center;">
Every day
</td>
</tr>
<tr>
<td style="text-align:right;">
mhc11
</td>
<td style="text-align:left;">
that you had warm and trusting relationships with others
</td>
<td style="text-align:center;">
Never/once or twice
</td>
<td style="text-align:center;">
1-3 times a week
</td>
<td style="text-align:center;">
<span style="display: block; padding: 0 4px; border-radius: 4px; background-color: #add8e6">Almost every day</span>
</td>
<td style="text-align:center;">
Every day
</td>
</tr>
<tr>
<td style="text-align:right;">
mhc12
</td>
<td style="text-align:left;">
that you had experiences that challenged you to grow and become a better person
</td>
<td style="text-align:center;">
Never/once or twice
</td>
<td style="text-align:center;">
1-3 times a week
</td>
<td style="text-align:center;">
<span style="display: block; padding: 0 4px; border-radius: 4px; background-color: #add8e6">Almost every day</span>
</td>
<td style="text-align:center;">
Every day
</td>
</tr>
<tr>
<td style="text-align:right;">
mhc13
</td>
<td style="text-align:left;">
confident to think or express your own ideas and opinions
</td>
<td style="text-align:center;">
Never/once or twice
</td>
<td style="text-align:center;">
1-3 times a week
</td>
<td style="text-align:center;">
<span style="display: block; padding: 0 4px; border-radius: 4px; background-color: #add8e6">Almost every day</span>
</td>
<td style="text-align:center;">
Every day
</td>
</tr>
<tr>
<td style="text-align:right;">
mhc14
</td>
<td style="text-align:left;">
that your life has a sense of direction or meaning to it
</td>
<td style="text-align:center;">
Never/once or twice
</td>
<td style="text-align:center;">
1-3 times a week
</td>
<td style="text-align:center;">
<span style="display: block; padding: 0 4px; border-radius: 4px; background-color: #add8e6">Almost every day</span>
</td>
<td style="text-align:center;">
Every day
</td>
</tr>
</tbody>
</table>
</div>
<details><summary>Code</summary><div class="sourceCode" id="cb32"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">respDist</span><span class="op">(</span><span class="st">"60-80"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="LatentResponse_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid" width="1050"></p>
</div>
</div>
</div>
<div id="tabset-3-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-5-tab">
<div class="cell" data-hash="LatentResponse_cache/html/unnamed-chunk-28_30cefaa3009ff71db3e3c72d7fa0dddb">
<details><summary>Code</summary><div class="sourceCode" id="cb33"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">respTable</span><span class="op">(</span><span class="st">"80-100"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">

<table class="table table-striped" style="font-size: 15px; font-family: Lato">
<thead><tr>
<th style="text-align:right;">
itemnr
</th>
<th style="text-align:left;">
How often during the past month did you feel…
</th>
<th style="text-align:center;">
Category0
</th>
<th style="text-align:center;">
Category1
</th>
<th style="text-align:center;">
Category2
</th>
<th style="text-align:center;">
Category3
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:right;">
mhc1
</td>
<td style="text-align:left;">
happy
</td>
<td style="text-align:center;">
Never/once or twice
</td>
<td style="text-align:center;">
1-3 times a week
</td>
<td style="text-align:center;">
Almost every day
</td>
<td style="text-align:center;">
<span style="display: block; padding: 0 4px; border-radius: 4px; background-color: #add8e6">Every day</span>
</td>
</tr>
<tr>
<td style="text-align:right;">
mhc5
</td>
<td style="text-align:left;">
that you belonged to a community
</td>
<td style="text-align:center;">
Never/once or twice
</td>
<td style="text-align:center;">
1-3 times a week
</td>
<td style="text-align:center;">
Almost every day
</td>
<td style="text-align:center;">
<span style="display: block; padding: 0 4px; border-radius: 4px; background-color: #add8e6">Every day</span>
</td>
</tr>
<tr>
<td style="text-align:right;">
mhc6
</td>
<td style="text-align:left;">
that our society is becoming a better place for people like you
</td>
<td style="text-align:center;">
Never/once or twice
</td>
<td style="text-align:center;">
<span style="display: block; padding: 0 4px; border-radius: 4px; background-color: #add8e6">1-3 times a week</span>
</td>
<td style="text-align:center;">
Almost every day
</td>
<td style="text-align:center;">
Every day
</td>
</tr>
<tr>
<td style="text-align:right;">
mhc9
</td>
<td style="text-align:left;">
that you liked most parts of your personality
</td>
<td style="text-align:center;">
Never/once or twice
</td>
<td style="text-align:center;">
1-3 times a week
</td>
<td style="text-align:center;">
Almost every day
</td>
<td style="text-align:center;">
<span style="display: block; padding: 0 4px; border-radius: 4px; background-color: #add8e6">Every day</span>
</td>
</tr>
<tr>
<td style="text-align:right;">
mhc10
</td>
<td style="text-align:left;">
good at managing the responsibilities of your daily life
</td>
<td style="text-align:center;">
Never/once or twice
</td>
<td style="text-align:center;">
1-3 times a week
</td>
<td style="text-align:center;">
Almost every day
</td>
<td style="text-align:center;">
<span style="display: block; padding: 0 4px; border-radius: 4px; background-color: #add8e6">Every day</span>
</td>
</tr>
<tr>
<td style="text-align:right;">
mhc11
</td>
<td style="text-align:left;">
that you had warm and trusting relationships with others
</td>
<td style="text-align:center;">
Never/once or twice
</td>
<td style="text-align:center;">
1-3 times a week
</td>
<td style="text-align:center;">
Almost every day
</td>
<td style="text-align:center;">
<span style="display: block; padding: 0 4px; border-radius: 4px; background-color: #add8e6">Every day</span>
</td>
</tr>
<tr>
<td style="text-align:right;">
mhc12
</td>
<td style="text-align:left;">
that you had experiences that challenged you to grow and become a better person
</td>
<td style="text-align:center;">
Never/once or twice
</td>
<td style="text-align:center;">
1-3 times a week
</td>
<td style="text-align:center;">
Almost every day
</td>
<td style="text-align:center;">
<span style="display: block; padding: 0 4px; border-radius: 4px; background-color: #add8e6">Every day</span>
</td>
</tr>
<tr>
<td style="text-align:right;">
mhc13
</td>
<td style="text-align:left;">
confident to think or express your own ideas and opinions
</td>
<td style="text-align:center;">
Never/once or twice
</td>
<td style="text-align:center;">
1-3 times a week
</td>
<td style="text-align:center;">
Almost every day
</td>
<td style="text-align:center;">
<span style="display: block; padding: 0 4px; border-radius: 4px; background-color: #add8e6">Every day</span>
</td>
</tr>
<tr>
<td style="text-align:right;">
mhc14
</td>
<td style="text-align:left;">
that your life has a sense of direction or meaning to it
</td>
<td style="text-align:center;">
Never/once or twice
</td>
<td style="text-align:center;">
1-3 times a week
</td>
<td style="text-align:center;">
Almost every day
</td>
<td style="text-align:center;">
<span style="display: block; padding: 0 4px; border-radius: 4px; background-color: #add8e6">Every day</span>
</td>
</tr>
</tbody>
</table>
</div>
<details><summary>Code</summary><div class="sourceCode" id="cb34"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">respDist</span><span class="op">(</span><span class="st">"80-100"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="LatentResponse_files/figure-html/unnamed-chunk-28-1.png" class="img-fluid" width="1050"></p>
</div>
</div>
</div>
<div id="tabset-3-6" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-6-tab">
<div class="cell" data-hash="LatentResponse_cache/html/unnamed-chunk-29_23a0fdcaade78606dadf250f0c828339">
<details><summary>Code</summary><div class="sourceCode" id="cb35"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">MHCscore</span>, y <span class="op">=</span> <span class="va">Gender</span>, fill <span class="op">=</span> <span class="va">Gender</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="http://mjskay.github.io/ggdist/reference/stat_slab.html">stat_slab</a></span><span class="op">(</span></span>
<span>    side <span class="op">=</span> <span class="st">"right"</span>, show.legend <span class="op">=</span> <span class="cn">F</span>,</span>
<span>    scale <span class="op">=</span> <span class="fl">0.7</span>,</span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>fill_ramp <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html">after_stat</a></span><span class="op">(</span><span class="va">level</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    .width <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">.50</span>, <span class="fl">.75</span>, <span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/stat_summary.html">stat_summary</a></span><span class="op">(</span></span>
<span>    fun.data <span class="op">=</span> <span class="st">"mean_cl_normal"</span>, show.legend <span class="op">=</span> <span class="cn">F</span>, size <span class="op">=</span> <span class="fl">.4</span>,</span>
<span>    position <span class="op">=</span> <span class="fu"><a href="https://docs.r4photobiology.info/ggpp/reference/position_dodgenudge.html">position_dodge2nudge</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">.05</span>, width <span class="op">=</span> <span class="fl">.8</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="http://mjskay.github.io/ggdist/reference/scale_colour_ramp.html">scale_fill_ramp_discrete</a></span><span class="op">(</span>from <span class="op">=</span> <span class="st">"black"</span>, aesthetics <span class="op">=</span> <span class="st">"fill_ramp"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html">scale_fill_viridis_d</a></span><span class="op">(</span>begin <span class="op">=</span> <span class="fl">0.4</span>, direction <span class="op">=</span> <span class="op">-</span><span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="va">avg1</span>, color <span class="op">=</span> <span class="st">"orange"</span>, linetype <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">annotate</span><span class="op">(</span><span class="st">"rect"</span>, ymin <span class="op">=</span> <span class="fl">0</span>, ymax <span class="op">=</span> <span class="cn">Inf</span>, xmin <span class="op">=</span> <span class="va">avg1</span> <span class="op">-</span> <span class="va">sem1</span>, xmax <span class="op">=</span> <span class="va">avg1</span> <span class="op">+</span> <span class="va">sem1</span>, alpha <span class="op">=</span> <span class="fl">.1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">annotate</span><span class="op">(</span><span class="st">"text"</span>, label <span class="op">=</span> <span class="st">"0-20"</span>, x <span class="op">=</span> <span class="va">avg1</span><span class="op">-</span><span class="fl">0.1</span>, y <span class="op">=</span> <span class="fl">1.5</span>, angle <span class="op">=</span> <span class="fl">90</span>, size <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="va">avg2</span>, color <span class="op">=</span> <span class="st">"orange"</span>, linetype <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">annotate</span><span class="op">(</span><span class="st">"rect"</span>, ymin <span class="op">=</span> <span class="fl">0</span>, ymax <span class="op">=</span> <span class="cn">Inf</span>, xmin <span class="op">=</span> <span class="va">avg2</span> <span class="op">-</span> <span class="va">sem2</span>, xmax <span class="op">=</span> <span class="va">avg2</span> <span class="op">+</span> <span class="va">sem2</span>, alpha <span class="op">=</span> <span class="fl">.1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">annotate</span><span class="op">(</span><span class="st">"text"</span>, label <span class="op">=</span> <span class="st">"20-40"</span>, x <span class="op">=</span> <span class="va">avg2</span><span class="op">-</span><span class="fl">0.1</span>, y <span class="op">=</span> <span class="fl">1.5</span>, angle <span class="op">=</span> <span class="fl">90</span>, size <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="va">avg3</span>, color <span class="op">=</span> <span class="st">"orange"</span>, linetype <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">annotate</span><span class="op">(</span><span class="st">"rect"</span>, ymin <span class="op">=</span> <span class="fl">0</span>, ymax <span class="op">=</span> <span class="cn">Inf</span>, xmin <span class="op">=</span> <span class="va">avg3</span> <span class="op">-</span> <span class="va">sem3</span>, xmax <span class="op">=</span> <span class="va">avg3</span> <span class="op">+</span> <span class="va">sem3</span>, alpha <span class="op">=</span> <span class="fl">.1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">annotate</span><span class="op">(</span><span class="st">"text"</span>, label <span class="op">=</span> <span class="st">"40-60"</span>, x <span class="op">=</span> <span class="va">avg3</span><span class="op">-</span><span class="fl">0.1</span>, y <span class="op">=</span> <span class="fl">1.5</span>, angle <span class="op">=</span> <span class="fl">90</span>, size <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="va">avg4</span>, color <span class="op">=</span> <span class="st">"orange"</span>, linetype <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">annotate</span><span class="op">(</span><span class="st">"text"</span>, label <span class="op">=</span> <span class="st">"60-80"</span>, x <span class="op">=</span> <span class="va">avg4</span><span class="op">-</span><span class="fl">0.1</span>, y <span class="op">=</span> <span class="fl">1.5</span>, angle <span class="op">=</span> <span class="fl">90</span>, size <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">annotate</span><span class="op">(</span><span class="st">"rect"</span>, ymin <span class="op">=</span> <span class="fl">0</span>, ymax <span class="op">=</span> <span class="cn">Inf</span>, xmin <span class="op">=</span> <span class="va">avg4</span> <span class="op">-</span> <span class="va">sem4</span>, xmax <span class="op">=</span> <span class="va">avg4</span> <span class="op">+</span> <span class="va">sem4</span>, alpha <span class="op">=</span> <span class="fl">.1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="va">avg5</span>, color <span class="op">=</span> <span class="st">"orange"</span>, linetype <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">annotate</span><span class="op">(</span><span class="st">"text"</span>, label <span class="op">=</span> <span class="st">"80-100"</span>, x <span class="op">=</span> <span class="va">avg5</span><span class="op">-</span><span class="fl">0.1</span>, y <span class="op">=</span> <span class="fl">1.5</span>, angle <span class="op">=</span> <span class="fl">90</span>, size <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">annotate</span><span class="op">(</span><span class="st">"rect"</span>, ymin <span class="op">=</span> <span class="fl">0</span>, ymax <span class="op">=</span> <span class="cn">Inf</span>, xmin <span class="op">=</span> <span class="va">avg5</span> <span class="op">-</span> <span class="va">sem5</span>, xmax <span class="op">=</span> <span class="va">avg5</span> <span class="op">+</span> <span class="va">sem5</span>, alpha <span class="op">=</span> <span class="fl">.1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="st">"MHC-SF latent scores"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="st">""</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/RISEkbmRasch/man/theme_rise.html">theme_rise</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>axis.text.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">12</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="LatentResponse_files/figure-html/unnamed-chunk-29-1.png" class="img-fluid" width="1050"></p>
</div>
</div>
</div>
</div>
</div>
</section><section id="other-visualizations" class="level2" data-number="6"><h2 data-number="6" class="anchored" data-anchor-id="other-visualizations">
<span class="header-section-number">6</span> Other visualizations</h2>
<p>We can use the same set of scores and combine them with the previously reported figure for item hierarchy.</p>
<section id="targeting-example" class="level3" data-number="6.1"><h3 data-number="6.1" class="anchored" data-anchor-id="targeting-example">
<span class="header-section-number">6.1</span> Targeting example</h3>
<div class="cell" data-hash="LatentResponse_cache/html/unnamed-chunk-30_e57c252e0f956d5148ac32043cfbb2ed">
<details><summary>Code</summary><div class="sourceCode" id="cb36"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/RISEkbmRasch/man/RIitemHierarchy.html">RIitemHierarchy</a></span><span class="op">(</span><span class="va">df</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">9</span><span class="op">)</span><span class="op">]</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_hline</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="va">avg4</span><span class="op">)</span>, linetype <span class="op">=</span> <span class="fl">2</span>, color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">annotate</span><span class="op">(</span><span class="st">"rect"</span>, xmin <span class="op">=</span> <span class="fl">0</span>, xmax <span class="op">=</span> <span class="cn">Inf</span>, ymin <span class="op">=</span> <span class="va">avg4</span> <span class="op">-</span> <span class="va">sem4</span>, ymax <span class="op">=</span> <span class="va">avg4</span> <span class="op">+</span> <span class="va">sem4</span>, alpha <span class="op">=</span> <span class="fl">.1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">annotate</span><span class="op">(</span><span class="st">"text"</span>, label <span class="op">=</span> <span class="st">"60-80"</span>, y <span class="op">=</span> <span class="va">avg4</span><span class="op">-</span><span class="fl">0.1</span>, x <span class="op">=</span> <span class="fl">9</span>, angle <span class="op">=</span> <span class="fl">90</span>, size <span class="op">=</span> <span class="fl">3</span>, color <span class="op">=</span> <span class="st">"darkorange"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_hline</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="va">avg2</span><span class="op">)</span>, linetype <span class="op">=</span> <span class="fl">2</span>, color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">annotate</span><span class="op">(</span><span class="st">"rect"</span>, xmin <span class="op">=</span> <span class="fl">0</span>, xmax <span class="op">=</span> <span class="cn">Inf</span>, ymin <span class="op">=</span> <span class="va">avg2</span> <span class="op">-</span> <span class="va">sem2</span>, ymax <span class="op">=</span> <span class="va">avg2</span> <span class="op">+</span> <span class="va">sem2</span>, alpha <span class="op">=</span> <span class="fl">.1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">annotate</span><span class="op">(</span><span class="st">"text"</span>, label <span class="op">=</span> <span class="st">"20-40"</span>, y <span class="op">=</span> <span class="va">avg2</span><span class="op">-</span><span class="fl">0.1</span>, x <span class="op">=</span> <span class="fl">9</span>, angle <span class="op">=</span> <span class="fl">90</span>, size <span class="op">=</span> <span class="fl">3</span>, color <span class="op">=</span> <span class="st">"darkorange"</span><span class="op">)</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="LatentResponse_files/figure-html/unnamed-chunk-30-1.png" class="img-fluid" width="1050"></p>
</div>
</div>
</section></section><section id="software-used" class="level2" data-number="7"><h2 data-number="7" class="anchored" data-anchor-id="software-used">
<span class="header-section-number">7</span> Software used</h2>
<div class="cell" data-hash="LatentResponse_cache/html/unnamed-chunk-31_f847c0837df1de96aff5f48564443a55">
<details><summary>Code</summary><div class="sourceCode" id="cb37"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://pakillo.github.io/grateful/">grateful</a></span><span class="op">)</span></span>
<span><span class="va">pkgs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://pakillo.github.io/grateful/reference/cite_packages.html">cite_packages</a></span><span class="op">(</span>cite.tidyverse <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>                      output <span class="op">=</span> <span class="st">"table"</span>,</span>
<span>                      bib.file <span class="op">=</span> <span class="st">"grateful-refs.bib"</span>,</span>
<span>                      include.RStudio <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://renkun-ken.github.io/formattable/reference/formattable.html">formattable</a></span><span class="op">(</span><span class="va">pkgs</span>, </span>
<span>            table.attr <span class="op">=</span> <span class="st">'class=\"table table-striped\" style="font-size: 14px; font-family: Lato; width: 80%"'</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">

<table class="table table-striped" style="font-size: 14px; font-family: Lato; width: 80%">
<thead><tr>
<th style="text-align:right;">
Package
</th>
<th style="text-align:right;">
Version
</th>
<th style="text-align:right;">
Citation
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:right;">
arrow
</td>
<td style="text-align:right;">
10.0.0
</td>
<td style="text-align:right;">
<span class="citation" data-cites="arrow">Richardson et al. (<a href="#ref-arrow" role="doc-biblioref">2022</a>)</span>
</td>
</tr>
<tr>
<td style="text-align:right;">
base
</td>
<td style="text-align:right;">
4.2.2
</td>
<td style="text-align:right;">
<span class="citation" data-cites="base">R Core Team (<a href="#ref-base" role="doc-biblioref">2022</a>)</span>
</td>
</tr>
<tr>
<td style="text-align:right;">
car
</td>
<td style="text-align:right;">
3.1.1
</td>
<td style="text-align:right;">
<span class="citation" data-cites="car">Fox &amp; Weisberg (<a href="#ref-car" role="doc-biblioref">2019</a>)</span>
</td>
</tr>
<tr>
<td style="text-align:right;">
formattable
</td>
<td style="text-align:right;">
0.2.1
</td>
<td style="text-align:right;">
<span class="citation" data-cites="formattable">Ren &amp; Russell (<a href="#ref-formattable" role="doc-biblioref">2021</a>)</span>
</td>
</tr>
<tr>
<td style="text-align:right;">
ggdist
</td>
<td style="text-align:right;">
3.2.0
</td>
<td style="text-align:right;">
<span class="citation" data-cites="ggdist">Kay (<a href="#ref-ggdist" role="doc-biblioref">2022</a>)</span>
</td>
</tr>
<tr>
<td style="text-align:right;">
ggpp
</td>
<td style="text-align:right;">
0.4.5
</td>
<td style="text-align:right;">
<span class="citation" data-cites="ggpp">Aphalo (<a href="#ref-ggpp" role="doc-biblioref">2022</a>)</span>
</td>
</tr>
<tr>
<td style="text-align:right;">
grateful
</td>
<td style="text-align:right;">
0.1.11
</td>
<td style="text-align:right;">
<span class="citation" data-cites="grateful">Rodríguez-Sánchez et al. (<a href="#ref-grateful" role="doc-biblioref">2022</a>)</span>
</td>
</tr>
<tr>
<td style="text-align:right;">
RISEkbmRasch
</td>
<td style="text-align:right;">
0.1.9
</td>
<td style="text-align:right;">
<span class="citation" data-cites="RISEkbmRasch">Johansson (<a href="#ref-RISEkbmRasch" role="doc-biblioref">2023</a>)</span>
</td>
</tr>
<tr>
<td style="text-align:right;">
rmarkdown
</td>
<td style="text-align:right;">
2.20
</td>
<td style="text-align:right;">
<span class="citation" data-cites="rmarkdown2018">Xie et al. (<a href="#ref-rmarkdown2018" role="doc-biblioref">2018</a>)</span>; <span class="citation" data-cites="rmarkdown2020">Xie et al. (<a href="#ref-rmarkdown2020" role="doc-biblioref">2020</a>)</span>; <span class="citation" data-cites="rmarkdown2023">Allaire et al. (<a href="#ref-rmarkdown2023" role="doc-biblioref">2023</a>)</span>
</td>
</tr>
<tr>
<td style="text-align:right;">
tidyverse
</td>
<td style="text-align:right;">
1.3.2
</td>
<td style="text-align:right;">
<span class="citation" data-cites="tidyverse">Wickham et al. (<a href="#ref-tidyverse" role="doc-biblioref">2019</a>)</span>
</td>
</tr>
</tbody>
</table>
</div>
</div>
</section><section id="references" class="level2" data-number="8">


<!-- -->


</section><div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography"><h2 class="anchored quarto-appendix-heading">
8 References</h2><div id="refs" class="references csl-bib-body hanging-indent" data-line-spacing="2" role="doc-bibliography">
<div id="ref-rmarkdown2023" class="csl-entry" role="doc-biblioentry">
Allaire, J., Xie, Y., McPherson, J., Luraschi, J., Ushey, K., Atkins, A., Wickham, H., Cheng, J., Chang, W., &amp; Iannone, R. (2023). <em>Rmarkdown: Dynamic documents for r</em>. <a href="https://github.com/rstudio/rmarkdown">https://github.com/rstudio/rmarkdown</a>
</div>
<div id="ref-ggpp" class="csl-entry" role="doc-biblioentry">
Aphalo, P. J. (2022). <em>Ggpp: Grammar extensions to ’ggplot2’</em>. <a href="https://CRAN.R-project.org/package=ggpp">https://CRAN.R-project.org/package=ggpp</a>
</div>
<div id="ref-car" class="csl-entry" role="doc-biblioentry">
Fox, J., &amp; Weisberg, S. (2019). <em>An <span>R</span> companion to applied regression</em> (Third). Sage. <a href="https://socialsciences.mcmaster.ca/jfox/Books/Companion/">https://socialsciences.mcmaster.ca/jfox/Books/Companion/</a>
</div>
<div id="ref-RISEkbmRasch" class="csl-entry" role="doc-biblioentry">
Johansson, M. (2023). <em>RISEkbmRasch: Psychometric analysis in r with rasch measurement theory</em>. <a href="https://github.com/pgmj/RISEkbmRasch">https://github.com/pgmj/RISEkbmRasch</a>
</div>
<div id="ref-ggdist" class="csl-entry" role="doc-biblioentry">
Kay, M. (2022). <em><span class="nocase">ggdist</span>: Visualizations of distributions and uncertainty</em>. <a href="https://doi.org/10.5281/zenodo.3879620">https://doi.org/10.5281/zenodo.3879620</a>
</div>
<div id="ref-base" class="csl-entry" role="doc-biblioentry">
R Core Team. (2022). <em>R: A language and environment for statistical computing</em>. R Foundation for Statistical Computing. <a href="https://www.R-project.org/">https://www.R-project.org/</a>
</div>
<div id="ref-formattable" class="csl-entry" role="doc-biblioentry">
Ren, K., &amp; Russell, K. (2021). <em>Formattable: Create ’formattable’ data structures</em>. <a href="https://CRAN.R-project.org/package=formattable">https://CRAN.R-project.org/package=formattable</a>
</div>
<div id="ref-arrow" class="csl-entry" role="doc-biblioentry">
Richardson, N., Cook, I., Crane, N., Dunnington, D., François, R., Keane, J., Moldovan-Grünfeld, D., Ooms, J., &amp; Apache Arrow. (2022). <em>Arrow: Integration to ’apache’ ’arrow’</em>. <a href="https://CRAN.R-project.org/package=arrow">https://CRAN.R-project.org/package=arrow</a>
</div>
<div id="ref-grateful" class="csl-entry" role="doc-biblioentry">
Rodríguez-Sánchez, F., Jackson, C. P., &amp; Hutchins, S. D. (2022). <em>Grateful: Facilitate citation of r packages</em>. <a href="https://github.com/Pakillo/grateful">https://github.com/Pakillo/grateful</a>
</div>
<div id="ref-ryff1989" class="csl-entry" role="doc-biblioentry">
Ryff, C. D. (1989). Happiness Is Everything, or Is It? Explorations on the Meaning of Psychological Well-Being. <em>Journal of Personality and Social Psychology</em>, <em>57</em>(6), 1069–1081. https://doi.org/<a href="http://dx.doi.org/10.1037/0022-3514.57.6.1069">http://dx.doi.org/10.1037/0022-3514.57.6.1069</a>
</div>
<div id="ref-ryff2014" class="csl-entry" role="doc-biblioentry">
Ryff, C. D. (2014). Psychological Well-Being Revisited: Advances in the Science and Practice of Eudaimonia. <em>Psychotherapy and Psychosomatics</em>, <em>83</em>(1), 10–28. <a href="https://doi.org/10.1159/000353263">https://doi.org/10.1159/000353263</a>
</div>
<div id="ref-tidyverse" class="csl-entry" role="doc-biblioentry">
Wickham, H., Averick, M., Bryan, J., Chang, W., McGowan, L. D., François, R., Grolemund, G., Hayes, A., Henry, L., Hester, J., Kuhn, M., Pedersen, T. L., Miller, E., Bache, S. M., Müller, K., Ooms, J., Robinson, D., Seidel, D. P., Spinu, V., … Yutani, H. (2019). Welcome to the <span class="nocase">tidyverse</span>. <em>Journal of Open Source Software</em>, <em>4</em>(43), 1686. <a href="https://doi.org/10.21105/joss.01686">https://doi.org/10.21105/joss.01686</a>
</div>
<div id="ref-rmarkdown2018" class="csl-entry" role="doc-biblioentry">
Xie, Y., Allaire, J. J., &amp; Grolemund, G. (2018). <em>R markdown: The definitive guide</em>. Chapman; Hall/CRC. <a href="https://bookdown.org/yihui/rmarkdown">https://bookdown.org/yihui/rmarkdown</a>
</div>
<div id="ref-rmarkdown2020" class="csl-entry" role="doc-biblioentry">
Xie, Y., Dervieux, C., &amp; Riederer, E. (2020). <em>R markdown cookbook</em>. Chapman; Hall/CRC. <a href="https://bookdown.org/yihui/rmarkdown-cookbook">https://bookdown.org/yihui/rmarkdown-cookbook</a>
</div>
</div></section><section class="quarto-appendix-contents"><h2 class="anchored quarto-appendix-heading">Reuse</h2><div quarto-reuse="quarto-reuse" class="quarto-appendix-contents"><a rel="license" href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</a></div></section><section class="quarto-appendix-contents"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@online{johansson2023,
  author = {Magnus Johansson},
  title = {What’s in a Latent Trait Score?},
  date = {2023-02-24},
  url = {https://pgmj.github.io/LatentResponse.html},
  langid = {en}
}
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-johansson2023" class="csl-entry quarto-appendix-citeas" role="doc-biblioentry">
Magnus Johansson. (2023, February 24). <em>What’s in a latent trait
score?</em> <a href="https://pgmj.github.io/LatentResponse.html">https://pgmj.github.io/LatentResponse.html</a>
</div></div></section></div></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb38" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "What's in a latent trait score?"</span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span><span class="co"> </span></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a><span class="co">  name: Magnus Johansson</span></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a><span class="co">  affiliation: RISE Research Institutes of Sweden</span></span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a><span class="co">  affiliation-url: https://www.ri.se/sv/vad-vi-gor/expertiser/kategoriskt-baserade-matningar</span></span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a><span class="co">  orcid: 0000-0003-1669-592X</span></span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a><span class="an">date:</span><span class="co"> 2023-02-24</span></span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a><span class="an">citation:</span></span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a><span class="co">  type: 'webpage'</span></span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a><span class="an">csl:</span><span class="co"> ../apa.csl</span></span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a><span class="an">google-scholar:</span><span class="co"> true</span></span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span></span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb38-15"><a href="#cb38-15" aria-hidden="true" tabindex="-1"></a><span class="co">    code-fold: true</span></span>
<span id="cb38-16"><a href="#cb38-16" aria-hidden="true" tabindex="-1"></a><span class="an">website:</span></span>
<span id="cb38-17"><a href="#cb38-17" aria-hidden="true" tabindex="-1"></a><span class="co">  twitter-card:</span></span>
<span id="cb38-18"><a href="#cb38-18" aria-hidden="true" tabindex="-1"></a><span class="co">    image: "https://pgmj.github.io/latentResp/LatentResponse_files/figure-html/unnamed-chunk-26-1.png"</span></span>
<span id="cb38-19"><a href="#cb38-19" aria-hidden="true" tabindex="-1"></a><span class="an">execute:</span><span class="co"> </span></span>
<span id="cb38-20"><a href="#cb38-20" aria-hidden="true" tabindex="-1"></a><span class="co">  cache: true</span></span>
<span id="cb38-21"><a href="#cb38-21" aria-hidden="true" tabindex="-1"></a><span class="co">  warning: false</span></span>
<span id="cb38-22"><a href="#cb38-22" aria-hidden="true" tabindex="-1"></a><span class="co">  message: false</span></span>
<span id="cb38-23"><a href="#cb38-23" aria-hidden="true" tabindex="-1"></a><span class="an">bibliography:</span><span class="co"> </span></span>
<span id="cb38-24"><a href="#cb38-24" aria-hidden="true" tabindex="-1"></a><span class="co">- references.bib</span></span>
<span id="cb38-25"><a href="#cb38-25" aria-hidden="true" tabindex="-1"></a><span class="co">- grateful-refs.bib</span></span>
<span id="cb38-26"><a href="#cb38-26" aria-hidden="true" tabindex="-1"></a><span class="an">editor_options:</span><span class="co"> </span></span>
<span id="cb38-27"><a href="#cb38-27" aria-hidden="true" tabindex="-1"></a><span class="co">  chunk_output_type: console</span></span>
<span id="cb38-28"><a href="#cb38-28" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb38-29"><a href="#cb38-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-30"><a href="#cb38-30" aria-hidden="true" tabindex="-1"></a>We frequently use questionnaires to measure latent variables based on multiple items/indicators, but the connection between item responses and a latent trait score is often unclear. Here, I will present a way to visualize item responses and their corresponding latent score and measurement uncertainty that hopefully makes what lies behind the latent score much easier to understand.</span>
<span id="cb38-31"><a href="#cb38-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-32"><a href="#cb38-32" aria-hidden="true" tabindex="-1"></a>It should be noted that the term "latent trait score" is not entirely established. The intent is to refer to what in Item Response Theory and Rasch modeling is labelled "theta" - 𝜃 (also known as "person ability", "person location", or "person score"). For each participant, IRT/Rasch models make it possible to both estimate a latent trait score on an interval scale and a measurement error specific for each participant's score. The measurement error depends on the item properties and is not a constant value that is the same for all participants/scores.</span>
<span id="cb38-33"><a href="#cb38-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-34"><a href="#cb38-34" aria-hidden="true" tabindex="-1"></a>In classical test theory, latent trait scores may be estimated using factor analysis and used in structural equation models. However, I have never seen anyone "export" the actual latent trait scores for each participant in a dataset, based on a confirmatory factor analysis (CFA). What is usually done, based on classical test theory/CFA, is to use the raw ordinal sum score as a representation of the latent variable.</span>
<span id="cb38-35"><a href="#cb38-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-36"><a href="#cb38-36" aria-hidden="true" tabindex="-1"></a>Jump ahead to @sec-visualization to see the visualization and skip the psychometric background.</span>
<span id="cb38-37"><a href="#cb38-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-38"><a href="#cb38-38" aria-hidden="true" tabindex="-1"></a><span class="fu">## Background</span></span>
<span id="cb38-39"><a href="#cb38-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-40"><a href="#cb38-40" aria-hidden="true" tabindex="-1"></a>The Mental Health Continuum Short Form <span class="co">[</span><span class="ot">@ryff1989; @ryff2014</span><span class="co">]</span> will be used as an example. I have conducted a Rasch analysis and preliminary results indicate that some modifications are needed for the response categories, and some items need to be removed. This will be reported elsewhere in greater detail. Here, only a summary of the changes and the measurement properties of the final set of items will be reported.</span>
<span id="cb38-41"><a href="#cb38-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-42"><a href="#cb38-42" aria-hidden="true" tabindex="-1"></a>The analysis makes use of my R package for Rasch psychometric analysis, which in turn depends on (and automatically loads) a lot of packages. See the <span class="co">[</span><span class="ot">RISEkbmRasch vignette</span><span class="co">](https://pgmj.github.io/raschrvignette/RaschRvign.html)</span> and <span class="co">[</span><span class="ot">GitHub package repository</span><span class="co">](https://github.com/pgmj/RISEkbmRasch)</span> for more details.</span>
<span id="cb38-43"><a href="#cb38-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-46"><a href="#cb38-46" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb38-47"><a href="#cb38-47" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RISEkbmRasch)</span>
<span id="cb38-48"><a href="#cb38-48" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(arrow)</span>
<span id="cb38-49"><a href="#cb38-49" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggdist)</span>
<span id="cb38-50"><a href="#cb38-50" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggpp)</span>
<span id="cb38-51"><a href="#cb38-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-52"><a href="#cb38-52" aria-hidden="true" tabindex="-1"></a><span class="do">### some commands exist in multiple packages, here we define preferred ones that are frequently used</span></span>
<span id="cb38-53"><a href="#cb38-53" aria-hidden="true" tabindex="-1"></a>select <span class="ot">&lt;-</span> dplyr<span class="sc">::</span>select</span>
<span id="cb38-54"><a href="#cb38-54" aria-hidden="true" tabindex="-1"></a>count <span class="ot">&lt;-</span> dplyr<span class="sc">::</span>count</span>
<span id="cb38-55"><a href="#cb38-55" aria-hidden="true" tabindex="-1"></a>recode <span class="ot">&lt;-</span> car<span class="sc">::</span>recode</span>
<span id="cb38-56"><a href="#cb38-56" aria-hidden="true" tabindex="-1"></a>rename <span class="ot">&lt;-</span> dplyr<span class="sc">::</span>rename</span>
<span id="cb38-57"><a href="#cb38-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-58"><a href="#cb38-58" aria-hidden="true" tabindex="-1"></a><span class="co"># import item information</span></span>
<span id="cb38-59"><a href="#cb38-59" aria-hidden="true" tabindex="-1"></a>itemlabels <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"/Volumes/magnuspjo/RegionUppsala/data/RegUaItemlabelsEng.xls"</span>, <span class="at">sheet =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb38-60"><a href="#cb38-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">str_detect</span>(itemnr,<span class="st">"mhc"</span>))</span>
<span id="cb38-61"><a href="#cb38-61" aria-hidden="true" tabindex="-1"></a>itemresponses <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"/Volumes/magnuspjo/RegionUppsala/data/RegUaItemlabelsEng.xls"</span>, <span class="at">sheet =</span> <span class="dv">3</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb38-62"><a href="#cb38-62" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">`</span><span class="at">How often during the past month did you feel...</span><span class="st">`</span> <span class="ot">=</span> item)</span>
<span id="cb38-63"><a href="#cb38-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-64"><a href="#cb38-64" aria-hidden="true" tabindex="-1"></a><span class="co"># import recoded data</span></span>
<span id="cb38-65"><a href="#cb38-65" aria-hidden="true" tabindex="-1"></a>df.all <span class="ot">&lt;-</span> <span class="fu">read_parquet</span>(<span class="st">"/Volumes/magnuspjo/RegionUppsala/data/RegUaLHUdata.parquet"</span>)</span>
<span id="cb38-66"><a href="#cb38-66" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df.all</span>
<span id="cb38-67"><a href="#cb38-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-68"><a href="#cb38-68" aria-hidden="true" tabindex="-1"></a><span class="co"># recode response categories to numerics</span></span>
<span id="cb38-69"><a href="#cb38-69" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> </span>
<span id="cb38-70"><a href="#cb38-70" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">starts_with</span>(<span class="st">"I1_"</span>), <span class="sc">~</span> <span class="fu">recode</span>(.x,<span class="st">"'Aldrig'=0;</span></span>
<span id="cb38-71"><a href="#cb38-71" aria-hidden="true" tabindex="-1"></a><span class="st">                    'En eller två gånger'=1;</span></span>
<span id="cb38-72"><a href="#cb38-72" aria-hidden="true" tabindex="-1"></a><span class="st">                    '1 gång/vecka'=2;</span></span>
<span id="cb38-73"><a href="#cb38-73" aria-hidden="true" tabindex="-1"></a><span class="st">                    '2-3 gånger/vecka'=3;</span></span>
<span id="cb38-74"><a href="#cb38-74" aria-hidden="true" tabindex="-1"></a><span class="st">                    'Nästan dagligen'=4;</span></span>
<span id="cb38-75"><a href="#cb38-75" aria-hidden="true" tabindex="-1"></a><span class="st">                    'Dagligen'=5"</span>,</span>
<span id="cb38-76"><a href="#cb38-76" aria-hidden="true" tabindex="-1"></a>                    <span class="at">as.factor =</span> <span class="cn">FALSE</span>)</span>
<span id="cb38-77"><a href="#cb38-77" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb38-78"><a href="#cb38-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-79"><a href="#cb38-79" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> </span>
<span id="cb38-80"><a href="#cb38-80" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(inars <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">2019</span>,<span class="dv">2021</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb38-81"><a href="#cb38-81" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Age =</span> <span class="fu">recode</span>(arskurs,<span class="st">"1='13 yo';2='15 yo';3=' 17 yo';9=NA;99=NA"</span>, <span class="at">as.factor =</span> <span class="cn">TRUE</span>),</span>
<span id="cb38-82"><a href="#cb38-82" aria-hidden="true" tabindex="-1"></a>         <span class="at">Gender =</span> <span class="fu">recode</span>(kon,<span class="st">"99=NA;9=NA;2='Girls';1='Boys'"</span>, <span class="at">as.factor =</span> T),</span>
<span id="cb38-83"><a href="#cb38-83" aria-hidden="true" tabindex="-1"></a>         ) <span class="sc">%&gt;%</span> </span>
<span id="cb38-84"><a href="#cb38-84" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Age <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"15 yo"</span>,<span class="st">"17 yo"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb38-85"><a href="#cb38-85" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">starts_with</span>(<span class="st">"I1_"</span>),Age,Gender) <span class="sc">%&gt;%</span> </span>
<span id="cb38-86"><a href="#cb38-86" aria-hidden="true" tabindex="-1"></a>  <span class="fu">na.omit</span>()</span>
<span id="cb38-87"><a href="#cb38-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-88"><a href="#cb38-88" aria-hidden="true" tabindex="-1"></a><span class="co"># create variables for analysis of Differential Item Functioning</span></span>
<span id="cb38-89"><a href="#cb38-89" aria-hidden="true" tabindex="-1"></a>dif.age <span class="ot">&lt;-</span> df<span class="sc">$</span>Age</span>
<span id="cb38-90"><a href="#cb38-90" aria-hidden="true" tabindex="-1"></a>dif.gender <span class="ot">&lt;-</span> df<span class="sc">$</span>Gender</span>
<span id="cb38-91"><a href="#cb38-91" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>Age <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb38-92"><a href="#cb38-92" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>Gender <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb38-93"><a href="#cb38-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-94"><a href="#cb38-94" aria-hidden="true" tabindex="-1"></a><span class="co"># set variable names to match</span></span>
<span id="cb38-95"><a href="#cb38-95" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(df) <span class="ot">&lt;-</span> itemlabels<span class="sc">$</span>itemnr</span>
<span id="cb38-96"><a href="#cb38-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-97"><a href="#cb38-97" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb38-98"><a href="#cb38-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-99"><a href="#cb38-99" aria-hidden="true" tabindex="-1"></a>Questions in the MHC-SF are prefixed with ***How often during the past month did you feel...***, and the items are listed below in @sec-rasch in the right-hand side margin.</span>
<span id="cb38-100"><a href="#cb38-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-101"><a href="#cb38-101" aria-hidden="true" tabindex="-1"></a>Six response categories were used, as specified in the original MHC-SF: ***every day, almost every day, about 2 or 3 times a week, about once a week, once or twice, never*** and the Rasch analysis found them disordered for all items. This means that some response categories do not contribute meaningful differential information to the latent score, compared to an adjacent response category - the categories are too similar to the respondents. After merging ***never*** with ***once or twice***, and ***about once a week*** with ***about 2 or 3 times a week***, the disordering was resolved. However, there are still quite small distances between item category thresholds, as shown in the ICC plots. This leaves us with 4 response categories for each item.</span>
<span id="cb38-102"><a href="#cb38-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-103"><a href="#cb38-103" aria-hidden="true" tabindex="-1"></a>The sample consists of <span class="in">`r nrow(df)`</span> respondents.</span>
<span id="cb38-104"><a href="#cb38-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-107"><a href="#cb38-107" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb38-108"><a href="#cb38-108" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> itemlabels<span class="sc">$</span>itemnr) {</span>
<span id="cb38-109"><a href="#cb38-109" aria-hidden="true" tabindex="-1"></a>  df[[i]] <span class="ot">&lt;-</span> <span class="fu">recode</span>(df[[i]],<span class="st">"1=0;2=1;3=1;4=2;5=3"</span>,</span>
<span id="cb38-110"><a href="#cb38-110" aria-hidden="true" tabindex="-1"></a>                    <span class="at">as.factor =</span> <span class="cn">FALSE</span>)</span>
<span id="cb38-111"><a href="#cb38-111" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb38-112"><a href="#cb38-112" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb38-113"><a href="#cb38-113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-114"><a href="#cb38-114" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb38-115"><a href="#cb38-115" aria-hidden="true" tabindex="-1"></a><span class="fu">### Tileplot</span></span>
<span id="cb38-116"><a href="#cb38-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-119"><a href="#cb38-119" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb38-120"><a href="#cb38-120" aria-hidden="true" tabindex="-1"></a><span class="fu">RItileplot</span>(df)</span>
<span id="cb38-121"><a href="#cb38-121" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb38-122"><a href="#cb38-122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-123"><a href="#cb38-123" aria-hidden="true" tabindex="-1"></a><span class="fu">### ICC plots</span></span>
<span id="cb38-124"><a href="#cb38-124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-127"><a href="#cb38-127" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb38-128"><a href="#cb38-128" aria-hidden="true" tabindex="-1"></a><span class="co">#| layout-ncol: 3</span></span>
<span id="cb38-129"><a href="#cb38-129" aria-hidden="true" tabindex="-1"></a>ermOut <span class="ot">&lt;-</span> <span class="fu">PCM</span>(df)</span>
<span id="cb38-130"><a href="#cb38-130" aria-hidden="true" tabindex="-1"></a><span class="fu">plotICC</span>(ermOut)</span>
<span id="cb38-131"><a href="#cb38-131" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb38-132"><a href="#cb38-132" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb38-133"><a href="#cb38-133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-134"><a href="#cb38-134" aria-hidden="true" tabindex="-1"></a><span class="fu">## Rasch analysis summary {#sec-rasch}</span></span>
<span id="cb38-135"><a href="#cb38-135" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-136"><a href="#cb38-136" aria-hidden="true" tabindex="-1"></a>Five items were removed, mostly due to issues of multidimensionality and large residual correlations. Here, the analysis of remaining items is presented.</span>
<span id="cb38-137"><a href="#cb38-137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-140"><a href="#cb38-140" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb38-141"><a href="#cb38-141" aria-hidden="true" tabindex="-1"></a>removed.items <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"mhc2"</span>,<span class="st">"mhc3"</span>,<span class="st">"mhc4"</span>,<span class="st">"mhc8"</span>,<span class="st">"mhc7"</span>)</span>
<span id="cb38-142"><a href="#cb38-142" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> </span>
<span id="cb38-143"><a href="#cb38-143" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">!</span><span class="fu">any_of</span>(removed.items))</span>
<span id="cb38-144"><a href="#cb38-144" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb38-145"><a href="#cb38-145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-148"><a href="#cb38-148" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb38-149"><a href="#cb38-149" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: margin</span></span>
<span id="cb38-150"><a href="#cb38-150" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb38-151"><a href="#cb38-151" aria-hidden="true" tabindex="-1"></a><span class="fu">RIlistItemsMargin</span>(df, <span class="at">fontsize =</span> <span class="dv">12</span>)</span>
<span id="cb38-152"><a href="#cb38-152" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb38-153"><a href="#cb38-153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-154"><a href="#cb38-154" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb38-155"><a href="#cb38-155" aria-hidden="true" tabindex="-1"></a><span class="fu">### Item fit</span></span>
<span id="cb38-156"><a href="#cb38-156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-159"><a href="#cb38-159" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb38-160"><a href="#cb38-160" aria-hidden="true" tabindex="-1"></a><span class="fu">RIitemfitPCM2</span>(df, <span class="dv">300</span>, <span class="dv">32</span>, <span class="dv">8</span>)</span>
<span id="cb38-161"><a href="#cb38-161" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb38-162"><a href="#cb38-162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-163"><a href="#cb38-163" aria-hidden="true" tabindex="-1"></a><span class="fu">### PCA</span></span>
<span id="cb38-164"><a href="#cb38-164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-167"><a href="#cb38-167" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb38-168"><a href="#cb38-168" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "PCA of Rasch model residuals"</span></span>
<span id="cb38-169"><a href="#cb38-169" aria-hidden="true" tabindex="-1"></a><span class="fu">RIpcmPCA</span>(df)</span>
<span id="cb38-170"><a href="#cb38-170" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb38-171"><a href="#cb38-171" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-172"><a href="#cb38-172" aria-hidden="true" tabindex="-1"></a><span class="fu">### Residual correlations</span></span>
<span id="cb38-173"><a href="#cb38-173" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-176"><a href="#cb38-176" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb38-177"><a href="#cb38-177" aria-hidden="true" tabindex="-1"></a><span class="fu">RIresidcorr</span>(df, <span class="at">cutoff =</span> <span class="fl">0.2</span>)</span>
<span id="cb38-178"><a href="#cb38-178" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb38-179"><a href="#cb38-179" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-180"><a href="#cb38-180" aria-hidden="true" tabindex="-1"></a><span class="fu">### 1st contrast loadings</span></span>
<span id="cb38-181"><a href="#cb38-181" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-184"><a href="#cb38-184" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb38-185"><a href="#cb38-185" aria-hidden="true" tabindex="-1"></a><span class="fu">RIloadLoc</span>(df)</span>
<span id="cb38-186"><a href="#cb38-186" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb38-187"><a href="#cb38-187" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-188"><a href="#cb38-188" aria-hidden="true" tabindex="-1"></a><span class="fu">### Targeting</span></span>
<span id="cb38-189"><a href="#cb38-189" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-192"><a href="#cb38-192" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb38-193"><a href="#cb38-193" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 6</span></span>
<span id="cb38-194"><a href="#cb38-194" aria-hidden="true" tabindex="-1"></a><span class="co"># increase fig-height above as needed, if you have many items</span></span>
<span id="cb38-195"><a href="#cb38-195" aria-hidden="true" tabindex="-1"></a><span class="fu">RItargeting</span>(df)</span>
<span id="cb38-196"><a href="#cb38-196" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb38-197"><a href="#cb38-197" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-198"><a href="#cb38-198" aria-hidden="true" tabindex="-1"></a><span class="fu">### Item hierarchy</span></span>
<span id="cb38-199"><a href="#cb38-199" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-202"><a href="#cb38-202" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb38-203"><a href="#cb38-203" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 6</span></span>
<span id="cb38-204"><a href="#cb38-204" aria-hidden="true" tabindex="-1"></a><span class="fu">RIitemHierarchy</span>(df)</span>
<span id="cb38-205"><a href="#cb38-205" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb38-206"><a href="#cb38-206" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-207"><a href="#cb38-207" aria-hidden="true" tabindex="-1"></a><span class="fu">### DIF</span></span>
<span id="cb38-208"><a href="#cb38-208" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-209"><a href="#cb38-209" aria-hidden="true" tabindex="-1"></a>Interaction between age and gender.</span>
<span id="cb38-210"><a href="#cb38-210" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-213"><a href="#cb38-213" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb38-214"><a href="#cb38-214" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 3</span></span>
<span id="cb38-215"><a href="#cb38-215" aria-hidden="true" tabindex="-1"></a>df.tree <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">matrix</span>(<span class="at">ncol =</span> <span class="dv">0</span>, <span class="at">nrow =</span> <span class="fu">nrow</span>(df)))</span>
<span id="cb38-216"><a href="#cb38-216" aria-hidden="true" tabindex="-1"></a>df.tree<span class="sc">$</span>difdata <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(df)</span>
<span id="cb38-217"><a href="#cb38-217" aria-hidden="true" tabindex="-1"></a>df.tree<span class="sc">$</span>dif.gender <span class="ot">&lt;-</span> dif.gender</span>
<span id="cb38-218"><a href="#cb38-218" aria-hidden="true" tabindex="-1"></a>df.tree<span class="sc">$</span>dif.age<span class="ot">&lt;-</span> dif.age</span>
<span id="cb38-219"><a href="#cb38-219" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-220"><a href="#cb38-220" aria-hidden="true" tabindex="-1"></a>pctree.out <span class="ot">&lt;-</span> <span class="fu">pctree</span>(difdata <span class="sc">~</span> dif.gender <span class="sc">+</span> dif.age, <span class="at">data =</span> df.tree)</span>
<span id="cb38-221"><a href="#cb38-221" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(pctree.out)</span>
<span id="cb38-222"><a href="#cb38-222" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb38-223"><a href="#cb38-223" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-226"><a href="#cb38-226" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb38-227"><a href="#cb38-227" aria-hidden="true" tabindex="-1"></a>cutoff <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb38-228"><a href="#cb38-228" aria-hidden="true" tabindex="-1"></a>diffig <span class="ot">&lt;-</span> <span class="fu">itempar</span>(pctree.out) <span class="sc">%&gt;%</span></span>
<span id="cb38-229"><a href="#cb38-229" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb38-230"><a href="#cb38-230" aria-hidden="true" tabindex="-1"></a>  <span class="fu">t</span>() <span class="sc">%&gt;%</span></span>
<span id="cb38-231"><a href="#cb38-231" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb38-232"><a href="#cb38-232" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb38-233"><a href="#cb38-233" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Mean location</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">rowMeans</span>(.),</span>
<span id="cb38-234"><a href="#cb38-234" aria-hidden="true" tabindex="-1"></a>    <span class="at">StDev =</span> <span class="fu">rowSds</span>(<span class="fu">as.matrix</span>(.))</span>
<span id="cb38-235"><a href="#cb38-235" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb38-236"><a href="#cb38-236" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rowwise</span>() <span class="sc">%&gt;%</span></span>
<span id="cb38-237"><a href="#cb38-237" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">MaxDiff =</span> (<span class="fu">max</span>(<span class="fu">c_across</span>(<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span>(<span class="fu">ncol</span>(.) <span class="sc">-</span> <span class="dv">2</span>))))) <span class="sc">-</span></span>
<span id="cb38-238"><a href="#cb38-238" aria-hidden="true" tabindex="-1"></a>    <span class="fu">min</span>(<span class="fu">c_across</span>(<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span>(<span class="fu">ncol</span>(.) <span class="sc">-</span> <span class="dv">2</span>))))) <span class="sc">%&gt;%</span></span>
<span id="cb38-239"><a href="#cb38-239" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb38-240"><a href="#cb38-240" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), round, <span class="dv">3</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb38-241"><a href="#cb38-241" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>(<span class="at">var =</span> <span class="st">"Item"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb38-242"><a href="#cb38-242" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Item =</span> <span class="fu">names</span>(df)) <span class="sc">%&gt;%</span></span>
<span id="cb38-243"><a href="#cb38-243" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(MaxDiff, <span class="at">.after =</span> <span class="fu">last_col</span>())</span>
<span id="cb38-244"><a href="#cb38-244" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-245"><a href="#cb38-245" aria-hidden="true" tabindex="-1"></a>  <span class="fu">formattable</span>(diffig,</span>
<span id="cb38-246"><a href="#cb38-246" aria-hidden="true" tabindex="-1"></a>    <span class="fu">list</span>(<span class="at">MaxDiff =</span> <span class="fu">formatter</span>(<span class="st">"span"</span>,</span>
<span id="cb38-247"><a href="#cb38-247" aria-hidden="true" tabindex="-1"></a>      <span class="at">style =</span> <span class="sc">~</span> <span class="fu">style</span>(<span class="at">color =</span> <span class="fu">ifelse</span>(MaxDiff <span class="sc">&lt;</span> <span class="sc">-</span>cutoff,</span>
<span id="cb38-248"><a href="#cb38-248" aria-hidden="true" tabindex="-1"></a>        <span class="st">"red"</span>, <span class="fu">ifelse</span>(MaxDiff <span class="sc">&gt;</span> cutoff, <span class="st">"red"</span>, <span class="st">"black"</span>)</span>
<span id="cb38-249"><a href="#cb38-249" aria-hidden="true" tabindex="-1"></a>      ))</span>
<span id="cb38-250"><a href="#cb38-250" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb38-251"><a href="#cb38-251" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb38-252"><a href="#cb38-252" aria-hidden="true" tabindex="-1"></a>    <span class="at">table.attr =</span> <span class="st">"class=</span><span class="sc">\"</span><span class="st">table table-striped</span><span class="sc">\"</span><span class="st"> style=</span><span class="sc">\"</span><span class="st">font-size: 15px; font-family: Lato</span><span class="sc">\"</span><span class="st">"</span></span>
<span id="cb38-253"><a href="#cb38-253" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb38-254"><a href="#cb38-254" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb38-255"><a href="#cb38-255" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-256"><a href="#cb38-256" aria-hidden="true" tabindex="-1"></a>Only DIF between genders found, and none large enough to cause problems.</span>
<span id="cb38-257"><a href="#cb38-257" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-258"><a href="#cb38-258" aria-hidden="true" tabindex="-1"></a><span class="fu">### Reliability</span></span>
<span id="cb38-259"><a href="#cb38-259" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-262"><a href="#cb38-262" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb38-263"><a href="#cb38-263" aria-hidden="true" tabindex="-1"></a><span class="fu">RItif</span>(df)</span>
<span id="cb38-264"><a href="#cb38-264" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb38-265"><a href="#cb38-265" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb38-266"><a href="#cb38-266" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-267"><a href="#cb38-267" aria-hidden="true" tabindex="-1"></a>Item fit shows some minor issues, but we'll leave them as good enough for the primary goal of visualization. Do have a look at the item hierarchy and give it some thought?</span>
<span id="cb38-268"><a href="#cb38-268" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-269"><a href="#cb38-269" aria-hidden="true" tabindex="-1"></a><span class="fu">## Estimating latent scores</span></span>
<span id="cb38-270"><a href="#cb38-270" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-271"><a href="#cb38-271" aria-hidden="true" tabindex="-1"></a>First, we need the item threshold locations to later estimate person scores.</span>
<span id="cb38-272"><a href="#cb38-272" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-275"><a href="#cb38-275" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb38-276"><a href="#cb38-276" aria-hidden="true" tabindex="-1"></a><span class="fu">RIitemparams</span>(df, <span class="st">"mhcItemParams.csv"</span>)</span>
<span id="cb38-277"><a href="#cb38-277" aria-hidden="true" tabindex="-1"></a>MHCitemParameters <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">read.csv</span>(<span class="st">"mhcItemParams.csv"</span>))</span>
<span id="cb38-278"><a href="#cb38-278" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb38-279"><a href="#cb38-279" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-280"><a href="#cb38-280" aria-hidden="true" tabindex="-1"></a>Actually, the function used to estimate person scores can automatically estimate the item parameters. But since this is just a practical use case, and you might be interested in applying the item parameters on your own dataset (since I cannot share this data), I thought it worth mentioning and displaying the parameters.</span>
<span id="cb38-281"><a href="#cb38-281" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-284"><a href="#cb38-284" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb38-285"><a href="#cb38-285" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>MHCscore <span class="ot">&lt;-</span> <span class="fu">RIestThetas2</span>(df, <span class="at">itemParams =</span> MHCitemParameters, <span class="at">cpu =</span> <span class="dv">8</span>)</span>
<span id="cb38-286"><a href="#cb38-286" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb38-287"><a href="#cb38-287" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-288"><a href="#cb38-288" aria-hidden="true" tabindex="-1"></a><span class="fu">### Plotting the distribution</span></span>
<span id="cb38-289"><a href="#cb38-289" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-292"><a href="#cb38-292" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb38-293"><a href="#cb38-293" aria-hidden="true" tabindex="-1"></a><span class="co"># for visualization, we add Gender back to the df</span></span>
<span id="cb38-294"><a href="#cb38-294" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>Gender <span class="ot">&lt;-</span> dif.gender</span>
<span id="cb38-295"><a href="#cb38-295" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-296"><a href="#cb38-296" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df,<span class="fu">aes</span>(<span class="at">x =</span> MHCscore, <span class="at">y =</span> Gender, <span class="at">fill =</span> Gender)) <span class="sc">+</span></span>
<span id="cb38-297"><a href="#cb38-297" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_slab</span>(</span>
<span id="cb38-298"><a href="#cb38-298" aria-hidden="true" tabindex="-1"></a>    <span class="at">side =</span> <span class="st">"right"</span>, <span class="at">show.legend =</span> F,</span>
<span id="cb38-299"><a href="#cb38-299" aria-hidden="true" tabindex="-1"></a>    <span class="at">scale =</span> <span class="fl">0.7</span>, </span>
<span id="cb38-300"><a href="#cb38-300" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">fill_ramp =</span> <span class="fu">after_stat</span>(level)),</span>
<span id="cb38-301"><a href="#cb38-301" aria-hidden="true" tabindex="-1"></a>    <span class="at">.width =</span> <span class="fu">c</span>(.<span class="dv">50</span>, .<span class="dv">75</span>, <span class="dv">1</span>)</span>
<span id="cb38-302"><a href="#cb38-302" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb38-303"><a href="#cb38-303" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.data =</span> <span class="st">"mean_cl_normal"</span>,<span class="at">show.legend =</span> F, <span class="at">size =</span> .<span class="dv">4</span>,</span>
<span id="cb38-304"><a href="#cb38-304" aria-hidden="true" tabindex="-1"></a>               <span class="at">position =</span> <span class="fu">position_dodge2nudge</span>(<span class="at">x=</span>.<span class="dv">05</span>,<span class="at">width =</span> .<span class="dv">8</span>)) <span class="sc">+</span></span>
<span id="cb38-305"><a href="#cb38-305" aria-hidden="true" tabindex="-1"></a><span class="fu">scale_fill_ramp_discrete</span>(<span class="at">from=</span><span class="st">'black'</span>, <span class="at">aesthetics =</span> <span class="st">"fill_ramp"</span>) <span class="sc">+</span></span>
<span id="cb38-306"><a href="#cb38-306" aria-hidden="true" tabindex="-1"></a>      <span class="fu">scale_fill_viridis_d</span>(<span class="at">begin =</span> <span class="fl">0.4</span>, <span class="at">direction =</span> <span class="sc">-</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb38-307"><a href="#cb38-307" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-308"><a href="#cb38-308" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"MHC-SF latent scores"</span>) <span class="sc">+</span></span>
<span id="cb38-309"><a href="#cb38-309" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb38-310"><a href="#cb38-310" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb38-311"><a href="#cb38-311" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_rise</span>() <span class="sc">+</span></span>
<span id="cb38-312"><a href="#cb38-312" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">13</span>))</span>
<span id="cb38-313"><a href="#cb38-313" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb38-314"><a href="#cb38-314" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-315"><a href="#cb38-315" aria-hidden="true" tabindex="-1"></a><span class="fu">## Preparing visualization</span></span>
<span id="cb38-316"><a href="#cb38-316" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-317"><a href="#cb38-317" aria-hidden="true" tabindex="-1"></a>Let's use some sample values, based on distribution quintiles, as a starting point.</span>
<span id="cb38-318"><a href="#cb38-318" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-321"><a href="#cb38-321" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb38-322"><a href="#cb38-322" aria-hidden="true" tabindex="-1"></a>quintiles <span class="ot">&lt;-</span> <span class="fu">quantile</span>(df<span class="sc">$</span>MHCscore, <span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.2</span>,<span class="fl">0.4</span>,<span class="fl">0.6</span>,<span class="fl">0.8</span>))</span>
<span id="cb38-323"><a href="#cb38-323" aria-hidden="true" tabindex="-1"></a>quintiles</span>
<span id="cb38-324"><a href="#cb38-324" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb38-325"><a href="#cb38-325" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-326"><a href="#cb38-326" aria-hidden="true" tabindex="-1"></a>Now we find the mode responses for each item based on the respondents in each quintile.</span>
<span id="cb38-327"><a href="#cb38-327" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-328"><a href="#cb38-328" aria-hidden="true" tabindex="-1"></a>First, lets make groupings based on the quintile cutoff values.</span>
<span id="cb38-329"><a href="#cb38-329" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-332"><a href="#cb38-332" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb38-333"><a href="#cb38-333" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> </span>
<span id="cb38-334"><a href="#cb38-334" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Q_group =</span> <span class="fu">case_when</span>(MHCscore <span class="sc">&lt;</span> quintiles[<span class="dv">1</span>] <span class="sc">~</span> <span class="st">"0-20"</span>,</span>
<span id="cb38-335"><a href="#cb38-335" aria-hidden="true" tabindex="-1"></a>                             MHCscore <span class="sc">&gt;=</span> quintiles[<span class="dv">1</span>] <span class="sc">&amp;</span> MHCscore <span class="sc">&lt;</span> quintiles[<span class="dv">2</span>] <span class="sc">~</span> <span class="st">"20-40"</span>,</span>
<span id="cb38-336"><a href="#cb38-336" aria-hidden="true" tabindex="-1"></a>                             MHCscore <span class="sc">&gt;=</span> quintiles[<span class="dv">2</span>] <span class="sc">&amp;</span> MHCscore <span class="sc">&lt;</span> quintiles[<span class="dv">3</span>] <span class="sc">~</span> <span class="st">"40-60"</span>,</span>
<span id="cb38-337"><a href="#cb38-337" aria-hidden="true" tabindex="-1"></a>                             MHCscore <span class="sc">&gt;=</span> quintiles[<span class="dv">3</span>] <span class="sc">&amp;</span> MHCscore <span class="sc">&lt;</span> quintiles[<span class="dv">4</span>] <span class="sc">~</span> <span class="st">"60-80"</span>,</span>
<span id="cb38-338"><a href="#cb38-338" aria-hidden="true" tabindex="-1"></a>                             MHCscore <span class="sc">&gt;=</span> quintiles[<span class="dv">4</span>] <span class="sc">~</span> <span class="st">"80-100"</span>,</span>
<span id="cb38-339"><a href="#cb38-339" aria-hidden="true" tabindex="-1"></a>                             <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA</span>)</span>
<span id="cb38-340"><a href="#cb38-340" aria-hidden="true" tabindex="-1"></a>         )</span>
<span id="cb38-341"><a href="#cb38-341" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-342"><a href="#cb38-342" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span> </span>
<span id="cb38-343"><a href="#cb38-343" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(Q_group) <span class="sc">%&gt;%</span> </span>
<span id="cb38-344"><a href="#cb38-344" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Q_group, <span class="at">y =</span> n, <span class="at">fill =</span> Q_group)) <span class="sc">+</span></span>
<span id="cb38-345"><a href="#cb38-345" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>() <span class="sc">+</span></span>
<span id="cb38-346"><a href="#cb38-346" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_d</span>(<span class="at">begin =</span> <span class="fl">0.4</span>, <span class="at">direction =</span> <span class="sc">-</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb38-347"><a href="#cb38-347" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb38-348"><a href="#cb38-348" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_rise</span>()</span>
<span id="cb38-349"><a href="#cb38-349" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-350"><a href="#cb38-350" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb38-351"><a href="#cb38-351" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-352"><a href="#cb38-352" aria-hidden="true" tabindex="-1"></a>Identifying mode response categories for each item for each group is the next step</span>
<span id="cb38-353"><a href="#cb38-353" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-356"><a href="#cb38-356" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb38-357"><a href="#cb38-357" aria-hidden="true" tabindex="-1"></a>Mode <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb38-358"><a href="#cb38-358" aria-hidden="true" tabindex="-1"></a>  ux <span class="ot">&lt;-</span> <span class="fu">unique</span>(x)</span>
<span id="cb38-359"><a href="#cb38-359" aria-hidden="true" tabindex="-1"></a>  ux[<span class="fu">which.max</span>(<span class="fu">tabulate</span>(<span class="fu">match</span>(x, ux)))]</span>
<span id="cb38-360"><a href="#cb38-360" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb38-361"><a href="#cb38-361" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-362"><a href="#cb38-362" aria-hidden="true" tabindex="-1"></a><span class="co"># a df with one row per group and one column per item</span></span>
<span id="cb38-363"><a href="#cb38-363" aria-hidden="true" tabindex="-1"></a>modeResponses <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">matrix</span>(<span class="at">ncol =</span> <span class="dv">9</span>, <span class="at">nrow =</span> <span class="dv">5</span>))</span>
<span id="cb38-364"><a href="#cb38-364" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(modeResponses) <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> </span>
<span id="cb38-365"><a href="#cb38-365" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">starts_with</span>(<span class="st">"mhc"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb38-366"><a href="#cb38-366" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">!</span>MHCscore) <span class="sc">%&gt;%</span> </span>
<span id="cb38-367"><a href="#cb38-367" aria-hidden="true" tabindex="-1"></a>  <span class="fu">names</span>()</span>
<span id="cb38-368"><a href="#cb38-368" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-369"><a href="#cb38-369" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">names</span>(modeResponses)) {</span>
<span id="cb38-370"><a href="#cb38-370" aria-hidden="true" tabindex="-1"></a>  q0 <span class="ot">&lt;-</span> <span class="fu">Mode</span>(df <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Q_group <span class="sc">==</span> <span class="st">"0-20"</span>) <span class="sc">%&gt;%</span> <span class="fu">select</span>(i) <span class="sc">%&gt;%</span> <span class="fu">na.omit</span>() <span class="sc">%&gt;%</span> <span class="fu">pull</span>())</span>
<span id="cb38-371"><a href="#cb38-371" aria-hidden="true" tabindex="-1"></a>  q1 <span class="ot">&lt;-</span> <span class="fu">Mode</span>(df <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Q_group <span class="sc">==</span> <span class="st">"20-40"</span>) <span class="sc">%&gt;%</span> <span class="fu">select</span>(i) <span class="sc">%&gt;%</span> <span class="fu">na.omit</span>() <span class="sc">%&gt;%</span> <span class="fu">pull</span>())</span>
<span id="cb38-372"><a href="#cb38-372" aria-hidden="true" tabindex="-1"></a>  q2 <span class="ot">&lt;-</span> <span class="fu">Mode</span>(df <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Q_group <span class="sc">==</span> <span class="st">"40-60"</span>) <span class="sc">%&gt;%</span> <span class="fu">select</span>(i) <span class="sc">%&gt;%</span> <span class="fu">na.omit</span>() <span class="sc">%&gt;%</span> <span class="fu">pull</span>())</span>
<span id="cb38-373"><a href="#cb38-373" aria-hidden="true" tabindex="-1"></a>  q3 <span class="ot">&lt;-</span> <span class="fu">Mode</span>(df <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Q_group <span class="sc">==</span> <span class="st">"60-80"</span>) <span class="sc">%&gt;%</span> <span class="fu">select</span>(i) <span class="sc">%&gt;%</span> <span class="fu">na.omit</span>() <span class="sc">%&gt;%</span> <span class="fu">pull</span>())</span>
<span id="cb38-374"><a href="#cb38-374" aria-hidden="true" tabindex="-1"></a>  q4 <span class="ot">&lt;-</span> <span class="fu">Mode</span>(df <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Q_group <span class="sc">==</span> <span class="st">"80-100"</span>) <span class="sc">%&gt;%</span> <span class="fu">select</span>(i) <span class="sc">%&gt;%</span> <span class="fu">na.omit</span>() <span class="sc">%&gt;%</span> <span class="fu">pull</span>())</span>
<span id="cb38-375"><a href="#cb38-375" aria-hidden="true" tabindex="-1"></a>  modeResponses[[i]] <span class="ot">&lt;-</span> <span class="fu">rbind</span>(q0,q1,q2,q3,q4)</span>
<span id="cb38-376"><a href="#cb38-376" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb38-377"><a href="#cb38-377" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-378"><a href="#cb38-378" aria-hidden="true" tabindex="-1"></a><span class="co"># transform to dataframe with numeric variables for later extraction as vectors</span></span>
<span id="cb38-379"><a href="#cb38-379" aria-hidden="true" tabindex="-1"></a>modeResponses <span class="ot">&lt;-</span> modeResponses <span class="sc">%&gt;%</span> </span>
<span id="cb38-380"><a href="#cb38-380" aria-hidden="true" tabindex="-1"></a>  <span class="fu">t</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb38-381"><a href="#cb38-381" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>()</span>
<span id="cb38-382"><a href="#cb38-382" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb38-383"><a href="#cb38-383" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-384"><a href="#cb38-384" aria-hidden="true" tabindex="-1"></a>Estimating the latent score and SEM for each group's mode response pattern.</span>
<span id="cb38-385"><a href="#cb38-385" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-388"><a href="#cb38-388" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb38-389"><a href="#cb38-389" aria-hidden="true" tabindex="-1"></a><span class="co"># sorry for the copy+paste code here...</span></span>
<span id="cb38-390"><a href="#cb38-390" aria-hidden="true" tabindex="-1"></a>avg1 <span class="ot">&lt;-</span> <span class="fu">thetaEst</span>(MHCitemParameters, modeResponses<span class="sc">$</span>V1, <span class="at">model =</span> <span class="st">"PCM"</span>, <span class="at">method =</span> <span class="st">"WL"</span>)</span>
<span id="cb38-391"><a href="#cb38-391" aria-hidden="true" tabindex="-1"></a>sem1 <span class="ot">&lt;-</span> <span class="fu">semTheta</span>(<span class="at">thEst =</span> avg1, <span class="at">it =</span> MHCitemParameters, <span class="at">x =</span> modeResponses<span class="sc">$</span>V1, <span class="at">model =</span> <span class="st">"PCM"</span>, <span class="at">method =</span> <span class="st">"WL"</span>)</span>
<span id="cb38-392"><a href="#cb38-392" aria-hidden="true" tabindex="-1"></a>avg2 <span class="ot">&lt;-</span> <span class="fu">thetaEst</span>(MHCitemParameters, modeResponses<span class="sc">$</span>V2, <span class="at">model =</span> <span class="st">"PCM"</span>, <span class="at">method =</span> <span class="st">"WL"</span>)</span>
<span id="cb38-393"><a href="#cb38-393" aria-hidden="true" tabindex="-1"></a>sem2 <span class="ot">&lt;-</span> <span class="fu">semTheta</span>(<span class="at">thEst =</span> avg2, <span class="at">it =</span> MHCitemParameters, <span class="at">x =</span> modeResponses<span class="sc">$</span>V2, <span class="at">model =</span> <span class="st">"PCM"</span>, <span class="at">method =</span> <span class="st">"WL"</span>)</span>
<span id="cb38-394"><a href="#cb38-394" aria-hidden="true" tabindex="-1"></a>avg3 <span class="ot">&lt;-</span> <span class="fu">thetaEst</span>(MHCitemParameters, modeResponses<span class="sc">$</span>V3, <span class="at">model =</span> <span class="st">"PCM"</span>, <span class="at">method =</span> <span class="st">"WL"</span>)</span>
<span id="cb38-395"><a href="#cb38-395" aria-hidden="true" tabindex="-1"></a>sem3 <span class="ot">&lt;-</span> <span class="fu">semTheta</span>(<span class="at">thEst =</span> avg3, <span class="at">it =</span> MHCitemParameters, <span class="at">x =</span> modeResponses<span class="sc">$</span>V3, <span class="at">model =</span> <span class="st">"PCM"</span>, <span class="at">method =</span> <span class="st">"WL"</span>)</span>
<span id="cb38-396"><a href="#cb38-396" aria-hidden="true" tabindex="-1"></a>avg4 <span class="ot">&lt;-</span> <span class="fu">thetaEst</span>(MHCitemParameters, modeResponses<span class="sc">$</span>V4, <span class="at">model =</span> <span class="st">"PCM"</span>, <span class="at">method =</span> <span class="st">"WL"</span>)</span>
<span id="cb38-397"><a href="#cb38-397" aria-hidden="true" tabindex="-1"></a>sem4 <span class="ot">&lt;-</span> <span class="fu">semTheta</span>(<span class="at">thEst =</span> avg4, <span class="at">it =</span> MHCitemParameters, <span class="at">x =</span> modeResponses<span class="sc">$</span>V4, <span class="at">model =</span> <span class="st">"PCM"</span>, <span class="at">method =</span> <span class="st">"WL"</span>)</span>
<span id="cb38-398"><a href="#cb38-398" aria-hidden="true" tabindex="-1"></a>avg5 <span class="ot">&lt;-</span> <span class="fu">thetaEst</span>(MHCitemParameters, modeResponses<span class="sc">$</span>V5, <span class="at">model =</span> <span class="st">"PCM"</span>, <span class="at">method =</span> <span class="st">"WL"</span>)</span>
<span id="cb38-399"><a href="#cb38-399" aria-hidden="true" tabindex="-1"></a>sem5 <span class="ot">&lt;-</span> <span class="fu">semTheta</span>(<span class="at">thEst =</span> avg5, <span class="at">it =</span> MHCitemParameters, <span class="at">x =</span> modeResponses<span class="sc">$</span>V5, <span class="at">model =</span> <span class="st">"PCM"</span>, <span class="at">method =</span> <span class="st">"WL"</span>)</span>
<span id="cb38-400"><a href="#cb38-400" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb38-401"><a href="#cb38-401" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-402"><a href="#cb38-402" aria-hidden="true" tabindex="-1"></a><span class="fu">## Visualization {#sec-visualization}</span></span>
<span id="cb38-403"><a href="#cb38-403" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-406"><a href="#cb38-406" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb38-407"><a href="#cb38-407" aria-hidden="true" tabindex="-1"></a>respTable <span class="ot">&lt;-</span> <span class="cf">function</span>(qLevel) {</span>
<span id="cb38-408"><a href="#cb38-408" aria-hidden="true" tabindex="-1"></a>    <span class="co"># typical response patterns for different risk levels</span></span>
<span id="cb38-409"><a href="#cb38-409" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (qLevel <span class="sc">==</span> <span class="st">"0-20"</span>) {</span>
<span id="cb38-410"><a href="#cb38-410" aria-hidden="true" tabindex="-1"></a>      p.resp <span class="ot">&lt;-</span> modeResponses<span class="sc">$</span>V1 </span>
<span id="cb38-411"><a href="#cb38-411" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> <span class="cf">if</span> (qLevel <span class="sc">==</span> <span class="st">"20-40"</span>) {</span>
<span id="cb38-412"><a href="#cb38-412" aria-hidden="true" tabindex="-1"></a>      p.resp <span class="ot">&lt;-</span> modeResponses<span class="sc">$</span>V2 </span>
<span id="cb38-413"><a href="#cb38-413" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> <span class="cf">if</span> (qLevel <span class="sc">==</span> <span class="st">"40-60"</span>) {</span>
<span id="cb38-414"><a href="#cb38-414" aria-hidden="true" tabindex="-1"></a>      p.resp <span class="ot">&lt;-</span> modeResponses<span class="sc">$</span>V3 </span>
<span id="cb38-415"><a href="#cb38-415" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> <span class="cf">if</span> (qLevel <span class="sc">==</span> <span class="st">"60-80"</span>) {</span>
<span id="cb38-416"><a href="#cb38-416" aria-hidden="true" tabindex="-1"></a>      p.resp <span class="ot">&lt;-</span> modeResponses<span class="sc">$</span>V4 </span>
<span id="cb38-417"><a href="#cb38-417" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> <span class="cf">if</span> (qLevel <span class="sc">==</span> <span class="st">"80-100"</span>) {</span>
<span id="cb38-418"><a href="#cb38-418" aria-hidden="true" tabindex="-1"></a>      p.resp <span class="ot">&lt;-</span> modeResponses<span class="sc">$</span>V5 </span>
<span id="cb38-419"><a href="#cb38-419" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb38-420"><a href="#cb38-420" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-421"><a href="#cb38-421" aria-hidden="true" tabindex="-1"></a>    itemresponses <span class="sc">%&gt;%</span></span>
<span id="cb38-422"><a href="#cb38-422" aria-hidden="true" tabindex="-1"></a>      <span class="fu">formattable</span>(.,</span>
<span id="cb38-423"><a href="#cb38-423" aria-hidden="true" tabindex="-1"></a>        <span class="at">align =</span> <span class="fu">c</span>(<span class="st">"r"</span>, <span class="st">"l"</span>, <span class="st">"c"</span>, <span class="st">"c"</span>, <span class="st">"c"</span>, <span class="st">"c"</span>, <span class="st">"c"</span>), <span class="fu">list</span>(</span>
<span id="cb38-424"><a href="#cb38-424" aria-hidden="true" tabindex="-1"></a>          formattable<span class="sc">::</span><span class="fu">area</span>(<span class="at">row =</span> <span class="dv">1</span>, <span class="at">col =</span> <span class="dv">3</span> <span class="sc">+</span> p.resp[<span class="dv">1</span>]) <span class="sc">~</span> <span class="fu">color_tile</span>(<span class="st">"lightblue"</span>, <span class="st">"lightpink"</span>),</span>
<span id="cb38-425"><a href="#cb38-425" aria-hidden="true" tabindex="-1"></a>          formattable<span class="sc">::</span><span class="fu">area</span>(<span class="at">row =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="dv">3</span> <span class="sc">+</span> p.resp[<span class="dv">2</span>]) <span class="sc">~</span> <span class="fu">color_tile</span>(<span class="st">"lightblue"</span>, <span class="st">"lightpink"</span>),</span>
<span id="cb38-426"><a href="#cb38-426" aria-hidden="true" tabindex="-1"></a>          formattable<span class="sc">::</span><span class="fu">area</span>(<span class="at">row =</span> <span class="dv">3</span>, <span class="at">col =</span> <span class="dv">3</span> <span class="sc">+</span> p.resp[<span class="dv">3</span>]) <span class="sc">~</span> <span class="fu">color_tile</span>(<span class="st">"lightblue"</span>, <span class="st">"lightpink"</span>),</span>
<span id="cb38-427"><a href="#cb38-427" aria-hidden="true" tabindex="-1"></a>          formattable<span class="sc">::</span><span class="fu">area</span>(<span class="at">row =</span> <span class="dv">4</span>, <span class="at">col =</span> <span class="dv">3</span> <span class="sc">+</span> p.resp[<span class="dv">4</span>]) <span class="sc">~</span> <span class="fu">color_tile</span>(<span class="st">"lightblue"</span>, <span class="st">"lightpink"</span>),</span>
<span id="cb38-428"><a href="#cb38-428" aria-hidden="true" tabindex="-1"></a>          formattable<span class="sc">::</span><span class="fu">area</span>(<span class="at">row =</span> <span class="dv">5</span>, <span class="at">col =</span> <span class="dv">3</span> <span class="sc">+</span> p.resp[<span class="dv">5</span>]) <span class="sc">~</span> <span class="fu">color_tile</span>(<span class="st">"lightblue"</span>, <span class="st">"lightpink"</span>),</span>
<span id="cb38-429"><a href="#cb38-429" aria-hidden="true" tabindex="-1"></a>          formattable<span class="sc">::</span><span class="fu">area</span>(<span class="at">row =</span> <span class="dv">6</span>, <span class="at">col =</span> <span class="dv">3</span> <span class="sc">+</span> p.resp[<span class="dv">6</span>]) <span class="sc">~</span> <span class="fu">color_tile</span>(<span class="st">"lightblue"</span>, <span class="st">"lightpink"</span>),</span>
<span id="cb38-430"><a href="#cb38-430" aria-hidden="true" tabindex="-1"></a>          formattable<span class="sc">::</span><span class="fu">area</span>(<span class="at">row =</span> <span class="dv">7</span>, <span class="at">col =</span> <span class="dv">3</span> <span class="sc">+</span> p.resp[<span class="dv">7</span>]) <span class="sc">~</span> <span class="fu">color_tile</span>(<span class="st">"lightblue"</span>, <span class="st">"lightpink"</span>),</span>
<span id="cb38-431"><a href="#cb38-431" aria-hidden="true" tabindex="-1"></a>          formattable<span class="sc">::</span><span class="fu">area</span>(<span class="at">row =</span> <span class="dv">8</span>, <span class="at">col =</span> <span class="dv">3</span> <span class="sc">+</span> p.resp[<span class="dv">8</span>]) <span class="sc">~</span> <span class="fu">color_tile</span>(<span class="st">"lightblue"</span>, <span class="st">"lightpink"</span>),</span>
<span id="cb38-432"><a href="#cb38-432" aria-hidden="true" tabindex="-1"></a>          formattable<span class="sc">::</span><span class="fu">area</span>(<span class="at">row =</span> <span class="dv">9</span>, <span class="at">col =</span> <span class="dv">3</span> <span class="sc">+</span> p.resp[<span class="dv">9</span>]) <span class="sc">~</span> <span class="fu">color_tile</span>(<span class="st">"lightblue"</span>, <span class="st">"lightpink"</span>)</span>
<span id="cb38-433"><a href="#cb38-433" aria-hidden="true" tabindex="-1"></a>        ),</span>
<span id="cb38-434"><a href="#cb38-434" aria-hidden="true" tabindex="-1"></a>        <span class="at">table.attr =</span> <span class="st">'class=</span><span class="sc">\"</span><span class="st">table table-striped</span><span class="sc">\"</span><span class="st"> style="font-size: 15px; font-family: Lato"'</span></span>
<span id="cb38-435"><a href="#cb38-435" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb38-436"><a href="#cb38-436" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb38-437"><a href="#cb38-437" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-438"><a href="#cb38-438" aria-hidden="true" tabindex="-1"></a>respDist <span class="ot">&lt;-</span> <span class="cf">function</span>(qLevel) {</span>
<span id="cb38-439"><a href="#cb38-439" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (qLevel <span class="sc">==</span> <span class="st">"0-20"</span>) {</span>
<span id="cb38-440"><a href="#cb38-440" aria-hidden="true" tabindex="-1"></a>      score <span class="ot">&lt;-</span> avg1</span>
<span id="cb38-441"><a href="#cb38-441" aria-hidden="true" tabindex="-1"></a>      sem <span class="ot">&lt;-</span> sem1</span>
<span id="cb38-442"><a href="#cb38-442" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> <span class="cf">if</span> (qLevel <span class="sc">==</span> <span class="st">"20-40"</span>) {</span>
<span id="cb38-443"><a href="#cb38-443" aria-hidden="true" tabindex="-1"></a>      score <span class="ot">&lt;-</span> avg2</span>
<span id="cb38-444"><a href="#cb38-444" aria-hidden="true" tabindex="-1"></a>      sem <span class="ot">&lt;-</span> sem2</span>
<span id="cb38-445"><a href="#cb38-445" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> <span class="cf">if</span> (qLevel <span class="sc">==</span> <span class="st">"40-60"</span>) {</span>
<span id="cb38-446"><a href="#cb38-446" aria-hidden="true" tabindex="-1"></a>      score <span class="ot">&lt;-</span> avg3</span>
<span id="cb38-447"><a href="#cb38-447" aria-hidden="true" tabindex="-1"></a>      sem <span class="ot">&lt;-</span> sem3</span>
<span id="cb38-448"><a href="#cb38-448" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> <span class="cf">if</span> (qLevel <span class="sc">==</span> <span class="st">"60-80"</span>) {</span>
<span id="cb38-449"><a href="#cb38-449" aria-hidden="true" tabindex="-1"></a>      score <span class="ot">&lt;-</span> avg4</span>
<span id="cb38-450"><a href="#cb38-450" aria-hidden="true" tabindex="-1"></a>      sem <span class="ot">&lt;-</span> sem4</span>
<span id="cb38-451"><a href="#cb38-451" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> <span class="cf">if</span> (qLevel <span class="sc">==</span> <span class="st">"80-100"</span>) {</span>
<span id="cb38-452"><a href="#cb38-452" aria-hidden="true" tabindex="-1"></a>      score <span class="ot">&lt;-</span> avg5</span>
<span id="cb38-453"><a href="#cb38-453" aria-hidden="true" tabindex="-1"></a>      sem <span class="ot">&lt;-</span> sem5</span>
<span id="cb38-454"><a href="#cb38-454" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb38-455"><a href="#cb38-455" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-456"><a href="#cb38-456" aria-hidden="true" tabindex="-1"></a>  qlabel <span class="ot">&lt;-</span> qLevel</span>
<span id="cb38-457"><a href="#cb38-457" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x =</span> MHCscore, <span class="at">y =</span> Gender, <span class="at">fill =</span> Gender)) <span class="sc">+</span></span>
<span id="cb38-458"><a href="#cb38-458" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_slab</span>(</span>
<span id="cb38-459"><a href="#cb38-459" aria-hidden="true" tabindex="-1"></a>    <span class="at">side =</span> <span class="st">"right"</span>, <span class="at">show.legend =</span> F,</span>
<span id="cb38-460"><a href="#cb38-460" aria-hidden="true" tabindex="-1"></a>    <span class="at">scale =</span> <span class="fl">0.8</span>, <span class="at">justification =</span> <span class="dv">0</span>,</span>
<span id="cb38-461"><a href="#cb38-461" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">fill_ramp =</span> <span class="fu">after_stat</span>(level)),</span>
<span id="cb38-462"><a href="#cb38-462" aria-hidden="true" tabindex="-1"></a>    <span class="at">.width =</span> <span class="fu">c</span>(.<span class="dv">50</span>, .<span class="dv">75</span>, <span class="dv">1</span>)</span>
<span id="cb38-463"><a href="#cb38-463" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb38-464"><a href="#cb38-464" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb38-465"><a href="#cb38-465" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(</span>
<span id="cb38-466"><a href="#cb38-466" aria-hidden="true" tabindex="-1"></a>    <span class="at">fun.data =</span> <span class="st">"mean_cl_normal"</span>, <span class="at">show.legend =</span> F, <span class="at">size =</span> .<span class="dv">4</span>,</span>
<span id="cb38-467"><a href="#cb38-467" aria-hidden="true" tabindex="-1"></a>    <span class="at">position =</span> <span class="fu">position_dodge2nudge</span>(<span class="at">x =</span> .<span class="dv">05</span>, <span class="at">width =</span> .<span class="dv">8</span>)</span>
<span id="cb38-468"><a href="#cb38-468" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb38-469"><a href="#cb38-469" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_ramp_discrete</span>(<span class="at">from =</span> <span class="st">"black"</span>, <span class="at">aesthetics =</span> <span class="st">"fill_ramp"</span>) <span class="sc">+</span></span>
<span id="cb38-470"><a href="#cb38-470" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_d</span>(<span class="at">begin =</span> <span class="fl">0.4</span>, <span class="at">direction =</span> <span class="sc">-</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb38-471"><a href="#cb38-471" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> score, <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">linetype =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb38-472"><a href="#cb38-472" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"rect"</span>, <span class="at">ymin =</span> <span class="dv">0</span>, <span class="at">ymax =</span> <span class="cn">Inf</span>, <span class="at">xmin =</span> score <span class="sc">-</span> sem, <span class="at">xmax =</span> score <span class="sc">+</span> sem, <span class="at">alpha =</span> .<span class="dv">15</span>) <span class="sc">+</span></span>
<span id="cb38-473"><a href="#cb38-473" aria-hidden="true" tabindex="-1"></a>  <span class="co">#annotate("text", label = qlabel, x = score-0.12, y = 1.5, </span></span>
<span id="cb38-474"><a href="#cb38-474" aria-hidden="true" tabindex="-1"></a>  <span class="co">#         angle = 90, size = 4, family = "Lato") +</span></span>
<span id="cb38-475"><a href="#cb38-475" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"MHC-SF latent scores"</span>) <span class="sc">+</span></span>
<span id="cb38-476"><a href="#cb38-476" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb38-477"><a href="#cb38-477" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb38-478"><a href="#cb38-478" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_rise</span>(<span class="at">axissize =</span> <span class="dv">11</span>) <span class="sc">+</span></span>
<span id="cb38-479"><a href="#cb38-479" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">11</span>)) <span class="sc">+</span></span>
<span id="cb38-480"><a href="#cb38-480" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_discrete</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>))</span>
<span id="cb38-481"><a href="#cb38-481" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb38-482"><a href="#cb38-482" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb38-483"><a href="#cb38-483" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-484"><a href="#cb38-484" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb38-485"><a href="#cb38-485" aria-hidden="true" tabindex="-1"></a><span class="fu">### 0-20</span></span>
<span id="cb38-486"><a href="#cb38-486" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-489"><a href="#cb38-489" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb38-490"><a href="#cb38-490" aria-hidden="true" tabindex="-1"></a><span class="fu">respTable</span>(<span class="st">"0-20"</span>)</span>
<span id="cb38-491"><a href="#cb38-491" aria-hidden="true" tabindex="-1"></a><span class="fu">respDist</span>(<span class="st">"0-20"</span>)</span>
<span id="cb38-492"><a href="#cb38-492" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb38-493"><a href="#cb38-493" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-494"><a href="#cb38-494" aria-hidden="true" tabindex="-1"></a><span class="fu">### 20-40</span></span>
<span id="cb38-495"><a href="#cb38-495" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-498"><a href="#cb38-498" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb38-499"><a href="#cb38-499" aria-hidden="true" tabindex="-1"></a><span class="fu">respTable</span>(<span class="st">"20-40"</span>)</span>
<span id="cb38-500"><a href="#cb38-500" aria-hidden="true" tabindex="-1"></a><span class="fu">respDist</span>(<span class="st">"20-40"</span>)</span>
<span id="cb38-501"><a href="#cb38-501" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-502"><a href="#cb38-502" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb38-503"><a href="#cb38-503" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-504"><a href="#cb38-504" aria-hidden="true" tabindex="-1"></a><span class="fu">### 40-60</span></span>
<span id="cb38-505"><a href="#cb38-505" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-508"><a href="#cb38-508" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb38-509"><a href="#cb38-509" aria-hidden="true" tabindex="-1"></a><span class="fu">respTable</span>(<span class="st">"40-60"</span>)</span>
<span id="cb38-510"><a href="#cb38-510" aria-hidden="true" tabindex="-1"></a><span class="fu">respDist</span>(<span class="st">"40-60"</span>)</span>
<span id="cb38-511"><a href="#cb38-511" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-512"><a href="#cb38-512" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb38-513"><a href="#cb38-513" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-514"><a href="#cb38-514" aria-hidden="true" tabindex="-1"></a><span class="fu">### 60-80</span></span>
<span id="cb38-515"><a href="#cb38-515" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-518"><a href="#cb38-518" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb38-519"><a href="#cb38-519" aria-hidden="true" tabindex="-1"></a><span class="fu">respTable</span>(<span class="st">"60-80"</span>)</span>
<span id="cb38-520"><a href="#cb38-520" aria-hidden="true" tabindex="-1"></a><span class="fu">respDist</span>(<span class="st">"60-80"</span>)</span>
<span id="cb38-521"><a href="#cb38-521" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-522"><a href="#cb38-522" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb38-523"><a href="#cb38-523" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-524"><a href="#cb38-524" aria-hidden="true" tabindex="-1"></a><span class="fu">### 80-100</span></span>
<span id="cb38-525"><a href="#cb38-525" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-528"><a href="#cb38-528" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb38-529"><a href="#cb38-529" aria-hidden="true" tabindex="-1"></a><span class="fu">respTable</span>(<span class="st">"80-100"</span>)</span>
<span id="cb38-530"><a href="#cb38-530" aria-hidden="true" tabindex="-1"></a><span class="fu">respDist</span>(<span class="st">"80-100"</span>)</span>
<span id="cb38-531"><a href="#cb38-531" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-532"><a href="#cb38-532" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb38-533"><a href="#cb38-533" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-534"><a href="#cb38-534" aria-hidden="true" tabindex="-1"></a><span class="fu">### All together</span></span>
<span id="cb38-535"><a href="#cb38-535" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-538"><a href="#cb38-538" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb38-539"><a href="#cb38-539" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x =</span> MHCscore, <span class="at">y =</span> Gender, <span class="at">fill =</span> Gender)) <span class="sc">+</span></span>
<span id="cb38-540"><a href="#cb38-540" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_slab</span>(</span>
<span id="cb38-541"><a href="#cb38-541" aria-hidden="true" tabindex="-1"></a>    <span class="at">side =</span> <span class="st">"right"</span>, <span class="at">show.legend =</span> F,</span>
<span id="cb38-542"><a href="#cb38-542" aria-hidden="true" tabindex="-1"></a>    <span class="at">scale =</span> <span class="fl">0.7</span>,</span>
<span id="cb38-543"><a href="#cb38-543" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">fill_ramp =</span> <span class="fu">after_stat</span>(level)),</span>
<span id="cb38-544"><a href="#cb38-544" aria-hidden="true" tabindex="-1"></a>    <span class="at">.width =</span> <span class="fu">c</span>(.<span class="dv">50</span>, .<span class="dv">75</span>, <span class="dv">1</span>)</span>
<span id="cb38-545"><a href="#cb38-545" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb38-546"><a href="#cb38-546" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(</span>
<span id="cb38-547"><a href="#cb38-547" aria-hidden="true" tabindex="-1"></a>    <span class="at">fun.data =</span> <span class="st">"mean_cl_normal"</span>, <span class="at">show.legend =</span> F, <span class="at">size =</span> .<span class="dv">4</span>,</span>
<span id="cb38-548"><a href="#cb38-548" aria-hidden="true" tabindex="-1"></a>    <span class="at">position =</span> <span class="fu">position_dodge2nudge</span>(<span class="at">x =</span> .<span class="dv">05</span>, <span class="at">width =</span> .<span class="dv">8</span>)</span>
<span id="cb38-549"><a href="#cb38-549" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb38-550"><a href="#cb38-550" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_ramp_discrete</span>(<span class="at">from =</span> <span class="st">"black"</span>, <span class="at">aesthetics =</span> <span class="st">"fill_ramp"</span>) <span class="sc">+</span></span>
<span id="cb38-551"><a href="#cb38-551" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_d</span>(<span class="at">begin =</span> <span class="fl">0.4</span>, <span class="at">direction =</span> <span class="sc">-</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb38-552"><a href="#cb38-552" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> avg1, <span class="at">color =</span> <span class="st">"orange"</span>, <span class="at">linetype =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb38-553"><a href="#cb38-553" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"rect"</span>, <span class="at">ymin =</span> <span class="dv">0</span>, <span class="at">ymax =</span> <span class="cn">Inf</span>, <span class="at">xmin =</span> avg1 <span class="sc">-</span> sem1, <span class="at">xmax =</span> avg1 <span class="sc">+</span> sem1, <span class="at">alpha =</span> .<span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb38-554"><a href="#cb38-554" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">label =</span> <span class="st">"0-20"</span>, <span class="at">x =</span> avg1<span class="fl">-0.1</span>, <span class="at">y =</span> <span class="fl">1.5</span>, <span class="at">angle =</span> <span class="dv">90</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb38-555"><a href="#cb38-555" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> avg2, <span class="at">color =</span> <span class="st">"orange"</span>, <span class="at">linetype =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb38-556"><a href="#cb38-556" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"rect"</span>, <span class="at">ymin =</span> <span class="dv">0</span>, <span class="at">ymax =</span> <span class="cn">Inf</span>, <span class="at">xmin =</span> avg2 <span class="sc">-</span> sem2, <span class="at">xmax =</span> avg2 <span class="sc">+</span> sem2, <span class="at">alpha =</span> .<span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb38-557"><a href="#cb38-557" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">label =</span> <span class="st">"20-40"</span>, <span class="at">x =</span> avg2<span class="fl">-0.1</span>, <span class="at">y =</span> <span class="fl">1.5</span>, <span class="at">angle =</span> <span class="dv">90</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb38-558"><a href="#cb38-558" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> avg3, <span class="at">color =</span> <span class="st">"orange"</span>, <span class="at">linetype =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb38-559"><a href="#cb38-559" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"rect"</span>, <span class="at">ymin =</span> <span class="dv">0</span>, <span class="at">ymax =</span> <span class="cn">Inf</span>, <span class="at">xmin =</span> avg3 <span class="sc">-</span> sem3, <span class="at">xmax =</span> avg3 <span class="sc">+</span> sem3, <span class="at">alpha =</span> .<span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb38-560"><a href="#cb38-560" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">label =</span> <span class="st">"40-60"</span>, <span class="at">x =</span> avg3<span class="fl">-0.1</span>, <span class="at">y =</span> <span class="fl">1.5</span>, <span class="at">angle =</span> <span class="dv">90</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb38-561"><a href="#cb38-561" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> avg4, <span class="at">color =</span> <span class="st">"orange"</span>, <span class="at">linetype =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb38-562"><a href="#cb38-562" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">label =</span> <span class="st">"60-80"</span>, <span class="at">x =</span> avg4<span class="fl">-0.1</span>, <span class="at">y =</span> <span class="fl">1.5</span>, <span class="at">angle =</span> <span class="dv">90</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb38-563"><a href="#cb38-563" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"rect"</span>, <span class="at">ymin =</span> <span class="dv">0</span>, <span class="at">ymax =</span> <span class="cn">Inf</span>, <span class="at">xmin =</span> avg4 <span class="sc">-</span> sem4, <span class="at">xmax =</span> avg4 <span class="sc">+</span> sem4, <span class="at">alpha =</span> .<span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb38-564"><a href="#cb38-564" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> avg5, <span class="at">color =</span> <span class="st">"orange"</span>, <span class="at">linetype =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb38-565"><a href="#cb38-565" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">label =</span> <span class="st">"80-100"</span>, <span class="at">x =</span> avg5<span class="fl">-0.1</span>, <span class="at">y =</span> <span class="fl">1.5</span>, <span class="at">angle =</span> <span class="dv">90</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb38-566"><a href="#cb38-566" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"rect"</span>, <span class="at">ymin =</span> <span class="dv">0</span>, <span class="at">ymax =</span> <span class="cn">Inf</span>, <span class="at">xmin =</span> avg5 <span class="sc">-</span> sem5, <span class="at">xmax =</span> avg5 <span class="sc">+</span> sem5, <span class="at">alpha =</span> .<span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb38-567"><a href="#cb38-567" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"MHC-SF latent scores"</span>) <span class="sc">+</span></span>
<span id="cb38-568"><a href="#cb38-568" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb38-569"><a href="#cb38-569" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb38-570"><a href="#cb38-570" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_rise</span>() <span class="sc">+</span></span>
<span id="cb38-571"><a href="#cb38-571" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>))</span>
<span id="cb38-572"><a href="#cb38-572" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-573"><a href="#cb38-573" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb38-574"><a href="#cb38-574" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb38-575"><a href="#cb38-575" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-576"><a href="#cb38-576" aria-hidden="true" tabindex="-1"></a><span class="fu">## Other visualizations</span></span>
<span id="cb38-577"><a href="#cb38-577" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-578"><a href="#cb38-578" aria-hidden="true" tabindex="-1"></a>We can use the same set of scores and combine them with the previously reported figure for item hierarchy.</span>
<span id="cb38-579"><a href="#cb38-579" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-580"><a href="#cb38-580" aria-hidden="true" tabindex="-1"></a><span class="fu">### Targeting example</span></span>
<span id="cb38-581"><a href="#cb38-581" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-584"><a href="#cb38-584" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb38-585"><a href="#cb38-585" aria-hidden="true" tabindex="-1"></a><span class="fu">RIitemHierarchy</span>(df[,<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>)]) <span class="sc">+</span></span>
<span id="cb38-586"><a href="#cb38-586" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="fu">aes</span>(<span class="at">yintercept =</span> avg4), <span class="at">linetype =</span> <span class="dv">2</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb38-587"><a href="#cb38-587" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"rect"</span>, <span class="at">xmin =</span> <span class="dv">0</span>, <span class="at">xmax =</span> <span class="cn">Inf</span>, <span class="at">ymin =</span> avg4 <span class="sc">-</span> sem4, <span class="at">ymax =</span> avg4 <span class="sc">+</span> sem4, <span class="at">alpha =</span> .<span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb38-588"><a href="#cb38-588" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">label =</span> <span class="st">"60-80"</span>, <span class="at">y =</span> avg4<span class="fl">-0.1</span>, <span class="at">x =</span> <span class="dv">9</span>, <span class="at">angle =</span> <span class="dv">90</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">"darkorange"</span>) <span class="sc">+</span></span>
<span id="cb38-589"><a href="#cb38-589" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="fu">aes</span>(<span class="at">yintercept =</span> avg2), <span class="at">linetype =</span> <span class="dv">2</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb38-590"><a href="#cb38-590" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"rect"</span>, <span class="at">xmin =</span> <span class="dv">0</span>, <span class="at">xmax =</span> <span class="cn">Inf</span>, <span class="at">ymin =</span> avg2 <span class="sc">-</span> sem2, <span class="at">ymax =</span> avg2 <span class="sc">+</span> sem2, <span class="at">alpha =</span> .<span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb38-591"><a href="#cb38-591" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">label =</span> <span class="st">"20-40"</span>, <span class="at">y =</span> avg2<span class="fl">-0.1</span>, <span class="at">x =</span> <span class="dv">9</span>, <span class="at">angle =</span> <span class="dv">90</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">"darkorange"</span>) </span>
<span id="cb38-592"><a href="#cb38-592" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-593"><a href="#cb38-593" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb38-594"><a href="#cb38-594" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-595"><a href="#cb38-595" aria-hidden="true" tabindex="-1"></a><span class="fu">## Software used</span></span>
<span id="cb38-596"><a href="#cb38-596" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-599"><a href="#cb38-599" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb38-600"><a href="#cb38-600" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(grateful)</span>
<span id="cb38-601"><a href="#cb38-601" aria-hidden="true" tabindex="-1"></a>pkgs <span class="ot">&lt;-</span> <span class="fu">cite_packages</span>(<span class="at">cite.tidyverse =</span> <span class="cn">TRUE</span>, </span>
<span id="cb38-602"><a href="#cb38-602" aria-hidden="true" tabindex="-1"></a>                      <span class="at">output =</span> <span class="st">"table"</span>,</span>
<span id="cb38-603"><a href="#cb38-603" aria-hidden="true" tabindex="-1"></a>                      <span class="at">bib.file =</span> <span class="st">"grateful-refs.bib"</span>,</span>
<span id="cb38-604"><a href="#cb38-604" aria-hidden="true" tabindex="-1"></a>                      <span class="at">include.RStudio =</span> <span class="cn">TRUE</span>)</span>
<span id="cb38-605"><a href="#cb38-605" aria-hidden="true" tabindex="-1"></a><span class="fu">formattable</span>(pkgs, </span>
<span id="cb38-606"><a href="#cb38-606" aria-hidden="true" tabindex="-1"></a>            <span class="at">table.attr =</span> <span class="st">'class=</span><span class="sc">\"</span><span class="st">table table-striped</span><span class="sc">\"</span><span class="st"> style="font-size: 14px; font-family: Lato; width: 80%"'</span>)</span>
<span id="cb38-607"><a href="#cb38-607" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb38-608"><a href="#cb38-608" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-609"><a href="#cb38-609" aria-hidden="true" tabindex="-1"></a><span class="fu">## References</span></span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->



</body></html>