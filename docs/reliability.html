<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.24">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="author" content="Magnus Johansson">
<meta name="dcterms.date" content="2025-10-23">
<title>RMU — relative measurement uncertainty – R, Rasch, etc</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dc55a5b9e770e841cd82e46aadbfb9b0.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-159ef884c39ba5c67e5d2ece280cdb5e.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><link rel="stylesheet" href="styles.css">
<meta property="og:title" content="RMU — relative measurement uncertainty – R, Rasch, etc">
<meta property="og:description" content="Comparing methods and metrics">
<meta property="og:image" content="https://pgmj.github.io/data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg==">
<meta property="og:site_name" content="R, Rasch, etc">
<meta name="twitter:title" content="RMU — relative measurement uncertainty – R, Rasch, etc">
<meta name="twitter:description" content="Comparing methods and metrics">
<meta name="twitter:image" content="https://pgmj.github.io/data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg==">
<meta name="twitter:card" content="summary_large_image">
<meta name="citation_title" content="RMU --- relative measurement uncertainty">
<meta name="citation_author" content="Magnus Johansson">
<meta name="citation_publication_date" content="2025-10-23">
<meta name="citation_cover_date" content="2025-10-23">
<meta name="citation_year" content="2025">
<meta name="citation_online_date" content="2025-10-23">
<meta name="citation_fulltext_html_url" content="https://pgmj.github.io/reliability.html">
<meta name="citation_language" content="en">
<meta name="citation_reference" content="citation_title=Bayesian Item Response Modeling in R with brms and Stan;,citation_abstract=Item response theory (IRT) is widely applied in the human sciences to model persons’ responses on a set of items measuring one or more latent constructs. While several R packages have been developed that implement IRT models, they tend to be restricted to respective pre-specified classes of models. Further, most implementations are frequentist while the availability of Bayesian methods remains comparably limited. I demonstrate how to use the R package brms together with the probabilistic programming language Stan to specify and fit a wide range of Bayesian IRT models using flexible and intuitive multilevel formula syntax. Further, item and person parameters can be related in both a linear or non-linear manner. Various distributions for categorical, ordinal, and continuous responses are supported. Users may even define their own custom response distribution for use in the presented framework. Common IRT model classes that can be specified natively in the presented framework include 1PL and 2PL logistic models optionally also containing guessing parameters, graded response and partial credit ordinal models, as well as drift diffusion models of response times coupled with binary decisions. Posterior distributions of item and person parameters can be conveniently extracted and postprocessed. Model fit can be evaluated and compared using Bayes factors and efficient cross-validation procedures.;,citation_author=Paul-Christian Bürkner;,citation_publication_date=2021-11;,citation_cover_date=2021-11;,citation_year=2021;,citation_fulltext_html_url=https://doi.org/10.18637/jss.v100.i05;,citation_doi=10.18637/jss.v100.i05;,citation_issn=1548-7660;,citation_volume=100;,citation_journal_title=Journal of Statistical Software;">
<meta name="citation_reference" content="citation_title=A general method for estimating reliability using Bayesian Measurement Uncertainty;,citation_abstract=Unreliable measurement can lead to lower statistical power, attenuated effect sizes and residual confounding. However, estimating reliability can be challenging for complex cognitive and behavioural assessments without test-retest data. Most statistical methods for assessing reliability with a single test administration are designed for fixed-item questionnaires. We introduce a novel Bayesian procedure called relative measurement uncertainty (RMU) for estimating reliability that can be broadly applied, including to many widely used computational models. Our approach draws pairs of samples from each subject’s posterior and calculates the correlation between draws. We demonstrate analytically and via simulation that this method provides accurate reliability estimates and well-calibrated credible intervals across linear factor, signal detection and reinforcement learning models. Simulations found that RMU was more accurate (lower root mean square error) than existing measures (coefficient alpha, coefficient H, split-half), but more importantly, it can be applied across a wide range of computational models. RMU offers a general method for estimating reliability, leveraging the modelling flexibility of Bayesian statistical methods.;,citation_author=Giacomo Bignardi;,citation_author=Rogier Kievit;,citation_author=Paul-Christian Bürkner;,citation_publication_date=2025-09;,citation_cover_date=2025-09;,citation_year=2025;,citation_fulltext_html_url=https://osf.io/h54k8_v1;,citation_doi=10.31234/osf.io/h54k8_v1;,citation_publisher=OSF;">
<meta name="citation_reference" content="citation_title=On Specific Objectivity and Measurement by Rasch Models: A Statistical Viewpoint;,citation_abstract=Rasch’s original definition of specific objectivity insisted that measurement by items of educational tests had to be provided by estimates of person parameters of a measurement model that did not involve estimates of item parameters. It was never stated clearly, but there is no doubt that Rasch was thinking about conditional maximum likelihood (CML) estimates similar to the well-known CML estimates of item parameters. However, for technical reasons, there are only few examples of attempts to implement the CML estimates of person parameters in software applications for item analysis by Rasch models. Nevertheless, today CML estimation of person parameters in Rasch models is possible. And since the exact distribution of estimates of person parameters in Rasch models is known, it is possible to compare the performance of the specific objective CML estimates of person parameters to the performances of the other estimates of the person parameters. This paper provides one example of such an exercise. It compares five different estimators of the person parameters of a Rasch model with forty dichotomous items for a Danish cognitive test. In this paper, the point of view on the measurement quality is purely statistical. The superior measure of the latent trait has to have ignorable bias and as little standard error of measurement as possible. In this example, it turns out that the specific objective CML estimate is not the superior estimate. This motivates a slightly weaker notion of essential specific objectivity than many other estimates of person parameters in Rasch models live up to.;,citation_author=Svend Kreiner;,citation_publication_date=2025;,citation_cover_date=2025;,citation_year=2025;,citation_fulltext_html_url=https://dx.doi.org/10.61186/emp.2025.7;,citation_doi=10.61186/emp.2025.7;,citation_volume=3;,citation_journal_title=Educational Methods &amp;amp;amp; Psychometrics;">
<meta name="citation_reference" content="citation_title=Reliability representativeness: How well does coefficient alpha summarize reliability across the score distribution?;,citation_abstract=Scale scores in psychology studies are commonly accompanied by a reliability coefficient like alpha. Coefficient alpha is an index that summarizes reliability across the entire score distribution, implying equal precision for all scores. However, an underappreciated fact is that reliability can be conditional such that scores in certain parts of the score distribution may be more reliable than others. This conditional perspective of reliability is common in item response theory (IRT), but psychologists are generally not well versed in IRT. Correspondingly, the representativeness of a single summary index like alpha across the entire score distribution can be unclear but is rarely considered. If conditional reliability is fairly homogeneous across the score distribution, coefficient alpha may be sufficiently representative and a useful summary. But, if conditional reliability is heterogeneous across the score distribution, alpha may be unrepresentative and may not align with the reliability of a typical score in the data or with a particularly important score like a cut point where decisions are made. This paper proposes a method, R package, and Shiny application to quantify the potential differences between coefficient alpha and conditional reliability across the score distribution. The goal is to facilitate comparisons between conditional reliability and reliability summary indices so that psychologists can contextualize the reliability of their scores more clearly and comprehensively.;,citation_author=Daniel McNeish;,citation_author=Denis Dumas;,citation_publication_date=2025-02;,citation_cover_date=2025-02;,citation_year=2025;,citation_fulltext_html_url=https://doi.org/10.3758/s13428-025-02611-8;,citation_issue=3;,citation_doi=10.3758/s13428-025-02611-8;,citation_issn=1554-3528;,citation_volume=57;,citation_journal_title=Behavior Research Methods;">
<meta name="citation_reference" content="citation_title=The role of plausible values in large-scale surveys;,citation_abstract=In large-scale assessment programs such as NAEP, TIMSS and PISA, students’ achievement data sets provided for secondary analysts contain so-called plausible values. Plausible values are multiple imputations of the unobservable latent achievement for each student. In this article it has been shown how plausible values are used to: (1) address concerns with bias in the estimation of certain population parameters when point estimates of latent achievement are used to estimate those population parameters; (2) allow secondary data analysts to employ standard techniques and tools (e.g., SPSS, SAS procedures) to analyse achievement data that contains substantial measurement error components; and (3) facilitate the conlputation or&amp;amp;amp;quot; standard errors of estimates when the sample design is complex. The advantages of plausible values have been illustrated by comparing the use of maximum likelihood estimates and plausible values (PV) for estimating a range of population statistics.;,citation_author=Margaret Wu;,citation_publication_date=2005-01;,citation_cover_date=2005-01;,citation_year=2005;,citation_fulltext_html_url=https://linkinghub.elsevier.com/retrieve/pii/S0191491X05000209;,citation_issue=2-3;,citation_doi=10.1016/j.stueduc.2005.05.005;,citation_issn=0191491X;,citation_volume=31;,citation_journal_title=Studies in Educational Evaluation;">
<meta name="citation_reference" content="citation_title=Randomization-Based Inference about Latent Variables from Complex Samples;,citation_abstract=Standard procedures for drawing inferences from complex samples do not apply when the variable of interest θ cannot be observed directly, but must be inferred from the values of secondary random variables that depend on θ stochastically. Examples are proficiency variables in item response models and class memberships in latent class models. Rubin’s “multiple imputation” techniques yield approximations of sample statistics that would have been obtained, had θ been observable, and associated variance estimates that account for uncertainty due to both the sampling of respondents and the latent nature of θ. The approach is illustrated with data from the National Assessment for Educational Progress.;,citation_author=Robert J. Mislevy;,citation_publication_date=1991-06;,citation_cover_date=1991-06;,citation_year=1991;,citation_fulltext_html_url=https://www.cambridge.org/core/journals/psychometrika/article/abs/randomizationbased-inference-about-latent-variables-from-complex-samples/E981F9B78896C2D3567863944CCA8D83;,citation_issue=2;,citation_doi=10.1007/BF02294457;,citation_issn=0033-3123, 1860-0980;,citation_volume=56;,citation_journal_title=Psychometrika;">
</head>
<body class="nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="navbar navbar-expand-lg " data-bs-theme="dark"><div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="./index.html" class="navbar-brand navbar-brand-logo">
    </a>
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">R, Rasch, etc</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
<li class="nav-item">
    <a class="nav-link" href="./index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./raschrvignette/RaschRvign.html"> 
<span class="menu-text">easyRasch vignette</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./about.html"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-blog" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Blog</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-blog">
<li>
    <a class="dropdown-item" href="./reliability.html">
 <span class="dropdown-text">RMU — relative measurement uncertainty</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./parameterizedQ.html">
 <span class="dropdown-text">Automating reports with Quarto</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./latentResp/LatentResponse.html">
 <span class="dropdown-text">What’s in a latent trait score?</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./SkolverketAPI/skolverketapi.html">
 <span class="dropdown-text">Data retrieval with R using API calls</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./powerviz.html">
 <span class="dropdown-text">Power analysis for multilevel models</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./datawrangling.html">
 <span class="dropdown-text">Data wrangling for psychometrics in R</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./simcutoffs.html">
 <span class="dropdown-text">Simulation based cutoff values for Rasch item fit and residual correlations</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./est_comp.html">
 <span class="dropdown-text">Comparing Rasch packages/estimators</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./dif_magnitude.html">
 <span class="dropdown-text">Rasch DIF magnitude &amp; item split</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./clrt.html">
 <span class="dropdown-text">Conditional Likelihood Ratio Test and sample size</span></a>
  </li>  
    </ul>
</li>
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/pgmj/pgmj.github.io"> <i class="bi bi-github" role="img" aria-label="GitHub">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
</div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav><div id="quarto-announcement" data-announcement-id="1330bc4b660363ec42da79384be05f58" class="alert alert-primary hidden">
<i class="bi bi-info-circle quarto-announcement-icon"></i><div class="quarto-announcement-content">
<p><strong>Note:</strong> easyRasch has new functions, check <a href="https://pgmj.github.io/easyRasch/news/index.html" class="uri">https://pgmj.github.io/easyRasch/news/index.html</a></p>
</div>
<i class="bi bi-x-lg quarto-announcement-action"></i>
</div>
</header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Table of contents</h2>
   
  <ul>
<li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction"><span class="header-section-number">1</span> Introduction</a></li>
  <li><a href="#method" id="toc-method" class="nav-link" data-scroll-target="#method"><span class="header-section-number">2</span> Method</a></li>
  <li>
<a href="#rasch-dichotomous-model" id="toc-rasch-dichotomous-model" class="nav-link" data-scroll-target="#rasch-dichotomous-model"><span class="header-section-number">3</span> Rasch dichotomous model</a>
  <ul class="collapse">
<li><a href="#bayesian-model" id="toc-bayesian-model" class="nav-link" data-scroll-target="#bayesian-model"><span class="header-section-number">3.1</span> Bayesian model</a></li>
  <li><a href="#plausible-values" id="toc-plausible-values" class="nav-link" data-scroll-target="#plausible-values"><span class="header-section-number">3.2</span> Plausible values</a></li>
  <li><a href="#conditional-reliability" id="toc-conditional-reliability" class="nav-link" data-scroll-target="#conditional-reliability"><span class="header-section-number">3.3</span> Conditional reliability</a></li>
  <li><a href="#summarizing-rmu-findings" id="toc-summarizing-rmu-findings" class="nav-link" data-scroll-target="#summarizing-rmu-findings"><span class="header-section-number">3.4</span> Summarizing RMU findings</a></li>
  <li><a href="#summary-table" id="toc-summary-table" class="nav-link" data-scroll-target="#summary-table"><span class="header-section-number">3.5</span> Summary table</a></li>
  </ul>
</li>
  <li>
<a href="#partial-credit-model-pcm" id="toc-partial-credit-model-pcm" class="nav-link" data-scroll-target="#partial-credit-model-pcm"><span class="header-section-number">4</span> Partial credit model (PCM)</a>
  <ul class="collapse">
<li><a href="#bayesian-model-1" id="toc-bayesian-model-1" class="nav-link" data-scroll-target="#bayesian-model-1"><span class="header-section-number">4.1</span> Bayesian model</a></li>
  <li><a href="#conditional-reliability-1" id="toc-conditional-reliability-1" class="nav-link" data-scroll-target="#conditional-reliability-1"><span class="header-section-number">4.2</span> Conditional reliability</a></li>
  <li><a href="#summary-table-1" id="toc-summary-table-1" class="nav-link" data-scroll-target="#summary-table-1"><span class="header-section-number">4.3</span> Summary table</a></li>
  </ul>
</li>
  <li><a href="#session-info" id="toc-session-info" class="nav-link" data-scroll-target="#session-info"><span class="header-section-number">5</span> Session info</a></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references"><span class="header-section-number">6</span> References</a></li>
  </ul></nav>
    </div>
<!-- main -->
<main class="content column-page-left" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">RMU — relative measurement uncertainty</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
<p class="subtitle lead">Comparing methods and metrics</p>
</div>


<div class="quarto-title-meta-author column-page-left">
  <div class="quarto-title-meta-heading">Author</div>
  <div class="quarto-title-meta-heading">Affiliation</div>
  
    <div class="quarto-title-meta-contents">
    <p class="author"><a href="https://ki.se/personer/magnus-johansson-3">Magnus Johansson, PhD</a> <a href="mailto:magnus.johansson.3@ki.se" class="quarto-title-author-email"><i class="bi bi-envelope"></i></a> <a href="https://orcid.org/0000-0003-1669-592X" class="quarto-title-author-orcid"> <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg=="></a></p>
  </div>
  <div class="quarto-title-meta-contents">
        <p class="affiliation">
            Karolinska Institutet
          </p>
      </div>
  </div>

<div class="quarto-title-meta column-page-left">

      
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">2025-10-23</p>
    </div>
  </div>
  
    <div>
    <div class="quarto-title-meta-heading">Modified</div>
    <div class="quarto-title-meta-contents">
      <p class="date-modified">2025-10-24</p>
    </div>
  </div>
    
  </div>
  


</header><section id="introduction" class="level2" data-number="1"><h2 data-number="1" class="anchored" data-anchor-id="introduction">
<span class="header-section-number">1</span> Introduction</h2>
<p>This post has two purposes. The primary one is to compare some reliability metrics, since a new preprint <span class="citation" data-cites="bignardi_general_2025">(<a href="#ref-bignardi_general_2025" role="doc-biblioref">Bignardi, Kievit, and Bürkner 2025</a>)</span> inspired some ideas. They propose a general “relative measurement uncertainty” (RMU) metric, applicable in many situations thanks to Bayesian modeling and posterior MCMC draws. My idea that is evaluated here is to use “plausible values” <span class="citation" data-cites="mislevy_randomization_based_1991 wu_role_2005">(<a href="#ref-mislevy_randomization_based_1991" role="doc-biblioref">Mislevy 1991</a>; <a href="#ref-wu_role_2005" role="doc-biblioref">Wu 2005</a>)</span> instead of fully Bayesian model posterior draws to estimate the RMU. This would make the RMU metric more accessible to users unfamiliar with Bayesian statistics, and easily applicable for existing Rasch measurement software in R, such as my package <a href="https://pgmj.github.io/easyRasch/index.html"><code>easyRasch</code></a>. Please read <a href="https://osf.io/h54k8_v1">the preprint</a> by Bignardi and colleagues to learn how the RMU is estimated. A summary is available on pages 12-13.</p>
<p>The secondary purpose is to show how to fit Rasch models, dichotomous and partial credit models (PCM), using Bayesian models with <code>brms</code>, and make some comparisons of person and item parameters relative CML/WLE estimation. There is already an excellent paper on Bayesian Item Response Modeling <span class="citation" data-cites="burkner_bayesian_2021">(<a href="#ref-burkner_bayesian_2021" role="doc-biblioref">Bürkner 2021</a>)</span>, but I thought a blog post like this might still be a useful addition to learning materials available. And also an opportunity for myself to learn. This will be added to the post when I have time to work on it.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://mjskay.github.io/ggdist/">ggdist</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/pgmj/easyRasch">easyRasch</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/paul-buerkner/brms">brms</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/qsbase/qs2">qs2</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">789012475</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</section><section id="method" class="level2" data-number="2"><h2 data-number="2" class="anchored" data-anchor-id="method">
<span class="header-section-number">2</span> Method</h2>
<p>We won’t check model fit in this initial part, as we focus on how the reliability metrics compare and how to specify Rasch models using <code>brms</code>. Weakly informative priors are used for item parameters, borrowing from Bürkner <span class="citation" data-cites="burkner_bayesian_2021">(<a href="#ref-burkner_bayesian_2021" role="doc-biblioref">2021</a>)</span>. We use four parallel chains with four CPU cores, each with 2000 draws of which half are warmup, resulting in 4000 post-warmup draws from the posterior distribution. In the dichotomous example, we also fit the same model with 8000 draws (code not shown below).</p>
<p>I will at some point add descriptions of the comparison metrics used, and how the <code>mirt</code> and <code>TAM</code> packages generate plausible values. For now, I hope this will be of use as it is.</p>
</section><section id="rasch-dichotomous-model" class="level2" data-number="3"><h2 data-number="3" class="anchored" data-anchor-id="rasch-dichotomous-model">
<span class="header-section-number">3</span> Rasch dichotomous model</h2>
<p>For this example, the <code><a href="https://rdrr.io/pkg/eRm/man/eRm.data.html">eRm::raschdat1</a></code> dataset is used, selecting the first 20 items. The dataset has 100 respondents.</p>
<section id="bayesian-model" class="level3" data-number="3.1"><h3 data-number="3.1" class="anchored" data-anchor-id="bayesian-model">
<span class="header-section-number">3.1</span> Bayesian model</h3>
<p>We need the dataset in long form for <code>brms</code>.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu">eRm</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/eRm/man/eRm.data.html">raschdat1</a></span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">20</span><span class="op">]</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html">rownames_to_column</a></span><span class="op">(</span><span class="st">"id"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span><span class="op">!</span><span class="va">id</span>, names_to <span class="op">=</span> <span class="st">"item"</span>, values_to <span class="op">=</span> <span class="st">"response"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">rasch_prior</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://paulbuerkner.com/brms/reference/set_prior.html">prior</a></span><span class="op">(</span><span class="st">"normal(0, 3)"</span>, class <span class="op">=</span> <span class="st">"sd"</span>, group <span class="op">=</span> <span class="st">"id"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://paulbuerkner.com/brms/reference/set_prior.html">prior</a></span><span class="op">(</span><span class="st">"normal(0, 3)"</span>, class <span class="op">=</span> <span class="st">"sd"</span>, group <span class="op">=</span> <span class="st">"item"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">brms_rasch</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://paulbuerkner.com/brms/reference/brm.html">brm</a></span><span class="op">(</span></span>
<span>  <span class="va">response</span> <span class="op">~</span> <span class="fl">0</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">|</span> <span class="va">item</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">|</span> <span class="va">id</span><span class="op">)</span>,</span>
<span>  data    <span class="op">=</span> <span class="va">df</span>,</span>
<span>  prior <span class="op">=</span> <span class="va">rasch_prior</span>,</span>
<span>  chains  <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  cores   <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  iter <span class="op">=</span> <span class="fl">2000</span>,</span>
<span>  family <span class="op">=</span> <span class="st">"bernoulli"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/qs2/man/qs_save.html">qs_save</a></span><span class="op">(</span><span class="va">brms_rasch</span>, file <span class="op">=</span> <span class="st">"brms_rasch4000.qs2"</span>,compress_level <span class="op">=</span> <span class="fl">11</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/qs2/man/qs_save.html">qs_save</a></span><span class="op">(</span><span class="va">brms_rasch2</span>, file <span class="op">=</span> <span class="st">"brms_rasch8000.qs2"</span>,compress_level <span class="op">=</span> <span class="fl">13</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">brms_rasch8000</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/qs2/man/qs_read.html">qs_read</a></span><span class="op">(</span><span class="st">"brms_rasch8000.qs2"</span><span class="op">)</span></span>
<span><span class="va">brms_rasch4000</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/qs2/man/qs_read.html">qs_read</a></span><span class="op">(</span><span class="st">"brms_rasch4000.qs2"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># summary(brms_rasch)</span></span>
<span><span class="co"># loo(brms_rasch)</span></span>
<span></span>
<span><span class="va">posterior_draws_rm4000</span> <span class="op">=</span> <span class="va">brms_rasch4000</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://mc-stan.org/posterior/reference/draws_df.html">as_draws_df</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html">starts_with</a></span><span class="op">(</span><span class="st">"r_id"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">posterior_draws_rm8000</span> <span class="op">=</span> <span class="va">brms_rasch8000</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://mc-stan.org/posterior/reference/draws_df.html">as_draws_df</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html">starts_with</a></span><span class="op">(</span><span class="st">"r_id"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<p>4000 draws:</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://pgmj.github.io/easyRasch/reference/RMUreliability.html">RMUreliability</a></span><span class="op">(</span><span class="va">posterior_draws_rm4000</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>  rmu_estimate hdci_lowerbound hdci_upperbound .width .point .interval
1    0.7500278       0.6771337       0.8131132   0.95   mean      hdci</code></pre>
</div>
</div>
<p>8000 draws:</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://pgmj.github.io/easyRasch/reference/RMUreliability.html">RMUreliability</a></span><span class="op">(</span><span class="va">posterior_draws_rm8000</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>  rmu_estimate hdci_lowerbound hdci_upperbound .width .point .interval
1    0.7524065       0.6819247       0.8210144   0.95   mean      hdci</code></pre>
</div>
</div>
</section><section id="plausible-values" class="level3" data-number="3.2"><h3 data-number="3.2" class="anchored" data-anchor-id="plausible-values">
<span class="header-section-number">3.2</span> Plausible values</h3>
<p>As seen in the code below, I did some simple timing tests to compare the performance of <code>TAM</code> and <code>mirt</code> packages, where the latter has options in how to estimate thetas (latent scores) used for generating the plausible values (not available in <code>TAM</code>). Since WLE is generally considered to have the lowest bias <span class="citation" data-cites="kreiner_specific_2025">(<a href="#ref-kreiner_specific_2025" role="doc-biblioref">Kreiner 2025</a>)</span>, this is the default choice in the <code><a href="https://pgmj.github.io/easyRasch/reference/RIreliability.html">RIreliability()</a></code> function, dubbed WLE-RMU.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># defining a separate function for RIreliability to use in this post, in case I make changes later on in the easyRasch package</span></span>
<span><span class="va">RIreliability3</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">data</span>, <span class="va">conf_int</span> <span class="op">=</span> <span class="fl">.95</span>, <span class="va">draws</span> <span class="op">=</span> <span class="fl">1000</span>, <span class="va">estim</span> <span class="op">=</span> <span class="st">"WLE"</span>, <span class="va">boot</span> <span class="op">=</span> <span class="cn">FALSE</span>, <span class="va">cpu</span> <span class="op">=</span> <span class="fl">4</span>, <span class="va">pv</span> <span class="op">=</span> <span class="st">"mirt"</span><span class="op">)</span> <span class="op">{</span></span>
<span>  </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/message.html">message</a></span><span class="op">(</span><span class="st">"Note that PSI is calculated with max/min scoring individuals excluded."</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/stop.html">stop</a></span><span class="op">(</span><span class="st">"The lowest response category needs to coded as 0. Please recode your data."</span><span class="op">)</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">model</span> <span class="op">&lt;-</span> <span class="st">"RM"</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">1</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">model</span> <span class="op">&lt;-</span> <span class="st">"PCM"</span></span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">model</span> <span class="op">==</span> <span class="st">"PCM"</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">mirt_out</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://philchalmers.github.io/mirt/reference/mirt.html">mirt</a></span><span class="op">(</span></span>
<span>      <span class="va">data</span>,</span>
<span>      model <span class="op">=</span> <span class="fl">1</span>,</span>
<span>      itemtype <span class="op">=</span> <span class="st">"Rasch"</span>,</span>
<span>      verbose <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>      accelerate <span class="op">=</span> <span class="st">"squarem"</span></span>
<span>    <span class="op">)</span></span>
<span>    <span class="va">erm_out</span> <span class="op">&lt;-</span> <span class="fu">eRm</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/eRm/man/PCM.html">PCM</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span> <span class="op">(</span><span class="va">model</span> <span class="op">==</span> <span class="st">"RM"</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">mirt_out</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://philchalmers.github.io/mirt/reference/mirt.html">mirt</a></span><span class="op">(</span></span>
<span>      <span class="va">data</span>,</span>
<span>      model <span class="op">=</span> <span class="fl">1</span>,</span>
<span>      itemtype <span class="op">=</span> <span class="st">"1PL"</span>,</span>
<span>      verbose <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>      accelerate <span class="op">=</span> <span class="st">"squarem"</span></span>
<span>    <span class="op">)</span></span>
<span>    <span class="va">erm_out</span> <span class="op">&lt;-</span> <span class="fu">eRm</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/eRm/man/RM.html">RM</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span>  <span class="va">wle</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://pgmj.github.io/easyRasch/reference/RI_iarm_person_estimates.html">RI_iarm_person_estimates</a></span><span class="op">(</span><span class="va">erm_out</span>, properties <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">wle</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span>  </span>
<span>  <span class="va">empirical_rel</span> <span class="op">&lt;-</span> <span class="fu">mirt</span><span class="fu">::</span><span class="fu"><a href="https://philchalmers.github.io/mirt/reference/fscores.html">fscores</a></span><span class="op">(</span><span class="va">mirt_out</span>,</span>
<span>                                 method <span class="op">=</span> <span class="va">estim</span>,</span>
<span>                                 theta_lim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">10</span>, <span class="fl">10</span><span class="op">)</span>,</span>
<span>                                 full.scores.SE <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                                 verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu">mirt</span><span class="fu">::</span><span class="fu"><a href="https://philchalmers.github.io/mirt/reference/empirical_rxx.html">empirical_rxx</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">boot</span> <span class="op">==</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/library.html">require</a></span><span class="op">(</span><span class="va"><a href="https://github.com/RevolutionAnalytics/doparallel">doParallel</a></span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/doParallel/man/registerDoParallel.html">registerDoParallel</a></span><span class="op">(</span>cores <span class="op">=</span> <span class="va">cpu</span><span class="op">)</span></span>
<span>    <span class="co"># bootstrap CI for empirical</span></span>
<span>    <span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="op">)</span></span>
<span>    <span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/foreach/man/foreach.html">foreach</a></span><span class="op">(</span>i <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="va">draws</span>, .combine <span class="op">=</span> <span class="va">rbind</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/foreach/man/foreach.html">%dopar%</a></span> <span class="op">{</span></span>
<span>      </span>
<span>      <span class="va">dat</span> <span class="op">&lt;-</span> <span class="va">data</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, <span class="op">]</span></span>
<span>      </span>
<span>      <span class="kw">if</span> <span class="op">(</span><span class="va">model</span> <span class="op">==</span> <span class="st">"PCM"</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="va">mirt_out2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://philchalmers.github.io/mirt/reference/mirt.html">mirt</a></span><span class="op">(</span></span>
<span>          <span class="va">dat</span>,</span>
<span>          model <span class="op">=</span> <span class="fl">1</span>,</span>
<span>          itemtype <span class="op">=</span> <span class="st">"Rasch"</span>,</span>
<span>          verbose <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>          accelerate <span class="op">=</span> <span class="st">"squarem"</span></span>
<span>        <span class="op">)</span></span>
<span>      <span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span> <span class="op">(</span><span class="va">model</span> <span class="op">==</span> <span class="st">"RM"</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="va">mirt_out2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://philchalmers.github.io/mirt/reference/mirt.html">mirt</a></span><span class="op">(</span></span>
<span>          <span class="va">dat</span>,</span>
<span>          model <span class="op">=</span> <span class="fl">1</span>,</span>
<span>          itemtype <span class="op">=</span> <span class="st">"1PL"</span>,</span>
<span>          verbose <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>          accelerate <span class="op">=</span> <span class="st">"squarem"</span></span>
<span>        <span class="op">)</span></span>
<span>      <span class="op">}</span></span>
<span>      </span>
<span>      <span class="fu">mirt</span><span class="fu">::</span><span class="fu"><a href="https://philchalmers.github.io/mirt/reference/fscores.html">fscores</a></span><span class="op">(</span><span class="va">mirt_out2</span>,</span>
<span>                    method <span class="op">=</span> <span class="va">estim</span>,</span>
<span>                    theta_lim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">10</span>, <span class="fl">10</span><span class="op">)</span>,</span>
<span>                    full.scores.SE <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                    verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>        <span class="fu">mirt</span><span class="fu">::</span><span class="fu"><a href="https://philchalmers.github.io/mirt/reference/empirical_rxx.html">empirical_rxx</a></span><span class="op">(</span><span class="op">)</span></span>
<span>      </span>
<span>    <span class="op">}</span></span>
<span>    </span>
<span>    <span class="va">emp_boot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://mjskay.github.io/ggdist/reference/point_interval.html">mean_hdci</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html">across</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/where.html">where</a></span><span class="op">(</span><span class="va">is.numeric</span><span class="op">)</span>, <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">.x</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>    </span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">pv</span> <span class="op">==</span> <span class="st">"mirt"</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">plvals</span> <span class="op">&lt;-</span> <span class="fu">mirt</span><span class="fu">::</span><span class="fu"><a href="https://philchalmers.github.io/mirt/reference/fscores.html">fscores</a></span><span class="op">(</span><span class="va">mirt_out</span>, method <span class="op">=</span> <span class="va">estim</span>,</span>
<span>                          theta_lim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">10</span>, <span class="fl">10</span><span class="op">)</span>,</span>
<span>                          plausible.draws <span class="op">=</span> <span class="va">draws</span>,</span>
<span>                          plausible.type <span class="op">=</span> <span class="st">"MH"</span>,</span>
<span>                          verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">rmu</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html">do.call</a></span><span class="op">(</span><span class="va">cbind.data.frame</span>, <span class="va">plvals</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://pgmj.github.io/easyRasch/reference/RMUreliability.html">RMUreliability</a></span><span class="op">(</span>level <span class="op">=</span> <span class="va">conf_int</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html">across</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/where.html">where</a></span><span class="op">(</span><span class="va">is.numeric</span><span class="op">)</span>, <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">.x</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span> <span class="op">(</span><span class="va">pv</span> <span class="op">==</span> <span class="st">"TAM"</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">estim</span> <span class="op">=</span> <span class="st">"EAP"</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="va">model</span> <span class="op">==</span> <span class="st">"PCM"</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">tam_out</span> <span class="op">&lt;-</span> <span class="fu">TAM</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/TAM/man/tam.mml.html">tam.mml</a></span><span class="op">(</span>resp <span class="op">=</span> <span class="va">data</span>, irtmodel <span class="op">=</span> <span class="st">"PCM"</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span>    <span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span> <span class="op">(</span><span class="va">model</span> <span class="op">==</span> <span class="st">"RM"</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">tam_out</span> <span class="op">&lt;-</span> <span class="fu">TAM</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/TAM/man/tam.mml.html">tam.mml</a></span><span class="op">(</span>resp <span class="op">=</span> <span class="va">data</span>, irtmodel <span class="op">=</span> <span class="st">"1PL"</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>    </span>
<span>    <span class="va">plvals</span> <span class="op">&lt;-</span> <span class="fu">TAM</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/TAM/man/tam.pv.html">tam.pv</a></span><span class="op">(</span><span class="va">tam_out</span>, nplausible <span class="op">=</span> <span class="va">draws</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">[[</span><span class="st">"pv"</span><span class="op">]</span><span class="op">]</span><span class="op">[</span>,<span class="op">-</span><span class="fl">1</span><span class="op">]</span></span>
<span>    </span>
<span>    <span class="va">rmu</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://pgmj.github.io/easyRasch/reference/RMUreliability.html">RMUreliability</a></span><span class="op">(</span><span class="va">plvals</span>, level <span class="op">=</span> <span class="va">conf_int</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html">across</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/where.html">where</a></span><span class="op">(</span><span class="va">is.numeric</span><span class="op">)</span>, <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">.x</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/message.html">message</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"RMU reliability estimates based on "</span>,<span class="va">draws</span>,<span class="st">" posterior draws (plausible values) from "</span>,<span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span>,<span class="st">" respondents."</span>,</span>
<span>                 <span class="st">"\nSee Bignardi, Kievit, &amp; Bürkner (2025). 'A general method for estimating reliability using Bayesian Measurement Uncertainty' for details. "</span>,</span>
<span>                 <span class="st">"The procedure has been modified in `easyRasch` to use plausible values based on an MML estimated Rasch model."</span><span class="op">)</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">boot</span> <span class="op">==</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">{</span></span>
<span>    </span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>WLE <span class="op">=</span> <span class="va">wle</span>,</span>
<span>                PSI <span class="op">=</span> <span class="fu">eRm</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/eRm/man/person.parameter.html">person.parameter</a></span><span class="op">(</span><span class="va">erm_out</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu">eRm</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/eRm/man/SepRel.html">SepRel</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>                Empirical <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">estim</span>,<span class="st">"_empirical = "</span>,<span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">empirical_rel</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                Empirical_bootstrap <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">estim</span>,<span class="st">"_empirical = "</span>,<span class="va">emp_boot</span><span class="op">$</span><span class="va">y</span>,<span class="st">" (95% HDCI ["</span>,<span class="va">emp_boot</span><span class="op">$</span><span class="va">ymin</span>,<span class="st">", "</span>,<span class="va">emp_boot</span><span class="op">$</span><span class="va">ymax</span>,<span class="st">"]) ("</span>,<span class="va">draws</span>,<span class="st">" bootstrap resamples)"</span><span class="op">)</span>,</span>
<span>                RMU <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">estim</span>,<span class="st">"-RMU = "</span>,<span class="va">rmu</span><span class="op">$</span><span class="va">rmu_estimate</span>,<span class="st">" (95% HDCI ["</span>,<span class="va">rmu</span><span class="op">$</span><span class="va">hdci_lowerbound</span>,<span class="st">", "</span>,<span class="va">rmu</span><span class="op">$</span><span class="va">hdci_upperbound</span>,<span class="st">"]) ("</span>,<span class="va">draws</span>,<span class="st">" draws) using package "</span>,<span class="va">pv</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>WLE <span class="op">=</span> <span class="va">wle</span>,</span>
<span>                PSI <span class="op">=</span> <span class="fu">eRm</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/eRm/man/person.parameter.html">person.parameter</a></span><span class="op">(</span><span class="va">erm_out</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu">eRm</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/eRm/man/SepRel.html">SepRel</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>                Empirical <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">estim</span>,<span class="st">"_empirical = "</span>,<span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">empirical_rel</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                RMU <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">estim</span>,<span class="st">"-RMU = "</span>,<span class="va">rmu</span><span class="op">$</span><span class="va">rmu_estimate</span>,<span class="st">" (95% HDCI ["</span>,<span class="va">rmu</span><span class="op">$</span><span class="va">hdci_lowerbound</span>,<span class="st">", "</span>,<span class="va">rmu</span><span class="op">$</span><span class="va">hdci_upperbound</span>,<span class="st">"]) ("</span>,<span class="va">draws</span>,<span class="st">" draws) using package "</span>,<span class="va">pv</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">t0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html">Sys.time</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">rmu_mirt_wle4000</span> <span class="op">&lt;-</span> <span class="fu">RIreliability3</span><span class="op">(</span><span class="fu">eRm</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/eRm/man/eRm.data.html">raschdat1</a></span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">20</span><span class="op">]</span>, draws <span class="op">=</span> <span class="fl">4000</span><span class="op">)</span></span>
<span><span class="va">t1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html">Sys.time</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">t1</span> <span class="op">-</span> <span class="va">t0</span> <span class="co"># 4.5s</span></span>
<span></span>
<span><span class="va">t0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html">Sys.time</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">rmu_mirt_eap4000</span> <span class="op">&lt;-</span> <span class="fu">RIreliability3</span><span class="op">(</span><span class="fu">eRm</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/eRm/man/eRm.data.html">raschdat1</a></span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">20</span><span class="op">]</span>, draws <span class="op">=</span> <span class="fl">4000</span>, estim <span class="op">=</span> <span class="st">"EAP"</span><span class="op">)</span></span>
<span><span class="va">t1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html">Sys.time</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">t1</span> <span class="op">-</span> <span class="va">t0</span> <span class="co"># 4.1s</span></span>
<span></span>
<span><span class="va">t0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html">Sys.time</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">rmu_tam_eap4000</span> <span class="op">&lt;-</span> <span class="fu">RIreliability3</span><span class="op">(</span><span class="fu">eRm</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/eRm/man/eRm.data.html">raschdat1</a></span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">20</span><span class="op">]</span>, draws <span class="op">=</span> <span class="fl">4000</span>, pv <span class="op">=</span> <span class="st">"TAM"</span><span class="op">)</span></span>
<span><span class="va">t1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html">Sys.time</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">t1</span> <span class="op">-</span> <span class="va">t0</span> <span class="co"># 13.9s</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<p>Using <code>mirt</code>, there is not much difference between WLE and EAP, approximately 4.1s for EAP and 4.5s for WLE. <code>TAM</code> takes quite a bit longer, at around 14s. I only did two iterations, so take this with a grain of salt.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">t0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html">Sys.time</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">rmu_mirt_wle8000</span> <span class="op">&lt;-</span> <span class="fu">RIreliability3</span><span class="op">(</span><span class="fu">eRm</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/eRm/man/eRm.data.html">raschdat1</a></span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">20</span><span class="op">]</span>, draws <span class="op">=</span> <span class="fl">8000</span><span class="op">)</span></span>
<span><span class="va">t1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html">Sys.time</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">t1</span> <span class="op">-</span> <span class="va">t0</span> <span class="co"># 8.1 </span></span>
<span></span>
<span><span class="va">t0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html">Sys.time</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">rmu_mirt_eap8000</span> <span class="op">&lt;-</span> <span class="fu">RIreliability3</span><span class="op">(</span><span class="fu">eRm</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/eRm/man/eRm.data.html">raschdat1</a></span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">20</span><span class="op">]</span>, draws <span class="op">=</span> <span class="fl">8000</span>, estim <span class="op">=</span> <span class="st">"EAP"</span><span class="op">)</span></span>
<span><span class="va">t1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html">Sys.time</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">t1</span> <span class="op">-</span> <span class="va">t0</span> <span class="co"># 8.1</span></span>
<span></span>
<span><span class="va">t0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html">Sys.time</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">rmu_tam_eap8000</span> <span class="op">&lt;-</span> <span class="fu">RIreliability3</span><span class="op">(</span><span class="fu">eRm</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/eRm/man/eRm.data.html">raschdat1</a></span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">20</span><span class="op">]</span>, draws <span class="op">=</span> <span class="fl">8000</span>, pv <span class="op">=</span> <span class="st">"TAM"</span><span class="op">)</span></span>
<span><span class="va">t1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html">Sys.time</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">t1</span> <span class="op">-</span> <span class="va">t0</span> <span class="co"># 31s</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<p>With 8000 draws, WLE and EAP with <code>mirt</code> are both at 8.1s, while <code>TAM</code> takes about 31s.</p>
</section><section id="conditional-reliability" class="level3" data-number="3.3"><h3 data-number="3.3" class="anchored" data-anchor-id="conditional-reliability">
<span class="header-section-number">3.3</span> Conditional reliability</h3>
<p>This function and its code is borrowed from a recent paper by McNeish and Dumas <span class="citation" data-cites="mcneish_reliability_2025">(<a href="#ref-mcneish_reliability_2025" role="doc-biblioref">2025</a>)</span>. Alpha and omega are reported with 95% confidence intervals.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true" href="">Alpha</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false" href="">Omega</a></li>
</ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://pgmj.github.io/easyRasch/reference/RelRep.html">RIrelRep</a></span><span class="op">(</span><span class="fu">eRm</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/eRm/man/eRm.data.html">raschdat1</a></span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">20</span><span class="op">]</span><span class="op">)</span><span class="op">$</span><span class="va">plot</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>Coefficient Alpha:                  0.75
Coefficient Alpha 95% CI:          [0.68,0.82]

People above Alpha interval:    0%
People within Alpha interval   :    99%
People below  Alpha interval:    1%</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="reliability_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="1050"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://pgmj.github.io/easyRasch/reference/RelRep.html">RIrelRep</a></span><span class="op">(</span><span class="fu">eRm</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/eRm/man/eRm.data.html">raschdat1</a></span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">20</span><span class="op">]</span>, rel <span class="op">=</span> <span class="st">"omega"</span><span class="op">)</span><span class="op">$</span><span class="va">plot</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>Coefficient Omega:                  0.72
Coefficient Omega 95% CI:          [0.64,0.79]

People above Omega interval:    0%
People within Omega interval   :    100%
People below  Omega interval:    0%</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="reliability_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="1050"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section><section id="summarizing-rmu-findings" class="level3" data-number="3.4"><h3 data-number="3.4" class="anchored" data-anchor-id="summarizing-rmu-findings">
<span class="header-section-number">3.4</span> Summarizing RMU findings</h3>
<p>Since RMU uses a random pairing of posterior draws, there is variation in both point values and HDCI estimates if one runs the RMU estimation repeatedly using the same set of draws. Let’s investigate how much it varies, using the <code>brms</code> model with 4000 draws.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb15"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">rel</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map_dfr.html">map_dfr</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">1000</span>, <span class="op">~</span> <span class="fu"><a href="https://pgmj.github.io/easyRasch/reference/RMUreliability.html">RMUreliability</a></span><span class="op">(</span><span class="va">posterior_draws_rm4000</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/qs2/man/qs_save.html">qs_save</a></span><span class="op">(</span><span class="va">rel</span>,<span class="st">"rel4000.qs2"</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb16"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">rel</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/qs2/man/qs_read.html">qs_read</a></span><span class="op">(</span><span class="st">"rel4000.qs2"</span><span class="op">)</span></span>
<span><span class="va">rel_text</span> <span class="op">&lt;-</span> <span class="va">rel</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html">everything</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">name</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span>text_location <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">value</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">rel</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html">everything</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">value</span>, y <span class="op">=</span> <span class="fl">1</span>, fill <span class="op">=</span> <span class="va">name</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://mjskay.github.io/ggdist/reference/stat_slabinterval.html">stat_slabinterval</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html">geom_text</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">rel_text</span>,</span>
<span>            <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>label <span class="op">=</span> <span class="va">name</span>, x <span class="op">=</span> <span class="va">text_location</span><span class="op">)</span>,</span>
<span>            position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_nudge.html">position_nudge</a></span><span class="op">(</span>y <span class="op">=</span> <span class="op">-</span><span class="fl">0.04</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"RMU random variation"</span>,</span>
<span>       subtitle <span class="op">=</span> <span class="st">"Using a `brms` Rasch model with 4000 posterior draws, estimating RMU 1000 times"</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"Relative Measurement Uncertainty"</span>,</span>
<span>       y <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span>,</span>
<span>        axis.title.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>vjust <span class="op">=</span> <span class="op">-</span><span class="fl">0.1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_continuous</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.65</span>,<span class="fl">0.85</span><span class="op">)</span>, breaks <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/breaks_pretty.html">breaks_pretty</a></span><span class="op">(</span><span class="fl">8</span><span class="op">)</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="reliability_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid figure-img" width="1050"></p>
</figure>
</div>
</div>
</div>
<p>CI’s have more variation than the point estimate.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb17"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">rel</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html">everything</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">name</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/reframe.html">reframe</a></span><span class="op">(</span>min <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">value</span><span class="op">)</span>, </span>
<span>          max <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">value</span><span class="op">)</span>,</span>
<span>          mean_hdci <span class="op">=</span> <span class="fu"><a href="https://mjskay.github.io/ggdist/reference/point_interval.html">mean_hdci</a></span><span class="op">(</span><span class="va">value</span><span class="op">)</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 4
  name              min   max mean_hdci$y $ymin $ymax $.width $.point $.interval
  &lt;chr&gt;           &lt;dbl&gt; &lt;dbl&gt;       &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt;     
1 hdci_lowerbound 0.664 0.688       0.679 0.673 0.686    0.95 mean    hdci      
2 hdci_upperbound 0.809 0.830       0.818 0.812 0.825    0.95 mean    hdci      
3 rmu_estimate    0.748 0.752       0.750 0.749 0.751    0.95 mean    hdci      </code></pre>
</div>
</div>
<p>Let’s do the same with 8000 draws.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb19"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">rel8</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map_dfr.html">map_dfr</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">1000</span>, <span class="op">~</span> <span class="fu"><a href="https://pgmj.github.io/easyRasch/reference/RMUreliability.html">RMUreliability</a></span><span class="op">(</span><span class="va">posterior_draws_rm8000</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/qs2/man/qs_save.html">qs_save</a></span><span class="op">(</span><span class="va">rel8</span>,<span class="st">"rel8000.qs2"</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb20"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">rel8</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/qs2/man/qs_read.html">qs_read</a></span><span class="op">(</span><span class="st">"rel8000.qs2"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">rel8_text</span> <span class="op">&lt;-</span> <span class="va">rel8</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html">everything</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">name</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span>text_location <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">value</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">rel8</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html">everything</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">value</span>, y <span class="op">=</span> <span class="fl">1</span>, fill <span class="op">=</span> <span class="va">name</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://mjskay.github.io/ggdist/reference/stat_slabinterval.html">stat_slabinterval</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html">geom_text</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">rel_text</span>,</span>
<span>            <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>label <span class="op">=</span> <span class="va">name</span>, x <span class="op">=</span> <span class="va">text_location</span><span class="op">)</span>,</span>
<span>            position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_nudge.html">position_nudge</a></span><span class="op">(</span>y <span class="op">=</span> <span class="op">-</span><span class="fl">0.04</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"RMU random variation"</span>,</span>
<span>       subtitle <span class="op">=</span> <span class="st">"Using a `brms` Rasch model with 8000 posterior draws, estimating RMU 1000 times"</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"Relative Measurement Uncertainty"</span>,</span>
<span>       y <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span>,</span>
<span>        axis.title.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>vjust <span class="op">=</span> <span class="op">-</span><span class="fl">0.1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_continuous</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.65</span>,<span class="fl">0.85</span><span class="op">)</span>, breaks <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/breaks_pretty.html">breaks_pretty</a></span><span class="op">(</span><span class="fl">8</span><span class="op">)</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="reliability_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid figure-img" width="1050"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb21"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">rel8</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html">everything</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">name</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/reframe.html">reframe</a></span><span class="op">(</span>min <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">value</span><span class="op">)</span>, </span>
<span>          max <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">value</span><span class="op">)</span>,</span>
<span>          mean_hdci <span class="op">=</span> <span class="fu"><a href="https://mjskay.github.io/ggdist/reference/point_interval.html">mean_hdci</a></span><span class="op">(</span><span class="va">value</span><span class="op">)</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 4
  name              min   max mean_hdci$y $ymin $ymax $.width $.point $.interval
  &lt;chr&gt;           &lt;dbl&gt; &lt;dbl&gt;       &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt;     
1 hdci_lowerbound 0.670 0.685       0.678 0.673 0.683    0.95 mean    hdci      
2 hdci_upperbound 0.811 0.825       0.819 0.814 0.823    0.95 mean    hdci      
3 rmu_estimate    0.748 0.751       0.750 0.749 0.750    0.95 mean    hdci      </code></pre>
</div>
</div>
<p>Less variation - more precision in estimates with 8000 draws compared to 4000 draws.</p>
<p>How about just estimating RMU 50 times, does it converge on the same mean values for point and CI estimates, compared to estimating RMU 1000 times? This is obviously not a thorough test, it should be evaluated more properly at some point.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb23"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">t0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html">Sys.time</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">rel50</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map_dfr.html">map_dfr</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">50</span>, <span class="op">~</span> <span class="fu"><a href="https://pgmj.github.io/easyRasch/reference/RMUreliability.html">RMUreliability</a></span><span class="op">(</span><span class="va">posterior_draws_rm4000</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">t1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html">Sys.time</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">t1</span> <span class="op">-</span> <span class="va">t0</span> <span class="co"># ~3.4s</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>Time difference of 3.317572 secs</code></pre>
</div>
<details class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb25"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">rel50</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html">everything</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">name</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/reframe.html">reframe</a></span><span class="op">(</span>mean_hdci <span class="op">=</span> <span class="fu"><a href="https://mjskay.github.io/ggdist/reference/point_interval.html">mean_hdci</a></span><span class="op">(</span><span class="va">value</span><span class="op">)</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 2
  name            mean_hdci$y $ymin $ymax $.width $.point $.interval
  &lt;chr&gt;                 &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt;     
1 hdci_lowerbound       0.679 0.674 0.684    0.95 mean    hdci      
2 hdci_upperbound       0.818 0.814 0.824    0.95 mean    hdci      
3 rmu_estimate          0.750 0.749 0.751    0.95 mean    hdci      </code></pre>
</div>
</div>
<p>Clearly seems more stable than just estimating RMU once.</p>
<p>This finding leads me to incorporate the 50x RMU estimation as a default setting in the <code><a href="https://pgmj.github.io/easyRasch/reference/RIreliability.html">RIreliability()</a></code> function in the next version update. Results reported below are based on this method.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb27"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">RIreliability50</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">data</span>, <span class="va">conf_int</span> <span class="op">=</span> <span class="fl">.95</span>, <span class="va">draws</span> <span class="op">=</span> <span class="fl">1000</span>, <span class="va">estim</span> <span class="op">=</span> <span class="st">"WLE"</span>, <span class="va">boot</span> <span class="op">=</span> <span class="cn">FALSE</span>, <span class="va">cpu</span> <span class="op">=</span> <span class="fl">4</span>, <span class="va">pv</span> <span class="op">=</span> <span class="st">"mirt"</span>, <span class="va">iter</span> <span class="op">=</span> <span class="fl">50</span>, <span class="va">verbose</span> <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">{</span></span>
<span>  </span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">verbose</span> <span class="op">==</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/message.html">message</a></span><span class="op">(</span><span class="st">"Note that PSI is calculated with max/min scoring individuals excluded."</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/message.html">message</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"RMU reliability estimates based on "</span>,<span class="va">draws</span>,<span class="st">" posterior draws (plausible values) from "</span>,<span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span>,<span class="st">" respondents."</span>,</span>
<span>                 <span class="st">"\nSee Bignardi, Kievit, &amp; Bürkner (2025). 'A general method for estimating reliability using Bayesian Measurement Uncertainty' for details. "</span>,</span>
<span>                 <span class="st">"The procedure has been modified in `easyRasch` to use plausible values based on an MML estimated Rasch model."</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/stop.html">stop</a></span><span class="op">(</span><span class="st">"The lowest response category needs to coded as 0. Please recode your data."</span><span class="op">)</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">model</span> <span class="op">&lt;-</span> <span class="st">"RM"</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">1</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">model</span> <span class="op">&lt;-</span> <span class="st">"PCM"</span></span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">model</span> <span class="op">==</span> <span class="st">"PCM"</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">mirt_out</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://philchalmers.github.io/mirt/reference/mirt.html">mirt</a></span><span class="op">(</span></span>
<span>      <span class="va">data</span>,</span>
<span>      model <span class="op">=</span> <span class="fl">1</span>,</span>
<span>      itemtype <span class="op">=</span> <span class="st">"Rasch"</span>,</span>
<span>      verbose <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>      accelerate <span class="op">=</span> <span class="st">"squarem"</span></span>
<span>    <span class="op">)</span></span>
<span>    <span class="va">erm_out</span> <span class="op">&lt;-</span> <span class="fu">eRm</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/eRm/man/PCM.html">PCM</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span> <span class="op">(</span><span class="va">model</span> <span class="op">==</span> <span class="st">"RM"</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">mirt_out</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://philchalmers.github.io/mirt/reference/mirt.html">mirt</a></span><span class="op">(</span></span>
<span>      <span class="va">data</span>,</span>
<span>      model <span class="op">=</span> <span class="fl">1</span>,</span>
<span>      itemtype <span class="op">=</span> <span class="st">"1PL"</span>,</span>
<span>      verbose <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>      accelerate <span class="op">=</span> <span class="st">"squarem"</span></span>
<span>    <span class="op">)</span></span>
<span>    <span class="va">erm_out</span> <span class="op">&lt;-</span> <span class="fu">eRm</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/eRm/man/RM.html">RM</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span>  <span class="va">wle</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://pgmj.github.io/easyRasch/reference/RI_iarm_person_estimates.html">RI_iarm_person_estimates</a></span><span class="op">(</span><span class="va">erm_out</span>, properties <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">wle</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span>  </span>
<span>  <span class="va">empirical_rel</span> <span class="op">&lt;-</span> <span class="fu">mirt</span><span class="fu">::</span><span class="fu"><a href="https://philchalmers.github.io/mirt/reference/fscores.html">fscores</a></span><span class="op">(</span><span class="va">mirt_out</span>,</span>
<span>                                 method <span class="op">=</span> <span class="va">estim</span>,</span>
<span>                                 theta_lim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">10</span>, <span class="fl">10</span><span class="op">)</span>,</span>
<span>                                 full.scores.SE <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                                 verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu">mirt</span><span class="fu">::</span><span class="fu"><a href="https://philchalmers.github.io/mirt/reference/empirical_rxx.html">empirical_rxx</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">boot</span> <span class="op">==</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/library.html">require</a></span><span class="op">(</span><span class="va"><a href="https://github.com/RevolutionAnalytics/doparallel">doParallel</a></span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/doParallel/man/registerDoParallel.html">registerDoParallel</a></span><span class="op">(</span>cores <span class="op">=</span> <span class="va">cpu</span><span class="op">)</span></span>
<span>    <span class="co"># bootstrap CI for empirical</span></span>
<span>    <span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="op">)</span></span>
<span>    <span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/foreach/man/foreach.html">foreach</a></span><span class="op">(</span>i <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="va">draws</span>, .combine <span class="op">=</span> <span class="va">rbind</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/foreach/man/foreach.html">%dopar%</a></span> <span class="op">{</span></span>
<span>      </span>
<span>      <span class="va">dat</span> <span class="op">&lt;-</span> <span class="va">data</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, <span class="op">]</span></span>
<span>      </span>
<span>      <span class="kw">if</span> <span class="op">(</span><span class="va">model</span> <span class="op">==</span> <span class="st">"PCM"</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="va">mirt_out2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://philchalmers.github.io/mirt/reference/mirt.html">mirt</a></span><span class="op">(</span></span>
<span>          <span class="va">dat</span>,</span>
<span>          model <span class="op">=</span> <span class="fl">1</span>,</span>
<span>          itemtype <span class="op">=</span> <span class="st">"Rasch"</span>,</span>
<span>          verbose <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>          accelerate <span class="op">=</span> <span class="st">"squarem"</span></span>
<span>        <span class="op">)</span></span>
<span>      <span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span> <span class="op">(</span><span class="va">model</span> <span class="op">==</span> <span class="st">"RM"</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="va">mirt_out2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://philchalmers.github.io/mirt/reference/mirt.html">mirt</a></span><span class="op">(</span></span>
<span>          <span class="va">dat</span>,</span>
<span>          model <span class="op">=</span> <span class="fl">1</span>,</span>
<span>          itemtype <span class="op">=</span> <span class="st">"1PL"</span>,</span>
<span>          verbose <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>          accelerate <span class="op">=</span> <span class="st">"squarem"</span></span>
<span>        <span class="op">)</span></span>
<span>      <span class="op">}</span></span>
<span>      </span>
<span>      <span class="fu">mirt</span><span class="fu">::</span><span class="fu"><a href="https://philchalmers.github.io/mirt/reference/fscores.html">fscores</a></span><span class="op">(</span><span class="va">mirt_out2</span>,</span>
<span>                    method <span class="op">=</span> <span class="va">estim</span>,</span>
<span>                    theta_lim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">10</span>, <span class="fl">10</span><span class="op">)</span>,</span>
<span>                    full.scores.SE <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                    verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>        <span class="fu">mirt</span><span class="fu">::</span><span class="fu"><a href="https://philchalmers.github.io/mirt/reference/empirical_rxx.html">empirical_rxx</a></span><span class="op">(</span><span class="op">)</span></span>
<span>      </span>
<span>    <span class="op">}</span></span>
<span>    </span>
<span>    <span class="va">emp_boot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://mjskay.github.io/ggdist/reference/point_interval.html">mean_hdci</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html">across</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/where.html">where</a></span><span class="op">(</span><span class="va">is.numeric</span><span class="op">)</span>, <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">.x</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>    </span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">pv</span> <span class="op">==</span> <span class="st">"mirt"</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">plvals</span> <span class="op">&lt;-</span> <span class="fu">mirt</span><span class="fu">::</span><span class="fu"><a href="https://philchalmers.github.io/mirt/reference/fscores.html">fscores</a></span><span class="op">(</span><span class="va">mirt_out</span>, method <span class="op">=</span> <span class="va">estim</span>,</span>
<span>                          theta_lim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">10</span>, <span class="fl">10</span><span class="op">)</span>,</span>
<span>                          plausible.draws <span class="op">=</span> <span class="va">draws</span>,</span>
<span>                          plausible.type <span class="op">=</span> <span class="st">"MH"</span>,</span>
<span>                          verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">rmu_draws</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html">do.call</a></span><span class="op">(</span><span class="va">cbind.data.frame</span>, <span class="va">plvals</span><span class="op">)</span> </span>
<span>  <span class="va">rmu_iter</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map_dfr.html">map_dfr</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">iter</span>, <span class="op">~</span> <span class="fu"><a href="https://pgmj.github.io/easyRasch/reference/RMUreliability.html">RMUreliability</a></span><span class="op">(</span><span class="va">rmu_draws</span>, level <span class="op">=</span> <span class="va">conf_int</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">rmu</span> <span class="op">&lt;-</span> <span class="va">rmu_iter</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span>rmu_estimate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">rmu_estimate</span><span class="op">)</span>,</span>
<span>              hdci_lowerbound <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">hdci_lowerbound</span><span class="op">)</span>,</span>
<span>              hdci_upperbound <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">hdci_upperbound</span><span class="op">)</span></span>
<span>              <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html">across</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/where.html">where</a></span><span class="op">(</span><span class="va">is.numeric</span><span class="op">)</span>, <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">.x</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span> <span class="op">(</span><span class="va">pv</span> <span class="op">==</span> <span class="st">"TAM"</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">estim</span> <span class="op">=</span> <span class="st">"EAP"</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="va">model</span> <span class="op">==</span> <span class="st">"PCM"</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">tam_out</span> <span class="op">&lt;-</span> <span class="fu">TAM</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/TAM/man/tam.mml.html">tam.mml</a></span><span class="op">(</span>resp <span class="op">=</span> <span class="va">data</span>, irtmodel <span class="op">=</span> <span class="st">"PCM"</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span>    <span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span> <span class="op">(</span><span class="va">model</span> <span class="op">==</span> <span class="st">"RM"</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">tam_out</span> <span class="op">&lt;-</span> <span class="fu">TAM</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/TAM/man/tam.mml.html">tam.mml</a></span><span class="op">(</span>resp <span class="op">=</span> <span class="va">data</span>, irtmodel <span class="op">=</span> <span class="st">"1PL"</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>    </span>
<span>    <span class="va">plvals</span> <span class="op">&lt;-</span> <span class="fu">TAM</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/TAM/man/tam.pv.html">tam.pv</a></span><span class="op">(</span><span class="va">tam_out</span>, nplausible <span class="op">=</span> <span class="va">draws</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">[[</span><span class="st">"pv"</span><span class="op">]</span><span class="op">]</span><span class="op">[</span>,<span class="op">-</span><span class="fl">1</span><span class="op">]</span></span>
<span>    </span>
<span>    <span class="va">rmu_iter</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map_dfr.html">map_dfr</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">iter</span>, <span class="op">~</span> <span class="fu"><a href="https://pgmj.github.io/easyRasch/reference/RMUreliability.html">RMUreliability</a></span><span class="op">(</span><span class="va">plvals</span>, level <span class="op">=</span> <span class="va">conf_int</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span>    <span class="va">rmu</span> <span class="op">&lt;-</span> <span class="va">rmu_iter</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span>rmu_estimate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">rmu_estimate</span><span class="op">)</span>,</span>
<span>                hdci_lowerbound <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">hdci_lowerbound</span><span class="op">)</span>,</span>
<span>                hdci_upperbound <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">hdci_upperbound</span><span class="op">)</span></span>
<span>                <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html">across</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/where.html">where</a></span><span class="op">(</span><span class="va">is.numeric</span><span class="op">)</span>, <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">.x</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">boot</span> <span class="op">==</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">{</span></span>
<span>    </span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>WLE <span class="op">=</span> <span class="va">wle</span>,</span>
<span>                PSI <span class="op">=</span> <span class="fu">eRm</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/eRm/man/person.parameter.html">person.parameter</a></span><span class="op">(</span><span class="va">erm_out</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu">eRm</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/eRm/man/SepRel.html">SepRel</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>                Empirical <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">estim</span>,<span class="st">"_empirical = "</span>,<span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">empirical_rel</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                Empirical_bootstrap <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">estim</span>,<span class="st">"_empirical = "</span>,<span class="va">emp_boot</span><span class="op">$</span><span class="va">y</span>,<span class="st">" (95% HDCI ["</span>,<span class="va">emp_boot</span><span class="op">$</span><span class="va">ymin</span>,<span class="st">", "</span>,<span class="va">emp_boot</span><span class="op">$</span><span class="va">ymax</span>,<span class="st">"]) ("</span>,<span class="va">draws</span>,<span class="st">" bootstrap resamples)"</span><span class="op">)</span>,</span>
<span>                RMU <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">estim</span>,<span class="st">"-RMU = "</span>,<span class="va">rmu</span><span class="op">$</span><span class="va">rmu_estimate</span>,<span class="st">" (95% HDCI ["</span>,<span class="va">rmu</span><span class="op">$</span><span class="va">hdci_lowerbound</span>,<span class="st">", "</span>,<span class="va">rmu</span><span class="op">$</span><span class="va">hdci_upperbound</span>,<span class="st">"]) ("</span>,<span class="va">draws</span>,<span class="st">" draws) using package "</span>,<span class="va">pv</span>,<span class="st">" and "</span>,<span class="va">iter</span>,<span class="st">" RMU iterations."</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>WLE <span class="op">=</span> <span class="va">wle</span>,</span>
<span>                PSI <span class="op">=</span> <span class="fu">eRm</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/eRm/man/person.parameter.html">person.parameter</a></span><span class="op">(</span><span class="va">erm_out</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu">eRm</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/eRm/man/SepRel.html">SepRel</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>                Empirical <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">estim</span>,<span class="st">"_empirical = "</span>,<span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">empirical_rel</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                RMU <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">estim</span>,<span class="st">"-RMU = "</span>,<span class="va">rmu</span><span class="op">$</span><span class="va">rmu_estimate</span>,<span class="st">" (95% HDCI ["</span>,<span class="va">rmu</span><span class="op">$</span><span class="va">hdci_lowerbound</span>,<span class="st">", "</span>,<span class="va">rmu</span><span class="op">$</span><span class="va">hdci_upperbound</span>,<span class="st">"]) ("</span>,<span class="va">draws</span>,<span class="st">" draws) using package "</span>,<span class="va">pv</span>,<span class="st">" and "</span>,<span class="va">iter</span>,<span class="st">" RMU iterations."</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<p>Using the 50 iteration setting 10 times with 4000 draws. What is the variation!?</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb28"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">iter50</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html">map_vec</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, <span class="op">~</span> <span class="fu">RIreliability50</span><span class="op">(</span><span class="va">raschdat1</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">20</span><span class="op">]</span>, draws <span class="op">=</span> <span class="fl">4000</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">$</span><span class="va">RMU</span><span class="op">)</span></span>
<span><span class="va">iter50</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<p>Point estimate varies from .761 to .764, with lower/upper CI ranging from .694 to .698 and .825 to .827. Estimates seem unlikely to vary more than 0.01, which I find acceptable.</p>
</section><section id="summary-table" class="level3" data-number="3.5"><h3 data-number="3.5" class="anchored" data-anchor-id="summary-table">
<span class="header-section-number">3.5</span> Summary table</h3>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb29"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">rmu_mirt_wle_full</span> <span class="op">&lt;-</span> <span class="fu">RIreliability50</span><span class="op">(</span><span class="fu">eRm</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/eRm/man/eRm.data.html">raschdat1</a></span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">20</span><span class="op">]</span>, draws <span class="op">=</span> <span class="fl">4000</span>, verbose <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span>
<span><span class="va">rmu_mirt_eap_full</span> <span class="op">&lt;-</span> <span class="fu">RIreliability50</span><span class="op">(</span><span class="fu">eRm</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/eRm/man/eRm.data.html">raschdat1</a></span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">20</span><span class="op">]</span>, draws <span class="op">=</span> <span class="fl">4000</span>, estim <span class="op">=</span> <span class="st">"EAP"</span>, verbose <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span>
<span></span>
<span><span class="va">t0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html">Sys.time</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">rmu_mirt_wle4000</span> <span class="op">&lt;-</span> <span class="fu">RIreliability50</span><span class="op">(</span><span class="fu">eRm</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/eRm/man/eRm.data.html">raschdat1</a></span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">20</span><span class="op">]</span>, draws <span class="op">=</span> <span class="fl">4000</span>, verbose <span class="op">=</span> <span class="cn">F</span><span class="op">)</span><span class="op">$</span><span class="va">RMU</span></span>
<span><span class="va">t1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html">Sys.time</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">t1</span> <span class="op">-</span> <span class="va">t0</span> <span class="co"># 8.3s</span></span>
<span></span>
<span><span class="va">t0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html">Sys.time</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">rmu_mirt_eap4000</span> <span class="op">&lt;-</span> <span class="fu">RIreliability50</span><span class="op">(</span><span class="fu">eRm</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/eRm/man/eRm.data.html">raschdat1</a></span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">20</span><span class="op">]</span>, draws <span class="op">=</span> <span class="fl">4000</span>, estim <span class="op">=</span> <span class="st">"EAP"</span>, verbose <span class="op">=</span> <span class="cn">F</span><span class="op">)</span><span class="op">$</span><span class="va">RMU</span></span>
<span><span class="va">t1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html">Sys.time</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">t1</span> <span class="op">-</span> <span class="va">t0</span> <span class="co"># 7.7s</span></span>
<span></span>
<span><span class="va">t0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html">Sys.time</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">rmu_tam_eap4000</span> <span class="op">&lt;-</span> <span class="fu">RIreliability50</span><span class="op">(</span><span class="fu">eRm</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/eRm/man/eRm.data.html">raschdat1</a></span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">20</span><span class="op">]</span>, draws <span class="op">=</span> <span class="fl">4000</span>, pv <span class="op">=</span> <span class="st">"TAM"</span>, verbose <span class="op">=</span> <span class="cn">F</span><span class="op">)</span><span class="op">$</span><span class="va">RMU</span></span>
<span><span class="va">t1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html">Sys.time</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">t1</span> <span class="op">-</span> <span class="va">t0</span> <span class="co"># 10.6s</span></span>
<span></span>
<span><span class="va">brms4000</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map_dfr.html">map_dfr</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">50</span>, <span class="op">~</span> <span class="fu"><a href="https://pgmj.github.io/easyRasch/reference/RMUreliability.html">RMUreliability</a></span><span class="op">(</span><span class="va">posterior_draws_rm4000</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span>rmu_estimate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">rmu_estimate</span><span class="op">)</span>,</span>
<span>              hdci_lowerbound <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">hdci_lowerbound</span><span class="op">)</span>,</span>
<span>              hdci_upperbound <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">hdci_upperbound</span><span class="op">)</span></span>
<span>              <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html">across</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/where.html">where</a></span><span class="op">(</span><span class="va">is.numeric</span><span class="op">)</span>, <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">.x</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">brms8000</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map_dfr.html">map_dfr</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">50</span>, <span class="op">~</span> <span class="fu"><a href="https://pgmj.github.io/easyRasch/reference/RMUreliability.html">RMUreliability</a></span><span class="op">(</span><span class="va">posterior_draws_rm8000</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span>rmu_estimate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">rmu_estimate</span><span class="op">)</span>,</span>
<span>              hdci_lowerbound <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">hdci_lowerbound</span><span class="op">)</span>,</span>
<span>              hdci_upperbound <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">hdci_upperbound</span><span class="op">)</span></span>
<span>              <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html">across</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/where.html">where</a></span><span class="op">(</span><span class="va">is.numeric</span><span class="op">)</span>, <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">.x</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb30"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>Metric <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"RMU brms 8000"</span>,<span class="st">"RMU brms 4000"</span>,<span class="st">"WLE-RMU PV 4000 (mirt)"</span>,<span class="st">"EAP-RMU PV 4000 (mirt)"</span>,<span class="st">"EAP-RMU PV 4000 (TAM)"</span>,<span class="st">"EAP (TAM)"</span>,<span class="st">"PSI (eRm)"</span>,<span class="st">"WLE empirical (mirt)"</span>,<span class="st">"EAP empirical (mirt)"</span>,<span class="st">"Alpha"</span>,<span class="st">"Omega"</span><span class="op">)</span>,</span>
<span>           Estimate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"0.750, 95% HDCI [0.678, 0.818]"</span>,</span>
<span>                        <span class="st">"0.750, 95% HDCI [0.679, 0.818]"</span>,</span>
<span>                        <span class="st">"0.762, 95% HDCI [0.696, 0.827]"</span>,</span>
<span>                        <span class="st">"0.762, 95% HDCI [0.695, 0.826]"</span>,</span>
<span>                        <span class="st">"0.740, 95% HDCI [0.669, 0.809]"</span>,</span>
<span>                        <span class="st">"0.749"</span>,</span>
<span>                        <span class="st">"0.747"</span>,</span>
<span>                        <span class="st">"0.792"</span>,</span>
<span>                        <span class="st">"0.761"</span>,</span>
<span>                        <span class="st">"0.75 95% CI [0.68,0.82]"</span>,</span>
<span>                        <span class="st">"0.72 95% CI [0.64,0.80]"</span><span class="op">)</span></span>
<span>           <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<thead><tr class="header">
<th style="text-align: left;">Metric</th>
<th style="text-align: left;">Estimate</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">RMU brms 8000</td>
<td style="text-align: left;">0.750, 95% HDCI [0.678, 0.818]</td>
</tr>
<tr class="even">
<td style="text-align: left;">RMU brms 4000</td>
<td style="text-align: left;">0.750, 95% HDCI [0.679, 0.818]</td>
</tr>
<tr class="odd">
<td style="text-align: left;">WLE-RMU PV 4000 (mirt)</td>
<td style="text-align: left;">0.762, 95% HDCI [0.696, 0.827]</td>
</tr>
<tr class="even">
<td style="text-align: left;">EAP-RMU PV 4000 (mirt)</td>
<td style="text-align: left;">0.762, 95% HDCI [0.695, 0.826]</td>
</tr>
<tr class="odd">
<td style="text-align: left;">EAP-RMU PV 4000 (TAM)</td>
<td style="text-align: left;">0.740, 95% HDCI [0.669, 0.809]</td>
</tr>
<tr class="even">
<td style="text-align: left;">EAP (TAM)</td>
<td style="text-align: left;">0.749</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PSI (eRm)</td>
<td style="text-align: left;">0.747</td>
</tr>
<tr class="even">
<td style="text-align: left;">WLE empirical (mirt)</td>
<td style="text-align: left;">0.792</td>
</tr>
<tr class="odd">
<td style="text-align: left;">EAP empirical (mirt)</td>
<td style="text-align: left;">0.761</td>
</tr>
<tr class="even">
<td style="text-align: left;">Alpha</td>
<td style="text-align: left;">0.75 95% CI [0.68,0.82]</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Omega</td>
<td style="text-align: left;">0.72 95% CI [0.64,0.80]</td>
</tr>
</tbody>
</table>
</div>
</div>
</section></section><section id="partial-credit-model-pcm" class="level2" data-number="4"><h2 data-number="4" class="anchored" data-anchor-id="partial-credit-model-pcm">
<span class="header-section-number">4</span> Partial credit model (PCM)</h2>
<p>For this example, the <code><a href="https://rdrr.io/pkg/eRm/man/eRm.data.html">eRm::pcmdat2</a></code> dataset is used. It has 4 items with 3 response categories each, and 300 respondents. It might not be an optimal dataset to use since item 3 is a bit overfit to the PCM.</p>
<section id="bayesian-model-1" class="level3" data-number="4.1"><h3 data-number="4.1" class="anchored" data-anchor-id="bayesian-model-1">
<span class="header-section-number">4.1</span> Bayesian model</h3>
<p>To fit a PCM with <code>brms</code>, we need <code>family = "acat"</code>, which defaults to use logit link.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb31"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">df2</span> <span class="op">&lt;-</span> <span class="va">pcmdat2</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html">across</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html">everything</a></span><span class="op">(</span><span class="op">)</span>, <span class="op">~</span> <span class="va">.x</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="co"># lowest category needs to be 1, unlike most Rasch packages that use 0</span></span>
<span>  <span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html">rownames_to_column</a></span><span class="op">(</span><span class="st">"id"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span><span class="op">!</span><span class="va">id</span>, names_to <span class="op">=</span> <span class="st">"item"</span>, values_to <span class="op">=</span> <span class="st">"response"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://paulbuerkner.com/brms/reference/default_prior.html">get_prior</a></span><span class="op">(</span><span class="va">response</span> <span class="op">|</span> <span class="fu">thres</span><span class="op">(</span>gr <span class="op">=</span> <span class="va">item</span><span class="op">)</span> <span class="op">~</span> <span class="fl">1</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">|</span> <span class="va">id</span><span class="op">)</span>,</span>
<span>  data    <span class="op">=</span> <span class="va">df2</span>,</span>
<span>  family  <span class="op">=</span> <span class="st">"acat"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">prior_pcm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://paulbuerkner.com/brms/reference/set_prior.html">prior</a></span><span class="op">(</span><span class="st">"normal(0, 5)"</span>, class <span class="op">=</span> <span class="st">"Intercept"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://paulbuerkner.com/brms/reference/set_prior.html">prior</a></span><span class="op">(</span><span class="st">"normal(0, 3)"</span>, class <span class="op">=</span> <span class="st">"sd"</span>, group <span class="op">=</span> <span class="st">"id"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">brms_pcm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://paulbuerkner.com/brms/reference/brm.html">brm</a></span><span class="op">(</span></span>
<span>  <span class="va">response</span> <span class="op">|</span> <span class="fu">thres</span><span class="op">(</span>gr <span class="op">=</span> <span class="va">item</span><span class="op">)</span> <span class="op">~</span> <span class="fl">1</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">|</span> <span class="va">id</span><span class="op">)</span>,</span>
<span>  data    <span class="op">=</span> <span class="va">df2</span>,</span>
<span>  prior   <span class="op">=</span> <span class="va">prior_pcm</span>,</span>
<span>  chains  <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  cores   <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  iter    <span class="op">=</span> <span class="fl">2000</span>,</span>
<span>  family  <span class="op">=</span> <span class="st">"acat"</span>,</span>
<span>  control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>adapt_delta <span class="op">=</span> <span class="fl">0.99</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://mc-stan.org/loo/reference/loo.html">loo</a></span><span class="op">(</span><span class="va">brms_pcm</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/qs2/man/qs_save.html">qs_save</a></span><span class="op">(</span><span class="va">brms_pcm</span>, file <span class="op">=</span> <span class="st">"brms_pcm.qs2"</span>, compress_level <span class="op">=</span> <span class="fl">11</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb32"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">brms_pcm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/qs2/man/qs_read.html">qs_read</a></span><span class="op">(</span><span class="st">"brms_pcm.qs2"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">posterior_draws_pcm</span> <span class="op">&lt;-</span> <span class="va">brms_pcm</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://mc-stan.org/posterior/reference/draws_df.html">as_draws_df</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html">starts_with</a></span><span class="op">(</span><span class="st">"r_id"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</section><section id="conditional-reliability-1" class="level3" data-number="4.2"><h3 data-number="4.2" class="anchored" data-anchor-id="conditional-reliability-1">
<span class="header-section-number">4.2</span> Conditional reliability</h3>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true" href="">Alpha</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false" href="">Omega</a></li>
</ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb33"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://pgmj.github.io/easyRasch/reference/RelRep.html">RIrelRep</a></span><span class="op">(</span><span class="fu">eRm</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/eRm/man/eRm.data.html">pcmdat2</a></span><span class="op">)</span><span class="op">$</span><span class="va">plot</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>Coefficient Alpha:                  0.66
Coefficient Alpha 95% CI:          [0.59,0.72]

People above Alpha interval:    0%
People within Alpha interval   :    87.67%
People below  Alpha interval:    12.33%</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="reliability_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid figure-img" width="1050"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb35"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://pgmj.github.io/easyRasch/reference/RelRep.html">RIrelRep</a></span><span class="op">(</span><span class="fu">eRm</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/eRm/man/eRm.data.html">pcmdat2</a></span>, rel <span class="op">=</span> <span class="st">"omega"</span><span class="op">)</span><span class="op">$</span><span class="va">plot</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>Coefficient Omega:                  0.63
Coefficient Omega 95% CI:          [0.56,0.7]

People above Omega interval:    50%
People within Omega interval   :    37.67%
People below  Omega interval:    12.33%</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="reliability_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid figure-img" width="1050"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section><section id="summary-table-1" class="level3" data-number="4.3"><h3 data-number="4.3" class="anchored" data-anchor-id="summary-table-1">
<span class="header-section-number">4.3</span> Summary table</h3>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb37"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">brms4000pcm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map_dfr.html">map_dfr</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">50</span>, <span class="op">~</span> <span class="fu"><a href="https://pgmj.github.io/easyRasch/reference/RMUreliability.html">RMUreliability</a></span><span class="op">(</span><span class="va">posterior_draws_pcm</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span>rmu_estimate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">rmu_estimate</span><span class="op">)</span>,</span>
<span>              hdci_lowerbound <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">hdci_lowerbound</span><span class="op">)</span>,</span>
<span>              hdci_upperbound <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">hdci_upperbound</span><span class="op">)</span></span>
<span>              <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html">across</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/where.html">where</a></span><span class="op">(</span><span class="va">is.numeric</span><span class="op">)</span>, <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">.x</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">rmu_mirt_wle_full</span> <span class="op">&lt;-</span> <span class="fu">RIreliability50</span><span class="op">(</span><span class="fu">eRm</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/eRm/man/eRm.data.html">pcmdat2</a></span>, draws <span class="op">=</span> <span class="fl">4000</span>, verbose <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span>
<span><span class="va">rmu_mirt_eap_full</span> <span class="op">&lt;-</span> <span class="fu">RIreliability50</span><span class="op">(</span><span class="fu">eRm</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/eRm/man/eRm.data.html">pcmdat2</a></span>, draws <span class="op">=</span> <span class="fl">4000</span>, estim <span class="op">=</span> <span class="st">"EAP"</span>, verbose <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span>
<span></span>
<span><span class="va">rmu_mirt_wle4000</span> <span class="op">&lt;-</span> <span class="fu">RIreliability50</span><span class="op">(</span><span class="fu">eRm</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/eRm/man/eRm.data.html">pcmdat2</a></span>, draws <span class="op">=</span> <span class="fl">4000</span>, verbose <span class="op">=</span> <span class="cn">F</span><span class="op">)</span><span class="op">$</span><span class="va">RMU</span></span>
<span><span class="va">rmu_mirt_eap4000</span> <span class="op">&lt;-</span> <span class="fu">RIreliability50</span><span class="op">(</span><span class="fu">eRm</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/eRm/man/eRm.data.html">pcmdat2</a></span>, draws <span class="op">=</span> <span class="fl">4000</span>, estim <span class="op">=</span> <span class="st">"EAP"</span>, verbose <span class="op">=</span> <span class="cn">F</span><span class="op">)</span><span class="op">$</span><span class="va">RMU</span></span>
<span><span class="va">rmu_tam_eap4000</span> <span class="op">&lt;-</span> <span class="fu">RIreliability50</span><span class="op">(</span><span class="fu">eRm</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/eRm/man/eRm.data.html">pcmdat2</a></span>, draws <span class="op">=</span> <span class="fl">4000</span>, pv <span class="op">=</span> <span class="st">"TAM"</span>, verbose <span class="op">=</span> <span class="cn">F</span><span class="op">)</span><span class="op">$</span><span class="va">RMU</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb38"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>Metric <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"RMU brms 4000"</span>,<span class="st">"WLE-RMU PV 4000 (mirt)"</span>,<span class="st">"EAP-RMU PV 4000 (mirt)"</span>,<span class="st">"EAP-RMU PV 4000 (TAM)"</span>,<span class="st">"EAP"</span>,<span class="st">"WLE empirical (mirt)"</span>,<span class="st">"EAP empirical (mirt)"</span>,<span class="st">"PSI"</span>,<span class="st">"Alpha"</span>,<span class="st">"Omega"</span><span class="op">)</span>,</span>
<span>           Estimate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"0.672, 95% HDCI [0.615, 0.729]"</span>,</span>
<span>                        <span class="st">"0.671, 95% HDCI [0.618, 0.721]"</span>,</span>
<span>                        <span class="st">"0.670, 95% HDCI [0.618, 0.721]"</span>,</span>
<span>                        <span class="st">"0.672, 95% HDCI [0.621, 0.722]"</span>,</span>
<span>                        <span class="st">"0.669"</span>,</span>
<span>                        <span class="st">"0.718"</span>,</span>
<span>                        <span class="st">"0.670"</span>,</span>
<span>                        <span class="st">"0.380"</span>,</span>
<span>                        <span class="st">"0.66 95% CI [0.59,0.72]"</span>,</span>
<span>                        <span class="st">"0.63 95% CI [0.56,0.70]"</span><span class="op">)</span></span>
<span>           <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<thead><tr class="header">
<th style="text-align: left;">Metric</th>
<th style="text-align: left;">Estimate</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">RMU brms 4000</td>
<td style="text-align: left;">0.672, 95% HDCI [0.615, 0.729]</td>
</tr>
<tr class="even">
<td style="text-align: left;">WLE-RMU PV 4000 (mirt)</td>
<td style="text-align: left;">0.671, 95% HDCI [0.618, 0.721]</td>
</tr>
<tr class="odd">
<td style="text-align: left;">EAP-RMU PV 4000 (mirt)</td>
<td style="text-align: left;">0.670, 95% HDCI [0.618, 0.721]</td>
</tr>
<tr class="even">
<td style="text-align: left;">EAP-RMU PV 4000 (TAM)</td>
<td style="text-align: left;">0.672, 95% HDCI [0.621, 0.722]</td>
</tr>
<tr class="odd">
<td style="text-align: left;">EAP</td>
<td style="text-align: left;">0.669</td>
</tr>
<tr class="even">
<td style="text-align: left;">WLE empirical (mirt)</td>
<td style="text-align: left;">0.718</td>
</tr>
<tr class="odd">
<td style="text-align: left;">EAP empirical (mirt)</td>
<td style="text-align: left;">0.670</td>
</tr>
<tr class="even">
<td style="text-align: left;">PSI</td>
<td style="text-align: left;">0.380</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Alpha</td>
<td style="text-align: left;">0.66 95% CI [0.59,0.72]</td>
</tr>
<tr class="even">
<td style="text-align: left;">Omega</td>
<td style="text-align: left;">0.63 95% CI [0.56,0.70]</td>
</tr>
</tbody>
</table>
</div>
</div>
</section></section><section id="session-info" class="level2" data-number="5"><h2 data-number="5" class="anchored" data-anchor-id="session-info">
<span class="header-section-number">5</span> Session info</h2>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb39"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>R version 4.4.3 (2025-02-28)
Platform: aarch64-apple-darwin20
Running under: macOS Sequoia 15.7.1

Matrix products: default
BLAS:   /Library/Frameworks/R.framework/Versions/4.4-arm64/Resources/lib/libRblas.0.dylib 
LAPACK: /Library/Frameworks/R.framework/Versions/4.4-arm64/Resources/lib/libRlapack.dylib;  LAPACK version 3.12.0

locale:
[1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8

time zone: Europe/Stockholm
tzcode source: internal

attached base packages:
 [1] parallel  grid      stats4    stats     graphics  grDevices utils    
 [8] datasets  methods   base     

other attached packages:
 [1] qs2_0.1.5         brms_2.23.0       Rcpp_1.0.14       easyRasch_0.4.1.2
 [5] Bayesrel_0.7.8    doParallel_1.0.17 iterators_1.0.14  furrr_0.3.1      
 [9] future_1.67.0     foreach_1.5.2     janitor_2.2.1     iarm_0.4.3       
[13] hexbin_1.28.4     catR_3.17         glue_1.8.0        ggrepel_0.9.6    
[17] patchwork_1.3.2   reshape_0.8.10    matrixStats_1.4.1 psychotree_0.16-2
[21] psychotools_0.7-4 partykit_1.2-24   mvtnorm_1.3-3     libcoin_1.0-10   
[25] psych_2.5.6       mirt_1.45.1       lattice_0.22-6    eRm_1.0-10       
[29] kableExtra_1.4.0  formattable_0.2.1 ggdist_3.3.3      lubridate_1.9.4  
[33] forcats_1.0.0     stringr_1.5.2     dplyr_1.1.4       purrr_1.1.0      
[37] readr_2.1.5       tidyr_1.3.1       tibble_3.3.0      ggplot2_3.5.2    
[41] tidyverse_2.0.0  

loaded via a namespace (and not attached):
  [1] splines_4.4.3        R.oo_1.26.0          cellranger_1.1.0    
  [4] rpart_4.1.24         lifecycle_1.0.4      Rdpack_2.6.1        
  [7] StanHeaders_2.32.10  rprojroot_2.1.1      globals_0.18.0      
 [10] MASS_7.3-64          backports_1.5.0      magrittr_2.0.3      
 [13] vcd_1.4-12           Hmisc_5.2-4          rmarkdown_2.29      
 [16] yaml_2.3.10          pkgbuild_1.4.6       sessioninfo_1.2.3   
 [19] pbapply_1.7-2        RColorBrewer_1.1-3   multcomp_1.4-26     
 [22] abind_1.4-5          audio_0.1-11         quadprog_1.5-8      
 [25] R.utils_2.12.3       TH.data_1.1-2        nnet_7.3-20         
 [28] tensorA_0.36.2.1     sandwich_3.1-1       inline_0.3.19       
 [31] listenv_0.9.1        testthat_3.2.1.1     vegan_2.6-8         
 [34] bridgesampling_1.1-2 parallelly_1.45.1    svglite_2.1.3       
 [37] permute_0.9-7        codetools_0.2-20     xml2_1.3.6          
 [40] tidyselect_1.2.1     bayesplot_1.14.0     farver_2.1.2        
 [43] base64enc_0.1-3      jsonlite_1.8.9       progressr_0.14.0    
 [46] Formula_1.2-5        survival_3.8-3       emmeans_1.10.4      
 [49] systemfonts_1.2.3    tools_4.4.3          gnm_1.1-5           
 [52] mnormt_2.1.1         gridExtra_2.3        xfun_0.46           
 [55] here_1.0.2           mgcv_1.9-1           distributional_0.4.0
 [58] ca_0.71.1            loo_2.8.0            withr_3.0.2         
 [61] beepr_2.0            fastmap_1.2.0        digest_0.6.37       
 [64] timechange_0.3.0     R6_2.5.1             estimability_1.5.1  
 [67] colorspace_2.1-1     R.methodsS3_1.8.2    inum_1.0-5          
 [70] utf8_1.2.4           generics_0.1.3       data.table_1.17.8   
 [73] SimDesign_2.21       htmlwidgets_1.6.4    pkgconfig_2.0.3     
 [76] gtable_0.3.6         lmtest_0.9-40        brio_1.1.5          
 [79] htmltools_0.5.8.1    lavaan_0.6-20        scales_1.4.0        
 [82] posterior_1.6.0      snakecase_0.11.1     knitr_1.48          
 [85] rstudioapi_0.17.1    tzdb_0.4.0           curl_7.0.0          
 [88] coda_0.19-4.1        checkmate_2.3.2      nlme_3.1-167        
 [91] zoo_1.8-12           relimp_1.0-5         vcdExtra_0.8-5      
 [94] foreign_0.8-88       pillar_1.10.1        vctrs_0.6.5         
 [97] stringfish_0.16.0    xtable_1.8-4         Deriv_4.1.3         
[100] cluster_2.1.8        dcurver_0.9.2        GPArotation_2024.3-1
[103] htmlTable_2.4.3      pbivnorm_0.6.0       evaluate_1.0.1      
[106] cli_3.6.3            compiler_4.4.3       rlang_1.1.6         
[109] rstantools_2.4.0     future.apply_1.20.0  LaplacesDemon_16.1.6
[112] labeling_0.4.3       plyr_1.8.9           rstan_2.32.6        
[115] stringi_1.8.7        QuickJSR_1.3.1       viridisLite_0.4.2   
[118] V8_4.4.2             Brobdingnag_1.2-9    Matrix_1.7-2        
[121] qvcalc_1.0.3         hms_1.1.3            rbibutils_2.2.16    
[124] clipr_0.8.0          RcppParallel_5.1.8   readxl_1.4.5        </code></pre>
</div>
</div>
</section><section id="references" class="level2" data-number="6">


<!-- -->


</section><div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">
6 References</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-bignardi_general_2025" class="csl-entry" role="listitem">
Bignardi, Giacomo, Rogier Kievit, and Paul-Christian Bürkner. 2025. <span>“A General Method for Estimating Reliability Using <span>Bayesian</span> <span>Measurement</span> <span>Uncertainty</span>.”</span> OSF. <a href="https://doi.org/10.31234/osf.io/h54k8_v1">https://doi.org/10.31234/osf.io/h54k8_v1</a>.
</div>
<div id="ref-burkner_bayesian_2021" class="csl-entry" role="listitem">
Bürkner, Paul-Christian. 2021. <span>“Bayesian <span>Item</span> <span>Response</span> <span>Modeling</span> in <span>R</span> with Brms and <span>Stan</span>.”</span> <em>Journal of Statistical Software</em> 100 (November): 1–54. <a href="https://doi.org/10.18637/jss.v100.i05">https://doi.org/10.18637/jss.v100.i05</a>.
</div>
<div id="ref-kreiner_specific_2025" class="csl-entry" role="listitem">
Kreiner, Svend. 2025. <span>“On <span>Specific</span> <span>Objectivity</span> and <span>Measurement</span> by <span>Rasch</span> <span>Models</span>: <span>A</span> <span>Statistical</span> <span>Viewpoint</span>.”</span> <em>Educational Methods &amp; Psychometrics</em> 3. <a href="https://doi.org/10.61186/emp.2025.7">https://doi.org/10.61186/emp.2025.7</a>.
</div>
<div id="ref-mcneish_reliability_2025" class="csl-entry" role="listitem">
McNeish, Daniel, and Denis Dumas. 2025. <span>“Reliability Representativeness: <span>How</span> Well Does Coefficient Alpha Summarize Reliability Across the Score Distribution?”</span> <em>Behavior Research Methods</em> 57 (3): 93. <a href="https://doi.org/10.3758/s13428-025-02611-8">https://doi.org/10.3758/s13428-025-02611-8</a>.
</div>
<div id="ref-mislevy_randomization_based_1991" class="csl-entry" role="listitem">
Mislevy, Robert J. 1991. <span>“Randomization-<span>Based</span> <span>Inference</span> about <span>Latent</span> <span>Variables</span> from <span>Complex</span> <span>Samples</span>.”</span> <em>Psychometrika</em> 56 (2): 177–96. <a href="https://doi.org/10.1007/BF02294457">https://doi.org/10.1007/BF02294457</a>.
</div>
<div id="ref-wu_role_2005" class="csl-entry" role="listitem">
Wu, Margaret. 2005. <span>“The Role of Plausible Values in Large-Scale Surveys.”</span> <em>Studies in Educational Evaluation</em> 31 (2-3): 114–28. <a href="https://doi.org/10.1016/j.stueduc.2005.05.005">https://doi.org/10.1016/j.stueduc.2005.05.005</a>.
</div>
</div></section><section class="quarto-appendix-contents" id="quarto-reuse"><h2 class="anchored quarto-appendix-heading">Reuse</h2><div class="quarto-appendix-contents"><div><a rel="license" href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a></div></div></section><section class="quarto-appendix-contents" id="quarto-citation"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@online{johansson2025,
  author = {Johansson, Magnus},
  title = {RMU -\/-\/- Relative Measurement Uncertainty},
  date = {2025-10-23},
  url = {https://pgmj.github.io/reliability.html},
  langid = {en}
}
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-johansson2025" class="csl-entry quarto-appendix-citeas" role="listitem">
Johansson, Magnus. 2025. <span>“RMU --- Relative Measurement
Uncertainty.”</span> October 23, 2025. <a href="https://pgmj.github.io/reliability.html">https://pgmj.github.io/reliability.html</a>.
</div></div></section></div></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
    const viewSource = window.document.getElementById('quarto-view-source') ||
                       window.document.getElementById('quarto-code-tools-source');
    if (viewSource) {
      const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
      viewSource.addEventListener("click", function(e) {
        if (sourceUrl) {
          // rstudio viewer pane
          if (/\bcapabilities=\b/.test(window.location)) {
            window.open(sourceUrl);
          } else {
            window.location.href = sourceUrl;
          }
        } else {
          const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
          modal.show();
        }
        return false;
      });
    }
    function toggleCodeHandler(show) {
      return function(e) {
        const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
        for (let i=0; i<detailsSrc.length; i++) {
          const details = detailsSrc[i].parentElement;
          if (show) {
            details.open = true;
          } else {
            details.removeAttribute("open");
          }
        }
        const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
        const fromCls = show ? "hidden" : "unhidden";
        const toCls = show ? "unhidden" : "hidden";
        for (let i=0; i<cellCodeDivs.length; i++) {
          const codeDiv = cellCodeDivs[i];
          if (codeDiv.classList.contains(fromCls)) {
            codeDiv.classList.remove(fromCls);
            codeDiv.classList.add(toCls);
          } 
        }
        return false;
      }
    }
    const hideAllCode = window.document.getElementById("quarto-hide-all-code");
    if (hideAllCode) {
      hideAllCode.addEventListener("click", toggleCodeHandler(false));
    }
    const showAllCode = window.document.getElementById("quarto-show-all-code");
    if (showAllCode) {
      showAllCode.addEventListener("click", toggleCodeHandler(true));
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/pgmj\.github\.io");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script><input type="hidden" id="giscus-base-theme" value="light"><input type="hidden" id="giscus-alt-theme" value="dark"><script>
  function loadGiscus() {
    // Function to get the theme based on body class
    const getTheme = () => {
      let baseTheme = document.getElementById('giscus-base-theme').value;
      let altTheme = document.getElementById('giscus-alt-theme').value;
      return document.body.classList.contains('quarto-dark') ? altTheme : baseTheme;
    };
    const script = document.createElement("script");
    script.src = "https://giscus.app/client.js";
    script.async = true;
    script.dataset.repo = "pgmj/pgmj.github.io";
    script.dataset.repoId = "R_kgDOGtKrEA";
    script.dataset.category = "General";
    script.dataset.categoryId = "DIC_kwDOGtKrEM4CdX5K";
    script.dataset.mapping = "title";
    script.dataset.reactionsEnabled = "1";
    script.dataset.emitMetadata = "0";
    script.dataset.inputPosition = "top";
    script.dataset.theme = getTheme();
    script.dataset.lang = "en";
    script.crossOrigin = "anonymous";
    // Append the script to the desired div instead of at the end of the body
    document.getElementById("quarto-content").appendChild(script);
  }
  loadGiscus();
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb41" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "RMU --- relative measurement uncertainty"</span></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a><span class="an">subtitle:</span><span class="co"> "Comparing methods and metrics"</span></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a><span class="co">  name: 'Magnus Johansson'</span></span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a><span class="co">  affiliation: 'Karolinska Institutet'</span></span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a><span class="co">  orcid: '0000-0003-1669-592X'</span></span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a><span class="co">  email: 'magnus.johansson.3@ki.se'</span></span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a><span class="co">  degrees: PhD</span></span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a><span class="co">  url: https://ki.se/personer/magnus-johansson-3</span></span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a><span class="an">date:</span><span class="co"> 2025-10-23</span></span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a><span class="an">date-format:</span><span class="co"> iso</span></span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a><span class="an">date-modified:</span><span class="co"> last-modified</span></span>
<span id="cb41-14"><a href="#cb41-14" aria-hidden="true" tabindex="-1"></a><span class="an">google-scholar:</span><span class="co"> true</span></span>
<span id="cb41-15"><a href="#cb41-15" aria-hidden="true" tabindex="-1"></a><span class="an">citation:</span></span>
<span id="cb41-16"><a href="#cb41-16" aria-hidden="true" tabindex="-1"></a><span class="co">  type: 'webpage'</span></span>
<span id="cb41-17"><a href="#cb41-17" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span><span class="co"> </span></span>
<span id="cb41-18"><a href="#cb41-18" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb41-19"><a href="#cb41-19" aria-hidden="true" tabindex="-1"></a><span class="co">    code-fold: true</span></span>
<span id="cb41-20"><a href="#cb41-20" aria-hidden="true" tabindex="-1"></a><span class="an">execute:</span><span class="co"> </span></span>
<span id="cb41-21"><a href="#cb41-21" aria-hidden="true" tabindex="-1"></a><span class="co">  cache: true</span></span>
<span id="cb41-22"><a href="#cb41-22" aria-hidden="true" tabindex="-1"></a><span class="co">  warning: false</span></span>
<span id="cb41-23"><a href="#cb41-23" aria-hidden="true" tabindex="-1"></a><span class="co">  message: false</span></span>
<span id="cb41-24"><a href="#cb41-24" aria-hidden="true" tabindex="-1"></a><span class="an">editor_options:</span><span class="co"> </span></span>
<span id="cb41-25"><a href="#cb41-25" aria-hidden="true" tabindex="-1"></a><span class="co">  chunk_output_type: console</span></span>
<span id="cb41-26"><a href="#cb41-26" aria-hidden="true" tabindex="-1"></a><span class="an">bibliography:</span><span class="co"> reliability.bib</span></span>
<span id="cb41-27"><a href="#cb41-27" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb41-28"><a href="#cb41-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-29"><a href="#cb41-29" aria-hidden="true" tabindex="-1"></a><span class="fu">## Introduction</span></span>
<span id="cb41-30"><a href="#cb41-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-31"><a href="#cb41-31" aria-hidden="true" tabindex="-1"></a>This post has two purposes. The primary one is to compare some reliability metrics, since a new preprint <span class="co">[</span><span class="ot">@bignardi_general_2025</span><span class="co">]</span> inspired some ideas. They propose a general "relative measurement uncertainty" (RMU) metric, applicable in many situations thanks to Bayesian modeling and posterior MCMC draws. My idea that is evaluated here is to use "plausible values" <span class="co">[</span><span class="ot">@mislevy_randomization_based_1991;@wu_role_2005</span><span class="co">]</span> instead of fully Bayesian model posterior draws to estimate the RMU. This would make the RMU metric more accessible to users unfamiliar with Bayesian statistics, and easily applicable for existing Rasch measurement software in R, such as my package <span class="co">[</span><span class="ot">`easyRasch`</span><span class="co">](https://pgmj.github.io/easyRasch/index.html)</span>. Please read <span class="co">[</span><span class="ot">the preprint</span><span class="co">](https://osf.io/h54k8_v1)</span> by Bignardi and colleagues to learn how the RMU is estimated. A summary is available on pages 12-13.</span>
<span id="cb41-32"><a href="#cb41-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-33"><a href="#cb41-33" aria-hidden="true" tabindex="-1"></a>The secondary purpose is to show how to fit Rasch models, dichotomous and partial credit models (PCM), using Bayesian models with <span class="in">`brms`</span>, and make some comparisons of person and item parameters relative CML/WLE estimation. There is already an excellent paper on Bayesian Item Response Modeling <span class="co">[</span><span class="ot">@burkner_bayesian_2021</span><span class="co">]</span>, but I thought a blog post like this might still be a useful addition to learning materials available. And also an opportunity for myself to learn. This will be added to the post when I have time to work on it.</span>
<span id="cb41-34"><a href="#cb41-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-35"><a href="#cb41-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-38"><a href="#cb41-38" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb41-39"><a href="#cb41-39" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb41-40"><a href="#cb41-40" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggdist)</span>
<span id="cb41-41"><a href="#cb41-41" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(easyRasch)</span>
<span id="cb41-42"><a href="#cb41-42" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(brms)</span>
<span id="cb41-43"><a href="#cb41-43" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(qs2)</span>
<span id="cb41-44"><a href="#cb41-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-45"><a href="#cb41-45" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">789012475</span>)</span>
<span id="cb41-46"><a href="#cb41-46" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb41-47"><a href="#cb41-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-48"><a href="#cb41-48" aria-hidden="true" tabindex="-1"></a><span class="fu">## Method</span></span>
<span id="cb41-49"><a href="#cb41-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-50"><a href="#cb41-50" aria-hidden="true" tabindex="-1"></a>We won't check model fit in this initial part, as we focus on how the reliability metrics compare and how to specify Rasch models using <span class="in">`brms`</span>. Weakly informative priors are used for item parameters, borrowing from Bürkner <span class="co">[</span><span class="ot">-@burkner_bayesian_2021</span><span class="co">]</span>. We use four parallel chains with four CPU cores, each with 2000 draws of which half are warmup, resulting in 4000 post-warmup draws from the posterior distribution. In the dichotomous example, we also fit the same model with 8000 draws (code not shown below).</span>
<span id="cb41-51"><a href="#cb41-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-52"><a href="#cb41-52" aria-hidden="true" tabindex="-1"></a>I will at some point add descriptions of the comparison metrics used, and how the <span class="in">`mirt`</span> and <span class="in">`TAM`</span> packages generate plausible values. For now, I hope this will be of use as it is.</span>
<span id="cb41-53"><a href="#cb41-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-54"><a href="#cb41-54" aria-hidden="true" tabindex="-1"></a><span class="fu">## Rasch dichotomous model</span></span>
<span id="cb41-55"><a href="#cb41-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-56"><a href="#cb41-56" aria-hidden="true" tabindex="-1"></a>For this example, the <span class="in">`eRm::raschdat1`</span> dataset is used, selecting the first 20 items. The dataset has 100 respondents.</span>
<span id="cb41-57"><a href="#cb41-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-58"><a href="#cb41-58" aria-hidden="true" tabindex="-1"></a><span class="fu">### Bayesian model</span></span>
<span id="cb41-59"><a href="#cb41-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-60"><a href="#cb41-60" aria-hidden="true" tabindex="-1"></a>We need the dataset in long form for <span class="in">`brms`</span>.</span>
<span id="cb41-61"><a href="#cb41-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-64"><a href="#cb41-64" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb41-65"><a href="#cb41-65" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb41-66"><a href="#cb41-66" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: show</span></span>
<span id="cb41-67"><a href="#cb41-67" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> eRm<span class="sc">::</span>raschdat1[,<span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>] <span class="sc">%&gt;%</span></span>
<span id="cb41-68"><a href="#cb41-68" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>(<span class="st">"id"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb41-69"><a href="#cb41-69" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">!</span>id, <span class="at">names_to =</span> <span class="st">"item"</span>, <span class="at">values_to =</span> <span class="st">"response"</span>)</span>
<span id="cb41-70"><a href="#cb41-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-71"><a href="#cb41-71" aria-hidden="true" tabindex="-1"></a>rasch_prior <span class="ot">&lt;-</span> <span class="fu">prior</span>(<span class="st">"normal(0, 3)"</span>, <span class="at">class =</span> <span class="st">"sd"</span>, <span class="at">group =</span> <span class="st">"id"</span>) <span class="sc">+</span></span>
<span id="cb41-72"><a href="#cb41-72" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prior</span>(<span class="st">"normal(0, 3)"</span>, <span class="at">class =</span> <span class="st">"sd"</span>, <span class="at">group =</span> <span class="st">"item"</span>)</span>
<span id="cb41-73"><a href="#cb41-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-74"><a href="#cb41-74" aria-hidden="true" tabindex="-1"></a>brms_rasch <span class="ot">&lt;-</span> <span class="fu">brm</span>(</span>
<span id="cb41-75"><a href="#cb41-75" aria-hidden="true" tabindex="-1"></a>  response <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> item) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> id),</span>
<span id="cb41-76"><a href="#cb41-76" aria-hidden="true" tabindex="-1"></a>  <span class="at">data    =</span> df,</span>
<span id="cb41-77"><a href="#cb41-77" aria-hidden="true" tabindex="-1"></a>  <span class="at">prior =</span> rasch_prior,</span>
<span id="cb41-78"><a href="#cb41-78" aria-hidden="true" tabindex="-1"></a>  <span class="at">chains  =</span> <span class="dv">4</span>,</span>
<span id="cb41-79"><a href="#cb41-79" aria-hidden="true" tabindex="-1"></a>  <span class="at">cores   =</span> <span class="dv">4</span>,</span>
<span id="cb41-80"><a href="#cb41-80" aria-hidden="true" tabindex="-1"></a>  <span class="at">iter =</span> <span class="dv">2000</span>,</span>
<span id="cb41-81"><a href="#cb41-81" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="st">"bernoulli"</span></span>
<span id="cb41-82"><a href="#cb41-82" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb41-83"><a href="#cb41-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-84"><a href="#cb41-84" aria-hidden="true" tabindex="-1"></a><span class="fu">qs_save</span>(brms_rasch, <span class="at">file =</span> <span class="st">"brms_rasch4000.qs2"</span>,<span class="at">compress_level =</span> <span class="dv">11</span>)</span>
<span id="cb41-85"><a href="#cb41-85" aria-hidden="true" tabindex="-1"></a><span class="fu">qs_save</span>(brms_rasch2, <span class="at">file =</span> <span class="st">"brms_rasch8000.qs2"</span>,<span class="at">compress_level =</span> <span class="dv">13</span>)</span>
<span id="cb41-86"><a href="#cb41-86" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb41-87"><a href="#cb41-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-88"><a href="#cb41-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-91"><a href="#cb41-91" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb41-92"><a href="#cb41-92" aria-hidden="true" tabindex="-1"></a>brms_rasch8000 <span class="ot">&lt;-</span> <span class="fu">qs_read</span>(<span class="st">"brms_rasch8000.qs2"</span>)</span>
<span id="cb41-93"><a href="#cb41-93" aria-hidden="true" tabindex="-1"></a>brms_rasch4000 <span class="ot">&lt;-</span> <span class="fu">qs_read</span>(<span class="st">"brms_rasch4000.qs2"</span>)</span>
<span id="cb41-94"><a href="#cb41-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-95"><a href="#cb41-95" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(brms_rasch)</span></span>
<span id="cb41-96"><a href="#cb41-96" aria-hidden="true" tabindex="-1"></a><span class="co"># loo(brms_rasch)</span></span>
<span id="cb41-97"><a href="#cb41-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-98"><a href="#cb41-98" aria-hidden="true" tabindex="-1"></a>posterior_draws_rm4000 <span class="ot">=</span> brms_rasch4000 <span class="sc">%&gt;%</span></span>
<span id="cb41-99"><a href="#cb41-99" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_draws_df</span>() <span class="sc">%&gt;%</span></span>
<span id="cb41-100"><a href="#cb41-100" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">starts_with</span>(<span class="st">"r_id"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb41-101"><a href="#cb41-101" aria-hidden="true" tabindex="-1"></a>  <span class="fu">t</span>()</span>
<span id="cb41-102"><a href="#cb41-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-103"><a href="#cb41-103" aria-hidden="true" tabindex="-1"></a>posterior_draws_rm8000 <span class="ot">=</span> brms_rasch8000 <span class="sc">%&gt;%</span></span>
<span id="cb41-104"><a href="#cb41-104" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_draws_df</span>() <span class="sc">%&gt;%</span></span>
<span id="cb41-105"><a href="#cb41-105" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">starts_with</span>(<span class="st">"r_id"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb41-106"><a href="#cb41-106" aria-hidden="true" tabindex="-1"></a>  <span class="fu">t</span>()</span>
<span id="cb41-107"><a href="#cb41-107" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb41-108"><a href="#cb41-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-109"><a href="#cb41-109" aria-hidden="true" tabindex="-1"></a>4000 draws:</span>
<span id="cb41-112"><a href="#cb41-112" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb41-113"><a href="#cb41-113" aria-hidden="true" tabindex="-1"></a><span class="fu">RMUreliability</span>(posterior_draws_rm4000)</span>
<span id="cb41-114"><a href="#cb41-114" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb41-115"><a href="#cb41-115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-116"><a href="#cb41-116" aria-hidden="true" tabindex="-1"></a>8000 draws:</span>
<span id="cb41-119"><a href="#cb41-119" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb41-120"><a href="#cb41-120" aria-hidden="true" tabindex="-1"></a><span class="fu">RMUreliability</span>(posterior_draws_rm8000)</span>
<span id="cb41-121"><a href="#cb41-121" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb41-122"><a href="#cb41-122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-123"><a href="#cb41-123" aria-hidden="true" tabindex="-1"></a><span class="fu">### Plausible values</span></span>
<span id="cb41-124"><a href="#cb41-124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-125"><a href="#cb41-125" aria-hidden="true" tabindex="-1"></a>As seen in the code below, I did some simple timing tests to compare the performance of <span class="in">`TAM`</span> and <span class="in">`mirt`</span> packages, where the latter has options in how to estimate thetas (latent scores) used for generating the plausible values (not available in <span class="in">`TAM`</span>). Since WLE is generally considered to have the lowest bias <span class="co">[</span><span class="ot">@kreiner_specific_2025</span><span class="co">]</span>, this is the default choice in the <span class="in">`RIreliability()`</span> function, dubbed WLE-RMU.</span>
<span id="cb41-126"><a href="#cb41-126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-129"><a href="#cb41-129" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb41-130"><a href="#cb41-130" aria-hidden="true" tabindex="-1"></a><span class="co"># defining a separate function for RIreliability to use in this post, in case I make changes later on in the easyRasch package</span></span>
<span id="cb41-131"><a href="#cb41-131" aria-hidden="true" tabindex="-1"></a>RIreliability3 <span class="ot">&lt;-</span> <span class="cf">function</span>(data, <span class="at">conf_int =</span> .<span class="dv">95</span>, <span class="at">draws =</span> <span class="dv">1000</span>, <span class="at">estim =</span> <span class="st">"WLE"</span>, <span class="at">boot =</span> <span class="cn">FALSE</span>, <span class="at">cpu =</span> <span class="dv">4</span>, <span class="at">pv =</span> <span class="st">"mirt"</span>) {</span>
<span id="cb41-132"><a href="#cb41-132" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb41-133"><a href="#cb41-133" aria-hidden="true" tabindex="-1"></a>  <span class="fu">message</span>(<span class="st">"Note that PSI is calculated with max/min scoring individuals excluded."</span>)</span>
<span id="cb41-134"><a href="#cb41-134" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb41-135"><a href="#cb41-135" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">min</span>(<span class="fu">as.matrix</span>(data), <span class="at">na.rm =</span> T) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb41-136"><a href="#cb41-136" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stop</span>(<span class="st">"The lowest response category needs to coded as 0. Please recode your data."</span>)</span>
<span id="cb41-137"><a href="#cb41-137" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span>(<span class="fu">max</span>(<span class="fu">as.matrix</span>(data), <span class="at">na.rm =</span> T) <span class="sc">==</span> <span class="dv">1</span>) {</span>
<span id="cb41-138"><a href="#cb41-138" aria-hidden="true" tabindex="-1"></a>    model <span class="ot">&lt;-</span> <span class="st">"RM"</span></span>
<span id="cb41-139"><a href="#cb41-139" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span>(<span class="fu">max</span>(<span class="fu">as.matrix</span>(data), <span class="at">na.rm =</span> T) <span class="sc">&gt;</span> <span class="dv">1</span>) {</span>
<span id="cb41-140"><a href="#cb41-140" aria-hidden="true" tabindex="-1"></a>    model <span class="ot">&lt;-</span> <span class="st">"PCM"</span></span>
<span id="cb41-141"><a href="#cb41-141" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb41-142"><a href="#cb41-142" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb41-143"><a href="#cb41-143" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (model <span class="sc">==</span> <span class="st">"PCM"</span>) {</span>
<span id="cb41-144"><a href="#cb41-144" aria-hidden="true" tabindex="-1"></a>    mirt_out <span class="ot">&lt;-</span> <span class="fu">mirt</span>(</span>
<span id="cb41-145"><a href="#cb41-145" aria-hidden="true" tabindex="-1"></a>      data,</span>
<span id="cb41-146"><a href="#cb41-146" aria-hidden="true" tabindex="-1"></a>      <span class="at">model =</span> <span class="dv">1</span>,</span>
<span id="cb41-147"><a href="#cb41-147" aria-hidden="true" tabindex="-1"></a>      <span class="at">itemtype =</span> <span class="st">"Rasch"</span>,</span>
<span id="cb41-148"><a href="#cb41-148" aria-hidden="true" tabindex="-1"></a>      <span class="at">verbose =</span> <span class="cn">FALSE</span>,</span>
<span id="cb41-149"><a href="#cb41-149" aria-hidden="true" tabindex="-1"></a>      <span class="at">accelerate =</span> <span class="st">"squarem"</span></span>
<span id="cb41-150"><a href="#cb41-150" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb41-151"><a href="#cb41-151" aria-hidden="true" tabindex="-1"></a>    erm_out <span class="ot">&lt;-</span> eRm<span class="sc">::</span><span class="fu">PCM</span>(data)</span>
<span id="cb41-152"><a href="#cb41-152" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (model <span class="sc">==</span> <span class="st">"RM"</span>) {</span>
<span id="cb41-153"><a href="#cb41-153" aria-hidden="true" tabindex="-1"></a>    mirt_out <span class="ot">&lt;-</span> <span class="fu">mirt</span>(</span>
<span id="cb41-154"><a href="#cb41-154" aria-hidden="true" tabindex="-1"></a>      data,</span>
<span id="cb41-155"><a href="#cb41-155" aria-hidden="true" tabindex="-1"></a>      <span class="at">model =</span> <span class="dv">1</span>,</span>
<span id="cb41-156"><a href="#cb41-156" aria-hidden="true" tabindex="-1"></a>      <span class="at">itemtype =</span> <span class="st">"1PL"</span>,</span>
<span id="cb41-157"><a href="#cb41-157" aria-hidden="true" tabindex="-1"></a>      <span class="at">verbose =</span> <span class="cn">FALSE</span>,</span>
<span id="cb41-158"><a href="#cb41-158" aria-hidden="true" tabindex="-1"></a>      <span class="at">accelerate =</span> <span class="st">"squarem"</span></span>
<span id="cb41-159"><a href="#cb41-159" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb41-160"><a href="#cb41-160" aria-hidden="true" tabindex="-1"></a>    erm_out <span class="ot">&lt;-</span> eRm<span class="sc">::</span><span class="fu">RM</span>(data)</span>
<span id="cb41-161"><a href="#cb41-161" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb41-162"><a href="#cb41-162" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb41-163"><a href="#cb41-163" aria-hidden="true" tabindex="-1"></a>  wle <span class="ot">&lt;-</span> <span class="fu">RI_iarm_person_estimates</span>(erm_out, <span class="at">properties =</span> <span class="cn">TRUE</span>)[[<span class="dv">2</span>]] <span class="sc">%&gt;%</span></span>
<span id="cb41-164"><a href="#cb41-164" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.data.frame</span>()</span>
<span id="cb41-165"><a href="#cb41-165" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames</span>(wle) <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb41-166"><a href="#cb41-166" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb41-167"><a href="#cb41-167" aria-hidden="true" tabindex="-1"></a>  empirical_rel <span class="ot">&lt;-</span> mirt<span class="sc">::</span><span class="fu">fscores</span>(mirt_out,</span>
<span id="cb41-168"><a href="#cb41-168" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">method =</span> estim,</span>
<span id="cb41-169"><a href="#cb41-169" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">theta_lim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">10</span>, <span class="dv">10</span>),</span>
<span id="cb41-170"><a href="#cb41-170" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">full.scores.SE =</span> <span class="cn">TRUE</span>,</span>
<span id="cb41-171"><a href="#cb41-171" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">verbose =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb41-172"><a href="#cb41-172" aria-hidden="true" tabindex="-1"></a>    mirt<span class="sc">::</span><span class="fu">empirical_rxx</span>()</span>
<span id="cb41-173"><a href="#cb41-173" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb41-174"><a href="#cb41-174" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (boot <span class="sc">==</span> <span class="cn">TRUE</span>) {</span>
<span id="cb41-175"><a href="#cb41-175" aria-hidden="true" tabindex="-1"></a>    <span class="fu">require</span>(doParallel)</span>
<span id="cb41-176"><a href="#cb41-176" aria-hidden="true" tabindex="-1"></a>    <span class="fu">registerDoParallel</span>(<span class="at">cores =</span> cpu)</span>
<span id="cb41-177"><a href="#cb41-177" aria-hidden="true" tabindex="-1"></a>    <span class="co"># bootstrap CI for empirical</span></span>
<span id="cb41-178"><a href="#cb41-178" aria-hidden="true" tabindex="-1"></a>    fit <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb41-179"><a href="#cb41-179" aria-hidden="true" tabindex="-1"></a>    fit <span class="ot">&lt;-</span> <span class="fu">foreach</span>(<span class="at">i =</span> <span class="dv">1</span><span class="sc">:</span>draws, <span class="at">.combine =</span> rbind) <span class="sc">%dopar%</span> {</span>
<span id="cb41-180"><a href="#cb41-180" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb41-181"><a href="#cb41-181" aria-hidden="true" tabindex="-1"></a>      dat <span class="ot">&lt;-</span> data[<span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(data), <span class="fu">nrow</span>(data), <span class="at">replace =</span> <span class="cn">TRUE</span>), ]</span>
<span id="cb41-182"><a href="#cb41-182" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb41-183"><a href="#cb41-183" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (model <span class="sc">==</span> <span class="st">"PCM"</span>) {</span>
<span id="cb41-184"><a href="#cb41-184" aria-hidden="true" tabindex="-1"></a>        mirt_out2 <span class="ot">&lt;-</span> <span class="fu">mirt</span>(</span>
<span id="cb41-185"><a href="#cb41-185" aria-hidden="true" tabindex="-1"></a>          dat,</span>
<span id="cb41-186"><a href="#cb41-186" aria-hidden="true" tabindex="-1"></a>          <span class="at">model =</span> <span class="dv">1</span>,</span>
<span id="cb41-187"><a href="#cb41-187" aria-hidden="true" tabindex="-1"></a>          <span class="at">itemtype =</span> <span class="st">"Rasch"</span>,</span>
<span id="cb41-188"><a href="#cb41-188" aria-hidden="true" tabindex="-1"></a>          <span class="at">verbose =</span> <span class="cn">FALSE</span>,</span>
<span id="cb41-189"><a href="#cb41-189" aria-hidden="true" tabindex="-1"></a>          <span class="at">accelerate =</span> <span class="st">"squarem"</span></span>
<span id="cb41-190"><a href="#cb41-190" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb41-191"><a href="#cb41-191" aria-hidden="true" tabindex="-1"></a>      } <span class="cf">else</span> <span class="cf">if</span> (model <span class="sc">==</span> <span class="st">"RM"</span>) {</span>
<span id="cb41-192"><a href="#cb41-192" aria-hidden="true" tabindex="-1"></a>        mirt_out2 <span class="ot">&lt;-</span> <span class="fu">mirt</span>(</span>
<span id="cb41-193"><a href="#cb41-193" aria-hidden="true" tabindex="-1"></a>          dat,</span>
<span id="cb41-194"><a href="#cb41-194" aria-hidden="true" tabindex="-1"></a>          <span class="at">model =</span> <span class="dv">1</span>,</span>
<span id="cb41-195"><a href="#cb41-195" aria-hidden="true" tabindex="-1"></a>          <span class="at">itemtype =</span> <span class="st">"1PL"</span>,</span>
<span id="cb41-196"><a href="#cb41-196" aria-hidden="true" tabindex="-1"></a>          <span class="at">verbose =</span> <span class="cn">FALSE</span>,</span>
<span id="cb41-197"><a href="#cb41-197" aria-hidden="true" tabindex="-1"></a>          <span class="at">accelerate =</span> <span class="st">"squarem"</span></span>
<span id="cb41-198"><a href="#cb41-198" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb41-199"><a href="#cb41-199" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb41-200"><a href="#cb41-200" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb41-201"><a href="#cb41-201" aria-hidden="true" tabindex="-1"></a>      mirt<span class="sc">::</span><span class="fu">fscores</span>(mirt_out2,</span>
<span id="cb41-202"><a href="#cb41-202" aria-hidden="true" tabindex="-1"></a>                    <span class="at">method =</span> estim,</span>
<span id="cb41-203"><a href="#cb41-203" aria-hidden="true" tabindex="-1"></a>                    <span class="at">theta_lim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">10</span>, <span class="dv">10</span>),</span>
<span id="cb41-204"><a href="#cb41-204" aria-hidden="true" tabindex="-1"></a>                    <span class="at">full.scores.SE =</span> <span class="cn">TRUE</span>,</span>
<span id="cb41-205"><a href="#cb41-205" aria-hidden="true" tabindex="-1"></a>                    <span class="at">verbose =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb41-206"><a href="#cb41-206" aria-hidden="true" tabindex="-1"></a>        mirt<span class="sc">::</span><span class="fu">empirical_rxx</span>()</span>
<span id="cb41-207"><a href="#cb41-207" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb41-208"><a href="#cb41-208" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb41-209"><a href="#cb41-209" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb41-210"><a href="#cb41-210" aria-hidden="true" tabindex="-1"></a>    emp_boot <span class="ot">&lt;-</span> <span class="fu">mean_hdci</span>(fit) <span class="sc">%&gt;%</span></span>
<span id="cb41-211"><a href="#cb41-211" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), <span class="sc">~</span> <span class="fu">round</span>(.x, <span class="dv">3</span>)))</span>
<span id="cb41-212"><a href="#cb41-212" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb41-213"><a href="#cb41-213" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb41-214"><a href="#cb41-214" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb41-215"><a href="#cb41-215" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (pv <span class="sc">==</span> <span class="st">"mirt"</span>) {</span>
<span id="cb41-216"><a href="#cb41-216" aria-hidden="true" tabindex="-1"></a>  plvals <span class="ot">&lt;-</span> mirt<span class="sc">::</span><span class="fu">fscores</span>(mirt_out, <span class="at">method =</span> estim,</span>
<span id="cb41-217"><a href="#cb41-217" aria-hidden="true" tabindex="-1"></a>                          <span class="at">theta_lim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">10</span>, <span class="dv">10</span>),</span>
<span id="cb41-218"><a href="#cb41-218" aria-hidden="true" tabindex="-1"></a>                          <span class="at">plausible.draws =</span> draws,</span>
<span id="cb41-219"><a href="#cb41-219" aria-hidden="true" tabindex="-1"></a>                          <span class="at">plausible.type =</span> <span class="st">"MH"</span>,</span>
<span id="cb41-220"><a href="#cb41-220" aria-hidden="true" tabindex="-1"></a>                          <span class="at">verbose =</span> <span class="cn">FALSE</span>)</span>
<span id="cb41-221"><a href="#cb41-221" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb41-222"><a href="#cb41-222" aria-hidden="true" tabindex="-1"></a>  rmu <span class="ot">&lt;-</span> <span class="fu">do.call</span>(cbind.data.frame, plvals) <span class="sc">%&gt;%</span></span>
<span id="cb41-223"><a href="#cb41-223" aria-hidden="true" tabindex="-1"></a>    <span class="fu">RMUreliability</span>(<span class="at">level =</span> conf_int) <span class="sc">%&gt;%</span></span>
<span id="cb41-224"><a href="#cb41-224" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), <span class="sc">~</span> <span class="fu">round</span>(.x, <span class="dv">3</span>)))</span>
<span id="cb41-225"><a href="#cb41-225" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (pv <span class="sc">==</span> <span class="st">"TAM"</span>) {</span>
<span id="cb41-226"><a href="#cb41-226" aria-hidden="true" tabindex="-1"></a>    estim <span class="ot">=</span> <span class="st">"EAP"</span></span>
<span id="cb41-227"><a href="#cb41-227" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (model <span class="sc">==</span> <span class="st">"PCM"</span>) {</span>
<span id="cb41-228"><a href="#cb41-228" aria-hidden="true" tabindex="-1"></a>    tam_out <span class="ot">&lt;-</span> TAM<span class="sc">::</span><span class="fu">tam.mml</span>(<span class="at">resp =</span> data, <span class="at">irtmodel =</span> <span class="st">"PCM"</span>, <span class="at">verbose =</span> <span class="cn">FALSE</span>)</span>
<span id="cb41-229"><a href="#cb41-229" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> <span class="cf">if</span> (model <span class="sc">==</span> <span class="st">"RM"</span>) {</span>
<span id="cb41-230"><a href="#cb41-230" aria-hidden="true" tabindex="-1"></a>    tam_out <span class="ot">&lt;-</span> TAM<span class="sc">::</span><span class="fu">tam.mml</span>(<span class="at">resp =</span> data, <span class="at">irtmodel =</span> <span class="st">"1PL"</span>, <span class="at">verbose =</span> <span class="cn">FALSE</span>)</span>
<span id="cb41-231"><a href="#cb41-231" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb41-232"><a href="#cb41-232" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb41-233"><a href="#cb41-233" aria-hidden="true" tabindex="-1"></a>    plvals <span class="ot">&lt;-</span> TAM<span class="sc">::</span><span class="fu">tam.pv</span>(tam_out, <span class="at">nplausible =</span> draws, <span class="at">verbose =</span> <span class="cn">FALSE</span>)[[<span class="st">"pv"</span>]][,<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb41-234"><a href="#cb41-234" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb41-235"><a href="#cb41-235" aria-hidden="true" tabindex="-1"></a>    rmu <span class="ot">&lt;-</span> <span class="fu">RMUreliability</span>(plvals, <span class="at">level =</span> conf_int) <span class="sc">%&gt;%</span></span>
<span id="cb41-236"><a href="#cb41-236" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), <span class="sc">~</span> <span class="fu">round</span>(.x, <span class="dv">3</span>)))</span>
<span id="cb41-237"><a href="#cb41-237" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb41-238"><a href="#cb41-238" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb41-239"><a href="#cb41-239" aria-hidden="true" tabindex="-1"></a>  <span class="fu">message</span>(<span class="fu">paste0</span>(<span class="st">"RMU reliability estimates based on "</span>,draws,<span class="st">" posterior draws (plausible values) from "</span>,<span class="fu">nrow</span>(data),<span class="st">" respondents."</span>,</span>
<span id="cb41-240"><a href="#cb41-240" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"</span><span class="sc">\n</span><span class="st">See Bignardi, Kievit, &amp; Bürkner (2025). 'A general method for estimating reliability using Bayesian Measurement Uncertainty' for details. "</span>,</span>
<span id="cb41-241"><a href="#cb41-241" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"The procedure has been modified in `easyRasch` to use plausible values based on an MML estimated Rasch model."</span>))</span>
<span id="cb41-242"><a href="#cb41-242" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb41-243"><a href="#cb41-243" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (boot <span class="sc">==</span> <span class="cn">TRUE</span>) {</span>
<span id="cb41-244"><a href="#cb41-244" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb41-245"><a href="#cb41-245" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">WLE =</span> wle,</span>
<span id="cb41-246"><a href="#cb41-246" aria-hidden="true" tabindex="-1"></a>                <span class="at">PSI =</span> eRm<span class="sc">::</span><span class="fu">person.parameter</span>(erm_out) <span class="sc">%&gt;%</span> eRm<span class="sc">::</span><span class="fu">SepRel</span>(),</span>
<span id="cb41-247"><a href="#cb41-247" aria-hidden="true" tabindex="-1"></a>                <span class="at">Empirical =</span> <span class="fu">paste0</span>(estim,<span class="st">"_empirical = "</span>,<span class="fu">round</span>(empirical_rel,<span class="dv">3</span>)),</span>
<span id="cb41-248"><a href="#cb41-248" aria-hidden="true" tabindex="-1"></a>                <span class="at">Empirical_bootstrap =</span> <span class="fu">paste0</span>(estim,<span class="st">"_empirical = "</span>,emp_boot<span class="sc">$</span>y,<span class="st">" (95% HDCI ["</span>,emp_boot<span class="sc">$</span>ymin,<span class="st">", "</span>,emp_boot<span class="sc">$</span>ymax,<span class="st">"]) ("</span>,draws,<span class="st">" bootstrap resamples)"</span>),</span>
<span id="cb41-249"><a href="#cb41-249" aria-hidden="true" tabindex="-1"></a>                <span class="at">RMU =</span> <span class="fu">paste0</span>(estim,<span class="st">"-RMU = "</span>,rmu<span class="sc">$</span>rmu_estimate,<span class="st">" (95% HDCI ["</span>,rmu<span class="sc">$</span>hdci_lowerbound,<span class="st">", "</span>,rmu<span class="sc">$</span>hdci_upperbound,<span class="st">"]) ("</span>,draws,<span class="st">" draws) using package "</span>,pv)</span>
<span id="cb41-250"><a href="#cb41-250" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb41-251"><a href="#cb41-251" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb41-252"><a href="#cb41-252" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb41-253"><a href="#cb41-253" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">WLE =</span> wle,</span>
<span id="cb41-254"><a href="#cb41-254" aria-hidden="true" tabindex="-1"></a>                <span class="at">PSI =</span> eRm<span class="sc">::</span><span class="fu">person.parameter</span>(erm_out) <span class="sc">%&gt;%</span> eRm<span class="sc">::</span><span class="fu">SepRel</span>(),</span>
<span id="cb41-255"><a href="#cb41-255" aria-hidden="true" tabindex="-1"></a>                <span class="at">Empirical =</span> <span class="fu">paste0</span>(estim,<span class="st">"_empirical = "</span>,<span class="fu">round</span>(empirical_rel,<span class="dv">3</span>)),</span>
<span id="cb41-256"><a href="#cb41-256" aria-hidden="true" tabindex="-1"></a>                <span class="at">RMU =</span> <span class="fu">paste0</span>(estim,<span class="st">"-RMU = "</span>,rmu<span class="sc">$</span>rmu_estimate,<span class="st">" (95% HDCI ["</span>,rmu<span class="sc">$</span>hdci_lowerbound,<span class="st">", "</span>,rmu<span class="sc">$</span>hdci_upperbound,<span class="st">"]) ("</span>,draws,<span class="st">" draws) using package "</span>,pv)</span>
<span id="cb41-257"><a href="#cb41-257" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb41-258"><a href="#cb41-258" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb41-259"><a href="#cb41-259" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb41-260"><a href="#cb41-260" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb41-261"><a href="#cb41-261" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb41-262"><a href="#cb41-262" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-263"><a href="#cb41-263" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-266"><a href="#cb41-266" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb41-267"><a href="#cb41-267" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb41-268"><a href="#cb41-268" aria-hidden="true" tabindex="-1"></a>t0 <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb41-269"><a href="#cb41-269" aria-hidden="true" tabindex="-1"></a>rmu_mirt_wle4000 <span class="ot">&lt;-</span> <span class="fu">RIreliability3</span>(eRm<span class="sc">::</span>raschdat1[,<span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>], <span class="at">draws =</span> <span class="dv">4000</span>)</span>
<span id="cb41-270"><a href="#cb41-270" aria-hidden="true" tabindex="-1"></a>t1 <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb41-271"><a href="#cb41-271" aria-hidden="true" tabindex="-1"></a>t1 <span class="sc">-</span> t0 <span class="co"># 4.5s</span></span>
<span id="cb41-272"><a href="#cb41-272" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-273"><a href="#cb41-273" aria-hidden="true" tabindex="-1"></a>t0 <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb41-274"><a href="#cb41-274" aria-hidden="true" tabindex="-1"></a>rmu_mirt_eap4000 <span class="ot">&lt;-</span> <span class="fu">RIreliability3</span>(eRm<span class="sc">::</span>raschdat1[,<span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>], <span class="at">draws =</span> <span class="dv">4000</span>, <span class="at">estim =</span> <span class="st">"EAP"</span>)</span>
<span id="cb41-275"><a href="#cb41-275" aria-hidden="true" tabindex="-1"></a>t1 <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb41-276"><a href="#cb41-276" aria-hidden="true" tabindex="-1"></a>t1 <span class="sc">-</span> t0 <span class="co"># 4.1s</span></span>
<span id="cb41-277"><a href="#cb41-277" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-278"><a href="#cb41-278" aria-hidden="true" tabindex="-1"></a>t0 <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb41-279"><a href="#cb41-279" aria-hidden="true" tabindex="-1"></a>rmu_tam_eap4000 <span class="ot">&lt;-</span> <span class="fu">RIreliability3</span>(eRm<span class="sc">::</span>raschdat1[,<span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>], <span class="at">draws =</span> <span class="dv">4000</span>, <span class="at">pv =</span> <span class="st">"TAM"</span>)</span>
<span id="cb41-280"><a href="#cb41-280" aria-hidden="true" tabindex="-1"></a>t1 <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb41-281"><a href="#cb41-281" aria-hidden="true" tabindex="-1"></a>t1 <span class="sc">-</span> t0 <span class="co"># 13.9s</span></span>
<span id="cb41-282"><a href="#cb41-282" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb41-283"><a href="#cb41-283" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-284"><a href="#cb41-284" aria-hidden="true" tabindex="-1"></a>Using <span class="in">`mirt`</span>, there is not much difference between WLE and EAP, approximately 4.1s for EAP and 4.5s for WLE. <span class="in">`TAM`</span> takes quite a bit longer, at around 14s. I only did two iterations, so take this with a grain of salt.</span>
<span id="cb41-285"><a href="#cb41-285" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-288"><a href="#cb41-288" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb41-289"><a href="#cb41-289" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb41-290"><a href="#cb41-290" aria-hidden="true" tabindex="-1"></a>t0 <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb41-291"><a href="#cb41-291" aria-hidden="true" tabindex="-1"></a>rmu_mirt_wle8000 <span class="ot">&lt;-</span> <span class="fu">RIreliability3</span>(eRm<span class="sc">::</span>raschdat1[,<span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>], <span class="at">draws =</span> <span class="dv">8000</span>)</span>
<span id="cb41-292"><a href="#cb41-292" aria-hidden="true" tabindex="-1"></a>t1 <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb41-293"><a href="#cb41-293" aria-hidden="true" tabindex="-1"></a>t1 <span class="sc">-</span> t0 <span class="co"># 8.1 </span></span>
<span id="cb41-294"><a href="#cb41-294" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-295"><a href="#cb41-295" aria-hidden="true" tabindex="-1"></a>t0 <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb41-296"><a href="#cb41-296" aria-hidden="true" tabindex="-1"></a>rmu_mirt_eap8000 <span class="ot">&lt;-</span> <span class="fu">RIreliability3</span>(eRm<span class="sc">::</span>raschdat1[,<span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>], <span class="at">draws =</span> <span class="dv">8000</span>, <span class="at">estim =</span> <span class="st">"EAP"</span>)</span>
<span id="cb41-297"><a href="#cb41-297" aria-hidden="true" tabindex="-1"></a>t1 <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb41-298"><a href="#cb41-298" aria-hidden="true" tabindex="-1"></a>t1 <span class="sc">-</span> t0 <span class="co"># 8.1</span></span>
<span id="cb41-299"><a href="#cb41-299" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-300"><a href="#cb41-300" aria-hidden="true" tabindex="-1"></a>t0 <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb41-301"><a href="#cb41-301" aria-hidden="true" tabindex="-1"></a>rmu_tam_eap8000 <span class="ot">&lt;-</span> <span class="fu">RIreliability3</span>(eRm<span class="sc">::</span>raschdat1[,<span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>], <span class="at">draws =</span> <span class="dv">8000</span>, <span class="at">pv =</span> <span class="st">"TAM"</span>)</span>
<span id="cb41-302"><a href="#cb41-302" aria-hidden="true" tabindex="-1"></a>t1 <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb41-303"><a href="#cb41-303" aria-hidden="true" tabindex="-1"></a>t1 <span class="sc">-</span> t0 <span class="co"># 31s</span></span>
<span id="cb41-304"><a href="#cb41-304" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb41-305"><a href="#cb41-305" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-306"><a href="#cb41-306" aria-hidden="true" tabindex="-1"></a>With 8000 draws, WLE and EAP with <span class="in">`mirt`</span> are both at 8.1s, while <span class="in">`TAM`</span> takes about 31s.</span>
<span id="cb41-307"><a href="#cb41-307" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-308"><a href="#cb41-308" aria-hidden="true" tabindex="-1"></a><span class="fu">### Conditional reliability</span></span>
<span id="cb41-309"><a href="#cb41-309" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-310"><a href="#cb41-310" aria-hidden="true" tabindex="-1"></a>This function and its code is borrowed from a recent paper by McNeish and Dumas <span class="co">[</span><span class="ot">-@mcneish_reliability_2025</span><span class="co">]</span>. Alpha and omega are reported with 95% confidence intervals.</span>
<span id="cb41-311"><a href="#cb41-311" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-314"><a href="#cb41-314" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb41-315"><a href="#cb41-315" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb41-316"><a href="#cb41-316" aria-hidden="true" tabindex="-1"></a>RIrelRep <span class="ot">&lt;-</span> <span class="cf">function</span>(data, <span class="at">items=</span><span class="fu">c</span>(<span class="fu">names</span>(data)), <span class="at">rel=</span><span class="st">"alpha"</span>, <span class="at">missing=</span><span class="st">"NA"</span>, <span class="at">method=</span><span class="st">"CI"</span>, <span class="at">width=</span><span class="cn">NULL</span>, <span class="at">raw.low=</span><span class="cn">NULL</span>, <span class="at">raw.high=</span><span class="cn">NULL</span>)</span>
<span id="cb41-317"><a href="#cb41-317" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb41-318"><a href="#cb41-318" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> ( <span class="sc">!</span>(method<span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"CI"</span>, <span class="st">"width"</span>, <span class="st">"raw"</span>))){</span>
<span id="cb41-319"><a href="#cb41-319" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stop</span>(<span class="st">"Error:  the method input must be one of the following options: 'CI','width', or 'raw'"</span>)</span>
<span id="cb41-320"><a href="#cb41-320" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb41-321"><a href="#cb41-321" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb41-322"><a href="#cb41-322" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (method<span class="sc">==</span><span class="st">"width"</span> <span class="sc">&amp;</span> <span class="fu">is.null</span>(width)){</span>
<span id="cb41-323"><a href="#cb41-323" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stop</span>(<span class="st">"Error: method='width' requires a user-defined value in the 'width=' option"</span>)</span>
<span id="cb41-324"><a href="#cb41-324" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb41-325"><a href="#cb41-325" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb41-326"><a href="#cb41-326" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (method<span class="sc">==</span><span class="st">"raw"</span> <span class="sc">&amp;</span> (<span class="fu">is.null</span>(raw.low)<span class="sc">|</span><span class="fu">is.null</span>(raw.high))){</span>
<span id="cb41-327"><a href="#cb41-327" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stop</span>(<span class="st">"Error: method='raw' requires a user-defined values both the 'raw.low=' and 'raw.high' options"</span>)</span>
<span id="cb41-328"><a href="#cb41-328" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb41-329"><a href="#cb41-329" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb41-330"><a href="#cb41-330" aria-hidden="true" tabindex="-1"></a>  <span class="do">##recode missing data to NA for R</span></span>
<span id="cb41-331"><a href="#cb41-331" aria-hidden="true" tabindex="-1"></a>  <span class="do">##only used in Shiny app</span></span>
<span id="cb41-332"><a href="#cb41-332" aria-hidden="true" tabindex="-1"></a>  data[data <span class="sc">==</span> missing] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb41-333"><a href="#cb41-333" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb41-334"><a href="#cb41-334" aria-hidden="true" tabindex="-1"></a>  <span class="co">#subset the uploaded data to only include selected items</span></span>
<span id="cb41-335"><a href="#cb41-335" aria-hidden="true" tabindex="-1"></a>  dat<span class="ot">&lt;-</span>data[,items]</span>
<span id="cb41-336"><a href="#cb41-336" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb41-337"><a href="#cb41-337" aria-hidden="true" tabindex="-1"></a>  <span class="do">## delete any rows that are all missing to avoid errors</span></span>
<span id="cb41-338"><a href="#cb41-338" aria-hidden="true" tabindex="-1"></a>  dat<span class="ot">&lt;-</span>dat[<span class="fu">rowSums</span>(<span class="fu">is.na</span>(dat)) <span class="sc">!=</span> <span class="fu">ncol</span>(dat), ]</span>
<span id="cb41-339"><a href="#cb41-339" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb41-340"><a href="#cb41-340" aria-hidden="true" tabindex="-1"></a>  <span class="co">#fit IRT model for which sum scores are a sufficient statistic</span></span>
<span id="cb41-341"><a href="#cb41-341" aria-hidden="true" tabindex="-1"></a>  model<span class="ot">&lt;-</span>mirt<span class="sc">::</span><span class="fu">mirt</span>(<span class="at">data=</span>dat, <span class="at">itemtype=</span><span class="st">"Rasch"</span>, <span class="at">verbose=</span>F)</span>
<span id="cb41-342"><a href="#cb41-342" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb41-343"><a href="#cb41-343" aria-hidden="true" tabindex="-1"></a>  <span class="do">############</span></span>
<span id="cb41-344"><a href="#cb41-344" aria-hidden="true" tabindex="-1"></a>  <span class="co">#functions for conditional reliability</span></span>
<span id="cb41-345"><a href="#cb41-345" aria-hidden="true" tabindex="-1"></a>  <span class="co">#lifted from ggmirt package (Phillip Masurp, https://github.com/masurp/ggmirt)</span></span>
<span id="cb41-346"><a href="#cb41-346" aria-hidden="true" tabindex="-1"></a>  <span class="do">############</span></span>
<span id="cb41-347"><a href="#cb41-347" aria-hidden="true" tabindex="-1"></a>  computeItemtrace <span class="ot">&lt;-</span> <span class="cf">function</span>(pars, Theta, itemloc, <span class="at">offterm =</span> <span class="fu">matrix</span>(<span class="dv">0</span>L, <span class="dv">1</span>L, <span class="fu">length</span>(itemloc)<span class="sc">-</span><span class="dv">1</span>L),</span>
<span id="cb41-348"><a href="#cb41-348" aria-hidden="true" tabindex="-1"></a>                               CUSTOM.IND, <span class="at">pis =</span> <span class="cn">NULL</span>){</span>
<span id="cb41-349"><a href="#cb41-349" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(<span class="fu">is.null</span>(pis)){</span>
<span id="cb41-350"><a href="#cb41-350" aria-hidden="true" tabindex="-1"></a>      itemtrace <span class="ot">&lt;-</span> <span class="fu">.Call</span>(<span class="st">'computeItemTrace'</span>, pars, Theta, itemloc, offterm)</span>
<span id="cb41-351"><a href="#cb41-351" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span>(<span class="fu">length</span>(CUSTOM.IND)){</span>
<span id="cb41-352"><a href="#cb41-352" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span>(i <span class="cf">in</span> CUSTOM.IND)</span>
<span id="cb41-353"><a href="#cb41-353" aria-hidden="true" tabindex="-1"></a>          itemtrace[,itemloc[i]<span class="sc">:</span>(itemloc[i<span class="sc">+</span><span class="dv">1</span>L] <span class="sc">-</span> <span class="dv">1</span>L)] <span class="ot">&lt;-</span> <span class="fu">ProbTrace</span>(pars[[i]], <span class="at">Theta=</span>Theta)</span>
<span id="cb41-354"><a href="#cb41-354" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb41-355"><a href="#cb41-355" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb41-356"><a href="#cb41-356" aria-hidden="true" tabindex="-1"></a>      tmp_itemtrace <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">'list'</span>, <span class="fu">length</span>(pis))</span>
<span id="cb41-357"><a href="#cb41-357" aria-hidden="true" tabindex="-1"></a>      <span class="cf">for</span>(g <span class="cf">in</span> <span class="fu">seq_len</span>(<span class="fu">length</span>(pis))){</span>
<span id="cb41-358"><a href="#cb41-358" aria-hidden="true" tabindex="-1"></a>        tmp_itemtrace[[g]] <span class="ot">&lt;-</span> <span class="fu">.Call</span>(<span class="st">'computeItemTrace'</span>, pars[[g]]<span class="sc">@</span>ParObjects<span class="sc">$</span>pars, Theta, itemloc, offterm)</span>
<span id="cb41-359"><a href="#cb41-359" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span>(<span class="fu">length</span>(CUSTOM.IND)){</span>
<span id="cb41-360"><a href="#cb41-360" aria-hidden="true" tabindex="-1"></a>          <span class="cf">for</span>(i <span class="cf">in</span> CUSTOM.IND)</span>
<span id="cb41-361"><a href="#cb41-361" aria-hidden="true" tabindex="-1"></a>            tmp_itemtrace[[g]][,itemloc[i]<span class="sc">:</span>(itemloc[i<span class="sc">+</span><span class="dv">1</span>L] <span class="sc">-</span> <span class="dv">1</span>L)] <span class="ot">&lt;-</span> <span class="fu">ProbTrace</span>(pars[[g]]<span class="sc">@</span>ParObjects<span class="sc">$</span>pars[[i]], <span class="at">Theta=</span>Theta)</span>
<span id="cb41-362"><a href="#cb41-362" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb41-363"><a href="#cb41-363" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb41-364"><a href="#cb41-364" aria-hidden="true" tabindex="-1"></a>      itemtrace <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, tmp_itemtrace)</span>
<span id="cb41-365"><a href="#cb41-365" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb41-366"><a href="#cb41-366" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(itemtrace)</span>
<span id="cb41-367"><a href="#cb41-367" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb41-368"><a href="#cb41-368" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb41-369"><a href="#cb41-369" aria-hidden="true" tabindex="-1"></a>  ExtractGroupPars <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb41-370"><a href="#cb41-370" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(x<span class="sc">@</span>itemclass <span class="sc">&lt;</span> <span class="dv">0</span>L) <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">gmeans=</span><span class="dv">0</span>, <span class="at">gcov=</span><span class="fu">matrix</span>(<span class="dv">1</span>)))</span>
<span id="cb41-371"><a href="#cb41-371" aria-hidden="true" tabindex="-1"></a>    nfact <span class="ot">&lt;-</span> x<span class="sc">@</span>nfact</span>
<span id="cb41-372"><a href="#cb41-372" aria-hidden="true" tabindex="-1"></a>    gmeans <span class="ot">&lt;-</span> x<span class="sc">@</span>par[<span class="fu">seq_len</span>(nfact)]</span>
<span id="cb41-373"><a href="#cb41-373" aria-hidden="true" tabindex="-1"></a>    phi_matches <span class="ot">&lt;-</span> <span class="fu">grepl</span>(<span class="st">"PHI"</span>, x<span class="sc">@</span>parnames)</span>
<span id="cb41-374"><a href="#cb41-374" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (x<span class="sc">@</span>dentype <span class="sc">==</span> <span class="st">"Davidian"</span>) {</span>
<span id="cb41-375"><a href="#cb41-375" aria-hidden="true" tabindex="-1"></a>      phi <span class="ot">&lt;-</span> x<span class="sc">@</span>par[phi_matches]</span>
<span id="cb41-376"><a href="#cb41-376" aria-hidden="true" tabindex="-1"></a>      tmp <span class="ot">&lt;-</span> x<span class="sc">@</span>par[<span class="sc">-</span><span class="fu">c</span>(<span class="fu">seq_len</span>(nfact), <span class="fu">which</span>(phi_matches))]</span>
<span id="cb41-377"><a href="#cb41-377" aria-hidden="true" tabindex="-1"></a>      gcov <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, nfact, nfact)</span>
<span id="cb41-378"><a href="#cb41-378" aria-hidden="true" tabindex="-1"></a>      gcov[<span class="fu">lower.tri</span>(gcov, <span class="at">diag=</span><span class="cn">TRUE</span>)] <span class="ot">&lt;-</span> tmp</span>
<span id="cb41-379"><a href="#cb41-379" aria-hidden="true" tabindex="-1"></a>      gcov <span class="ot">&lt;-</span> <span class="fu">makeSymMat</span>(gcov)</span>
<span id="cb41-380"><a href="#cb41-380" aria-hidden="true" tabindex="-1"></a>      <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">gmeans=</span>gmeans, <span class="at">gcov=</span>gcov, <span class="at">phi=</span>phi))</span>
<span id="cb41-381"><a href="#cb41-381" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb41-382"><a href="#cb41-382" aria-hidden="true" tabindex="-1"></a>      par <span class="ot">&lt;-</span> x<span class="sc">@</span>par</span>
<span id="cb41-383"><a href="#cb41-383" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span>(x<span class="sc">@</span>dentype <span class="sc">==</span> <span class="st">"mixture"</span>) par <span class="ot">&lt;-</span> par[<span class="sc">-</span><span class="fu">length</span>(par)] <span class="co"># drop pi</span></span>
<span id="cb41-384"><a href="#cb41-384" aria-hidden="true" tabindex="-1"></a>      tmp <span class="ot">&lt;-</span> par[<span class="sc">-</span><span class="fu">seq_len</span>(nfact)]</span>
<span id="cb41-385"><a href="#cb41-385" aria-hidden="true" tabindex="-1"></a>      gcov <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, nfact, nfact)</span>
<span id="cb41-386"><a href="#cb41-386" aria-hidden="true" tabindex="-1"></a>      gcov[<span class="fu">lower.tri</span>(gcov, <span class="at">diag=</span><span class="cn">TRUE</span>)] <span class="ot">&lt;-</span> tmp</span>
<span id="cb41-387"><a href="#cb41-387" aria-hidden="true" tabindex="-1"></a>      gcov <span class="ot">&lt;-</span> <span class="fu">makeSymMat</span>(gcov)</span>
<span id="cb41-388"><a href="#cb41-388" aria-hidden="true" tabindex="-1"></a>      <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">gmeans=</span>gmeans, <span class="at">gcov=</span>gcov))</span>
<span id="cb41-389"><a href="#cb41-389" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb41-390"><a href="#cb41-390" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb41-391"><a href="#cb41-391" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb41-392"><a href="#cb41-392" aria-hidden="true" tabindex="-1"></a>  makeSymMat <span class="ot">&lt;-</span> <span class="cf">function</span>(mat){</span>
<span id="cb41-393"><a href="#cb41-393" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(<span class="fu">ncol</span>(mat) <span class="sc">&gt;</span> <span class="dv">1</span>L){</span>
<span id="cb41-394"><a href="#cb41-394" aria-hidden="true" tabindex="-1"></a>      mat[<span class="fu">is.na</span>(mat)] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb41-395"><a href="#cb41-395" aria-hidden="true" tabindex="-1"></a>      mat <span class="ot">&lt;-</span> mat <span class="sc">+</span> <span class="fu">t</span>(mat) <span class="sc">-</span> <span class="fu">diag</span>(<span class="fu">diag</span>(mat))</span>
<span id="cb41-396"><a href="#cb41-396" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb41-397"><a href="#cb41-397" aria-hidden="true" tabindex="-1"></a>    mat</span>
<span id="cb41-398"><a href="#cb41-398" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb41-399"><a href="#cb41-399" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb41-400"><a href="#cb41-400" aria-hidden="true" tabindex="-1"></a>  <span class="co">#compute number of sum scores and number of people with each scores</span></span>
<span id="cb41-401"><a href="#cb41-401" aria-hidden="true" tabindex="-1"></a>  f<span class="ot">&lt;-</span>mirt<span class="sc">::</span><span class="fu">fscores</span>(model,<span class="at">method=</span><span class="st">"EAPsum"</span>, <span class="at">full.scores=</span>F,<span class="at">verbose=</span>F, <span class="at">na.rm=</span><span class="cn">TRUE</span>)</span>
<span id="cb41-402"><a href="#cb41-402" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb41-403"><a href="#cb41-403" aria-hidden="true" tabindex="-1"></a>  <span class="do">## functions for computing conditional reliabilty (partially lifted for ggmirt package)</span></span>
<span id="cb41-404"><a href="#cb41-404" aria-hidden="true" tabindex="-1"></a>  nfact <span class="ot">&lt;-</span> model<span class="sc">@</span>Model<span class="sc">$</span>nfact</span>
<span id="cb41-405"><a href="#cb41-405" aria-hidden="true" tabindex="-1"></a>  J <span class="ot">&lt;-</span> model<span class="sc">@</span>Data<span class="sc">$</span>nitems</span>
<span id="cb41-406"><a href="#cb41-406" aria-hidden="true" tabindex="-1"></a>  theta <span class="ot">&lt;-</span> f<span class="sc">$</span>F1</span>
<span id="cb41-407"><a href="#cb41-407" aria-hidden="true" tabindex="-1"></a>  ThetaFull <span class="ot">&lt;-</span> Theta <span class="ot">&lt;-</span> <span class="fu">thetaComb</span>(theta, nfact)</span>
<span id="cb41-408"><a href="#cb41-408" aria-hidden="true" tabindex="-1"></a>  info <span class="ot">&lt;-</span> <span class="fu">testinfo</span>(model, ThetaFull)</span>
<span id="cb41-409"><a href="#cb41-409" aria-hidden="true" tabindex="-1"></a>  itemtrace <span class="ot">&lt;-</span> <span class="fu">computeItemtrace</span>(model<span class="sc">@</span>ParObjects<span class="sc">$</span>pars, ThetaFull, model<span class="sc">@</span>Model<span class="sc">$</span>itemloc,</span>
<span id="cb41-410"><a href="#cb41-410" aria-hidden="true" tabindex="-1"></a>                                <span class="at">CUSTOM.IND=</span>model<span class="sc">@</span>Internals<span class="sc">$</span>CUSTOM.IND)</span>
<span id="cb41-411"><a href="#cb41-411" aria-hidden="true" tabindex="-1"></a>  mins <span class="ot">&lt;-</span> model<span class="sc">@</span>Data<span class="sc">$</span>mins</span>
<span id="cb41-412"><a href="#cb41-412" aria-hidden="true" tabindex="-1"></a>  maxs <span class="ot">&lt;-</span> <span class="fu">extract.mirt</span>(model, <span class="st">'K'</span>) <span class="sc">+</span> mins <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb41-413"><a href="#cb41-413" aria-hidden="true" tabindex="-1"></a>  gp <span class="ot">&lt;-</span> <span class="fu">ExtractGroupPars</span>(model<span class="sc">@</span>ParObjects<span class="sc">$</span>pars[[J<span class="sc">+</span><span class="dv">1</span>]])</span>
<span id="cb41-414"><a href="#cb41-414" aria-hidden="true" tabindex="-1"></a>  score <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb41-415"><a href="#cb41-415" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>J)</span>
<span id="cb41-416"><a href="#cb41-416" aria-hidden="true" tabindex="-1"></a>    score <span class="ot">&lt;-</span> <span class="fu">c</span>(score, (<span class="dv">0</span><span class="sc">:</span>(model<span class="sc">@</span>Data<span class="sc">$</span>K[i]<span class="sc">-</span><span class="dv">1</span>) <span class="sc">+</span> mins[i]) <span class="sc">*</span> (i <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span>J)))</span>
<span id="cb41-417"><a href="#cb41-417" aria-hidden="true" tabindex="-1"></a>  score <span class="ot">&lt;-</span> <span class="fu">matrix</span>(score, <span class="fu">nrow</span>(itemtrace), <span class="fu">ncol</span>(itemtrace), <span class="at">byrow =</span> <span class="cn">TRUE</span>)</span>
<span id="cb41-418"><a href="#cb41-418" aria-hidden="true" tabindex="-1"></a>  plt <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">cbind</span>(info,<span class="at">score=</span><span class="fu">rowSums</span>(score<span class="sc">*</span>itemtrace),<span class="at">Theta=</span>Theta))</span>
<span id="cb41-419"><a href="#cb41-419" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colnames</span>(plt) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"info"</span>, <span class="st">"score"</span>, <span class="st">"Theta"</span>)</span>
<span id="cb41-420"><a href="#cb41-420" aria-hidden="true" tabindex="-1"></a>  plt<span class="sc">$</span>SE <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">/</span> <span class="fu">sqrt</span>(plt<span class="sc">$</span>info)</span>
<span id="cb41-421"><a href="#cb41-421" aria-hidden="true" tabindex="-1"></a>  plt<span class="sc">$</span>rxx <span class="ot">&lt;-</span> plt<span class="sc">$</span>info <span class="sc">/</span> (plt<span class="sc">$</span>info <span class="sc">+</span> <span class="dv">1</span><span class="sc">/</span>gp<span class="sc">$</span>gcov[<span class="dv">1</span>L,<span class="dv">1</span>L])</span>
<span id="cb41-422"><a href="#cb41-422" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb41-423"><a href="#cb41-423" aria-hidden="true" tabindex="-1"></a>  <span class="co">#possible sum scores in data</span></span>
<span id="cb41-424"><a href="#cb41-424" aria-hidden="true" tabindex="-1"></a>  plt<span class="sc">$</span>sum<span class="ot">&lt;-</span>f<span class="sc">$</span>Sum.Scores</span>
<span id="cb41-425"><a href="#cb41-425" aria-hidden="true" tabindex="-1"></a>  <span class="co">#number of people with each score</span></span>
<span id="cb41-426"><a href="#cb41-426" aria-hidden="true" tabindex="-1"></a>  plt<span class="sc">$</span>observed<span class="ot">&lt;-</span>f<span class="sc">$</span>observed</span>
<span id="cb41-427"><a href="#cb41-427" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb41-428"><a href="#cb41-428" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(method<span class="sc">==</span><span class="st">"CI"</span>){</span>
<span id="cb41-429"><a href="#cb41-429" aria-hidden="true" tabindex="-1"></a>    <span class="co">#compute alpha and 95% CI</span></span>
<span id="cb41-430"><a href="#cb41-430" aria-hidden="true" tabindex="-1"></a>    ci<span class="ot">&lt;-</span>Bayesrel<span class="sc">::</span><span class="fu">strel</span>(<span class="at">data=</span>dat, <span class="at">estimates=</span>rel, <span class="at">n.burnin=</span><span class="dv">5000</span>,<span class="at">n.iter=</span><span class="dv">10000</span>, <span class="at">missing=</span><span class="st">"listwise"</span>)</span>
<span id="cb41-431"><a href="#cb41-431" aria-hidden="true" tabindex="-1"></a>    low<span class="ot">&lt;-</span><span class="fu">as.numeric</span>(ci<span class="sc">$</span>Bayes<span class="sc">$</span>cred<span class="sc">$</span>low)</span>
<span id="cb41-432"><a href="#cb41-432" aria-hidden="true" tabindex="-1"></a>    upp<span class="ot">&lt;-</span><span class="fu">as.numeric</span>(ci<span class="sc">$</span>Bayes<span class="sc">$</span>cred<span class="sc">$</span>up)</span>
<span id="cb41-433"><a href="#cb41-433" aria-hidden="true" tabindex="-1"></a>    est<span class="ot">&lt;-</span><span class="fu">as.numeric</span>(ci<span class="sc">$</span>Bayes<span class="sc">$</span>est)</span>
<span id="cb41-434"><a href="#cb41-434" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb41-435"><a href="#cb41-435" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb41-436"><a href="#cb41-436" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(method<span class="sc">==</span><span class="st">"width"</span>){</span>
<span id="cb41-437"><a href="#cb41-437" aria-hidden="true" tabindex="-1"></a>    ci<span class="ot">&lt;-</span>Bayesrel<span class="sc">::</span><span class="fu">strel</span>(<span class="at">data=</span>dat, <span class="at">estimates=</span>rel, <span class="at">n.burnin=</span><span class="dv">5000</span>,<span class="at">n.iter=</span><span class="dv">10000</span>, <span class="at">missing=</span><span class="st">"listwise"</span>)</span>
<span id="cb41-438"><a href="#cb41-438" aria-hidden="true" tabindex="-1"></a>    est<span class="ot">&lt;-</span><span class="fu">as.numeric</span>(ci<span class="sc">$</span>Bayes<span class="sc">$</span>est)</span>
<span id="cb41-439"><a href="#cb41-439" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb41-440"><a href="#cb41-440" aria-hidden="true" tabindex="-1"></a>    low<span class="ot">&lt;-</span>est<span class="sc">-</span>width</span>
<span id="cb41-441"><a href="#cb41-441" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(low<span class="sc">&lt;</span><span class="dv">0</span>){</span>
<span id="cb41-442"><a href="#cb41-442" aria-hidden="true" tabindex="-1"></a>      low<span class="ot">&lt;-</span><span class="dv">0</span></span>
<span id="cb41-443"><a href="#cb41-443" aria-hidden="true" tabindex="-1"></a>      <span class="fu">warning</span>(</span>
<span id="cb41-444"><a href="#cb41-444" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Warning: The 'width =' value implies an interval lower bound below 0.</span></span>
<span id="cb41-445"><a href="#cb41-445" aria-hidden="true" tabindex="-1"></a><span class="st">         The lower bound has been replaced with 0.</span></span>
<span id="cb41-446"><a href="#cb41-446" aria-hidden="true" tabindex="-1"></a><span class="st">         Check that your width was accurately entered"</span>, <span class="at">immediate.=</span>T)</span>
<span id="cb41-447"><a href="#cb41-447" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb41-448"><a href="#cb41-448" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb41-449"><a href="#cb41-449" aria-hidden="true" tabindex="-1"></a>    upp<span class="ot">&lt;-</span>est<span class="sc">+</span>width</span>
<span id="cb41-450"><a href="#cb41-450" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb41-451"><a href="#cb41-451" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (upp<span class="sc">&gt;</span><span class="dv">1</span>) {</span>
<span id="cb41-452"><a href="#cb41-452" aria-hidden="true" tabindex="-1"></a>      upp<span class="ot">&lt;-</span><span class="dv">1</span></span>
<span id="cb41-453"><a href="#cb41-453" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb41-454"><a href="#cb41-454" aria-hidden="true" tabindex="-1"></a>      <span class="fu">warning</span>(</span>
<span id="cb41-455"><a href="#cb41-455" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Warning: The 'width =' value implies an interval upper bound above 1.</span></span>
<span id="cb41-456"><a href="#cb41-456" aria-hidden="true" tabindex="-1"></a><span class="st">       The upper bound has been replaced with 1.</span></span>
<span id="cb41-457"><a href="#cb41-457" aria-hidden="true" tabindex="-1"></a><span class="st">       Check that your width was accurately entered"</span>, <span class="at">immediate.=</span>T)</span>
<span id="cb41-458"><a href="#cb41-458" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb41-459"><a href="#cb41-459" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb41-460"><a href="#cb41-460" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb41-461"><a href="#cb41-461" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb41-462"><a href="#cb41-462" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(method<span class="sc">==</span><span class="st">"raw"</span>){</span>
<span id="cb41-463"><a href="#cb41-463" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb41-464"><a href="#cb41-464" aria-hidden="true" tabindex="-1"></a>    low<span class="ot">&lt;-</span>raw.low</span>
<span id="cb41-465"><a href="#cb41-465" aria-hidden="true" tabindex="-1"></a>    upp<span class="ot">&lt;-</span>raw.high</span>
<span id="cb41-466"><a href="#cb41-466" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb41-467"><a href="#cb41-467" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(upp<span class="sc">&gt;</span><span class="dv">1</span>) {</span>
<span id="cb41-468"><a href="#cb41-468" aria-hidden="true" tabindex="-1"></a>      <span class="fu">stop</span>(</span>
<span id="cb41-469"><a href="#cb41-469" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Error: The 'raw.high =' option exceeds 1.</span></span>
<span id="cb41-470"><a href="#cb41-470" aria-hidden="true" tabindex="-1"></a><span class="st">             Check that your width was accurately entered"</span>)</span>
<span id="cb41-471"><a href="#cb41-471" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb41-472"><a href="#cb41-472" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb41-473"><a href="#cb41-473" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (low<span class="sc">&lt;</span><span class="dv">0</span>) {</span>
<span id="cb41-474"><a href="#cb41-474" aria-hidden="true" tabindex="-1"></a>      <span class="fu">stop</span>(</span>
<span id="cb41-475"><a href="#cb41-475" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Error: The 'low =' option is below 0.</span></span>
<span id="cb41-476"><a href="#cb41-476" aria-hidden="true" tabindex="-1"></a><span class="st">             Check that your width was accurately entered"</span>)</span>
<span id="cb41-477"><a href="#cb41-477" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb41-478"><a href="#cb41-478" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb41-479"><a href="#cb41-479" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> ((raw.low<span class="sc">&gt;</span>raw.high <span class="sc">|</span> raw.low<span class="sc">==</span>raw.high)) {</span>
<span id="cb41-480"><a href="#cb41-480" aria-hidden="true" tabindex="-1"></a>      <span class="fu">stop</span>(</span>
<span id="cb41-481"><a href="#cb41-481" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Error: The interval lower bound exceeds the interval upper bound.</span></span>
<span id="cb41-482"><a href="#cb41-482" aria-hidden="true" tabindex="-1"></a><span class="st">                 Check that your width was accurately entered"</span>)</span>
<span id="cb41-483"><a href="#cb41-483" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb41-484"><a href="#cb41-484" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb41-485"><a href="#cb41-485" aria-hidden="true" tabindex="-1"></a>    ci<span class="ot">&lt;-</span>Bayesrel<span class="sc">::</span><span class="fu">strel</span>(<span class="at">data=</span>dat, <span class="at">estimates=</span>rel, <span class="at">n.burnin=</span><span class="dv">5000</span>,<span class="at">n.iter=</span><span class="dv">10000</span>, <span class="at">missing=</span><span class="st">"listwise"</span>)</span>
<span id="cb41-486"><a href="#cb41-486" aria-hidden="true" tabindex="-1"></a>    est<span class="ot">&lt;-</span><span class="fu">as.numeric</span>(ci<span class="sc">$</span>Bayes<span class="sc">$</span>est)</span>
<span id="cb41-487"><a href="#cb41-487" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb41-488"><a href="#cb41-488" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb41-489"><a href="#cb41-489" aria-hidden="true" tabindex="-1"></a>  <span class="co">#percentage within CI, above CI, and below CI</span></span>
<span id="cb41-490"><a href="#cb41-490" aria-hidden="true" tabindex="-1"></a>  plt<span class="sc">$</span>within<span class="ot">&lt;-</span><span class="fu">ifelse</span>(low <span class="sc">&lt;</span> plt<span class="sc">$</span>rxx <span class="sc">&amp;</span> plt<span class="sc">$</span>rxx <span class="sc">&lt;</span> upp, <span class="dv">1</span>,<span class="dv">0</span>)</span>
<span id="cb41-491"><a href="#cb41-491" aria-hidden="true" tabindex="-1"></a>  plt<span class="sc">$</span>above<span class="ot">&lt;-</span><span class="fu">ifelse</span>(upp <span class="sc">&lt;</span> plt<span class="sc">$</span>rxx, <span class="dv">1</span>,<span class="dv">0</span>)</span>
<span id="cb41-492"><a href="#cb41-492" aria-hidden="true" tabindex="-1"></a>  plt<span class="sc">$</span>below<span class="ot">&lt;-</span><span class="fu">ifelse</span>(plt<span class="sc">$</span>rxx <span class="sc">&lt;</span> low, <span class="dv">1</span>,<span class="dv">0</span>)</span>
<span id="cb41-493"><a href="#cb41-493" aria-hidden="true" tabindex="-1"></a>  people<span class="ot">&lt;-</span><span class="fu">round</span>(<span class="dv">100</span><span class="sc">*</span><span class="fu">apply</span>(plt[,<span class="fu">c</span>(<span class="st">"within"</span>,<span class="st">"above"</span>,<span class="st">"below"</span>)], <span class="dv">2</span>, weighted.mean, <span class="at">w=</span>plt<span class="sc">$</span>observed),<span class="dv">2</span>)</span>
<span id="cb41-494"><a href="#cb41-494" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb41-495"><a href="#cb41-495" aria-hidden="true" tabindex="-1"></a>  <span class="co">#used for plot legend</span></span>
<span id="cb41-496"><a href="#cb41-496" aria-hidden="true" tabindex="-1"></a>  alpha <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">yintercept=</span>est, <span class="at">Lines=</span><span class="fu">str_to_title</span>(rel))</span>
<span id="cb41-497"><a href="#cb41-497" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(method<span class="sc">==</span><span class="st">"CI"</span>){</span>
<span id="cb41-498"><a href="#cb41-498" aria-hidden="true" tabindex="-1"></a>    CI <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">yintercept=</span>low, <span class="at">Lines=</span><span class="fu">paste</span>(<span class="fu">str_to_title</span>(rel),<span class="st">'95% CI'</span>))</span>
<span id="cb41-499"><a href="#cb41-499" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb41-500"><a href="#cb41-500" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb41-501"><a href="#cb41-501" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(method<span class="sc">!=</span><span class="st">"CI"</span>){</span>
<span id="cb41-502"><a href="#cb41-502" aria-hidden="true" tabindex="-1"></a>    CI <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">yintercept=</span>low, <span class="at">Lines=</span><span class="st">'Test Interval'</span>)</span>
<span id="cb41-503"><a href="#cb41-503" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb41-504"><a href="#cb41-504" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb41-505"><a href="#cb41-505" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb41-506"><a href="#cb41-506" aria-hidden="true" tabindex="-1"></a>  <span class="co">#plot</span></span>
<span id="cb41-507"><a href="#cb41-507" aria-hidden="true" tabindex="-1"></a>  <span class="co">#conditional reliability, weighted by number of responses</span></span>
<span id="cb41-508"><a href="#cb41-508" aria-hidden="true" tabindex="-1"></a>  <span class="co">#with alpha and 95% CI</span></span>
<span id="cb41-509"><a href="#cb41-509" aria-hidden="true" tabindex="-1"></a>  <span class="co">#x axis is sum score, not theta score</span></span>
<span id="cb41-510"><a href="#cb41-510" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb41-511"><a href="#cb41-511" aria-hidden="true" tabindex="-1"></a>  p<span class="ot">&lt;-</span><span class="fu">ggplot</span>(plt, <span class="fu">aes</span>(<span class="at">x =</span> sum, <span class="at">y =</span> rxx)) <span class="sc">+</span></span>
<span id="cb41-512"><a href="#cb41-512" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">color =</span> (observed<span class="sc">+</span><span class="dv">1</span>)),<span class="at">lwd=</span><span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb41-513"><a href="#cb41-513" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_colour_gradient</span>(<span class="st">"People at Score"</span>,<span class="at">high =</span><span class="st">"#009ca6"</span>,<span class="at">low=</span><span class="st">"sienna1"</span>)<span class="sc">+</span> <span class="co">#low = "#fff7dd", high = "#009ca6"</span></span>
<span id="cb41-514"><a href="#cb41-514" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb41-515"><a href="#cb41-515" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>(<span class="at">base_size=</span><span class="dv">16</span>)<span class="sc">+</span></span>
<span id="cb41-516"><a href="#cb41-516" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept=</span>upp, <span class="at">linetype=</span><span class="st">"dotted"</span>, <span class="at">lwd=</span>.<span class="dv">5</span>)<span class="sc">+</span></span>
<span id="cb41-517"><a href="#cb41-517" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="fu">aes</span>(<span class="at">yintercept=</span>yintercept,  <span class="at">linetype=</span>Lines), CI, <span class="at">lwd=</span>.<span class="dv">5</span>)<span class="sc">+</span></span>
<span id="cb41-518"><a href="#cb41-518" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="fu">aes</span>(<span class="at">yintercept=</span>yintercept,  <span class="at">linetype=</span>Lines), alpha, <span class="at">lwd=</span>.<span class="dv">5</span>)<span class="sc">+</span></span>
<span id="cb41-519"><a href="#cb41-519" aria-hidden="true" tabindex="-1"></a>    <span class="fu">xlab</span>(<span class="st">"Sum Score"</span>) <span class="sc">+</span></span>
<span id="cb41-520"><a href="#cb41-520" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylab</span>(<span class="fu">paste</span>(<span class="st">"Reliability (Cronbach's alpha)"</span>))</span>
<span id="cb41-521"><a href="#cb41-521" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb41-522"><a href="#cb41-522" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb41-523"><a href="#cb41-523" aria-hidden="true" tabindex="-1"></a>  <span class="co">#print alpha and percentages in console</span></span>
<span id="cb41-524"><a href="#cb41-524" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb41-525"><a href="#cb41-525" aria-hidden="true" tabindex="-1"></a>  base<span class="sc">::</span><span class="fu">cat</span>(<span class="fu">paste0</span>(<span class="st">"Coefficient "</span>, <span class="fu">str_to_title</span>(rel),<span class="st">":                  "</span>, <span class="fu">format</span>(<span class="fu">round</span>(est,<span class="dv">2</span>),<span class="at">nsmall=</span><span class="dv">2</span>)))</span>
<span id="cb41-526"><a href="#cb41-526" aria-hidden="true" tabindex="-1"></a>  base<span class="sc">::</span><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb41-527"><a href="#cb41-527" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb41-528"><a href="#cb41-528" aria-hidden="true" tabindex="-1"></a>  base<span class="sc">::</span><span class="fu">cat</span>(<span class="fu">paste0</span>(<span class="st">"Coefficient "</span>, <span class="fu">str_to_title</span>(rel), <span class="st">" 95% CI:          "</span>, <span class="st">"["</span>,<span class="fu">round</span>(low,<span class="dv">2</span>),<span class="st">","</span>,<span class="fu">round</span>(upp,<span class="dv">2</span>),<span class="st">"]"</span>))</span>
<span id="cb41-529"><a href="#cb41-529" aria-hidden="true" tabindex="-1"></a>  base<span class="sc">::</span><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb41-530"><a href="#cb41-530" aria-hidden="true" tabindex="-1"></a>  base<span class="sc">::</span><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb41-531"><a href="#cb41-531" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb41-532"><a href="#cb41-532" aria-hidden="true" tabindex="-1"></a>  base<span class="sc">::</span><span class="fu">cat</span>(<span class="fu">paste0</span>(<span class="st">"People above "</span>, <span class="fu">str_to_title</span>(rel),<span class="st">" interval:    "</span>))</span>
<span id="cb41-533"><a href="#cb41-533" aria-hidden="true" tabindex="-1"></a>  base<span class="sc">::</span><span class="fu">cat</span>(<span class="fu">paste0</span>(<span class="fu">unname</span>(people[<span class="dv">2</span>]),<span class="st">"%"</span>))</span>
<span id="cb41-534"><a href="#cb41-534" aria-hidden="true" tabindex="-1"></a>  base<span class="sc">::</span><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb41-535"><a href="#cb41-535" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb41-536"><a href="#cb41-536" aria-hidden="true" tabindex="-1"></a>  base<span class="sc">::</span><span class="fu">cat</span>(<span class="fu">paste0</span>(<span class="st">"People within "</span>, <span class="fu">str_to_title</span>(rel),<span class="st">" interval   :    "</span>))</span>
<span id="cb41-537"><a href="#cb41-537" aria-hidden="true" tabindex="-1"></a>  base<span class="sc">::</span><span class="fu">cat</span>(<span class="fu">paste0</span>(<span class="fu">unname</span>(people[<span class="dv">1</span>]),<span class="st">"%"</span>))</span>
<span id="cb41-538"><a href="#cb41-538" aria-hidden="true" tabindex="-1"></a>  base<span class="sc">::</span><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb41-539"><a href="#cb41-539" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb41-540"><a href="#cb41-540" aria-hidden="true" tabindex="-1"></a>  base<span class="sc">::</span><span class="fu">cat</span>(<span class="fu">paste0</span>(<span class="st">"People below  "</span>, <span class="fu">str_to_title</span>(rel), <span class="st">" interval:    "</span>))</span>
<span id="cb41-541"><a href="#cb41-541" aria-hidden="true" tabindex="-1"></a>  base<span class="sc">::</span><span class="fu">cat</span>(<span class="fu">paste0</span>(<span class="fu">unname</span>(people[<span class="dv">3</span>]),<span class="st">"%"</span>))</span>
<span id="cb41-542"><a href="#cb41-542" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb41-543"><a href="#cb41-543" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb41-544"><a href="#cb41-544" aria-hidden="true" tabindex="-1"></a>  <span class="do">##Save a table for Shiny</span></span>
<span id="cb41-545"><a href="#cb41-545" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(method<span class="sc">==</span><span class="st">"CI"</span>){</span>
<span id="cb41-546"><a href="#cb41-546" aria-hidden="true" tabindex="-1"></a>    y<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="fu">paste0</span>(<span class="st">"Coefficient "</span>,<span class="fu">str_to_title</span>(rel),<span class="st">":"</span>),<span class="fu">paste0</span>(<span class="st">"Coefficient "</span>, <span class="fu">str_to_title</span>(rel), <span class="st">" 95% CI:"</span>), <span class="st">" "</span>,</span>
<span id="cb41-547"><a href="#cb41-547" aria-hidden="true" tabindex="-1"></a>         <span class="fu">paste0</span>(<span class="st">"People above "</span>, <span class="fu">str_to_title</span>(rel),<span class="st">" interval:"</span>),</span>
<span id="cb41-548"><a href="#cb41-548" aria-hidden="true" tabindex="-1"></a>         <span class="fu">paste0</span>(<span class="st">"People within "</span>, <span class="fu">str_to_title</span>(rel),<span class="st">" interval:"</span>),</span>
<span id="cb41-549"><a href="#cb41-549" aria-hidden="true" tabindex="-1"></a>         <span class="fu">paste0</span>(<span class="st">"People below "</span>, <span class="fu">str_to_title</span>(rel),<span class="st">" interval :"</span>),</span>
<span id="cb41-550"><a href="#cb41-550" aria-hidden="true" tabindex="-1"></a>         <span class="fu">format</span>(<span class="fu">round</span>(est,<span class="dv">2</span>),<span class="at">nsmall=</span><span class="dv">2</span>),</span>
<span id="cb41-551"><a href="#cb41-551" aria-hidden="true" tabindex="-1"></a>         <span class="fu">paste0</span>(<span class="st">"["</span>,<span class="fu">format</span>(<span class="fu">round</span>(low,<span class="dv">2</span>),<span class="at">nsmall=</span><span class="dv">2</span>),<span class="st">","</span>,<span class="fu">format</span>(<span class="fu">round</span>(upp,<span class="dv">2</span>),<span class="at">nsmall=</span><span class="dv">2</span>),<span class="st">"]"</span>),</span>
<span id="cb41-552"><a href="#cb41-552" aria-hidden="true" tabindex="-1"></a>         <span class="st">" "</span>,</span>
<span id="cb41-553"><a href="#cb41-553" aria-hidden="true" tabindex="-1"></a>         <span class="fu">paste0</span>(<span class="fu">unname</span>(people[<span class="dv">2</span>]),<span class="st">"%"</span>),</span>
<span id="cb41-554"><a href="#cb41-554" aria-hidden="true" tabindex="-1"></a>         <span class="fu">paste0</span>(<span class="fu">unname</span>(people[<span class="dv">1</span>]),<span class="st">"%"</span>),</span>
<span id="cb41-555"><a href="#cb41-555" aria-hidden="true" tabindex="-1"></a>         <span class="fu">paste0</span>(<span class="fu">unname</span>(people[<span class="dv">3</span>]),<span class="st">"%"</span>))</span>
<span id="cb41-556"><a href="#cb41-556" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb41-557"><a href="#cb41-557" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb41-558"><a href="#cb41-558" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(method<span class="sc">!=</span><span class="st">"CI"</span>){</span>
<span id="cb41-559"><a href="#cb41-559" aria-hidden="true" tabindex="-1"></a>    y<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="fu">paste0</span>(<span class="st">"Coefficient "</span>,<span class="fu">str_to_title</span>(rel),<span class="st">":"</span>),<span class="fu">paste0</span>(<span class="st">"Specified test interval:"</span>), <span class="st">" "</span>,</span>
<span id="cb41-560"><a href="#cb41-560" aria-hidden="true" tabindex="-1"></a>         <span class="fu">paste0</span>(<span class="st">"People above "</span>, <span class="fu">str_to_title</span>(rel),<span class="st">" interval:"</span>),</span>
<span id="cb41-561"><a href="#cb41-561" aria-hidden="true" tabindex="-1"></a>         <span class="fu">paste0</span>(<span class="st">"People within "</span>, <span class="fu">str_to_title</span>(rel),<span class="st">" interval:"</span>),</span>
<span id="cb41-562"><a href="#cb41-562" aria-hidden="true" tabindex="-1"></a>         <span class="fu">paste0</span>(<span class="st">"People below "</span>, <span class="fu">str_to_title</span>(rel),<span class="st">" interval :"</span>),</span>
<span id="cb41-563"><a href="#cb41-563" aria-hidden="true" tabindex="-1"></a>         <span class="fu">format</span>(<span class="fu">round</span>(est,<span class="dv">2</span>),<span class="at">nsmall=</span><span class="dv">2</span>),</span>
<span id="cb41-564"><a href="#cb41-564" aria-hidden="true" tabindex="-1"></a>         <span class="fu">paste0</span>(<span class="st">"["</span>,<span class="fu">format</span>(<span class="fu">round</span>(low,<span class="dv">2</span>),<span class="at">nsmall=</span><span class="dv">2</span>),<span class="st">","</span>,<span class="fu">format</span>(<span class="fu">round</span>(upp,<span class="dv">2</span>),<span class="at">nsmall=</span><span class="dv">2</span>),<span class="st">"]"</span>),</span>
<span id="cb41-565"><a href="#cb41-565" aria-hidden="true" tabindex="-1"></a>         <span class="st">" "</span>,</span>
<span id="cb41-566"><a href="#cb41-566" aria-hidden="true" tabindex="-1"></a>         <span class="fu">paste0</span>(<span class="fu">unname</span>(people[<span class="dv">2</span>]),<span class="st">"%"</span>),</span>
<span id="cb41-567"><a href="#cb41-567" aria-hidden="true" tabindex="-1"></a>         <span class="fu">paste0</span>(<span class="fu">unname</span>(people[<span class="dv">1</span>]),<span class="st">"%"</span>),</span>
<span id="cb41-568"><a href="#cb41-568" aria-hidden="true" tabindex="-1"></a>         <span class="fu">paste0</span>(<span class="fu">unname</span>(people[<span class="dv">3</span>]),<span class="st">"%"</span>))</span>
<span id="cb41-569"><a href="#cb41-569" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb41-570"><a href="#cb41-570" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb41-571"><a href="#cb41-571" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb41-572"><a href="#cb41-572" aria-hidden="true" tabindex="-1"></a>  x<span class="ot">&lt;-</span><span class="fu">matrix</span>(y, <span class="at">nrow=</span><span class="dv">6</span>, <span class="at">ncol=</span><span class="dv">2</span>)</span>
<span id="cb41-573"><a href="#cb41-573" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb41-574"><a href="#cb41-574" aria-hidden="true" tabindex="-1"></a>  x1<span class="ot">&lt;-</span><span class="fu">data.frame</span>(x)</span>
<span id="cb41-575"><a href="#cb41-575" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb41-576"><a href="#cb41-576" aria-hidden="true" tabindex="-1"></a>  d<span class="ot">&lt;-</span>plt[,<span class="fu">c</span>(<span class="dv">6</span>,<span class="dv">5</span>,<span class="dv">7</span>)]</span>
<span id="cb41-577"><a href="#cb41-577" aria-hidden="true" tabindex="-1"></a>  d[,<span class="dv">2</span>]<span class="ot">&lt;-</span><span class="fu">round</span>(d[,<span class="dv">2</span>],<span class="dv">3</span>)</span>
<span id="cb41-578"><a href="#cb41-578" aria-hidden="true" tabindex="-1"></a>  <span class="fu">names</span>(d)<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">"Sum Score"</span>,<span class="st">"Conditional Reliability"</span>,<span class="st">"Count"</span>)</span>
<span id="cb41-579"><a href="#cb41-579" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb41-580"><a href="#cb41-580" aria-hidden="true" tabindex="-1"></a>  z<span class="ot">&lt;-</span><span class="fu">list</span>()</span>
<span id="cb41-581"><a href="#cb41-581" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb41-582"><a href="#cb41-582" aria-hidden="true" tabindex="-1"></a>  <span class="co">#save summary table</span></span>
<span id="cb41-583"><a href="#cb41-583" aria-hidden="true" tabindex="-1"></a>  z<span class="sc">$</span>stat<span class="ot">&lt;-</span>x1</span>
<span id="cb41-584"><a href="#cb41-584" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb41-585"><a href="#cb41-585" aria-hidden="true" tabindex="-1"></a>  <span class="co">#save plot</span></span>
<span id="cb41-586"><a href="#cb41-586" aria-hidden="true" tabindex="-1"></a>  z<span class="sc">$</span>plot<span class="ot">&lt;-</span>p</span>
<span id="cb41-587"><a href="#cb41-587" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb41-588"><a href="#cb41-588" aria-hidden="true" tabindex="-1"></a>  <span class="co">#save conditional reliability table</span></span>
<span id="cb41-589"><a href="#cb41-589" aria-hidden="true" tabindex="-1"></a>  z<span class="sc">$</span>table<span class="ot">&lt;-</span>d</span>
<span id="cb41-590"><a href="#cb41-590" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb41-591"><a href="#cb41-591" aria-hidden="true" tabindex="-1"></a>  <span class="co">#print the plot by default</span></span>
<span id="cb41-592"><a href="#cb41-592" aria-hidden="true" tabindex="-1"></a>  <span class="co">#print(z$plot)</span></span>
<span id="cb41-593"><a href="#cb41-593" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb41-594"><a href="#cb41-594" aria-hidden="true" tabindex="-1"></a>  <span class="co">#return the plot with the function</span></span>
<span id="cb41-595"><a href="#cb41-595" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(z)</span>
<span id="cb41-596"><a href="#cb41-596" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb41-597"><a href="#cb41-597" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb41-598"><a href="#cb41-598" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb41-599"><a href="#cb41-599" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-600"><a href="#cb41-600" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-601"><a href="#cb41-601" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb41-602"><a href="#cb41-602" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Alpha</span></span>
<span id="cb41-605"><a href="#cb41-605" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb41-606"><a href="#cb41-606" aria-hidden="true" tabindex="-1"></a><span class="fu">RIrelRep</span>(eRm<span class="sc">::</span>raschdat1[,<span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>])<span class="sc">$</span>plot</span>
<span id="cb41-607"><a href="#cb41-607" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb41-608"><a href="#cb41-608" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-609"><a href="#cb41-609" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Omega</span></span>
<span id="cb41-612"><a href="#cb41-612" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb41-613"><a href="#cb41-613" aria-hidden="true" tabindex="-1"></a><span class="fu">RIrelRep</span>(eRm<span class="sc">::</span>raschdat1[,<span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>], <span class="at">rel =</span> <span class="st">"omega"</span>)<span class="sc">$</span>plot</span>
<span id="cb41-614"><a href="#cb41-614" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb41-615"><a href="#cb41-615" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb41-616"><a href="#cb41-616" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-617"><a href="#cb41-617" aria-hidden="true" tabindex="-1"></a><span class="fu">### Summarizing RMU findings</span></span>
<span id="cb41-618"><a href="#cb41-618" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-619"><a href="#cb41-619" aria-hidden="true" tabindex="-1"></a>Since RMU uses a random pairing of posterior draws, there is variation in both point values and HDCI estimates if one runs the RMU estimation repeatedly using the same set of draws. Let's investigate how much it varies, using the <span class="in">`brms`</span> model with 4000 draws.</span>
<span id="cb41-620"><a href="#cb41-620" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-623"><a href="#cb41-623" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb41-624"><a href="#cb41-624" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb41-625"><a href="#cb41-625" aria-hidden="true" tabindex="-1"></a>rel <span class="ot">&lt;-</span> <span class="fu">map_dfr</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>, <span class="sc">~</span> <span class="fu">RMUreliability</span>(posterior_draws_rm4000)[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>])</span>
<span id="cb41-626"><a href="#cb41-626" aria-hidden="true" tabindex="-1"></a><span class="fu">qs_save</span>(rel,<span class="st">"rel4000.qs2"</span>)</span>
<span id="cb41-627"><a href="#cb41-627" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb41-628"><a href="#cb41-628" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-631"><a href="#cb41-631" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb41-632"><a href="#cb41-632" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 4</span></span>
<span id="cb41-633"><a href="#cb41-633" aria-hidden="true" tabindex="-1"></a>rel <span class="ot">&lt;-</span> <span class="fu">qs_read</span>(<span class="st">"rel4000.qs2"</span>)</span>
<span id="cb41-634"><a href="#cb41-634" aria-hidden="true" tabindex="-1"></a>rel_text <span class="ot">&lt;-</span> rel <span class="sc">%&gt;%</span> </span>
<span id="cb41-635"><a href="#cb41-635" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">everything</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb41-636"><a href="#cb41-636" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(name) <span class="sc">%&gt;%</span> </span>
<span id="cb41-637"><a href="#cb41-637" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">text_location =</span> <span class="fu">mean</span>(value))</span>
<span id="cb41-638"><a href="#cb41-638" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-639"><a href="#cb41-639" aria-hidden="true" tabindex="-1"></a>rel <span class="sc">%&gt;%</span></span>
<span id="cb41-640"><a href="#cb41-640" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">everything</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb41-641"><a href="#cb41-641" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> value, <span class="at">y =</span> <span class="dv">1</span>, <span class="at">fill =</span> name)) <span class="sc">+</span></span>
<span id="cb41-642"><a href="#cb41-642" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_slabinterval</span>() <span class="sc">+</span></span>
<span id="cb41-643"><a href="#cb41-643" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> rel_text,</span>
<span id="cb41-644"><a href="#cb41-644" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">label =</span> name, <span class="at">x =</span> text_location),</span>
<span id="cb41-645"><a href="#cb41-645" aria-hidden="true" tabindex="-1"></a>            <span class="at">position =</span> <span class="fu">position_nudge</span>(<span class="at">y =</span> <span class="sc">-</span><span class="fl">0.04</span>)) <span class="sc">+</span></span>
<span id="cb41-646"><a href="#cb41-646" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"RMU random variation"</span>,</span>
<span id="cb41-647"><a href="#cb41-647" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Using a `brms` Rasch model with 4000 posterior draws, estimating RMU 1000 times"</span>,</span>
<span id="cb41-648"><a href="#cb41-648" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Relative Measurement Uncertainty"</span>,</span>
<span id="cb41-649"><a href="#cb41-649" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb41-650"><a href="#cb41-650" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb41-651"><a href="#cb41-651" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>,</span>
<span id="cb41-652"><a href="#cb41-652" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.1</span>)) <span class="sc">+</span></span>
<span id="cb41-653"><a href="#cb41-653" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="fl">0.65</span>,<span class="fl">0.85</span>), <span class="at">breaks =</span> scales<span class="sc">::</span><span class="fu">breaks_pretty</span>(<span class="dv">8</span>))</span>
<span id="cb41-654"><a href="#cb41-654" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-655"><a href="#cb41-655" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb41-656"><a href="#cb41-656" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-657"><a href="#cb41-657" aria-hidden="true" tabindex="-1"></a>CI's have more variation than the point estimate.</span>
<span id="cb41-658"><a href="#cb41-658" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-661"><a href="#cb41-661" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb41-662"><a href="#cb41-662" aria-hidden="true" tabindex="-1"></a>rel <span class="sc">%&gt;%</span></span>
<span id="cb41-663"><a href="#cb41-663" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">everything</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb41-664"><a href="#cb41-664" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(name) <span class="sc">%&gt;%</span></span>
<span id="cb41-665"><a href="#cb41-665" aria-hidden="true" tabindex="-1"></a>  <span class="fu">reframe</span>(<span class="at">min =</span> <span class="fu">min</span>(value), </span>
<span id="cb41-666"><a href="#cb41-666" aria-hidden="true" tabindex="-1"></a>          <span class="at">max =</span> <span class="fu">max</span>(value),</span>
<span id="cb41-667"><a href="#cb41-667" aria-hidden="true" tabindex="-1"></a>          <span class="at">mean_hdci =</span> <span class="fu">mean_hdci</span>(value))</span>
<span id="cb41-668"><a href="#cb41-668" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb41-669"><a href="#cb41-669" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-670"><a href="#cb41-670" aria-hidden="true" tabindex="-1"></a>Let's do the same with 8000 draws.</span>
<span id="cb41-671"><a href="#cb41-671" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-674"><a href="#cb41-674" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb41-675"><a href="#cb41-675" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb41-676"><a href="#cb41-676" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-677"><a href="#cb41-677" aria-hidden="true" tabindex="-1"></a>rel8 <span class="ot">&lt;-</span> <span class="fu">map_dfr</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>, <span class="sc">~</span> <span class="fu">RMUreliability</span>(posterior_draws_rm8000)[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>])</span>
<span id="cb41-678"><a href="#cb41-678" aria-hidden="true" tabindex="-1"></a><span class="fu">qs_save</span>(rel8,<span class="st">"rel8000.qs2"</span>)</span>
<span id="cb41-679"><a href="#cb41-679" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb41-680"><a href="#cb41-680" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-683"><a href="#cb41-683" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb41-684"><a href="#cb41-684" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 4</span></span>
<span id="cb41-685"><a href="#cb41-685" aria-hidden="true" tabindex="-1"></a>rel8 <span class="ot">&lt;-</span> <span class="fu">qs_read</span>(<span class="st">"rel8000.qs2"</span>)</span>
<span id="cb41-686"><a href="#cb41-686" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-687"><a href="#cb41-687" aria-hidden="true" tabindex="-1"></a>rel8_text <span class="ot">&lt;-</span> rel8 <span class="sc">%&gt;%</span> </span>
<span id="cb41-688"><a href="#cb41-688" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">everything</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb41-689"><a href="#cb41-689" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(name) <span class="sc">%&gt;%</span> </span>
<span id="cb41-690"><a href="#cb41-690" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">text_location =</span> <span class="fu">mean</span>(value))</span>
<span id="cb41-691"><a href="#cb41-691" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-692"><a href="#cb41-692" aria-hidden="true" tabindex="-1"></a>rel8 <span class="sc">%&gt;%</span></span>
<span id="cb41-693"><a href="#cb41-693" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">everything</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb41-694"><a href="#cb41-694" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> value, <span class="at">y =</span> <span class="dv">1</span>, <span class="at">fill =</span> name)) <span class="sc">+</span></span>
<span id="cb41-695"><a href="#cb41-695" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_slabinterval</span>() <span class="sc">+</span></span>
<span id="cb41-696"><a href="#cb41-696" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> rel_text,</span>
<span id="cb41-697"><a href="#cb41-697" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">label =</span> name, <span class="at">x =</span> text_location),</span>
<span id="cb41-698"><a href="#cb41-698" aria-hidden="true" tabindex="-1"></a>            <span class="at">position =</span> <span class="fu">position_nudge</span>(<span class="at">y =</span> <span class="sc">-</span><span class="fl">0.04</span>)) <span class="sc">+</span></span>
<span id="cb41-699"><a href="#cb41-699" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"RMU random variation"</span>,</span>
<span id="cb41-700"><a href="#cb41-700" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Using a `brms` Rasch model with 8000 posterior draws, estimating RMU 1000 times"</span>,</span>
<span id="cb41-701"><a href="#cb41-701" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Relative Measurement Uncertainty"</span>,</span>
<span id="cb41-702"><a href="#cb41-702" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb41-703"><a href="#cb41-703" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb41-704"><a href="#cb41-704" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>,</span>
<span id="cb41-705"><a href="#cb41-705" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.1</span>)) <span class="sc">+</span></span>
<span id="cb41-706"><a href="#cb41-706" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="fl">0.65</span>,<span class="fl">0.85</span>), <span class="at">breaks =</span> scales<span class="sc">::</span><span class="fu">breaks_pretty</span>(<span class="dv">8</span>))</span>
<span id="cb41-707"><a href="#cb41-707" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-708"><a href="#cb41-708" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb41-709"><a href="#cb41-709" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-712"><a href="#cb41-712" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb41-713"><a href="#cb41-713" aria-hidden="true" tabindex="-1"></a>rel8 <span class="sc">%&gt;%</span></span>
<span id="cb41-714"><a href="#cb41-714" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">everything</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb41-715"><a href="#cb41-715" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(name) <span class="sc">%&gt;%</span></span>
<span id="cb41-716"><a href="#cb41-716" aria-hidden="true" tabindex="-1"></a>  <span class="fu">reframe</span>(<span class="at">min =</span> <span class="fu">min</span>(value), </span>
<span id="cb41-717"><a href="#cb41-717" aria-hidden="true" tabindex="-1"></a>          <span class="at">max =</span> <span class="fu">max</span>(value),</span>
<span id="cb41-718"><a href="#cb41-718" aria-hidden="true" tabindex="-1"></a>          <span class="at">mean_hdci =</span> <span class="fu">mean_hdci</span>(value))</span>
<span id="cb41-719"><a href="#cb41-719" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb41-720"><a href="#cb41-720" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-721"><a href="#cb41-721" aria-hidden="true" tabindex="-1"></a>Less variation - more precision in estimates with 8000 draws compared to 4000 draws.</span>
<span id="cb41-722"><a href="#cb41-722" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-723"><a href="#cb41-723" aria-hidden="true" tabindex="-1"></a>How about just estimating RMU 50 times, does it converge on the same mean values for point and CI estimates, compared to estimating RMU 1000 times? This is obviously not a thorough test, it should be evaluated more properly at some point.</span>
<span id="cb41-724"><a href="#cb41-724" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-727"><a href="#cb41-727" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb41-728"><a href="#cb41-728" aria-hidden="true" tabindex="-1"></a>t0 <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb41-729"><a href="#cb41-729" aria-hidden="true" tabindex="-1"></a>rel50 <span class="ot">&lt;-</span> <span class="fu">map_dfr</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">50</span>, <span class="sc">~</span> <span class="fu">RMUreliability</span>(posterior_draws_rm4000)[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>])</span>
<span id="cb41-730"><a href="#cb41-730" aria-hidden="true" tabindex="-1"></a>t1 <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb41-731"><a href="#cb41-731" aria-hidden="true" tabindex="-1"></a>t1 <span class="sc">-</span> t0 <span class="co"># ~3.4s</span></span>
<span id="cb41-732"><a href="#cb41-732" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-733"><a href="#cb41-733" aria-hidden="true" tabindex="-1"></a>rel50 <span class="sc">%&gt;%</span></span>
<span id="cb41-734"><a href="#cb41-734" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">everything</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb41-735"><a href="#cb41-735" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(name) <span class="sc">%&gt;%</span></span>
<span id="cb41-736"><a href="#cb41-736" aria-hidden="true" tabindex="-1"></a>  <span class="fu">reframe</span>(<span class="at">mean_hdci =</span> <span class="fu">mean_hdci</span>(value))</span>
<span id="cb41-737"><a href="#cb41-737" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb41-738"><a href="#cb41-738" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-739"><a href="#cb41-739" aria-hidden="true" tabindex="-1"></a>Clearly seems more stable than just estimating RMU once.</span>
<span id="cb41-740"><a href="#cb41-740" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-741"><a href="#cb41-741" aria-hidden="true" tabindex="-1"></a>This finding leads me to incorporate the 50x RMU estimation as a default setting in the <span class="in">`RIreliability()`</span> function in the next version update. Results reported below are based on this method.</span>
<span id="cb41-742"><a href="#cb41-742" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-745"><a href="#cb41-745" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb41-746"><a href="#cb41-746" aria-hidden="true" tabindex="-1"></a>RIreliability50 <span class="ot">&lt;-</span> <span class="cf">function</span>(data, <span class="at">conf_int =</span> .<span class="dv">95</span>, <span class="at">draws =</span> <span class="dv">1000</span>, <span class="at">estim =</span> <span class="st">"WLE"</span>, <span class="at">boot =</span> <span class="cn">FALSE</span>, <span class="at">cpu =</span> <span class="dv">4</span>, <span class="at">pv =</span> <span class="st">"mirt"</span>, <span class="at">iter =</span> <span class="dv">50</span>, <span class="at">verbose =</span> <span class="cn">TRUE</span>) {</span>
<span id="cb41-747"><a href="#cb41-747" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb41-748"><a href="#cb41-748" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (verbose <span class="sc">==</span> <span class="cn">TRUE</span>) {</span>
<span id="cb41-749"><a href="#cb41-749" aria-hidden="true" tabindex="-1"></a>  <span class="fu">message</span>(<span class="st">"Note that PSI is calculated with max/min scoring individuals excluded."</span>)</span>
<span id="cb41-750"><a href="#cb41-750" aria-hidden="true" tabindex="-1"></a>  <span class="fu">message</span>(<span class="fu">paste0</span>(<span class="st">"RMU reliability estimates based on "</span>,draws,<span class="st">" posterior draws (plausible values) from "</span>,<span class="fu">nrow</span>(data),<span class="st">" respondents."</span>,</span>
<span id="cb41-751"><a href="#cb41-751" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"</span><span class="sc">\n</span><span class="st">See Bignardi, Kievit, &amp; Bürkner (2025). 'A general method for estimating reliability using Bayesian Measurement Uncertainty' for details. "</span>,</span>
<span id="cb41-752"><a href="#cb41-752" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"The procedure has been modified in `easyRasch` to use plausible values based on an MML estimated Rasch model."</span>))</span>
<span id="cb41-753"><a href="#cb41-753" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb41-754"><a href="#cb41-754" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb41-755"><a href="#cb41-755" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">min</span>(<span class="fu">as.matrix</span>(data), <span class="at">na.rm =</span> T) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb41-756"><a href="#cb41-756" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stop</span>(<span class="st">"The lowest response category needs to coded as 0. Please recode your data."</span>)</span>
<span id="cb41-757"><a href="#cb41-757" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span>(<span class="fu">max</span>(<span class="fu">as.matrix</span>(data), <span class="at">na.rm =</span> T) <span class="sc">==</span> <span class="dv">1</span>) {</span>
<span id="cb41-758"><a href="#cb41-758" aria-hidden="true" tabindex="-1"></a>    model <span class="ot">&lt;-</span> <span class="st">"RM"</span></span>
<span id="cb41-759"><a href="#cb41-759" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span>(<span class="fu">max</span>(<span class="fu">as.matrix</span>(data), <span class="at">na.rm =</span> T) <span class="sc">&gt;</span> <span class="dv">1</span>) {</span>
<span id="cb41-760"><a href="#cb41-760" aria-hidden="true" tabindex="-1"></a>    model <span class="ot">&lt;-</span> <span class="st">"PCM"</span></span>
<span id="cb41-761"><a href="#cb41-761" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb41-762"><a href="#cb41-762" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb41-763"><a href="#cb41-763" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (model <span class="sc">==</span> <span class="st">"PCM"</span>) {</span>
<span id="cb41-764"><a href="#cb41-764" aria-hidden="true" tabindex="-1"></a>    mirt_out <span class="ot">&lt;-</span> <span class="fu">mirt</span>(</span>
<span id="cb41-765"><a href="#cb41-765" aria-hidden="true" tabindex="-1"></a>      data,</span>
<span id="cb41-766"><a href="#cb41-766" aria-hidden="true" tabindex="-1"></a>      <span class="at">model =</span> <span class="dv">1</span>,</span>
<span id="cb41-767"><a href="#cb41-767" aria-hidden="true" tabindex="-1"></a>      <span class="at">itemtype =</span> <span class="st">"Rasch"</span>,</span>
<span id="cb41-768"><a href="#cb41-768" aria-hidden="true" tabindex="-1"></a>      <span class="at">verbose =</span> <span class="cn">FALSE</span>,</span>
<span id="cb41-769"><a href="#cb41-769" aria-hidden="true" tabindex="-1"></a>      <span class="at">accelerate =</span> <span class="st">"squarem"</span></span>
<span id="cb41-770"><a href="#cb41-770" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb41-771"><a href="#cb41-771" aria-hidden="true" tabindex="-1"></a>    erm_out <span class="ot">&lt;-</span> eRm<span class="sc">::</span><span class="fu">PCM</span>(data)</span>
<span id="cb41-772"><a href="#cb41-772" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (model <span class="sc">==</span> <span class="st">"RM"</span>) {</span>
<span id="cb41-773"><a href="#cb41-773" aria-hidden="true" tabindex="-1"></a>    mirt_out <span class="ot">&lt;-</span> <span class="fu">mirt</span>(</span>
<span id="cb41-774"><a href="#cb41-774" aria-hidden="true" tabindex="-1"></a>      data,</span>
<span id="cb41-775"><a href="#cb41-775" aria-hidden="true" tabindex="-1"></a>      <span class="at">model =</span> <span class="dv">1</span>,</span>
<span id="cb41-776"><a href="#cb41-776" aria-hidden="true" tabindex="-1"></a>      <span class="at">itemtype =</span> <span class="st">"1PL"</span>,</span>
<span id="cb41-777"><a href="#cb41-777" aria-hidden="true" tabindex="-1"></a>      <span class="at">verbose =</span> <span class="cn">FALSE</span>,</span>
<span id="cb41-778"><a href="#cb41-778" aria-hidden="true" tabindex="-1"></a>      <span class="at">accelerate =</span> <span class="st">"squarem"</span></span>
<span id="cb41-779"><a href="#cb41-779" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb41-780"><a href="#cb41-780" aria-hidden="true" tabindex="-1"></a>    erm_out <span class="ot">&lt;-</span> eRm<span class="sc">::</span><span class="fu">RM</span>(data)</span>
<span id="cb41-781"><a href="#cb41-781" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb41-782"><a href="#cb41-782" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb41-783"><a href="#cb41-783" aria-hidden="true" tabindex="-1"></a>  wle <span class="ot">&lt;-</span> <span class="fu">RI_iarm_person_estimates</span>(erm_out, <span class="at">properties =</span> <span class="cn">TRUE</span>)[[<span class="dv">2</span>]] <span class="sc">%&gt;%</span></span>
<span id="cb41-784"><a href="#cb41-784" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.data.frame</span>()</span>
<span id="cb41-785"><a href="#cb41-785" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames</span>(wle) <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb41-786"><a href="#cb41-786" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb41-787"><a href="#cb41-787" aria-hidden="true" tabindex="-1"></a>  empirical_rel <span class="ot">&lt;-</span> mirt<span class="sc">::</span><span class="fu">fscores</span>(mirt_out,</span>
<span id="cb41-788"><a href="#cb41-788" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">method =</span> estim,</span>
<span id="cb41-789"><a href="#cb41-789" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">theta_lim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">10</span>, <span class="dv">10</span>),</span>
<span id="cb41-790"><a href="#cb41-790" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">full.scores.SE =</span> <span class="cn">TRUE</span>,</span>
<span id="cb41-791"><a href="#cb41-791" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">verbose =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb41-792"><a href="#cb41-792" aria-hidden="true" tabindex="-1"></a>    mirt<span class="sc">::</span><span class="fu">empirical_rxx</span>()</span>
<span id="cb41-793"><a href="#cb41-793" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb41-794"><a href="#cb41-794" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (boot <span class="sc">==</span> <span class="cn">TRUE</span>) {</span>
<span id="cb41-795"><a href="#cb41-795" aria-hidden="true" tabindex="-1"></a>    <span class="fu">require</span>(doParallel)</span>
<span id="cb41-796"><a href="#cb41-796" aria-hidden="true" tabindex="-1"></a>    <span class="fu">registerDoParallel</span>(<span class="at">cores =</span> cpu)</span>
<span id="cb41-797"><a href="#cb41-797" aria-hidden="true" tabindex="-1"></a>    <span class="co"># bootstrap CI for empirical</span></span>
<span id="cb41-798"><a href="#cb41-798" aria-hidden="true" tabindex="-1"></a>    fit <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb41-799"><a href="#cb41-799" aria-hidden="true" tabindex="-1"></a>    fit <span class="ot">&lt;-</span> <span class="fu">foreach</span>(<span class="at">i =</span> <span class="dv">1</span><span class="sc">:</span>draws, <span class="at">.combine =</span> rbind) <span class="sc">%dopar%</span> {</span>
<span id="cb41-800"><a href="#cb41-800" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb41-801"><a href="#cb41-801" aria-hidden="true" tabindex="-1"></a>      dat <span class="ot">&lt;-</span> data[<span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(data), <span class="fu">nrow</span>(data), <span class="at">replace =</span> <span class="cn">TRUE</span>), ]</span>
<span id="cb41-802"><a href="#cb41-802" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb41-803"><a href="#cb41-803" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (model <span class="sc">==</span> <span class="st">"PCM"</span>) {</span>
<span id="cb41-804"><a href="#cb41-804" aria-hidden="true" tabindex="-1"></a>        mirt_out2 <span class="ot">&lt;-</span> <span class="fu">mirt</span>(</span>
<span id="cb41-805"><a href="#cb41-805" aria-hidden="true" tabindex="-1"></a>          dat,</span>
<span id="cb41-806"><a href="#cb41-806" aria-hidden="true" tabindex="-1"></a>          <span class="at">model =</span> <span class="dv">1</span>,</span>
<span id="cb41-807"><a href="#cb41-807" aria-hidden="true" tabindex="-1"></a>          <span class="at">itemtype =</span> <span class="st">"Rasch"</span>,</span>
<span id="cb41-808"><a href="#cb41-808" aria-hidden="true" tabindex="-1"></a>          <span class="at">verbose =</span> <span class="cn">FALSE</span>,</span>
<span id="cb41-809"><a href="#cb41-809" aria-hidden="true" tabindex="-1"></a>          <span class="at">accelerate =</span> <span class="st">"squarem"</span></span>
<span id="cb41-810"><a href="#cb41-810" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb41-811"><a href="#cb41-811" aria-hidden="true" tabindex="-1"></a>      } <span class="cf">else</span> <span class="cf">if</span> (model <span class="sc">==</span> <span class="st">"RM"</span>) {</span>
<span id="cb41-812"><a href="#cb41-812" aria-hidden="true" tabindex="-1"></a>        mirt_out2 <span class="ot">&lt;-</span> <span class="fu">mirt</span>(</span>
<span id="cb41-813"><a href="#cb41-813" aria-hidden="true" tabindex="-1"></a>          dat,</span>
<span id="cb41-814"><a href="#cb41-814" aria-hidden="true" tabindex="-1"></a>          <span class="at">model =</span> <span class="dv">1</span>,</span>
<span id="cb41-815"><a href="#cb41-815" aria-hidden="true" tabindex="-1"></a>          <span class="at">itemtype =</span> <span class="st">"1PL"</span>,</span>
<span id="cb41-816"><a href="#cb41-816" aria-hidden="true" tabindex="-1"></a>          <span class="at">verbose =</span> <span class="cn">FALSE</span>,</span>
<span id="cb41-817"><a href="#cb41-817" aria-hidden="true" tabindex="-1"></a>          <span class="at">accelerate =</span> <span class="st">"squarem"</span></span>
<span id="cb41-818"><a href="#cb41-818" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb41-819"><a href="#cb41-819" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb41-820"><a href="#cb41-820" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb41-821"><a href="#cb41-821" aria-hidden="true" tabindex="-1"></a>      mirt<span class="sc">::</span><span class="fu">fscores</span>(mirt_out2,</span>
<span id="cb41-822"><a href="#cb41-822" aria-hidden="true" tabindex="-1"></a>                    <span class="at">method =</span> estim,</span>
<span id="cb41-823"><a href="#cb41-823" aria-hidden="true" tabindex="-1"></a>                    <span class="at">theta_lim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">10</span>, <span class="dv">10</span>),</span>
<span id="cb41-824"><a href="#cb41-824" aria-hidden="true" tabindex="-1"></a>                    <span class="at">full.scores.SE =</span> <span class="cn">TRUE</span>,</span>
<span id="cb41-825"><a href="#cb41-825" aria-hidden="true" tabindex="-1"></a>                    <span class="at">verbose =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb41-826"><a href="#cb41-826" aria-hidden="true" tabindex="-1"></a>        mirt<span class="sc">::</span><span class="fu">empirical_rxx</span>()</span>
<span id="cb41-827"><a href="#cb41-827" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb41-828"><a href="#cb41-828" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb41-829"><a href="#cb41-829" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb41-830"><a href="#cb41-830" aria-hidden="true" tabindex="-1"></a>    emp_boot <span class="ot">&lt;-</span> <span class="fu">mean_hdci</span>(fit) <span class="sc">%&gt;%</span></span>
<span id="cb41-831"><a href="#cb41-831" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), <span class="sc">~</span> <span class="fu">round</span>(.x, <span class="dv">3</span>)))</span>
<span id="cb41-832"><a href="#cb41-832" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb41-833"><a href="#cb41-833" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb41-834"><a href="#cb41-834" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb41-835"><a href="#cb41-835" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (pv <span class="sc">==</span> <span class="st">"mirt"</span>) {</span>
<span id="cb41-836"><a href="#cb41-836" aria-hidden="true" tabindex="-1"></a>  plvals <span class="ot">&lt;-</span> mirt<span class="sc">::</span><span class="fu">fscores</span>(mirt_out, <span class="at">method =</span> estim,</span>
<span id="cb41-837"><a href="#cb41-837" aria-hidden="true" tabindex="-1"></a>                          <span class="at">theta_lim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">10</span>, <span class="dv">10</span>),</span>
<span id="cb41-838"><a href="#cb41-838" aria-hidden="true" tabindex="-1"></a>                          <span class="at">plausible.draws =</span> draws,</span>
<span id="cb41-839"><a href="#cb41-839" aria-hidden="true" tabindex="-1"></a>                          <span class="at">plausible.type =</span> <span class="st">"MH"</span>,</span>
<span id="cb41-840"><a href="#cb41-840" aria-hidden="true" tabindex="-1"></a>                          <span class="at">verbose =</span> <span class="cn">FALSE</span>)</span>
<span id="cb41-841"><a href="#cb41-841" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb41-842"><a href="#cb41-842" aria-hidden="true" tabindex="-1"></a>  rmu_draws <span class="ot">&lt;-</span> <span class="fu">do.call</span>(cbind.data.frame, plvals) </span>
<span id="cb41-843"><a href="#cb41-843" aria-hidden="true" tabindex="-1"></a>  rmu_iter <span class="ot">&lt;-</span> <span class="fu">map_dfr</span>(<span class="dv">1</span><span class="sc">:</span>iter, <span class="sc">~</span> <span class="fu">RMUreliability</span>(rmu_draws, <span class="at">level =</span> conf_int)[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>])</span>
<span id="cb41-844"><a href="#cb41-844" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-845"><a href="#cb41-845" aria-hidden="true" tabindex="-1"></a>  rmu <span class="ot">&lt;-</span> rmu_iter <span class="sc">%&gt;%</span> </span>
<span id="cb41-846"><a href="#cb41-846" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">rmu_estimate =</span> <span class="fu">mean</span>(rmu_estimate),</span>
<span id="cb41-847"><a href="#cb41-847" aria-hidden="true" tabindex="-1"></a>              <span class="at">hdci_lowerbound =</span> <span class="fu">mean</span>(hdci_lowerbound),</span>
<span id="cb41-848"><a href="#cb41-848" aria-hidden="true" tabindex="-1"></a>              <span class="at">hdci_upperbound =</span> <span class="fu">mean</span>(hdci_upperbound)</span>
<span id="cb41-849"><a href="#cb41-849" aria-hidden="true" tabindex="-1"></a>              ) <span class="sc">%&gt;%</span> </span>
<span id="cb41-850"><a href="#cb41-850" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), <span class="sc">~</span> <span class="fu">round</span>(.x, <span class="dv">3</span>)))</span>
<span id="cb41-851"><a href="#cb41-851" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb41-852"><a href="#cb41-852" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (pv <span class="sc">==</span> <span class="st">"TAM"</span>) {</span>
<span id="cb41-853"><a href="#cb41-853" aria-hidden="true" tabindex="-1"></a>    estim <span class="ot">=</span> <span class="st">"EAP"</span></span>
<span id="cb41-854"><a href="#cb41-854" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (model <span class="sc">==</span> <span class="st">"PCM"</span>) {</span>
<span id="cb41-855"><a href="#cb41-855" aria-hidden="true" tabindex="-1"></a>    tam_out <span class="ot">&lt;-</span> TAM<span class="sc">::</span><span class="fu">tam.mml</span>(<span class="at">resp =</span> data, <span class="at">irtmodel =</span> <span class="st">"PCM"</span>, <span class="at">verbose =</span> <span class="cn">FALSE</span>)</span>
<span id="cb41-856"><a href="#cb41-856" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> <span class="cf">if</span> (model <span class="sc">==</span> <span class="st">"RM"</span>) {</span>
<span id="cb41-857"><a href="#cb41-857" aria-hidden="true" tabindex="-1"></a>    tam_out <span class="ot">&lt;-</span> TAM<span class="sc">::</span><span class="fu">tam.mml</span>(<span class="at">resp =</span> data, <span class="at">irtmodel =</span> <span class="st">"1PL"</span>, <span class="at">verbose =</span> <span class="cn">FALSE</span>)</span>
<span id="cb41-858"><a href="#cb41-858" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb41-859"><a href="#cb41-859" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb41-860"><a href="#cb41-860" aria-hidden="true" tabindex="-1"></a>    plvals <span class="ot">&lt;-</span> TAM<span class="sc">::</span><span class="fu">tam.pv</span>(tam_out, <span class="at">nplausible =</span> draws, <span class="at">verbose =</span> <span class="cn">FALSE</span>)[[<span class="st">"pv"</span>]][,<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb41-861"><a href="#cb41-861" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb41-862"><a href="#cb41-862" aria-hidden="true" tabindex="-1"></a>    rmu_iter <span class="ot">&lt;-</span> <span class="fu">map_dfr</span>(<span class="dv">1</span><span class="sc">:</span>iter, <span class="sc">~</span> <span class="fu">RMUreliability</span>(plvals, <span class="at">level =</span> conf_int)[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>])</span>
<span id="cb41-863"><a href="#cb41-863" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-864"><a href="#cb41-864" aria-hidden="true" tabindex="-1"></a>    rmu <span class="ot">&lt;-</span> rmu_iter <span class="sc">%&gt;%</span> </span>
<span id="cb41-865"><a href="#cb41-865" aria-hidden="true" tabindex="-1"></a>      <span class="fu">summarise</span>(<span class="at">rmu_estimate =</span> <span class="fu">mean</span>(rmu_estimate),</span>
<span id="cb41-866"><a href="#cb41-866" aria-hidden="true" tabindex="-1"></a>                <span class="at">hdci_lowerbound =</span> <span class="fu">mean</span>(hdci_lowerbound),</span>
<span id="cb41-867"><a href="#cb41-867" aria-hidden="true" tabindex="-1"></a>                <span class="at">hdci_upperbound =</span> <span class="fu">mean</span>(hdci_upperbound)</span>
<span id="cb41-868"><a href="#cb41-868" aria-hidden="true" tabindex="-1"></a>                ) <span class="sc">%&gt;%</span> </span>
<span id="cb41-869"><a href="#cb41-869" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), <span class="sc">~</span> <span class="fu">round</span>(.x, <span class="dv">3</span>)))</span>
<span id="cb41-870"><a href="#cb41-870" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb41-871"><a href="#cb41-871" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb41-872"><a href="#cb41-872" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (boot <span class="sc">==</span> <span class="cn">TRUE</span>) {</span>
<span id="cb41-873"><a href="#cb41-873" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb41-874"><a href="#cb41-874" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">WLE =</span> wle,</span>
<span id="cb41-875"><a href="#cb41-875" aria-hidden="true" tabindex="-1"></a>                <span class="at">PSI =</span> eRm<span class="sc">::</span><span class="fu">person.parameter</span>(erm_out) <span class="sc">%&gt;%</span> eRm<span class="sc">::</span><span class="fu">SepRel</span>(),</span>
<span id="cb41-876"><a href="#cb41-876" aria-hidden="true" tabindex="-1"></a>                <span class="at">Empirical =</span> <span class="fu">paste0</span>(estim,<span class="st">"_empirical = "</span>,<span class="fu">round</span>(empirical_rel,<span class="dv">3</span>)),</span>
<span id="cb41-877"><a href="#cb41-877" aria-hidden="true" tabindex="-1"></a>                <span class="at">Empirical_bootstrap =</span> <span class="fu">paste0</span>(estim,<span class="st">"_empirical = "</span>,emp_boot<span class="sc">$</span>y,<span class="st">" (95% HDCI ["</span>,emp_boot<span class="sc">$</span>ymin,<span class="st">", "</span>,emp_boot<span class="sc">$</span>ymax,<span class="st">"]) ("</span>,draws,<span class="st">" bootstrap resamples)"</span>),</span>
<span id="cb41-878"><a href="#cb41-878" aria-hidden="true" tabindex="-1"></a>                <span class="at">RMU =</span> <span class="fu">paste0</span>(estim,<span class="st">"-RMU = "</span>,rmu<span class="sc">$</span>rmu_estimate,<span class="st">" (95% HDCI ["</span>,rmu<span class="sc">$</span>hdci_lowerbound,<span class="st">", "</span>,rmu<span class="sc">$</span>hdci_upperbound,<span class="st">"]) ("</span>,draws,<span class="st">" draws) using package "</span>,pv,<span class="st">" and "</span>,iter,<span class="st">" RMU iterations."</span>)</span>
<span id="cb41-879"><a href="#cb41-879" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb41-880"><a href="#cb41-880" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb41-881"><a href="#cb41-881" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb41-882"><a href="#cb41-882" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">WLE =</span> wle,</span>
<span id="cb41-883"><a href="#cb41-883" aria-hidden="true" tabindex="-1"></a>                <span class="at">PSI =</span> eRm<span class="sc">::</span><span class="fu">person.parameter</span>(erm_out) <span class="sc">%&gt;%</span> eRm<span class="sc">::</span><span class="fu">SepRel</span>(),</span>
<span id="cb41-884"><a href="#cb41-884" aria-hidden="true" tabindex="-1"></a>                <span class="at">Empirical =</span> <span class="fu">paste0</span>(estim,<span class="st">"_empirical = "</span>,<span class="fu">round</span>(empirical_rel,<span class="dv">3</span>)),</span>
<span id="cb41-885"><a href="#cb41-885" aria-hidden="true" tabindex="-1"></a>                <span class="at">RMU =</span> <span class="fu">paste0</span>(estim,<span class="st">"-RMU = "</span>,rmu<span class="sc">$</span>rmu_estimate,<span class="st">" (95% HDCI ["</span>,rmu<span class="sc">$</span>hdci_lowerbound,<span class="st">", "</span>,rmu<span class="sc">$</span>hdci_upperbound,<span class="st">"]) ("</span>,draws,<span class="st">" draws) using package "</span>,pv,<span class="st">" and "</span>,iter,<span class="st">" RMU iterations."</span>)</span>
<span id="cb41-886"><a href="#cb41-886" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb41-887"><a href="#cb41-887" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb41-888"><a href="#cb41-888" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb41-889"><a href="#cb41-889" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb41-890"><a href="#cb41-890" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb41-891"><a href="#cb41-891" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-892"><a href="#cb41-892" aria-hidden="true" tabindex="-1"></a>Using the 50 iteration setting 10 times with 4000 draws. What is the variation!?</span>
<span id="cb41-893"><a href="#cb41-893" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-896"><a href="#cb41-896" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb41-897"><a href="#cb41-897" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb41-898"><a href="#cb41-898" aria-hidden="true" tabindex="-1"></a>iter50 <span class="ot">&lt;-</span> <span class="fu">map_vec</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="sc">~</span> <span class="fu">RIreliability50</span>(raschdat1[,<span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>], <span class="at">draws =</span> <span class="dv">4000</span>, <span class="at">verbose =</span> <span class="cn">FALSE</span>)<span class="sc">$</span>RMU)</span>
<span id="cb41-899"><a href="#cb41-899" aria-hidden="true" tabindex="-1"></a>iter50</span>
<span id="cb41-900"><a href="#cb41-900" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb41-901"><a href="#cb41-901" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-902"><a href="#cb41-902" aria-hidden="true" tabindex="-1"></a>Point estimate varies from .761 to .764, with lower/upper CI ranging from .694 to .698 and .825 to .827. Estimates seem unlikely to vary more than 0.01, which I find acceptable.</span>
<span id="cb41-903"><a href="#cb41-903" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-904"><a href="#cb41-904" aria-hidden="true" tabindex="-1"></a><span class="fu">### Summary table</span></span>
<span id="cb41-905"><a href="#cb41-905" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-908"><a href="#cb41-908" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb41-909"><a href="#cb41-909" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb41-910"><a href="#cb41-910" aria-hidden="true" tabindex="-1"></a>rmu_mirt_wle_full <span class="ot">&lt;-</span> <span class="fu">RIreliability50</span>(eRm<span class="sc">::</span>raschdat1[,<span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>], <span class="at">draws =</span> <span class="dv">4000</span>, <span class="at">verbose =</span> F)</span>
<span id="cb41-911"><a href="#cb41-911" aria-hidden="true" tabindex="-1"></a>rmu_mirt_eap_full <span class="ot">&lt;-</span> <span class="fu">RIreliability50</span>(eRm<span class="sc">::</span>raschdat1[,<span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>], <span class="at">draws =</span> <span class="dv">4000</span>, <span class="at">estim =</span> <span class="st">"EAP"</span>, <span class="at">verbose =</span> F)</span>
<span id="cb41-912"><a href="#cb41-912" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-913"><a href="#cb41-913" aria-hidden="true" tabindex="-1"></a>t0 <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb41-914"><a href="#cb41-914" aria-hidden="true" tabindex="-1"></a>rmu_mirt_wle4000 <span class="ot">&lt;-</span> <span class="fu">RIreliability50</span>(eRm<span class="sc">::</span>raschdat1[,<span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>], <span class="at">draws =</span> <span class="dv">4000</span>, <span class="at">verbose =</span> F)<span class="sc">$</span>RMU</span>
<span id="cb41-915"><a href="#cb41-915" aria-hidden="true" tabindex="-1"></a>t1 <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb41-916"><a href="#cb41-916" aria-hidden="true" tabindex="-1"></a>t1 <span class="sc">-</span> t0 <span class="co"># 8.3s</span></span>
<span id="cb41-917"><a href="#cb41-917" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-918"><a href="#cb41-918" aria-hidden="true" tabindex="-1"></a>t0 <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb41-919"><a href="#cb41-919" aria-hidden="true" tabindex="-1"></a>rmu_mirt_eap4000 <span class="ot">&lt;-</span> <span class="fu">RIreliability50</span>(eRm<span class="sc">::</span>raschdat1[,<span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>], <span class="at">draws =</span> <span class="dv">4000</span>, <span class="at">estim =</span> <span class="st">"EAP"</span>, <span class="at">verbose =</span> F)<span class="sc">$</span>RMU</span>
<span id="cb41-920"><a href="#cb41-920" aria-hidden="true" tabindex="-1"></a>t1 <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb41-921"><a href="#cb41-921" aria-hidden="true" tabindex="-1"></a>t1 <span class="sc">-</span> t0 <span class="co"># 7.7s</span></span>
<span id="cb41-922"><a href="#cb41-922" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-923"><a href="#cb41-923" aria-hidden="true" tabindex="-1"></a>t0 <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb41-924"><a href="#cb41-924" aria-hidden="true" tabindex="-1"></a>rmu_tam_eap4000 <span class="ot">&lt;-</span> <span class="fu">RIreliability50</span>(eRm<span class="sc">::</span>raschdat1[,<span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>], <span class="at">draws =</span> <span class="dv">4000</span>, <span class="at">pv =</span> <span class="st">"TAM"</span>, <span class="at">verbose =</span> F)<span class="sc">$</span>RMU</span>
<span id="cb41-925"><a href="#cb41-925" aria-hidden="true" tabindex="-1"></a>t1 <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb41-926"><a href="#cb41-926" aria-hidden="true" tabindex="-1"></a>t1 <span class="sc">-</span> t0 <span class="co"># 10.6s</span></span>
<span id="cb41-927"><a href="#cb41-927" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-928"><a href="#cb41-928" aria-hidden="true" tabindex="-1"></a>brms4000 <span class="ot">&lt;-</span> <span class="fu">map_dfr</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">50</span>, <span class="sc">~</span> <span class="fu">RMUreliability</span>(posterior_draws_rm4000)[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>]) <span class="sc">%&gt;%</span> </span>
<span id="cb41-929"><a href="#cb41-929" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">rmu_estimate =</span> <span class="fu">mean</span>(rmu_estimate),</span>
<span id="cb41-930"><a href="#cb41-930" aria-hidden="true" tabindex="-1"></a>              <span class="at">hdci_lowerbound =</span> <span class="fu">mean</span>(hdci_lowerbound),</span>
<span id="cb41-931"><a href="#cb41-931" aria-hidden="true" tabindex="-1"></a>              <span class="at">hdci_upperbound =</span> <span class="fu">mean</span>(hdci_upperbound)</span>
<span id="cb41-932"><a href="#cb41-932" aria-hidden="true" tabindex="-1"></a>              ) <span class="sc">%&gt;%</span> </span>
<span id="cb41-933"><a href="#cb41-933" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), <span class="sc">~</span> <span class="fu">round</span>(.x, <span class="dv">3</span>)))</span>
<span id="cb41-934"><a href="#cb41-934" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-935"><a href="#cb41-935" aria-hidden="true" tabindex="-1"></a>brms8000 <span class="ot">&lt;-</span> <span class="fu">map_dfr</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">50</span>, <span class="sc">~</span> <span class="fu">RMUreliability</span>(posterior_draws_rm8000)[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>]) <span class="sc">%&gt;%</span> </span>
<span id="cb41-936"><a href="#cb41-936" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">rmu_estimate =</span> <span class="fu">mean</span>(rmu_estimate),</span>
<span id="cb41-937"><a href="#cb41-937" aria-hidden="true" tabindex="-1"></a>              <span class="at">hdci_lowerbound =</span> <span class="fu">mean</span>(hdci_lowerbound),</span>
<span id="cb41-938"><a href="#cb41-938" aria-hidden="true" tabindex="-1"></a>              <span class="at">hdci_upperbound =</span> <span class="fu">mean</span>(hdci_upperbound)</span>
<span id="cb41-939"><a href="#cb41-939" aria-hidden="true" tabindex="-1"></a>              ) <span class="sc">%&gt;%</span> </span>
<span id="cb41-940"><a href="#cb41-940" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), <span class="sc">~</span> <span class="fu">round</span>(.x, <span class="dv">3</span>)))</span>
<span id="cb41-941"><a href="#cb41-941" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb41-942"><a href="#cb41-942" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-945"><a href="#cb41-945" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb41-946"><a href="#cb41-946" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="at">Metric =</span> <span class="fu">c</span>(<span class="st">"RMU brms 8000"</span>,<span class="st">"RMU brms 4000"</span>,<span class="st">"WLE-RMU PV 4000 (mirt)"</span>,<span class="st">"EAP-RMU PV 4000 (mirt)"</span>,<span class="st">"EAP-RMU PV 4000 (TAM)"</span>,<span class="st">"EAP (TAM)"</span>,<span class="st">"PSI (eRm)"</span>,<span class="st">"WLE empirical (mirt)"</span>,<span class="st">"EAP empirical (mirt)"</span>,<span class="st">"Alpha"</span>,<span class="st">"Omega"</span>),</span>
<span id="cb41-947"><a href="#cb41-947" aria-hidden="true" tabindex="-1"></a>           <span class="at">Estimate =</span> <span class="fu">c</span>(<span class="st">"0.750, 95% HDCI [0.678, 0.818]"</span>,</span>
<span id="cb41-948"><a href="#cb41-948" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"0.750, 95% HDCI [0.679, 0.818]"</span>,</span>
<span id="cb41-949"><a href="#cb41-949" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"0.762, 95% HDCI [0.696, 0.827]"</span>,</span>
<span id="cb41-950"><a href="#cb41-950" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"0.762, 95% HDCI [0.695, 0.826]"</span>,</span>
<span id="cb41-951"><a href="#cb41-951" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"0.740, 95% HDCI [0.669, 0.809]"</span>,</span>
<span id="cb41-952"><a href="#cb41-952" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"0.749"</span>,</span>
<span id="cb41-953"><a href="#cb41-953" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"0.747"</span>,</span>
<span id="cb41-954"><a href="#cb41-954" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"0.792"</span>,</span>
<span id="cb41-955"><a href="#cb41-955" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"0.761"</span>,</span>
<span id="cb41-956"><a href="#cb41-956" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"0.75 95% CI [0.68,0.82]"</span>,</span>
<span id="cb41-957"><a href="#cb41-957" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"0.72 95% CI [0.64,0.80]"</span>)</span>
<span id="cb41-958"><a href="#cb41-958" aria-hidden="true" tabindex="-1"></a>           ) <span class="sc">%&gt;%</span> </span>
<span id="cb41-959"><a href="#cb41-959" aria-hidden="true" tabindex="-1"></a>  knitr<span class="sc">::</span><span class="fu">kable</span>()</span>
<span id="cb41-960"><a href="#cb41-960" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb41-961"><a href="#cb41-961" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-962"><a href="#cb41-962" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-963"><a href="#cb41-963" aria-hidden="true" tabindex="-1"></a><span class="fu">## Partial credit model (PCM)</span></span>
<span id="cb41-964"><a href="#cb41-964" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-965"><a href="#cb41-965" aria-hidden="true" tabindex="-1"></a>For this example, the <span class="in">`eRm::pcmdat2`</span> dataset is used. It has 4 items with 3 response categories each, and 300 respondents. It might not be an optimal dataset to use since item 3 is a bit overfit to the PCM.</span>
<span id="cb41-966"><a href="#cb41-966" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-967"><a href="#cb41-967" aria-hidden="true" tabindex="-1"></a><span class="fu">### Bayesian model</span></span>
<span id="cb41-968"><a href="#cb41-968" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-969"><a href="#cb41-969" aria-hidden="true" tabindex="-1"></a>To fit a PCM with <span class="in">`brms`</span>, we need <span class="in">`family = "acat"`</span>, which defaults to use logit link. </span>
<span id="cb41-970"><a href="#cb41-970" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-973"><a href="#cb41-973" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb41-974"><a href="#cb41-974" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb41-975"><a href="#cb41-975" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: show</span></span>
<span id="cb41-976"><a href="#cb41-976" aria-hidden="true" tabindex="-1"></a>df2 <span class="ot">&lt;-</span> pcmdat2 <span class="sc">%&gt;%</span></span>
<span id="cb41-977"><a href="#cb41-977" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">everything</span>(), <span class="sc">~</span> .x <span class="sc">+</span> <span class="dv">1</span>)) <span class="sc">%&gt;%</span> <span class="co"># lowest category needs to be 1, unlike most Rasch packages that use 0</span></span>
<span id="cb41-978"><a href="#cb41-978" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>(<span class="st">"id"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb41-979"><a href="#cb41-979" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">!</span>id, <span class="at">names_to =</span> <span class="st">"item"</span>, <span class="at">values_to =</span> <span class="st">"response"</span>)</span>
<span id="cb41-980"><a href="#cb41-980" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-981"><a href="#cb41-981" aria-hidden="true" tabindex="-1"></a><span class="fu">get_prior</span>(response <span class="sc">|</span> <span class="fu">thres</span>(<span class="at">gr =</span> item) <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> id),</span>
<span id="cb41-982"><a href="#cb41-982" aria-hidden="true" tabindex="-1"></a>  <span class="at">data    =</span> df2,</span>
<span id="cb41-983"><a href="#cb41-983" aria-hidden="true" tabindex="-1"></a>  <span class="at">family  =</span> <span class="st">"acat"</span>)</span>
<span id="cb41-984"><a href="#cb41-984" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-985"><a href="#cb41-985" aria-hidden="true" tabindex="-1"></a>prior_pcm <span class="ot">&lt;-</span> <span class="fu">prior</span>(<span class="st">"normal(0, 5)"</span>, <span class="at">class =</span> <span class="st">"Intercept"</span>) <span class="sc">+</span></span>
<span id="cb41-986"><a href="#cb41-986" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prior</span>(<span class="st">"normal(0, 3)"</span>, <span class="at">class =</span> <span class="st">"sd"</span>, <span class="at">group =</span> <span class="st">"id"</span>)</span>
<span id="cb41-987"><a href="#cb41-987" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-988"><a href="#cb41-988" aria-hidden="true" tabindex="-1"></a>brms_pcm <span class="ot">&lt;-</span> <span class="fu">brm</span>(</span>
<span id="cb41-989"><a href="#cb41-989" aria-hidden="true" tabindex="-1"></a>  response <span class="sc">|</span> <span class="fu">thres</span>(<span class="at">gr =</span> item) <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> id),</span>
<span id="cb41-990"><a href="#cb41-990" aria-hidden="true" tabindex="-1"></a>  <span class="at">data    =</span> df2,</span>
<span id="cb41-991"><a href="#cb41-991" aria-hidden="true" tabindex="-1"></a>  <span class="at">prior   =</span> prior_pcm,</span>
<span id="cb41-992"><a href="#cb41-992" aria-hidden="true" tabindex="-1"></a>  <span class="at">chains  =</span> <span class="dv">4</span>,</span>
<span id="cb41-993"><a href="#cb41-993" aria-hidden="true" tabindex="-1"></a>  <span class="at">cores   =</span> <span class="dv">4</span>,</span>
<span id="cb41-994"><a href="#cb41-994" aria-hidden="true" tabindex="-1"></a>  <span class="at">iter    =</span> <span class="dv">2000</span>,</span>
<span id="cb41-995"><a href="#cb41-995" aria-hidden="true" tabindex="-1"></a>  <span class="at">family  =</span> <span class="st">"acat"</span>,</span>
<span id="cb41-996"><a href="#cb41-996" aria-hidden="true" tabindex="-1"></a>  <span class="at">control =</span> <span class="fu">list</span>(<span class="at">adapt_delta =</span> <span class="fl">0.99</span>)</span>
<span id="cb41-997"><a href="#cb41-997" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb41-998"><a href="#cb41-998" aria-hidden="true" tabindex="-1"></a><span class="fu">loo</span>(brms_pcm)</span>
<span id="cb41-999"><a href="#cb41-999" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-1000"><a href="#cb41-1000" aria-hidden="true" tabindex="-1"></a><span class="fu">qs_save</span>(brms_pcm, <span class="at">file =</span> <span class="st">"brms_pcm.qs2"</span>, <span class="at">compress_level =</span> <span class="dv">11</span>)</span>
<span id="cb41-1001"><a href="#cb41-1001" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb41-1002"><a href="#cb41-1002" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-1003"><a href="#cb41-1003" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-1006"><a href="#cb41-1006" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb41-1007"><a href="#cb41-1007" aria-hidden="true" tabindex="-1"></a>brms_pcm <span class="ot">&lt;-</span> <span class="fu">qs_read</span>(<span class="st">"brms_pcm.qs2"</span>)</span>
<span id="cb41-1008"><a href="#cb41-1008" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-1009"><a href="#cb41-1009" aria-hidden="true" tabindex="-1"></a>posterior_draws_pcm <span class="ot">&lt;-</span> brms_pcm <span class="sc">%&gt;%</span></span>
<span id="cb41-1010"><a href="#cb41-1010" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_draws_df</span>() <span class="sc">%&gt;%</span></span>
<span id="cb41-1011"><a href="#cb41-1011" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">starts_with</span>(<span class="st">"r_id"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb41-1012"><a href="#cb41-1012" aria-hidden="true" tabindex="-1"></a>  <span class="fu">t</span>()</span>
<span id="cb41-1013"><a href="#cb41-1013" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb41-1014"><a href="#cb41-1014" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-1015"><a href="#cb41-1015" aria-hidden="true" tabindex="-1"></a><span class="fu">### Conditional reliability</span></span>
<span id="cb41-1016"><a href="#cb41-1016" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-1017"><a href="#cb41-1017" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb41-1018"><a href="#cb41-1018" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Alpha</span></span>
<span id="cb41-1021"><a href="#cb41-1021" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb41-1022"><a href="#cb41-1022" aria-hidden="true" tabindex="-1"></a><span class="fu">RIrelRep</span>(eRm<span class="sc">::</span>pcmdat2)<span class="sc">$</span>plot</span>
<span id="cb41-1023"><a href="#cb41-1023" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb41-1024"><a href="#cb41-1024" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-1025"><a href="#cb41-1025" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Omega</span></span>
<span id="cb41-1028"><a href="#cb41-1028" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb41-1029"><a href="#cb41-1029" aria-hidden="true" tabindex="-1"></a><span class="fu">RIrelRep</span>(eRm<span class="sc">::</span>pcmdat2, <span class="at">rel =</span> <span class="st">"omega"</span>)<span class="sc">$</span>plot</span>
<span id="cb41-1030"><a href="#cb41-1030" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb41-1031"><a href="#cb41-1031" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb41-1032"><a href="#cb41-1032" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-1033"><a href="#cb41-1033" aria-hidden="true" tabindex="-1"></a><span class="fu">### Summary table</span></span>
<span id="cb41-1034"><a href="#cb41-1034" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-1037"><a href="#cb41-1037" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb41-1038"><a href="#cb41-1038" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb41-1039"><a href="#cb41-1039" aria-hidden="true" tabindex="-1"></a>brms4000pcm <span class="ot">&lt;-</span> <span class="fu">map_dfr</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">50</span>, <span class="sc">~</span> <span class="fu">RMUreliability</span>(posterior_draws_pcm)[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>]) <span class="sc">%&gt;%</span> </span>
<span id="cb41-1040"><a href="#cb41-1040" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">rmu_estimate =</span> <span class="fu">mean</span>(rmu_estimate),</span>
<span id="cb41-1041"><a href="#cb41-1041" aria-hidden="true" tabindex="-1"></a>              <span class="at">hdci_lowerbound =</span> <span class="fu">mean</span>(hdci_lowerbound),</span>
<span id="cb41-1042"><a href="#cb41-1042" aria-hidden="true" tabindex="-1"></a>              <span class="at">hdci_upperbound =</span> <span class="fu">mean</span>(hdci_upperbound)</span>
<span id="cb41-1043"><a href="#cb41-1043" aria-hidden="true" tabindex="-1"></a>              ) <span class="sc">%&gt;%</span> </span>
<span id="cb41-1044"><a href="#cb41-1044" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), <span class="sc">~</span> <span class="fu">round</span>(.x, <span class="dv">3</span>)))</span>
<span id="cb41-1045"><a href="#cb41-1045" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-1046"><a href="#cb41-1046" aria-hidden="true" tabindex="-1"></a>rmu_mirt_wle_full <span class="ot">&lt;-</span> <span class="fu">RIreliability50</span>(eRm<span class="sc">::</span>pcmdat2, <span class="at">draws =</span> <span class="dv">4000</span>, <span class="at">verbose =</span> F)</span>
<span id="cb41-1047"><a href="#cb41-1047" aria-hidden="true" tabindex="-1"></a>rmu_mirt_eap_full <span class="ot">&lt;-</span> <span class="fu">RIreliability50</span>(eRm<span class="sc">::</span>pcmdat2, <span class="at">draws =</span> <span class="dv">4000</span>, <span class="at">estim =</span> <span class="st">"EAP"</span>, <span class="at">verbose =</span> F)</span>
<span id="cb41-1048"><a href="#cb41-1048" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-1049"><a href="#cb41-1049" aria-hidden="true" tabindex="-1"></a>rmu_mirt_wle4000 <span class="ot">&lt;-</span> <span class="fu">RIreliability50</span>(eRm<span class="sc">::</span>pcmdat2, <span class="at">draws =</span> <span class="dv">4000</span>, <span class="at">verbose =</span> F)<span class="sc">$</span>RMU</span>
<span id="cb41-1050"><a href="#cb41-1050" aria-hidden="true" tabindex="-1"></a>rmu_mirt_eap4000 <span class="ot">&lt;-</span> <span class="fu">RIreliability50</span>(eRm<span class="sc">::</span>pcmdat2, <span class="at">draws =</span> <span class="dv">4000</span>, <span class="at">estim =</span> <span class="st">"EAP"</span>, <span class="at">verbose =</span> F)<span class="sc">$</span>RMU</span>
<span id="cb41-1051"><a href="#cb41-1051" aria-hidden="true" tabindex="-1"></a>rmu_tam_eap4000 <span class="ot">&lt;-</span> <span class="fu">RIreliability50</span>(eRm<span class="sc">::</span>pcmdat2, <span class="at">draws =</span> <span class="dv">4000</span>, <span class="at">pv =</span> <span class="st">"TAM"</span>, <span class="at">verbose =</span> F)<span class="sc">$</span>RMU</span>
<span id="cb41-1052"><a href="#cb41-1052" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb41-1053"><a href="#cb41-1053" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-1056"><a href="#cb41-1056" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb41-1057"><a href="#cb41-1057" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="at">Metric =</span> <span class="fu">c</span>(<span class="st">"RMU brms 4000"</span>,<span class="st">"WLE-RMU PV 4000 (mirt)"</span>,<span class="st">"EAP-RMU PV 4000 (mirt)"</span>,<span class="st">"EAP-RMU PV 4000 (TAM)"</span>,<span class="st">"EAP"</span>,<span class="st">"WLE empirical (mirt)"</span>,<span class="st">"EAP empirical (mirt)"</span>,<span class="st">"PSI"</span>,<span class="st">"Alpha"</span>,<span class="st">"Omega"</span>),</span>
<span id="cb41-1058"><a href="#cb41-1058" aria-hidden="true" tabindex="-1"></a>           <span class="at">Estimate =</span> <span class="fu">c</span>(<span class="st">"0.672, 95% HDCI [0.615, 0.729]"</span>,</span>
<span id="cb41-1059"><a href="#cb41-1059" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"0.671, 95% HDCI [0.618, 0.721]"</span>,</span>
<span id="cb41-1060"><a href="#cb41-1060" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"0.670, 95% HDCI [0.618, 0.721]"</span>,</span>
<span id="cb41-1061"><a href="#cb41-1061" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"0.672, 95% HDCI [0.621, 0.722]"</span>,</span>
<span id="cb41-1062"><a href="#cb41-1062" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"0.669"</span>,</span>
<span id="cb41-1063"><a href="#cb41-1063" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"0.718"</span>,</span>
<span id="cb41-1064"><a href="#cb41-1064" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"0.670"</span>,</span>
<span id="cb41-1065"><a href="#cb41-1065" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"0.380"</span>,</span>
<span id="cb41-1066"><a href="#cb41-1066" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"0.66 95% CI [0.59,0.72]"</span>,</span>
<span id="cb41-1067"><a href="#cb41-1067" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"0.63 95% CI [0.56,0.70]"</span>)</span>
<span id="cb41-1068"><a href="#cb41-1068" aria-hidden="true" tabindex="-1"></a>           ) <span class="sc">%&gt;%</span> </span>
<span id="cb41-1069"><a href="#cb41-1069" aria-hidden="true" tabindex="-1"></a>  knitr<span class="sc">::</span><span class="fu">kable</span>()</span>
<span id="cb41-1070"><a href="#cb41-1070" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb41-1071"><a href="#cb41-1071" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-1072"><a href="#cb41-1072" aria-hidden="true" tabindex="-1"></a><span class="fu">## Session info</span></span>
<span id="cb41-1073"><a href="#cb41-1073" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-1076"><a href="#cb41-1076" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb41-1077"><a href="#cb41-1077" aria-hidden="true" tabindex="-1"></a><span class="fu">sessionInfo</span>()</span>
<span id="cb41-1078"><a href="#cb41-1078" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb41-1079"><a href="#cb41-1079" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-1080"><a href="#cb41-1080" aria-hidden="true" tabindex="-1"></a><span class="fu">## References</span></span>
</code></pre></div><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></div>
</div></div></div></div></div>
</div> <!-- /content -->



</body></html>