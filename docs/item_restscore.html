<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.56">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="author" content="Magnus Johansson">
<meta name="dcterms.date" content="2024-09-18">
<title>Rasch item-restscore and sample size – R, Rasch, etc</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><script src="site_libs/kePrint-0.0.1/kePrint.js"></script><link href="site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<link rel="stylesheet" href="styles.css">
<meta property="og:title" content="Rasch item-restscore and sample size – R, Rasch, etc">
<meta property="og:description" content="">
<meta property="og:image" content="https://pgmj.github.io/data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg==">
<meta property="og:site_name" content="R, Rasch, etc">
<meta name="twitter:title" content="Rasch item-restscore and sample size – R, Rasch, etc">
<meta name="twitter:description" content="">
<meta name="twitter:image" content="https://pgmj.github.io/data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg==">
<meta name="twitter:card" content="summary_large_image">
</head>
<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="navbar navbar-expand-lg " data-bs-theme="dark"><div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">R, Rasch, etc</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
<li class="nav-item">
    <a class="nav-link" href="./index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./raschrvignette/RaschRvign.html"> 
<span class="menu-text">RISEkbmRasch vignette</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./about.html"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-blog" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Blog</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-blog">
<li>
    <a class="dropdown-item" href="./parameterizedQ.html">
 <span class="dropdown-text">Automating reports with Quarto</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./latentResp/LatentResponse.html">
 <span class="dropdown-text">What’s in a latent trait score?</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./SkolverketAPI/skolverketapi.html">
 <span class="dropdown-text">Data retrieval with R using API calls</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./powerviz.html">
 <span class="dropdown-text">Power analysis for multilevel models</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./datawrangling.html">
 <span class="dropdown-text">Data wrangling for psychometrics in R</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./simcutoffs.html">
 <span class="dropdown-text">Simulation based cutoff values for Rasch item fit and residual correlations</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./est_comp.html">
 <span class="dropdown-text">Comparing Rasch packages/estimators</span></a>
  </li>  
    </ul>
</li>
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/pgmj/pgmj.github.io"> <i class="bi bi-github" role="img" aria-label="GitHub">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
</div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav><div id="quarto-announcement" data-announcement-id="f2201fbbefb1e9b8685bd91e4d0da5c8" class="alert alert-primary hidden">
<i class="bi bi-info-circle quarto-announcement-icon"></i><div class="quarto-announcement-content">
<p><strong>Note:</strong> The RISEkbmRasch vignette has new material on conditional item fit and simulation based cutoff values.</p>
</div>
<i class="bi bi-x-lg quarto-announcement-action"></i>
</div>
</header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Table of contents</h2>
   
  <ul>
<li>
<a href="#background" id="toc-background" class="nav-link active" data-scroll-target="#background"><span class="header-section-number">1</span> Background</a>
  <ul class="collapse">
<li><a href="#example" id="toc-example" class="nav-link" data-scroll-target="#example"><span class="header-section-number">1.1</span> Example</a></li>
  <li><a href="#reduced-sample" id="toc-reduced-sample" class="nav-link" data-scroll-target="#reduced-sample"><span class="header-section-number">1.2</span> Reduced sample</a></li>
  </ul>
</li>
  <li>
<a href="#non-parametric-bootstrapping" id="toc-non-parametric-bootstrapping" class="nav-link" data-scroll-target="#non-parametric-bootstrapping"><span class="header-section-number">2</span> Non-parametric bootstrapping</a>
  <ul class="collapse">
<li><a href="#results" id="toc-results" class="nav-link" data-scroll-target="#results"><span class="header-section-number">2.1</span> Results</a></li>
  </ul>
</li>
  <li>
<a href="#test-2" id="toc-test-2" class="nav-link" data-scroll-target="#test-2"><span class="header-section-number">3</span> Test 2</a>
  <ul class="collapse">
<li><a href="#results-1" id="toc-results-1" class="nav-link" data-scroll-target="#results-1"><span class="header-section-number">3.1</span> Results</a></li>
  </ul>
</li>
  <li>
<a href="#item-restscore-sample-size-variation" id="toc-item-restscore-sample-size-variation" class="nav-link" data-scroll-target="#item-restscore-sample-size-variation"><span class="header-section-number">4</span> Item-restscore sample size variation</a>
  <ul class="collapse">
<li><a href="#results-2" id="toc-results-2" class="nav-link" data-scroll-target="#results-2"><span class="header-section-number">4.1</span> Results</a></li>
  </ul>
</li>
  </ul></nav>
    </div>
<!-- main -->
<main class="content column-page-left" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Rasch item-restscore and sample size</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
</div>


<div class="quarto-title-meta-author column-page-left">
  <div class="quarto-title-meta-heading">Author</div>
  <div class="quarto-title-meta-heading">Affiliation</div>
  
    <div class="quarto-title-meta-contents">
    <p class="author">Magnus Johansson <a href="https://orcid.org/0000-0003-1669-592X" class="quarto-title-author-orcid"> <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg=="></a></p>
  </div>
  <div class="quarto-title-meta-contents">
        <p class="affiliation">
            <a href="https://www.ri.se/sv/vad-vi-gor/expertiser/kategoriskt-baserade-matningar">
            RISE Research Institutes of Sweden
            </a>
          </p>
      </div>
  </div>

<div class="quarto-title-meta column-page-left">

      
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">September 18, 2024</p>
    </div>
  </div>
  
    
  </div>
  


</header><div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">iarm</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://mjskay.github.io/ggdist/">ggdist</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/pgmj/RISEkbmRasch">RISEkbmRasch</a></span><span class="op">)</span></span>
<span><span class="co">### some commands exist in multiple packages, here we define preferred ones that are frequently used</span></span>
<span><span class="va">select</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="va"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span></span>
<span><span class="va">count</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="va"><a href="https://dplyr.tidyverse.org/reference/count.html">count</a></span></span>
<span><span class="va">rename</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="va"><a href="https://dplyr.tidyverse.org/reference/rename.html">rename</a></span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="background" class="level2" data-number="1"><h2 data-number="1" class="anchored" data-anchor-id="background">
<span class="header-section-number">1</span> Background</h2>
<p>It seems to me that the <code><a href="https://rdrr.io/pkg/iarm/man/item_restscore.html">iarm::item_restscore()</a></code> function is sensitive to sample size, which is not surprising as it provides a p-value. The questions of interest to me are:</p>
<ul>
<li>how important is that p-value in itself?</li>
<li>what is the connection between the difference between observed and expected score and the p-value? (magnitude and significance, if you will)</li>
<li>how is item-restscore related to the bootstrapped p-values from the <code><a href="https://rdrr.io/pkg/iarm/man/boot_fit.html">iarm::boot_fit()</a></code> function (which calculates conditional item fit values)?</li>
<li>how is simulation based cutoff values for conditional infit/outfit related to the two above?</li>
</ul>
<p>I will use the Rasch Partial Credit Model (PCM) for some explorations of this topic.</p>
<section id="example" class="level3" data-number="1.1"><h3 data-number="1.1" class="anchored" data-anchor-id="example">
<span class="header-section-number">1.1</span> Example</h3>
<p>First, we’ll review results from the dataset <code>pcmdat2</code> included in the <code>eRm</code> package.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/RISEkbmRasch/man/RItileplot.html">RItileplot</a></span><span class="op">(</span><span class="va">pcmdat2</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="item_restscore_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid figure-img" width="1050"></p>
</figure>
</div>
</div>
</div>
<div class="cell" data-fig-label="targeting1">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/RISEkbmRasch/man/RItargeting.html">RItargeting</a></span><span class="op">(</span><span class="va">pcmdat2</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="item_restscore_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid figure-img" width="1050"></p>
</figure>
</div>
</div>
</div>
<p>300 respondents, 4 items with 4 response categories each.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">testfit</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">data</span>, <span class="va">boot</span> <span class="op">=</span> <span class="fl">100</span>, <span class="va">sfit</span> <span class="op">=</span> <span class="fl">500</span><span class="op">)</span> <span class="op">{</span></span>
<span>  </span>
<span>  <span class="va">i1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/iarm/man/item_restscore.html">item_restscore</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/eRm/man/PCM.html">PCM</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">i1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="va">i1</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">i2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="st">"observed"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">i1</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span>,</span>
<span>                   <span class="st">"expected"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">i1</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span>,</span>
<span>                   <span class="st">"se"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">i1</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span>,<span class="fl">3</span><span class="op">]</span><span class="op">)</span>,</span>
<span>                   <span class="st">"p.value"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">i1</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span>,<span class="fl">4</span><span class="op">]</span><span class="op">)</span>,</span>
<span>                   <span class="st">"p.adj.BH"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">i1</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span>,<span class="fl">5</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>diff_abs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="va">expected</span> <span class="op">-</span> <span class="va">observed</span><span class="op">)</span>,</span>
<span>           diff <span class="op">=</span> <span class="va">expected</span> <span class="op">-</span> <span class="va">observed</span><span class="op">)</span></span>
<span>  <span class="va">ifit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/iarm/man/out_infit.html">out_infit</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/eRm/man/PCM.html">PCM</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">bfit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/iarm/man/boot_fit.html">boot_fit</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/eRm/man/PCM.html">PCM</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span>,<span class="va">boot</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">sfit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/RISEkbmRasch/man/RIgetfit.html">RIgetfit</a></span><span class="op">(</span><span class="va">data</span>,<span class="va">sfit</span>,<span class="fl">8</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="st">"item_restscore"</span> <span class="op">=</span> <span class="va">i2</span>,</span>
<span>              <span class="st">"out_infit"</span> <span class="op">=</span> <span class="va">ifit</span>,</span>
<span>              <span class="st">"boot_fit"</span> <span class="op">=</span> <span class="va">bfit</span>,</span>
<span>              <span class="st">"sfit"</span> <span class="op">=</span> <span class="va">sfit</span><span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">out</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">test1</span> <span class="op">&lt;-</span> <span class="fu">testfit</span><span class="op">(</span><span class="va">pcmdat2</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>

 Number of bootstrap samples:  10, 20, 30, 40, 50, 60, 70, 80, 90, 100, 
 </code></pre>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">test1</span><span class="op">$</span><span class="va">item_restscore</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>  observed expected     se p.value p.adj.BH diff_abs    diff
1   0.4729   0.5243 0.0530  0.3329   0.4439   0.0514  0.0514
2   0.4414   0.5244 0.0593  0.1620   0.3240   0.0830  0.0830
3   0.6427   0.4849 0.0541  0.0035   0.0140   0.1578 -0.1578
4   0.5351   0.4956 0.0599  0.5098   0.5098   0.0395 -0.0395</code></pre>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">test1</span><span class="op">$</span><span class="va">boot_fit</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
   Outfit pvalue padj  sig   Infit pvalue padj  sig   
I1 1.069  0.36   0.48        1.08  0.136  0.271       
I2 1.084  0.186  0.298       1.155 0      0     ***   
I3 0.802  0.019  0.05   .    0.828 0      0     ***   
I4 1.024  0.814  0.93        1.007 0.955  0.955       

P value adjustment: BH</code></pre>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/RISEkbmRasch/man/RIitemfit.html">RIitemfit</a></span><span class="op">(</span><span class="va">pcmdat2</span>,<span class="va">test1</span><span class="op">$</span><span class="va">sfit</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table data-quarto-disable-processing="true" style="width:65%; font-size: 14px;  font-family: Arial; margin-left: auto; margin-right: auto;border-bottom: 0;" class="table table-striped table-hover lightable-classic">
<thead><tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> Item </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> InfitMSQ </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> Infit thresholds </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> OutfitMSQ </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> Outfit thresholds </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> Infit diff </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> Outfit diff </th>
  </tr></thead>
<tbody>
<tr>
<td style="text-align:left;"> I1 </td>
   <td style="text-align:left;"> <span style="     color: black !important;">1.08</span> </td>
   <td style="text-align:left;"> [0.861, 1.156] </td>
   <td style="text-align:left;"> <span style="     color: black !important;">1.069</span> </td>
   <td style="text-align:left;"> [0.839, 1.212] </td>
   <td style="text-align:left;"> no misfit </td>
   <td style="text-align:left;"> no misfit </td>
  </tr>
<tr>
<td style="text-align:left;"> I2 </td>
   <td style="text-align:left;"> <span style="     color: black !important;">1.155</span> </td>
   <td style="text-align:left;"> [0.839, 1.202] </td>
   <td style="text-align:left;"> <span style="     color: black !important;">1.084</span> </td>
   <td style="text-align:left;"> [0.813, 1.32] </td>
   <td style="text-align:left;"> no misfit </td>
   <td style="text-align:left;"> no misfit </td>
  </tr>
<tr>
<td style="text-align:left;"> I3 </td>
   <td style="text-align:left;"> <span style="     color: red !important;">0.828</span> </td>
   <td style="text-align:left;"> [0.861, 1.157] </td>
   <td style="text-align:left;"> <span style="     color: red !important;">0.802</span> </td>
   <td style="text-align:left;"> [0.812, 1.226] </td>
   <td style="text-align:left;"> 0.033 </td>
   <td style="text-align:left;"> 0.01 </td>
  </tr>
<tr>
<td style="text-align:left;"> I4 </td>
   <td style="text-align:left;"> <span style="     color: black !important;">1.007</span> </td>
   <td style="text-align:left;"> [0.836, 1.183] </td>
   <td style="text-align:left;"> <span style="     color: black !important;">1.024</span> </td>
   <td style="text-align:left;"> [0.814, 1.23] </td>
   <td style="text-align:left;"> no misfit </td>
   <td style="text-align:left;"> no misfit </td>
  </tr>
</tbody>
<tfoot>
<tr><td style="padding: 0; " colspan="100%"><span style="font-style: italic;">Note: </span></td></tr>
<tr><td style="padding: 0; " colspan="100%">
<sup></sup> MSQ values based on conditional calculations (n = 300 complete cases).<br>                                Simulation based thresholds from 500 simulated datasets.</td></tr>
</tfoot>
</table>
</div>
</div>
<p>We have a significant item-restscore deviation for item 3 (higher than expected), and the low infit/outfit is significant when using bootstrapped p-values (100 iterations). The simulation based cutoff values for infit/outfit agree (500 iterations).</p>
<p>Also, note that item 3 has the worst targeting (see <strong>?@fig-targeting1</strong>)</p>
</section><section id="reduced-sample" class="level3" data-number="1.2"><h3 data-number="1.2" class="anchored" data-anchor-id="reduced-sample">
<span class="header-section-number">1.2</span> Reduced sample</h3>
<p>Our sample size is 300. What happens if we reduce that to 100?</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">1324</span><span class="op">)</span></span>
<span><span class="va">d100</span> <span class="op">&lt;-</span> <span class="va">pcmdat2</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">300</span>, <span class="fl">100</span><span class="op">)</span>, <span class="op">]</span></span>
<span></span>
<span><span class="va">test2</span> <span class="op">&lt;-</span> <span class="fu">testfit</span><span class="op">(</span><span class="va">d100</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>

 Number of bootstrap samples:  10, 20, 30, 40, 50, 60, 70, 80, 90, 100, 
 </code></pre>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">test2</span><span class="op">$</span><span class="va">item_restscore</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>  observed expected     se p.value p.adj.BH diff_abs    diff
1   0.4805   0.4989 0.0915  0.8407   0.9772   0.0184  0.0184
2   0.4541   0.5061 0.1016  0.6084   0.9772   0.0520  0.0520
3   0.6168   0.4551 0.1117  0.1477   0.5909   0.1617 -0.1617
4   0.4763   0.4730 0.1150  0.9772   0.9772   0.0033 -0.0033</code></pre>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb15"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">test2</span><span class="op">$</span><span class="va">boot_fit</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
   Outfit pvalue padj  sig  Infit pvalue padj  sig 
I1 1.039  0.65   0.698      1.024 0.698  0.698     
I2 1.042  0.658  0.698      1.071 0.675  0.698     
I3 0.911  0.404  0.698      0.869 0.12   0.698     
I4 1.039  0.66   0.698      1.045 0.554  0.698     

P value adjustment: BH</code></pre>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb17"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/RISEkbmRasch/man/RIitemfit.html">RIitemfit</a></span><span class="op">(</span><span class="va">d100</span>,<span class="va">test2</span><span class="op">$</span><span class="va">sfit</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table data-quarto-disable-processing="true" style="width:65%; font-size: 14px;  font-family: Arial; margin-left: auto; margin-right: auto;border-bottom: 0;" class="table table-striped table-hover lightable-classic">
<thead><tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> Item </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> InfitMSQ </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> Infit thresholds </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> OutfitMSQ </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> Outfit thresholds </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> Infit diff </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> Outfit diff </th>
  </tr></thead>
<tbody>
<tr>
<td style="text-align:left;"> I1 </td>
   <td style="text-align:left;"> <span style="     color: black !important;">1.024</span> </td>
   <td style="text-align:left;"> [0.744, 1.288] </td>
   <td style="text-align:left;"> <span style="     color: black !important;">1.039</span> </td>
   <td style="text-align:left;"> [0.726, 1.609] </td>
   <td style="text-align:left;"> no misfit </td>
   <td style="text-align:left;"> no misfit </td>
  </tr>
<tr>
<td style="text-align:left;"> I2 </td>
   <td style="text-align:left;"> <span style="     color: black !important;">1.071</span> </td>
   <td style="text-align:left;"> [0.742, 1.305] </td>
   <td style="text-align:left;"> <span style="     color: black !important;">1.042</span> </td>
   <td style="text-align:left;"> [0.728, 1.647] </td>
   <td style="text-align:left;"> no misfit </td>
   <td style="text-align:left;"> no misfit </td>
  </tr>
<tr>
<td style="text-align:left;"> I3 </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0.869</span> </td>
   <td style="text-align:left;"> [0.763, 1.269] </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0.911</span> </td>
   <td style="text-align:left;"> [0.67, 1.456] </td>
   <td style="text-align:left;"> no misfit </td>
   <td style="text-align:left;"> no misfit </td>
  </tr>
<tr>
<td style="text-align:left;"> I4 </td>
   <td style="text-align:left;"> <span style="     color: black !important;">1.045</span> </td>
   <td style="text-align:left;"> [0.76, 1.31] </td>
   <td style="text-align:left;"> <span style="     color: black !important;">1.039</span> </td>
   <td style="text-align:left;"> [0.692, 1.439] </td>
   <td style="text-align:left;"> no misfit </td>
   <td style="text-align:left;"> no misfit </td>
  </tr>
</tbody>
<tfoot>
<tr><td style="padding: 0; " colspan="100%"><span style="font-style: italic;">Note: </span></td></tr>
<tr><td style="padding: 0; " colspan="100%">
<sup></sup> MSQ values based on conditional calculations (n = 100 complete cases).<br>                                Simulation based thresholds from 486 simulated datasets.</td></tr>
</tfoot>
</table>
</div>
</div>
<p>Everything now looks ok. This could of course be due to random sampling. Let’s use the sample size of 100 and do 1000 iterations of random samples to see how many show misfit for item 3. We should really use a simulated dataset with induced (known) misfit, but let’s do that later.</p>
</section></section><section id="non-parametric-bootstrapping" class="level2" data-number="2"><h2 data-number="2" class="anchored" data-anchor-id="non-parametric-bootstrapping">
<span class="header-section-number">2</span> Non-parametric bootstrapping</h2>
<p>First, we build a function to run multiple samples.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb18"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">testfit2</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">dat</span>, <span class="va">boot</span> <span class="op">=</span> <span class="fl">100</span>, <span class="va">sfit</span> <span class="op">=</span> <span class="fl">500</span>, <span class="va">iterations</span> <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span> <span class="op">{</span></span>
<span>  </span>
<span>  <span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu">foreach</span><span class="op">(</span><span class="va">iterations</span><span class="op">)</span> <span class="op">%do%</span> <span class="op">{</span></span>
<span>    </span>
<span>    <span class="va">data</span> <span class="op">&lt;-</span> <span class="va">dat</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span>, <span class="fl">100</span><span class="op">)</span>, <span class="op">]</span></span>
<span>    </span>
<span>    <span class="va">i1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/iarm/man/item_restscore.html">item_restscore</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/eRm/man/PCM.html">PCM</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="va">i1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="va">i1</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="va">i2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="st">"observed"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">i1</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span>,</span>
<span>                     <span class="st">"expected"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">i1</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span>,</span>
<span>                     <span class="st">"se"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">i1</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span>,<span class="fl">3</span><span class="op">]</span><span class="op">)</span>,</span>
<span>                     <span class="st">"p.value"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">i1</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span>,<span class="fl">4</span><span class="op">]</span><span class="op">)</span>,</span>
<span>                     <span class="st">"p.adj.BH"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">i1</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span>,<span class="fl">5</span><span class="op">]</span><span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>diff_abs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="va">expected</span> <span class="op">-</span> <span class="va">observed</span><span class="op">)</span>,</span>
<span>             diff <span class="op">=</span> <span class="va">expected</span> <span class="op">-</span> <span class="va">observed</span>,</span>
<span>             ir_padj <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">p.adj.BH</span> <span class="op">&lt;</span> <span class="fl">.05</span>, <span class="st">"sign. misfit"</span>,<span class="st">"no misfit"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">ir_padj</span>, <span class="va">diff</span>, <span class="va">diff_abs</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>item <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="co">#ifit &lt;- out_infit(PCM(data))</span></span>
<span>    <span class="va">bfit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/iarm/man/boot_fit.html">boot_fit</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/eRm/man/PCM.html">PCM</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span>,<span class="va">boot</span><span class="op">)</span></span>
<span>    <span class="va">bfit</span> <span class="op">&lt;-</span> <span class="va">bfit</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>bfit_sig <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html">case_when</a></span><span class="op">(</span><span class="va">out.pkorr</span> <span class="op">&lt;</span> <span class="fl">.05</span> <span class="op">~</span> <span class="st">"sign. outfit"</span>,</span>
<span>                             <span class="va">in.pkorr</span> <span class="op">&lt;</span> <span class="fl">.05</span> <span class="op">~</span> <span class="st">"sign. infit"</span>,</span>
<span>                             <span class="va">out.pkorr</span> <span class="op">&lt;</span> <span class="fl">.05</span> <span class="op">&amp;</span> <span class="va">in.pkorr</span> <span class="op">&lt;</span> <span class="fl">.05</span> <span class="op">~</span> <span class="st">"sign. inoutfit"</span>,</span>
<span>                             .default <span class="op">=</span> <span class="st">"no misfit"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>item <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">item</span>,<span class="va">bfit_sig</span>,<span class="va">Outfit</span>,<span class="va">Infit</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="va">simfit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/RISEkbmRasch/man/RIgetfit.html">RIgetfit</a></span><span class="op">(</span><span class="va">data</span>,<span class="va">sfit</span>,<span class="fl">8</span><span class="op">)</span></span>
<span>    <span class="va">rfit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/RISEkbmRasch/man/RIitemfit.html">RIitemfit</a></span><span class="op">(</span><span class="va">data</span>,<span class="va">simfit</span>,output <span class="op">=</span> <span class="st">"dataframe"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">infit_diff</span>,<span class="va">outfit_diff</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>item <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="st">"item_restscore"</span> <span class="op">=</span> <span class="va">i2</span>,</span>
<span>         <span class="co">#"out_infit" = ifit,</span></span>
<span>         <span class="st">"boot_fit"</span> <span class="op">=</span> <span class="va">bfit</span>,</span>
<span>         <span class="st">"rfit"</span> <span class="op">=</span> <span class="va">rfit</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Then we run it for 1000 iterations.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb19"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#test3 &lt;- testfit2(pcmdat2, iterations = 1:1000)</span></span>
<span><span class="co">#saveRDS(test3,"irscore.Rdata")</span></span>
<span><span class="va">test3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span><span class="op">(</span><span class="st">"irscore.Rdata"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="results" class="level3" data-number="2.1"><h3 data-number="2.1" class="anchored" data-anchor-id="results">
<span class="header-section-number">2.1</span> Results</h3>
<p>Join results to a dataframe.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb20"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">iterations</span> <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">1000</span></span>
<span><span class="va">result_irscore</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map_dfr.html">map_dfr</a></span><span class="op">(</span><span class="va">iterations</span>, <span class="op">~</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html">bind_rows</a></span><span class="op">(</span><span class="va">test3</span><span class="op">[[</span><span class="va">.x</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">item_restscore</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>          <span class="fu"><a href="https://tibble.tidyverse.org/reference/add_column.html">add_column</a></span><span class="op">(</span>iteration <span class="op">=</span> <span class="va">.x</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">result_bfit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map_dfr.html">map_dfr</a></span><span class="op">(</span><span class="va">iterations</span>, <span class="op">~</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html">bind_rows</a></span><span class="op">(</span><span class="va">test3</span><span class="op">[[</span><span class="va">.x</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">boot_fit</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>          <span class="fu"><a href="https://tibble.tidyverse.org/reference/add_column.html">add_column</a></span><span class="op">(</span>iteration <span class="op">=</span> <span class="va">.x</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">result_sfit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map_dfr.html">map_dfr</a></span><span class="op">(</span><span class="va">iterations</span>, <span class="op">~</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html">bind_rows</a></span><span class="op">(</span><span class="va">test3</span><span class="op">[[</span><span class="va">.x</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">rfit</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>          <span class="fu"><a href="https://tibble.tidyverse.org/reference/add_column.html">add_column</a></span><span class="op">(</span>iteration <span class="op">=</span> <span class="va">.x</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">left_join</a></span><span class="op">(</span><span class="va">result_irscore</span>,<span class="va">result_bfit</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"iteration"</span>,<span class="st">"item"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">left_join</a></span><span class="op">(</span><span class="va">results</span>, <span class="va">result_sfit</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"iteration"</span>,<span class="st">"item"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">results</span>, <span class="fl">24</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>     ir_padj    diff diff_abs item iteration     bfit_sig    Outfit     Infit
1  no misfit  0.0727   0.0727    1         1    no misfit 1.0659711 1.0993426
2  no misfit  0.0186   0.0186    2         1    no misfit 0.9658042 1.0194994
3  no misfit -0.0587   0.0587    3         1    no misfit 1.0207190 0.9454184
4  no misfit -0.0941   0.0941    4         1    no misfit 1.0042747 0.9572694
5  no misfit -0.0027   0.0027    1         2    no misfit 0.9899937 0.9862542
6  no misfit  0.0375   0.0375    2         2    no misfit 1.0107473 1.0574265
7  no misfit -0.1745   0.1745    3         2  sign. infit 0.7756829 0.7640317
8  no misfit  0.0772   0.0772    4         2 sign. outfit 1.2900957 1.2411078
9  no misfit  0.0340   0.0340    1         3    no misfit 1.0615916 1.0620552
10 no misfit  0.1110   0.1110    2         3    no misfit 1.1499652 1.1798024
11 no misfit -0.2230   0.2230    3         3    no misfit 0.7856128 0.8097686
12 no misfit -0.0700   0.0700    4         3    no misfit 1.0055846 0.9904388
13 no misfit  0.1459   0.1459    1         4    no misfit 1.2733994 1.2708954
14 no misfit  0.0486   0.0486    2         4    no misfit 1.0097530 1.0603228
15 no misfit -0.1482   0.1482    3         4    no misfit 0.8384259 0.8156593
16 no misfit -0.0927   0.0927    4         4    no misfit 0.8229410 0.8741012
17 no misfit  0.0175   0.0175    1         5    no misfit 1.0121368 1.0234842
18 no misfit  0.0861   0.0861    2         5    no misfit 1.1212221 1.1665047
19 no misfit -0.1118   0.1118    3         5    no misfit 0.8405235 0.8587897
20 no misfit -0.0295   0.0295    4         5    no misfit 1.0095068 0.9915725
21 no misfit  0.0320   0.0320    1         6    no misfit 1.0593372 1.0527971
22 no misfit  0.1783   0.1783    2         6  sign. infit 1.2267309 1.3885530
23 no misfit -0.1901   0.1901    3         6    no misfit 0.8225946 0.8096652
24 no misfit -0.1424   0.1424    4         6    no misfit 0.8847511 0.8817594
   infit_diff outfit_diff
1   no misfit   no misfit
2   no misfit   no misfit
3   no misfit   no misfit
4   no misfit   no misfit
5   no misfit   no misfit
6   no misfit   no misfit
7   no misfit   no misfit
8   no misfit   no misfit
9   no misfit   no misfit
10  no misfit   no misfit
11  no misfit   no misfit
12  no misfit   no misfit
13      0.013   no misfit
14  no misfit   no misfit
15  no misfit   no misfit
16  no misfit   no misfit
17  no misfit   no misfit
18  no misfit   no misfit
19  no misfit   no misfit
20  no misfit   no misfit
21  no misfit   no misfit
22      0.083   no misfit
23  no misfit   no misfit
24  no misfit   no misfit</code></pre>
</div>
</div>
<p>Ok, we have some results to summarise. First, we filter on item-restscore misfit and look at the first 25 rows.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb22"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">results</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">ir_padj</span> <span class="op">==</span> <span class="st">"sign. misfit"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="fl">25</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>        ir_padj    diff diff_abs item iteration     bfit_sig    Outfit
1  sign. misfit -0.1797   0.1797    3        10 sign. outfit 0.6402285
2  sign. misfit -0.2376   0.2376    3        18    no misfit 0.7747958
3  sign. misfit -0.2552   0.2552    3        20 sign. outfit 0.6827816
4  sign. misfit -0.2531   0.2531    3        31 sign. outfit 0.6621439
5  sign. misfit -0.2729   0.2729    3        38 sign. outfit 0.6762267
6  sign. misfit -0.2129   0.2129    4        41 sign. outfit 0.6905030
7  sign. misfit -0.2334   0.2334    3        49 sign. outfit 0.6526281
8  sign. misfit -0.1905   0.1905    3        56 sign. outfit 0.6704844
9  sign. misfit -0.2583   0.2583    3        59 sign. outfit 0.7076849
10 sign. misfit -0.2280   0.2280    3        64 sign. outfit 0.6629790
11 sign. misfit -0.2323   0.2323    3        70  sign. infit 0.7532934
12 sign. misfit -0.2511   0.2511    3        71 sign. outfit 0.7174040
13 sign. misfit -0.2065   0.2065    3        76 sign. outfit 0.6904129
14 sign. misfit -0.2055   0.2055    3        84  sign. infit 0.7523724
15 sign. misfit -0.2479   0.2479    3        87    no misfit 0.6721512
16 sign. misfit -0.2206   0.2206    3        89 sign. outfit 0.6917995
17 sign. misfit -0.2220   0.2220    3        90    no misfit 0.6786376
18 sign. misfit -0.2364   0.2364    3        97 sign. outfit 0.5883898
19 sign. misfit -0.2585   0.2585    3       101 sign. outfit 0.6865158
20 sign. misfit -0.2799   0.2799    3       103 sign. outfit 0.6043981
21 sign. misfit -0.2521   0.2521    3       108 sign. outfit 0.7258624
22 sign. misfit -0.2284   0.2284    3       109 sign. outfit 0.6607257
23 sign. misfit -0.2850   0.2850    3       113 sign. outfit 0.6595454
24 sign. misfit -0.2197   0.2197    3       123 sign. outfit 0.6570153
25 sign. misfit -0.2744   0.2744    3       124 sign. outfit 0.6481838
       Infit infit_diff outfit_diff
1  0.7305199  no misfit   no misfit
2  0.7693903      0.004   no misfit
3  0.7218550      0.043       0.032
4  0.7247758      0.028       0.022
5  0.7155371      0.015   no misfit
6  0.7658634  no misfit   no misfit
7  0.7104056      0.045   no misfit
8  0.7227110      0.022   no misfit
9  0.7764644       0.01   no misfit
10 0.7339133      0.038       0.013
11 0.7558214      0.013   no misfit
12 0.7302366      0.026   no misfit
13 0.7466734      0.007   no misfit
14 0.7191440       0.03   no misfit
15 0.7524506      0.001   no misfit
16 0.7353687      0.057   no misfit
17 0.7417101  no misfit   no misfit
18 0.6870658       0.04       0.033
19 0.7523964      0.005       0.014
20 0.6582644      0.071       0.074
21 0.7784688  no misfit   no misfit
22 0.7416230      0.016       0.028
23 0.6928638      0.067   no misfit
24 0.7170398      0.011   no misfit
25 0.7348365      0.038   no misfit</code></pre>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb24"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">results</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">ir_padj</span> <span class="op">==</span> <span class="st">"sign. misfit"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html">count</a></span><span class="op">(</span><span class="va">item</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>  item   n
1    3 200
2    4   1</code></pre>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb26"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">ir</span> <span class="op">&lt;-</span> <span class="va">results</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">ir_padj</span> <span class="op">==</span> <span class="st">"sign. misfit"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">bf</span> <span class="op">&lt;-</span> <span class="va">results</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">ir_padj</span> <span class="op">==</span> <span class="st">"sign. misfit"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">bfit_sig</span> <span class="op">==</span> <span class="st">"no misfit"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">bfout</span> <span class="op">&lt;-</span> <span class="va">results</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">ir_padj</span> <span class="op">==</span> <span class="st">"sign. misfit"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">bfit_sig</span> <span class="op">==</span> <span class="st">"sign. outfit"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">simfitin</span> <span class="op">&lt;-</span> <span class="va">results</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">ir_padj</span> <span class="op">==</span> <span class="st">"sign. misfit"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="va">infit_diff</span> <span class="op">==</span> <span class="st">"no misfit"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">simfitout</span> <span class="op">&lt;-</span> <span class="va">results</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">ir_padj</span> <span class="op">==</span> <span class="st">"sign. misfit"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="va">outfit_diff</span> <span class="op">==</span> <span class="st">"no misfit"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">simfitboth</span> <span class="op">&lt;-</span> <span class="va">results</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">ir_padj</span> <span class="op">==</span> <span class="st">"sign. misfit"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="va">outfit_diff</span> <span class="op">==</span> <span class="st">"no misfit"</span> <span class="op">|</span> <span class="op">!</span><span class="va">infit_diff</span> <span class="op">==</span> <span class="st">"no misfit"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Item 3 misfit almost exclusively, except for one instance of item 4. Item-restscore shows misfit in 201 (out of 1000) datasets, 20.1%.</p>
<p>Bootstrapped (using 100 bootstraps per dataset) item infit/outfit p-values also indicate significant misfit amongst the datasets identified by item-restscore, and agrees with item-restscore all but 24 cases.</p>
<p>Simulation based cutoffs using 500 iterations (per dataset) indicate less misfit in this sample of item-restscore misfits. 149 out of 201, of which 142 were flagged for infit, and 70 for outfit.</p>
<section id="item-restscore" class="level4" data-number="2.1.1"><h4 data-number="2.1.1" class="anchored" data-anchor-id="item-restscore">
<span class="header-section-number">2.1.1</span> Item-restscore</h4>
<p>Let’s review the observed/expected differences.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb27"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">results</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">ir_padj</span> <span class="op">==</span> <span class="st">"sign. misfit"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span>Median <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/median.html">median</a></span><span class="op">(</span><span class="va">diff_abs</span><span class="op">)</span>,</span>
<span>            MAD <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/mad.html">mad</a></span><span class="op">(</span><span class="va">diff_abs</span><span class="op">)</span>,</span>
<span>            Mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">diff_abs</span><span class="op">)</span>,</span>
<span>            SD <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">diff_abs</span><span class="op">)</span>,</span>
<span>            Max <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">diff_abs</span><span class="op">)</span>,</span>
<span>            Min <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">diff_abs</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<thead><tr class="header">
<th style="text-align: right;">Median</th>
<th style="text-align: right;">MAD</th>
<th style="text-align: right;">Mean</th>
<th style="text-align: right;">SD</th>
<th style="text-align: right;">Max</th>
<th style="text-align: right;">Min</th>
</tr></thead>
<tbody><tr class="odd">
<td style="text-align: right;">0.232</td>
<td style="text-align: right;">0.031</td>
<td style="text-align: right;">0.235</td>
<td style="text-align: right;">0.031</td>
<td style="text-align: right;">0.348</td>
<td style="text-align: right;">0.167</td>
</tr></tbody>
</table>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb28"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">results</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">ir_padj</span> <span class="op">==</span> <span class="st">"sign. misfit"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="http://mjskay.github.io/ggdist/reference/stat_dotsinterval.html">stat_dotsinterval</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">diff_abs</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_continuous</a></span><span class="op">(</span><span class="st">'Distribution of absolut differences'</span>, limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0.4</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Observed vs expected item-restscore values"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="item_restscore_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="1050"></p>
</figure>
</div>
</div>
</div>
<p>The results above were filtered on only item-restscore, so there may be other results for the other methods.</p>
</section><section id="bootfit" class="level4" data-number="2.1.2"><h4 data-number="2.1.2" class="anchored" data-anchor-id="bootfit">
<span class="header-section-number">2.1.2</span> Bootfit</h4>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb29"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">bfo</span> <span class="op">&lt;-</span> <span class="va">results</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">bfit_sig</span> <span class="op">==</span> <span class="st">"sign. outfit"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">results</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">bfit_sig</span> <span class="op">==</span> <span class="st">"sign. outfit"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html">count</a></span><span class="op">(</span><span class="va">item</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span>caption <span class="op">=</span> <span class="st">"Items with statistically significant outfit"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Items with statistically significant outfit</caption>
<thead><tr class="header">
<th style="text-align: right;">item</th>
<th style="text-align: right;">n</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">24</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">9</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td style="text-align: right;">269</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: right;">35</td>
</tr>
</tbody>
</table>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb30"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">bfi</span> <span class="op">&lt;-</span> <span class="va">results</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">bfit_sig</span> <span class="op">==</span> <span class="st">"sign. infit"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">results</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">bfit_sig</span> <span class="op">==</span> <span class="st">"sign. infit"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html">count</a></span><span class="op">(</span><span class="va">item</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span>caption <span class="op">=</span> <span class="st">"Items with statistically significant infit"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Items with statistically significant infit</caption>
<thead><tr class="header">
<th style="text-align: right;">item</th>
<th style="text-align: right;">n</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">21</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">100</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td style="text-align: right;">56</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: right;">1</td>
</tr>
</tbody>
</table>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb31"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">bfboth</span> <span class="op">&lt;-</span> <span class="va">results</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">bfit_sig</span> <span class="op">==</span> <span class="st">"sign. infit"</span> <span class="op">|</span> <span class="va">bfit_sig</span> <span class="op">==</span> <span class="st">"sign. outfit"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">results</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">bfit_sig</span> <span class="op">==</span> <span class="st">"sign. infit"</span> <span class="op">|</span> <span class="va">bfit_sig</span> <span class="op">==</span> <span class="st">"sign. outfit"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html">count</a></span><span class="op">(</span><span class="va">item</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span>caption <span class="op">=</span> <span class="st">"Items with statistically significant infit and/or outfit"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Items with statistically significant infit and/or outfit</caption>
<thead><tr class="header">
<th style="text-align: right;">item</th>
<th style="text-align: right;">n</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">45</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">109</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td style="text-align: right;">325</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: right;">36</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>337 datasets with significant outfit and 178 with significant infit.</p>
</section><section id="simulation-based-cutoff" class="level4" data-number="2.1.3"><h4 data-number="2.1.3" class="anchored" data-anchor-id="simulation-based-cutoff">
<span class="header-section-number">2.1.3</span> Simulation based cutoff</h4>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb32"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">sfo</span> <span class="op">&lt;-</span> <span class="va">results</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="va">outfit_diff</span> <span class="op">==</span> <span class="st">"no misfit"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">results</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="va">outfit_diff</span> <span class="op">==</span> <span class="st">"no misfit"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html">count</a></span><span class="op">(</span><span class="va">item</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span>caption <span class="op">=</span> <span class="st">"Items with deviant outfit"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Items with deviant outfit</caption>
<thead><tr class="header">
<th style="text-align: right;">item</th>
<th style="text-align: right;">n</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">3</td>
<td style="text-align: right;">75</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: right;">3</td>
</tr>
</tbody>
</table>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb33"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">sfi</span> <span class="op">&lt;-</span> <span class="va">results</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="va">infit_diff</span> <span class="op">==</span> <span class="st">"no misfit"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">results</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="va">infit_diff</span> <span class="op">==</span> <span class="st">"no misfit"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html">count</a></span><span class="op">(</span><span class="va">item</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span>caption <span class="op">=</span> <span class="st">"Items with deviant infit"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Items with deviant infit</caption>
<thead><tr class="header">
<th style="text-align: right;">item</th>
<th style="text-align: right;">n</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">15</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">71</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td style="text-align: right;">169</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: right;">7</td>
</tr>
</tbody>
</table>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb34"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">sfboth</span> <span class="op">&lt;-</span> <span class="va">results</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="va">infit_diff</span> <span class="op">==</span> <span class="st">"no misfit"</span> <span class="op">|</span> <span class="op">!</span><span class="va">outfit_diff</span> <span class="op">==</span> <span class="st">"no misfit"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">results</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="va">infit_diff</span> <span class="op">==</span> <span class="st">"no misfit"</span> <span class="op">|</span> <span class="op">!</span><span class="va">outfit_diff</span> <span class="op">==</span> <span class="st">"no misfit"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html">count</a></span><span class="op">(</span><span class="va">item</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span>caption <span class="op">=</span> <span class="st">"Items with deviant infit and/or outfit"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Items with deviant infit and/or outfit</caption>
<thead><tr class="header">
<th style="text-align: right;">item</th>
<th style="text-align: right;">n</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">15</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">71</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td style="text-align: right;">178</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: right;">9</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>78 datasets with significant outfit and 262 with significant infit, resulting in 273 with either type of misfit.</p>
<p>We can review the distribution of infit/outfit for misfitting items.</p>
</section><section id="infit" class="level4" data-number="2.1.4"><h4 data-number="2.1.4" class="anchored" data-anchor-id="infit">
<span class="header-section-number">2.1.4</span> Infit</h4>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb35"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">results</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">ir_padj</span> <span class="op">==</span> <span class="st">"sign. misfit"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span>Median <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/median.html">median</a></span><span class="op">(</span><span class="va">Infit</span><span class="op">)</span>,</span>
<span>            MAD <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/mad.html">mad</a></span><span class="op">(</span><span class="va">Infit</span><span class="op">)</span>,</span>
<span>            Mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">Infit</span><span class="op">)</span>,</span>
<span>            SD <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">Infit</span><span class="op">)</span>,</span>
<span>            Max <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">Infit</span><span class="op">)</span>,</span>
<span>            Min <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">Infit</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<thead><tr class="header">
<th style="text-align: right;">Median</th>
<th style="text-align: right;">MAD</th>
<th style="text-align: right;">Mean</th>
<th style="text-align: right;">SD</th>
<th style="text-align: right;">Max</th>
<th style="text-align: right;">Min</th>
</tr></thead>
<tbody><tr class="odd">
<td style="text-align: right;">0.733</td>
<td style="text-align: right;">0.031</td>
<td style="text-align: right;">0.729</td>
<td style="text-align: right;">0.034</td>
<td style="text-align: right;">0.807</td>
<td style="text-align: right;">0.606</td>
</tr></tbody>
</table>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb36"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">results</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">ir_padj</span> <span class="op">==</span> <span class="st">"sign. misfit"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="http://mjskay.github.io/ggdist/reference/stat_dotsinterval.html">stat_dotsinterval</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Infit</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_continuous</a></span><span class="op">(</span><span class="st">'Distribution conditional infit MSQ'</span>, limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.5</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="item_restscore_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid figure-img" width="1050"></p>
</figure>
</div>
</div>
</div>
</section><section id="outfit" class="level4" data-number="2.1.5"><h4 data-number="2.1.5" class="anchored" data-anchor-id="outfit">
<span class="header-section-number">2.1.5</span> Outfit</h4>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb37"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">results</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">ir_padj</span> <span class="op">==</span> <span class="st">"sign. misfit"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span>Median <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/median.html">median</a></span><span class="op">(</span><span class="va">Outfit</span><span class="op">)</span>,</span>
<span>            MAD <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/mad.html">mad</a></span><span class="op">(</span><span class="va">Outfit</span><span class="op">)</span>,</span>
<span>            Mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">Outfit</span><span class="op">)</span>,</span>
<span>            SD <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">Outfit</span><span class="op">)</span>,</span>
<span>            Max <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">Outfit</span><span class="op">)</span>,</span>
<span>            Min <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">Outfit</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<thead><tr class="header">
<th style="text-align: right;">Median</th>
<th style="text-align: right;">MAD</th>
<th style="text-align: right;">Mean</th>
<th style="text-align: right;">SD</th>
<th style="text-align: right;">Max</th>
<th style="text-align: right;">Min</th>
</tr></thead>
<tbody><tr class="odd">
<td style="text-align: right;">0.667</td>
<td style="text-align: right;">0.053</td>
<td style="text-align: right;">0.667</td>
<td style="text-align: right;">0.053</td>
<td style="text-align: right;">0.815</td>
<td style="text-align: right;">0.53</td>
</tr></tbody>
</table>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb38"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">results</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">ir_padj</span> <span class="op">==</span> <span class="st">"sign. misfit"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="http://mjskay.github.io/ggdist/reference/stat_dotsinterval.html">stat_dotsinterval</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Outfit</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_continuous</a></span><span class="op">(</span><span class="st">'Distribution conditional outfit MSQ'</span>, limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.5</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="item_restscore_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid figure-img" width="1050"></p>
</figure>
</div>
</div>
</div>
</section></section></section><section id="test-2" class="level2" data-number="3"><h2 data-number="3" class="anchored" data-anchor-id="test-2">
<span class="header-section-number">3</span> Test 2</h2>
<p>What happens if we increase the number of iterations for simulation based cutoffs? We’ve been running at 500 to shorten runtime, but could go to 1000 iteration while cutting the number of datasets down from 1000 to 500. We’ll also try using 50 bootstrap samples for <code>bootfit()</code> and see how that affects its p-values.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb39"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#test4 &lt;- testfit2(pcmdat2, iterations = 1:500, sfit = 1000, boot = 50)</span></span>
<span><span class="co">#saveRDS(test4,"irscore500.Rdata")</span></span>
<span><span class="va">test4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span><span class="op">(</span><span class="st">"irscore500.Rdata"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="results-1" class="level3" data-number="3.1"><h3 data-number="3.1" class="anchored" data-anchor-id="results-1">
<span class="header-section-number">3.1</span> Results</h3>
<p>Join results to a dataframe.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb40"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">iterations</span> <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">500</span></span>
<span><span class="va">result_irscore</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map_dfr.html">map_dfr</a></span><span class="op">(</span><span class="va">iterations</span>, <span class="op">~</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html">bind_rows</a></span><span class="op">(</span><span class="va">test4</span><span class="op">[[</span><span class="va">.x</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">item_restscore</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>          <span class="fu"><a href="https://tibble.tidyverse.org/reference/add_column.html">add_column</a></span><span class="op">(</span>iteration <span class="op">=</span> <span class="va">.x</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">result_bfit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map_dfr.html">map_dfr</a></span><span class="op">(</span><span class="va">iterations</span>, <span class="op">~</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html">bind_rows</a></span><span class="op">(</span><span class="va">test4</span><span class="op">[[</span><span class="va">.x</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">boot_fit</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>          <span class="fu"><a href="https://tibble.tidyverse.org/reference/add_column.html">add_column</a></span><span class="op">(</span>iteration <span class="op">=</span> <span class="va">.x</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">result_sfit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map_dfr.html">map_dfr</a></span><span class="op">(</span><span class="va">iterations</span>, <span class="op">~</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html">bind_rows</a></span><span class="op">(</span><span class="va">test4</span><span class="op">[[</span><span class="va">.x</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">rfit</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>          <span class="fu"><a href="https://tibble.tidyverse.org/reference/add_column.html">add_column</a></span><span class="op">(</span>iteration <span class="op">=</span> <span class="va">.x</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">left_join</a></span><span class="op">(</span><span class="va">result_irscore</span>,<span class="va">result_bfit</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"iteration"</span>,<span class="st">"item"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">left_join</a></span><span class="op">(</span><span class="va">results</span>, <span class="va">result_sfit</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"iteration"</span>,<span class="st">"item"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">results</span>, <span class="fl">24</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>     ir_padj    diff diff_abs item iteration    bfit_sig    Outfit     Infit
1  no misfit  0.0278   0.0278    1         1   no misfit 1.0454139 1.0724946
2  no misfit  0.0860   0.0860    2         1   no misfit 1.0653470 1.2179965
3  no misfit -0.1556   0.1556    3         1   no misfit 0.8271545 0.8247410
4  no misfit -0.0592   0.0592    4         1   no misfit 1.0316122 1.0171284
5  no misfit  0.0264   0.0264    1         2   no misfit 1.0371496 1.0423821
6  no misfit  0.0763   0.0763    2         2   no misfit 1.0761663 1.1804809
7  no misfit -0.1992   0.1992    3         2 sign. infit 0.7431027 0.7771497
8  no misfit -0.0060   0.0060    4         2   no misfit 1.0988844 1.1447383
9  no misfit -0.0187   0.0187    1         3   no misfit 0.9555410 0.9643910
10 no misfit  0.0529   0.0529    2         3   no misfit 1.0483272 1.0789874
11 no misfit -0.2161   0.2161    3         3 sign. infit 0.8060479 0.8360092
12 no misfit  0.0570   0.0570    4         3   no misfit 1.2451834 1.1846969
13 no misfit -0.0162   0.0162    1         4   no misfit 0.9707772 0.9731070
14 no misfit  0.1582   0.1582    2         4   no misfit 1.2051081 1.2579444
15 no misfit -0.1891   0.1891    3         4   no misfit 0.8434983 0.8546639
16 no misfit -0.0680   0.0680    4         4   no misfit 1.0116630 0.9913493
17 no misfit  0.0658   0.0658    1         5   no misfit 1.0719629 1.0935663
18 no misfit  0.0971   0.0971    2         5   no misfit 1.0809464 1.1970012
19 no misfit -0.1619   0.1619    3         5   no misfit 0.7307903 0.8012734
20 no misfit -0.0592   0.0592    4         5   no misfit 1.0086764 0.9944696
21 no misfit -0.0626   0.0626    1         6   no misfit 0.9247730 0.9184895
22 no misfit  0.1088   0.1088    2         6   no misfit 1.0813182 1.1484476
23 no misfit -0.1263   0.1263    3         6   no misfit 0.9227389 0.9410586
24 no misfit -0.0176   0.0176    4         6   no misfit 1.0888125 1.0363839
   infit_diff outfit_diff
1   no misfit   no misfit
2   no misfit   no misfit
3   no misfit   no misfit
4   no misfit   no misfit
5   no misfit   no misfit
6   no misfit   no misfit
7   no misfit   no misfit
8   no misfit   no misfit
9   no misfit   no misfit
10  no misfit   no misfit
11  no misfit   no misfit
12  no misfit   no misfit
13  no misfit   no misfit
14  no misfit   no misfit
15  no misfit   no misfit
16  no misfit   no misfit
17  no misfit   no misfit
18  no misfit   no misfit
19  no misfit   no misfit
20  no misfit   no misfit
21  no misfit   no misfit
22  no misfit   no misfit
23  no misfit   no misfit
24  no misfit   no misfit</code></pre>
</div>
</div>
<p>Ok, we have some results to summarise. First, we filter on item-restscore misfit and look at the first 25 rows.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb42"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">results</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">ir_padj</span> <span class="op">==</span> <span class="st">"sign. misfit"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="fl">25</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>        ir_padj    diff diff_abs item iteration     bfit_sig    Outfit
1  sign. misfit -0.2633   0.2633    3         9 sign. outfit 0.6975253
2  sign. misfit -0.2529   0.2529    3        19 sign. outfit 0.7050639
3  sign. misfit -0.2867   0.2867    3        27 sign. outfit 0.5386553
4  sign. misfit -0.1996   0.1996    3        38 sign. outfit 0.5642884
5  sign. misfit -0.2330   0.2330    3        40 sign. outfit 0.6318898
6  sign. misfit -0.2387   0.2387    3        44 sign. outfit 0.6268911
7  sign. misfit -0.1951   0.1951    3        46 sign. outfit 0.6470683
8  sign. misfit -0.2359   0.2359    3        49    no misfit 0.6304596
9  sign. misfit -0.3082   0.3082    3        52    no misfit 0.7689529
10 sign. misfit -0.1964   0.1964    3        58 sign. outfit 0.6660527
11 sign. misfit -0.2999   0.2999    3        59 sign. outfit 0.6162333
12 sign. misfit -0.2393   0.2393    3        62 sign. outfit 0.6830782
13 sign. misfit -0.2269   0.2269    3        64 sign. outfit 0.7086075
14 sign. misfit -0.2317   0.2317    3        69 sign. outfit 0.6322802
15 sign. misfit -0.1926   0.1926    3        78 sign. outfit 0.6864711
16 sign. misfit -0.2397   0.2397    3        87 sign. outfit 0.6133337
17 sign. misfit -0.2174   0.2174    3        99 sign. outfit 0.7383997
18 sign. misfit -0.2289   0.2289    3       105 sign. outfit 0.6724876
19 sign. misfit -0.2477   0.2477    3       108 sign. outfit 0.6693367
20 sign. misfit -0.1854   0.1854    3       115  sign. infit 0.7460685
21 sign. misfit -0.2615   0.2615    3       126 sign. outfit 0.6203168
22 sign. misfit -0.2008   0.2008    3       136 sign. outfit 0.6706957
23 sign. misfit -0.2123   0.2123    3       138 sign. outfit 0.6372636
24 sign. misfit -0.2315   0.2315    3       141 sign. outfit 0.6989589
25 sign. misfit -0.2407   0.2407    3       156 sign. outfit 0.6788173
       Infit infit_diff outfit_diff
1  0.7617014      0.019   no misfit
2  0.7860327  no misfit   no misfit
3  0.6320351      0.082       0.104
4  0.6866108      0.046       0.002
5  0.7016374      0.023   no misfit
6  0.7338684      0.007   no misfit
7  0.7340116  no misfit   no misfit
8  0.7332496      0.011   no misfit
9  0.8015139  no misfit   no misfit
10 0.7259577      0.035   no misfit
11 0.6753428      0.083       0.018
12 0.7662194  no misfit   no misfit
13 0.7685445  no misfit   no misfit
14 0.6826949      0.059       0.031
15 0.7642318  no misfit   no misfit
16 0.6657616      0.071       0.015
17 0.7664598  no misfit   no misfit
18 0.7114820      0.044   no misfit
19 0.7466069      0.014       0.019
20 0.7465324  no misfit   no misfit
21 0.6809506      0.075       0.036
22 0.7295246      0.023       0.022
23 0.7533044  no misfit   no misfit
24 0.7590361  no misfit   no misfit
25 0.7417980      0.016   no misfit</code></pre>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb44"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">results</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">ir_padj</span> <span class="op">==</span> <span class="st">"sign. misfit"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html">count</a></span><span class="op">(</span><span class="va">item</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>Percent <span class="op">=</span> <span class="va">n</span><span class="op">*</span><span class="fl">100</span><span class="op">/</span><span class="fl">500</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<thead><tr class="header">
<th style="text-align: right;">item</th>
<th style="text-align: right;">n</th>
<th style="text-align: right;">Percent</th>
</tr></thead>
<tbody><tr class="odd">
<td style="text-align: right;">3</td>
<td style="text-align: right;">76</td>
<td style="text-align: right;">15.2</td>
</tr></tbody>
</table>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb45"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">ir</span> <span class="op">&lt;-</span> <span class="va">results</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">ir_padj</span> <span class="op">==</span> <span class="st">"sign. misfit"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">bf</span> <span class="op">&lt;-</span> <span class="va">results</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">ir_padj</span> <span class="op">==</span> <span class="st">"sign. misfit"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">bfit_sig</span> <span class="op">==</span> <span class="st">"no misfit"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">bfout</span> <span class="op">&lt;-</span> <span class="va">results</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">ir_padj</span> <span class="op">==</span> <span class="st">"sign. misfit"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">bfit_sig</span> <span class="op">==</span> <span class="st">"sign. outfit"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">simfitin</span> <span class="op">&lt;-</span> <span class="va">results</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">ir_padj</span> <span class="op">==</span> <span class="st">"sign. misfit"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="va">infit_diff</span> <span class="op">==</span> <span class="st">"no misfit"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">simfitout</span> <span class="op">&lt;-</span> <span class="va">results</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">ir_padj</span> <span class="op">==</span> <span class="st">"sign. misfit"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="va">outfit_diff</span> <span class="op">==</span> <span class="st">"no misfit"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">simfitboth</span> <span class="op">&lt;-</span> <span class="va">results</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">ir_padj</span> <span class="op">==</span> <span class="st">"sign. misfit"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="va">outfit_diff</span> <span class="op">==</span> <span class="st">"no misfit"</span> <span class="op">|</span> <span class="op">!</span><span class="va">infit_diff</span> <span class="op">==</span> <span class="st">"no misfit"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Item 3 misfit almost exclusively, except for one instance of item 4. Item-restscore shows misfit in 76 (out of 1000) datasets, 15.2%.</p>
<p>Bootstrapped (using 100 bootstraps per dataset) item infit/outfit p-values also indicate significant misfit amongst the datasets identified by item-restscore, and agrees with item-restscore all but 24 cases.</p>
<p>Simulation based cutoffs using 500 iterations (per dataset) indicate less misfit in this sample of item-restscore misfits. 55 out of 76, of which 54 were flagged for infit, and 25 for outfit.</p>
<section id="item-restscore-1" class="level4" data-number="3.1.1"><h4 data-number="3.1.1" class="anchored" data-anchor-id="item-restscore-1">
<span class="header-section-number">3.1.1</span> Item-restscore</h4>
<p>Let’s review the observed/expected differences.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb46"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">results</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">ir_padj</span> <span class="op">==</span> <span class="st">"sign. misfit"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html">count</a></span><span class="op">(</span><span class="va">item</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>Percent <span class="op">=</span> <span class="va">n</span><span class="op">*</span><span class="fl">100</span><span class="op">/</span><span class="fl">500</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<thead><tr class="header">
<th style="text-align: right;">item</th>
<th style="text-align: right;">n</th>
<th style="text-align: right;">Percent</th>
</tr></thead>
<tbody><tr class="odd">
<td style="text-align: right;">3</td>
<td style="text-align: right;">76</td>
<td style="text-align: right;">15.2</td>
</tr></tbody>
</table>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb47"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">results</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">ir_padj</span> <span class="op">==</span> <span class="st">"sign. misfit"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span>Median <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/median.html">median</a></span><span class="op">(</span><span class="va">diff_abs</span><span class="op">)</span>,</span>
<span>            MAD <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/mad.html">mad</a></span><span class="op">(</span><span class="va">diff_abs</span><span class="op">)</span>,</span>
<span>            Mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">diff_abs</span><span class="op">)</span>,</span>
<span>            SD <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">diff_abs</span><span class="op">)</span>,</span>
<span>            Max <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">diff_abs</span><span class="op">)</span>,</span>
<span>            Min <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">diff_abs</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<thead><tr class="header">
<th style="text-align: right;">Median</th>
<th style="text-align: right;">MAD</th>
<th style="text-align: right;">Mean</th>
<th style="text-align: right;">SD</th>
<th style="text-align: right;">Max</th>
<th style="text-align: right;">Min</th>
</tr></thead>
<tbody><tr class="odd">
<td style="text-align: right;">0.238</td>
<td style="text-align: right;">0.035</td>
<td style="text-align: right;">0.236</td>
<td style="text-align: right;">0.033</td>
<td style="text-align: right;">0.34</td>
<td style="text-align: right;">0.176</td>
</tr></tbody>
</table>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb48"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">results</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">ir_padj</span> <span class="op">==</span> <span class="st">"sign. misfit"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="http://mjskay.github.io/ggdist/reference/stat_dotsinterval.html">stat_dotsinterval</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">diff_abs</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_continuous</a></span><span class="op">(</span><span class="st">'Distribution of absolut differences'</span>, limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0.4</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Observed vs expected item-restscore values"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="item_restscore_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid figure-img" width="1050"></p>
</figure>
</div>
</div>
</div>
<p>The results above were filtered on only item-restscore, so there may be other results for the other methods.</p>
</section><section id="bootfit-1" class="level4" data-number="3.1.2"><h4 data-number="3.1.2" class="anchored" data-anchor-id="bootfit-1">
<span class="header-section-number">3.1.2</span> Bootfit</h4>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb49"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">bfo</span> <span class="op">&lt;-</span> <span class="va">results</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">bfit_sig</span> <span class="op">==</span> <span class="st">"sign. outfit"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">results</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">bfit_sig</span> <span class="op">==</span> <span class="st">"sign. outfit"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html">count</a></span><span class="op">(</span><span class="va">item</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>Percent <span class="op">=</span> <span class="va">n</span><span class="op">*</span><span class="fl">100</span><span class="op">/</span><span class="fl">500</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span>caption <span class="op">=</span> <span class="st">"Items with statistically significant outfit"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Items with statistically significant outfit</caption>
<thead><tr class="header">
<th style="text-align: right;">item</th>
<th style="text-align: right;">n</th>
<th style="text-align: right;">Percent</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">12</td>
<td style="text-align: right;">2.4</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">11</td>
<td style="text-align: right;">2.2</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td style="text-align: right;">157</td>
<td style="text-align: right;">31.4</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: right;">26</td>
<td style="text-align: right;">5.2</td>
</tr>
</tbody>
</table>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb50"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">bfi</span> <span class="op">&lt;-</span> <span class="va">results</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">bfit_sig</span> <span class="op">==</span> <span class="st">"sign. infit"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">results</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">bfit_sig</span> <span class="op">==</span> <span class="st">"sign. infit"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html">count</a></span><span class="op">(</span><span class="va">item</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>Percent <span class="op">=</span> <span class="va">n</span><span class="op">*</span><span class="fl">100</span><span class="op">/</span><span class="fl">500</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span>caption <span class="op">=</span> <span class="st">"Items with statistically significant infit"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Items with statistically significant infit</caption>
<thead><tr class="header">
<th style="text-align: right;">item</th>
<th style="text-align: right;">n</th>
<th style="text-align: right;">Percent</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">16</td>
<td style="text-align: right;">3.2</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">78</td>
<td style="text-align: right;">15.6</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td style="text-align: right;">40</td>
<td style="text-align: right;">8.0</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">1.4</td>
</tr>
</tbody>
</table>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb51"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">bfboth</span> <span class="op">&lt;-</span> <span class="va">results</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">bfit_sig</span> <span class="op">==</span> <span class="st">"sign. infit"</span> <span class="op">|</span> <span class="va">bfit_sig</span> <span class="op">==</span> <span class="st">"sign. outfit"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">results</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">bfit_sig</span> <span class="op">==</span> <span class="st">"sign. infit"</span> <span class="op">|</span> <span class="va">bfit_sig</span> <span class="op">==</span> <span class="st">"sign. outfit"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html">count</a></span><span class="op">(</span><span class="va">item</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>Percent <span class="op">=</span> <span class="va">n</span><span class="op">*</span><span class="fl">100</span><span class="op">/</span><span class="fl">500</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span>caption <span class="op">=</span> <span class="st">"Items with statistically significant infit and/or outfit"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Items with statistically significant infit and/or outfit</caption>
<thead><tr class="header">
<th style="text-align: right;">item</th>
<th style="text-align: right;">n</th>
<th style="text-align: right;">Percent</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">28</td>
<td style="text-align: right;">5.6</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">89</td>
<td style="text-align: right;">17.8</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td style="text-align: right;">197</td>
<td style="text-align: right;">39.4</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: right;">33</td>
<td style="text-align: right;">6.6</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>206 datasets with significant outfit and 141 with significant infit.</p>
</section><section id="simulation-based-cutoff-1" class="level4" data-number="3.1.3"><h4 data-number="3.1.3" class="anchored" data-anchor-id="simulation-based-cutoff-1">
<span class="header-section-number">3.1.3</span> Simulation based cutoff</h4>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb52"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">sfo</span> <span class="op">&lt;-</span> <span class="va">results</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="va">outfit_diff</span> <span class="op">==</span> <span class="st">"no misfit"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">results</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="va">outfit_diff</span> <span class="op">==</span> <span class="st">"no misfit"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html">count</a></span><span class="op">(</span><span class="va">item</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>Percent <span class="op">=</span> <span class="va">n</span><span class="op">*</span><span class="fl">100</span><span class="op">/</span><span class="fl">500</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span>caption <span class="op">=</span> <span class="st">"Items with deviant outfit"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Items with deviant outfit</caption>
<thead><tr class="header">
<th style="text-align: right;">item</th>
<th style="text-align: right;">n</th>
<th style="text-align: right;">Percent</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">3</td>
<td style="text-align: right;">26</td>
<td style="text-align: right;">5.2</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.2</td>
</tr>
</tbody>
</table>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb53"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">sfi</span> <span class="op">&lt;-</span> <span class="va">results</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="va">infit_diff</span> <span class="op">==</span> <span class="st">"no misfit"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">results</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="va">infit_diff</span> <span class="op">==</span> <span class="st">"no misfit"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html">count</a></span><span class="op">(</span><span class="va">item</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>Percent <span class="op">=</span> <span class="va">n</span><span class="op">*</span><span class="fl">100</span><span class="op">/</span><span class="fl">500</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span>caption <span class="op">=</span> <span class="st">"Items with deviant infit"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Items with deviant infit</caption>
<thead><tr class="header">
<th style="text-align: right;">item</th>
<th style="text-align: right;">n</th>
<th style="text-align: right;">Percent</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">0.8</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">33</td>
<td style="text-align: right;">6.6</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td style="text-align: right;">63</td>
<td style="text-align: right;">12.6</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.2</td>
</tr>
</tbody>
</table>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb54"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">sfboth</span> <span class="op">&lt;-</span> <span class="va">results</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="va">infit_diff</span> <span class="op">==</span> <span class="st">"no misfit"</span> <span class="op">|</span> <span class="op">!</span><span class="va">outfit_diff</span> <span class="op">==</span> <span class="st">"no misfit"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">results</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="va">infit_diff</span> <span class="op">==</span> <span class="st">"no misfit"</span> <span class="op">|</span> <span class="op">!</span><span class="va">outfit_diff</span> <span class="op">==</span> <span class="st">"no misfit"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html">count</a></span><span class="op">(</span><span class="va">item</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>Percent <span class="op">=</span> <span class="va">n</span><span class="op">*</span><span class="fl">100</span><span class="op">/</span><span class="fl">500</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span>caption <span class="op">=</span> <span class="st">"Items with deviant infit and/or outfit"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Items with deviant infit and/or outfit</caption>
<thead><tr class="header">
<th style="text-align: right;">item</th>
<th style="text-align: right;">n</th>
<th style="text-align: right;">Percent</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">0.8</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">33</td>
<td style="text-align: right;">6.6</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td style="text-align: right;">64</td>
<td style="text-align: right;">12.8</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">0.4</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>27 datasets with significant outfit and 101 with significant infit, resulting in 103 with either type of misfit.</p>
<p>We can review the distribution of infit/outfit for misfitting items.</p>
</section><section id="infit-1" class="level4" data-number="3.1.4"><h4 data-number="3.1.4" class="anchored" data-anchor-id="infit-1">
<span class="header-section-number">3.1.4</span> Infit</h4>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb55"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">results</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">ir_padj</span> <span class="op">==</span> <span class="st">"sign. misfit"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span>Median <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/median.html">median</a></span><span class="op">(</span><span class="va">Infit</span><span class="op">)</span>,</span>
<span>            MAD <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/mad.html">mad</a></span><span class="op">(</span><span class="va">Infit</span><span class="op">)</span>,</span>
<span>            Mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">Infit</span><span class="op">)</span>,</span>
<span>            SD <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">Infit</span><span class="op">)</span>,</span>
<span>            Max <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">Infit</span><span class="op">)</span>,</span>
<span>            Min <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">Infit</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<thead><tr class="header">
<th style="text-align: right;">Median</th>
<th style="text-align: right;">MAD</th>
<th style="text-align: right;">Mean</th>
<th style="text-align: right;">SD</th>
<th style="text-align: right;">Max</th>
<th style="text-align: right;">Min</th>
</tr></thead>
<tbody><tr class="odd">
<td style="text-align: right;">0.734</td>
<td style="text-align: right;">0.035</td>
<td style="text-align: right;">0.729</td>
<td style="text-align: right;">0.035</td>
<td style="text-align: right;">0.808</td>
<td style="text-align: right;">0.632</td>
</tr></tbody>
</table>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb56"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">results</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">ir_padj</span> <span class="op">==</span> <span class="st">"sign. misfit"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="http://mjskay.github.io/ggdist/reference/stat_dotsinterval.html">stat_dotsinterval</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Infit</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_continuous</a></span><span class="op">(</span><span class="st">'Distribution conditional infit MSQ'</span>, limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.5</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="item_restscore_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid figure-img" width="1050"></p>
</figure>
</div>
</div>
</div>
</section><section id="outfit-1" class="level4" data-number="3.1.5"><h4 data-number="3.1.5" class="anchored" data-anchor-id="outfit-1">
<span class="header-section-number">3.1.5</span> Outfit</h4>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb57"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">results</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">ir_padj</span> <span class="op">==</span> <span class="st">"sign. misfit"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span>Median <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/median.html">median</a></span><span class="op">(</span><span class="va">Outfit</span><span class="op">)</span>,</span>
<span>            MAD <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/mad.html">mad</a></span><span class="op">(</span><span class="va">Outfit</span><span class="op">)</span>,</span>
<span>            Mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">Outfit</span><span class="op">)</span>,</span>
<span>            SD <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">Outfit</span><span class="op">)</span>,</span>
<span>            Max <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">Outfit</span><span class="op">)</span>,</span>
<span>            Min <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">Outfit</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<thead><tr class="header">
<th style="text-align: right;">Median</th>
<th style="text-align: right;">MAD</th>
<th style="text-align: right;">Mean</th>
<th style="text-align: right;">SD</th>
<th style="text-align: right;">Max</th>
<th style="text-align: right;">Min</th>
</tr></thead>
<tbody><tr class="odd">
<td style="text-align: right;">0.665</td>
<td style="text-align: right;">0.048</td>
<td style="text-align: right;">0.665</td>
<td style="text-align: right;">0.05</td>
<td style="text-align: right;">0.798</td>
<td style="text-align: right;">0.539</td>
</tr></tbody>
</table>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb58"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">results</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">ir_padj</span> <span class="op">==</span> <span class="st">"sign. misfit"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="http://mjskay.github.io/ggdist/reference/stat_dotsinterval.html">stat_dotsinterval</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Outfit</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_continuous</a></span><span class="op">(</span><span class="st">'Distribution conditional outfit MSQ'</span>, limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.5</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="item_restscore_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid figure-img" width="1050"></p>
</figure>
</div>
</div>
</div>
</section></section></section><section id="item-restscore-sample-size-variation" class="level2" data-number="4"><h2 data-number="4" class="anchored" data-anchor-id="item-restscore-sample-size-variation">
<span class="header-section-number">4</span> Item-restscore sample size variation</h2>
<p>Let us look only at item-restscore and see how sample size affects the percentage of significant deviations indicated for item 3. We’ll do 50-250 in steps of 25.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb59"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">testfit3</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">dat</span>, <span class="va">iterations</span>, <span class="va">samplesize</span>, <span class="va">cpu</span> <span class="op">=</span> <span class="fl">8</span><span class="op">)</span> <span class="op">{</span></span>
<span>  </span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html">require</a></span><span class="op">(</span><span class="va"><a href="https://github.com/RevolutionAnalytics/doparallel">doParallel</a></span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/doParallel/man/registerDoParallel.html">registerDoParallel</a></span><span class="op">(</span>cores <span class="op">=</span> <span class="va">cpu</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/foreach/man/foreach.html">foreach</a></span><span class="op">(</span>i <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="va">iterations</span>, .combine <span class="op">=</span> <span class="va">rbind</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/foreach/man/foreach.html">%dopar%</a></span> <span class="op">{</span></span>
<span>    <span class="va">data</span> <span class="op">&lt;-</span> <span class="va">dat</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span>, <span class="va">samplesize</span><span class="op">)</span>, <span class="op">]</span></span>
<span>    </span>
<span>    <span class="va">i1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/iarm/man/item_restscore.html">item_restscore</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/eRm/man/PCM.html">PCM</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="va">i1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="va">i1</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="st">"observed"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">i1</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span>,</span>
<span>                     <span class="st">"expected"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">i1</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span>,</span>
<span>                     <span class="st">"se"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">i1</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span>,<span class="fl">3</span><span class="op">]</span><span class="op">)</span>,</span>
<span>                     <span class="st">"p.value"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">i1</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span>,<span class="fl">4</span><span class="op">]</span><span class="op">)</span>,</span>
<span>                     <span class="st">"p.adj.BH"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">i1</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span>,<span class="fl">5</span><span class="op">]</span><span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>diff_abs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="va">expected</span> <span class="op">-</span> <span class="va">observed</span><span class="op">)</span>,</span>
<span>             diff <span class="op">=</span> <span class="va">expected</span> <span class="op">-</span> <span class="va">observed</span>,</span>
<span>             ir_padj <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">p.adj.BH</span> <span class="op">&lt;</span> <span class="fl">.05</span>, <span class="st">"sign. misfit"</span>,<span class="st">"no misfit"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">ir_padj</span>, <span class="va">diff</span>, <span class="va">diff_abs</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>item <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>      <span class="fu"><a href="https://tibble.tidyverse.org/reference/add_column.html">add_column</a></span><span class="op">(</span>iteration <span class="op">=</span> <span class="va">i</span>,</span>
<span>                 samplesize <span class="op">=</span> <span class="va">samplesize</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb60"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#irscoreonly &lt;- list()</span></span>
<span><span class="co">#irscoreonly &lt;- map(samplesizes, ~ testfit3(pcmdat2, iterations = 1000, samplesize = .x))</span></span>
<span><span class="co">#saveRDS(irscoreonly,"item_restscore1000.Rdata")</span></span>
<span><span class="va">irscoreonly</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span><span class="op">(</span><span class="st">"item_restscore1000.Rdata"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb61"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">results_ir</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html">bind_rows</a></span><span class="op">(</span><span class="va">irscoreonly</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">item</span> <span class="op">==</span> <span class="fl">3</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">ir_padj</span> <span class="op">==</span> <span class="st">"sign. misfit"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="results-2" class="level3" data-number="4.1"><h3 data-number="4.1" class="anchored" data-anchor-id="results-2">
<span class="header-section-number">4.1</span> Results</h3>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb62"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">results_ir</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">samplesize</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html">n</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>            Percent <span class="op">=</span> <span class="va">n</span><span class="op">*</span><span class="fl">100</span><span class="op">/</span><span class="fl">1000</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">samplesize</span>, y <span class="op">=</span> <span class="va">Percent</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html">coord_cartesian</a></span><span class="op">(</span>ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">100</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">100</span>,<span class="fl">20</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>y <span class="op">=</span> <span class="st">"Percentage of datasets with indicated misfit for item 3"</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"Sample size"</span>,</span>
<span>       caption <span class="op">=</span> <span class="st">"Note: 1000 non-parametric bootstrap samples for each sample size"</span>,</span>
<span>       title <span class="op">=</span> <span class="st">"Item-restscore"</span>,</span>
<span>       subtitle <span class="op">=</span> <span class="st">"Sample size affects identification of misfitting item?"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="item_restscore_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid figure-img" width="1050"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb63"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">p01</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">results_ir</span><span class="op">$</span><span class="va">diff_abs</span>, <span class="fl">.01</span><span class="op">)</span>,<span class="fl">3</span><span class="op">)</span></span>
<span><span class="va">p05</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">results_ir</span><span class="op">$</span><span class="va">diff_abs</span>, <span class="fl">.05</span><span class="op">)</span>,<span class="fl">3</span><span class="op">)</span></span>
<span></span>
<span><span class="va">results_ir</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="http://mjskay.github.io/ggdist/reference/stat_dotsinterval.html">stat_dotsinterval</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">diff_abs</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_continuous</a></span><span class="op">(</span><span class="st">'Distribution of absolute differences'</span>, limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0.4</span><span class="op">)</span>, breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0.4</span>,<span class="fl">0.05</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/RISEkbmRasch/man/theme_rise.html">theme_rise</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Observed vs expected item-restscore values"</span>,</span>
<span>       subtitle <span class="op">=</span> <span class="st">"Only statistically significant values included in plot"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">""</span>,</span>
<span>       caption <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"Note: 1st percentile of the absolute difference between observed and expected item-restscore is "</span>,<span class="va">p01</span>,<span class="st">". 5th percentile is "</span>,<span class="va">p05</span>,<span class="st">"."</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="item_restscore_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid figure-img" width="1050"></p>
</figure>
</div>
</div>
</div>
<p>Now, let’s dig up a simulation function that allows us to specify a misfitting item.</p>


<!-- -->

</section></section><div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-reuse"><h2 class="anchored quarto-appendix-heading">Reuse</h2><div class="quarto-appendix-contents"><div><a rel="license" href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a></div></div></section><section class="quarto-appendix-contents" id="quarto-citation"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@online{johansson2024,
  author = {Johansson, Magnus},
  title = {Rasch Item-Restscore and Sample Size},
  date = {2024-09-18},
  url = {https://pgmj.github.io/item_restscore.html},
  langid = {en}
}
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-johansson2024" class="csl-entry quarto-appendix-citeas" role="listitem">
Johansson, M. (2024, September 18). <em>Rasch item-restscore and sample
size</em>. <a href="https://pgmj.github.io/item_restscore.html">https://pgmj.github.io/item_restscore.html</a>
</div></div></section></div></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/pgmj\.github\.io");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><script src="https://giscus.app/client.js" data-repo="pgmj/pgmj.github.io" data-repo-id="R_kgDOGtKrEA" data-category="General" data-category-id="DIC_kwDOGtKrEM4CdX5K" data-mapping="title" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="top" data-theme="light" data-lang="en" crossorigin="anonymous" async="">
</script><input type="hidden" id="giscus-base-theme" value="light"><input type="hidden" id="giscus-alt-theme" value="dark"><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb64" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Rasch item-restscore and sample size"</span></span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span><span class="co"> </span></span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a><span class="co">  name: Magnus Johansson</span></span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a><span class="co">  affiliation: RISE Research Institutes of Sweden</span></span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a><span class="co">  affiliation-url: https://www.ri.se/sv/vad-vi-gor/expertiser/kategoriskt-baserade-matningar</span></span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a><span class="co">  orcid: 0000-0003-1669-592X</span></span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a><span class="an">date:</span><span class="co"> last-modified</span></span>
<span id="cb64-9"><a href="#cb64-9" aria-hidden="true" tabindex="-1"></a><span class="an">citation:</span></span>
<span id="cb64-10"><a href="#cb64-10" aria-hidden="true" tabindex="-1"></a><span class="co">  type: 'webpage'</span></span>
<span id="cb64-11"><a href="#cb64-11" aria-hidden="true" tabindex="-1"></a><span class="an">csl:</span><span class="co"> apa.csl</span></span>
<span id="cb64-12"><a href="#cb64-12" aria-hidden="true" tabindex="-1"></a><span class="an">execute:</span><span class="co"> </span></span>
<span id="cb64-13"><a href="#cb64-13" aria-hidden="true" tabindex="-1"></a><span class="co">  cache: true</span></span>
<span id="cb64-14"><a href="#cb64-14" aria-hidden="true" tabindex="-1"></a><span class="co">  warning: false</span></span>
<span id="cb64-15"><a href="#cb64-15" aria-hidden="true" tabindex="-1"></a><span class="co">  message: false</span></span>
<span id="cb64-16"><a href="#cb64-16" aria-hidden="true" tabindex="-1"></a><span class="an">editor:</span><span class="co"> </span></span>
<span id="cb64-17"><a href="#cb64-17" aria-hidden="true" tabindex="-1"></a><span class="co">  markdown: </span></span>
<span id="cb64-18"><a href="#cb64-18" aria-hidden="true" tabindex="-1"></a><span class="co">    wrap: 72</span></span>
<span id="cb64-19"><a href="#cb64-19" aria-hidden="true" tabindex="-1"></a><span class="an">editor_options:</span><span class="co"> </span></span>
<span id="cb64-20"><a href="#cb64-20" aria-hidden="true" tabindex="-1"></a><span class="co">  chunk_output_type: console</span></span>
<span id="cb64-21"><a href="#cb64-21" aria-hidden="true" tabindex="-1"></a><span class="an">bibliography:</span><span class="co"> item_restscore.bib</span></span>
<span id="cb64-22"><a href="#cb64-22" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb64-23"><a href="#cb64-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-26"><a href="#cb64-26" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-27"><a href="#cb64-27" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(iarm)</span>
<span id="cb64-28"><a href="#cb64-28" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggdist)</span>
<span id="cb64-29"><a href="#cb64-29" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb64-30"><a href="#cb64-30" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RISEkbmRasch)</span>
<span id="cb64-31"><a href="#cb64-31" aria-hidden="true" tabindex="-1"></a><span class="do">### some commands exist in multiple packages, here we define preferred ones that are frequently used</span></span>
<span id="cb64-32"><a href="#cb64-32" aria-hidden="true" tabindex="-1"></a>select <span class="ot">&lt;-</span> dplyr<span class="sc">::</span>select</span>
<span id="cb64-33"><a href="#cb64-33" aria-hidden="true" tabindex="-1"></a>count <span class="ot">&lt;-</span> dplyr<span class="sc">::</span>count</span>
<span id="cb64-34"><a href="#cb64-34" aria-hidden="true" tabindex="-1"></a>rename <span class="ot">&lt;-</span> dplyr<span class="sc">::</span>rename</span>
<span id="cb64-35"><a href="#cb64-35" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-36"><a href="#cb64-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-37"><a href="#cb64-37" aria-hidden="true" tabindex="-1"></a><span class="fu">## Background</span></span>
<span id="cb64-38"><a href="#cb64-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-39"><a href="#cb64-39" aria-hidden="true" tabindex="-1"></a>It seems to me that the <span class="in">`iarm::item_restscore()`</span> function is sensitive to sample size, which is not surprising as it provides a p-value. The questions of interest to me are:</span>
<span id="cb64-40"><a href="#cb64-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-41"><a href="#cb64-41" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>how important is that p-value in itself?</span>
<span id="cb64-42"><a href="#cb64-42" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>what is the connection between the difference between observed and expected score and the p-value? (magnitude and significance, if you will)</span>
<span id="cb64-43"><a href="#cb64-43" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>how is item-restscore related to the bootstrapped p-values from the <span class="in">`iarm::boot_fit()`</span> function (which calculates conditional item fit values)?</span>
<span id="cb64-44"><a href="#cb64-44" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>how is simulation based cutoff values for conditional infit/outfit related to the two above?</span>
<span id="cb64-45"><a href="#cb64-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-46"><a href="#cb64-46" aria-hidden="true" tabindex="-1"></a>I will use the Rasch Partial Credit Model (PCM) for some explorations of this topic.</span>
<span id="cb64-47"><a href="#cb64-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-48"><a href="#cb64-48" aria-hidden="true" tabindex="-1"></a><span class="fu">### Example</span></span>
<span id="cb64-49"><a href="#cb64-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-50"><a href="#cb64-50" aria-hidden="true" tabindex="-1"></a>First, we'll review results from the dataset <span class="in">`pcmdat2`</span> included in the <span class="in">`eRm`</span> package.</span>
<span id="cb64-51"><a href="#cb64-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-54"><a href="#cb64-54" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-55"><a href="#cb64-55" aria-hidden="true" tabindex="-1"></a><span class="fu">RItileplot</span>(pcmdat2)</span>
<span id="cb64-56"><a href="#cb64-56" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-57"><a href="#cb64-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-58"><a href="#cb64-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-61"><a href="#cb64-61" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-62"><a href="#cb64-62" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-label: targeting1</span></span>
<span id="cb64-63"><a href="#cb64-63" aria-hidden="true" tabindex="-1"></a><span class="fu">RItargeting</span>(pcmdat2)</span>
<span id="cb64-64"><a href="#cb64-64" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-65"><a href="#cb64-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-66"><a href="#cb64-66" aria-hidden="true" tabindex="-1"></a>300 respondents, 4 items with 4 response categories each.</span>
<span id="cb64-67"><a href="#cb64-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-70"><a href="#cb64-70" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-71"><a href="#cb64-71" aria-hidden="true" tabindex="-1"></a>testfit <span class="ot">&lt;-</span> <span class="cf">function</span>(data, <span class="at">boot =</span> <span class="dv">100</span>, <span class="at">sfit =</span> <span class="dv">500</span>) {</span>
<span id="cb64-72"><a href="#cb64-72" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb64-73"><a href="#cb64-73" aria-hidden="true" tabindex="-1"></a>  i1 <span class="ot">&lt;-</span> <span class="fu">item_restscore</span>(<span class="fu">PCM</span>(data))</span>
<span id="cb64-74"><a href="#cb64-74" aria-hidden="true" tabindex="-1"></a>  i1 <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(i1)</span>
<span id="cb64-75"><a href="#cb64-75" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb64-76"><a href="#cb64-76" aria-hidden="true" tabindex="-1"></a>  i2 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="st">"observed"</span> <span class="ot">=</span> <span class="fu">as.numeric</span>(i1[[<span class="dv">1</span>]][<span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(data),<span class="dv">1</span>]),</span>
<span id="cb64-77"><a href="#cb64-77" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"expected"</span> <span class="ot">=</span> <span class="fu">as.numeric</span>(i1[[<span class="dv">1</span>]][<span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(data),<span class="dv">2</span>]),</span>
<span id="cb64-78"><a href="#cb64-78" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"se"</span> <span class="ot">=</span> <span class="fu">as.numeric</span>(i1[[<span class="dv">1</span>]][<span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(data),<span class="dv">3</span>]),</span>
<span id="cb64-79"><a href="#cb64-79" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"p.value"</span> <span class="ot">=</span> <span class="fu">as.numeric</span>(i1[[<span class="dv">1</span>]][<span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(data),<span class="dv">4</span>]),</span>
<span id="cb64-80"><a href="#cb64-80" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"p.adj.BH"</span> <span class="ot">=</span> <span class="fu">as.numeric</span>(i1[[<span class="dv">1</span>]][<span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(data),<span class="dv">5</span>])</span>
<span id="cb64-81"><a href="#cb64-81" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb64-82"><a href="#cb64-82" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">diff_abs =</span> <span class="fu">abs</span>(expected <span class="sc">-</span> observed),</span>
<span id="cb64-83"><a href="#cb64-83" aria-hidden="true" tabindex="-1"></a>           <span class="at">diff =</span> expected <span class="sc">-</span> observed)</span>
<span id="cb64-84"><a href="#cb64-84" aria-hidden="true" tabindex="-1"></a>  ifit <span class="ot">&lt;-</span> <span class="fu">out_infit</span>(<span class="fu">PCM</span>(data))</span>
<span id="cb64-85"><a href="#cb64-85" aria-hidden="true" tabindex="-1"></a>  bfit <span class="ot">&lt;-</span> <span class="fu">boot_fit</span>(<span class="fu">PCM</span>(data),boot)</span>
<span id="cb64-86"><a href="#cb64-86" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb64-87"><a href="#cb64-87" aria-hidden="true" tabindex="-1"></a>  sfit <span class="ot">&lt;-</span> <span class="fu">RIgetfit</span>(data,sfit,<span class="dv">8</span>)</span>
<span id="cb64-88"><a href="#cb64-88" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb64-89"><a href="#cb64-89" aria-hidden="true" tabindex="-1"></a>  out <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">"item_restscore"</span> <span class="ot">=</span> i2,</span>
<span id="cb64-90"><a href="#cb64-90" aria-hidden="true" tabindex="-1"></a>              <span class="st">"out_infit"</span> <span class="ot">=</span> ifit,</span>
<span id="cb64-91"><a href="#cb64-91" aria-hidden="true" tabindex="-1"></a>              <span class="st">"boot_fit"</span> <span class="ot">=</span> bfit,</span>
<span id="cb64-92"><a href="#cb64-92" aria-hidden="true" tabindex="-1"></a>              <span class="st">"sfit"</span> <span class="ot">=</span> sfit)</span>
<span id="cb64-93"><a href="#cb64-93" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(out)</span>
<span id="cb64-94"><a href="#cb64-94" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb64-95"><a href="#cb64-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-96"><a href="#cb64-96" aria-hidden="true" tabindex="-1"></a>test1 <span class="ot">&lt;-</span> <span class="fu">testfit</span>(pcmdat2)</span>
<span id="cb64-97"><a href="#cb64-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-98"><a href="#cb64-98" aria-hidden="true" tabindex="-1"></a>test1<span class="sc">$</span>item_restscore</span>
<span id="cb64-99"><a href="#cb64-99" aria-hidden="true" tabindex="-1"></a>test1<span class="sc">$</span>boot_fit</span>
<span id="cb64-100"><a href="#cb64-100" aria-hidden="true" tabindex="-1"></a><span class="fu">RIitemfit</span>(pcmdat2,test1<span class="sc">$</span>sfit)</span>
<span id="cb64-101"><a href="#cb64-101" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-102"><a href="#cb64-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-103"><a href="#cb64-103" aria-hidden="true" tabindex="-1"></a>We have a significant item-restscore deviation for item 3 (higher than expected), and the low infit/outfit is significant when using bootstrapped p-values (100 iterations). The simulation based cutoff values for infit/outfit agree (500 iterations).</span>
<span id="cb64-104"><a href="#cb64-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-105"><a href="#cb64-105" aria-hidden="true" tabindex="-1"></a>Also, note that item 3 has the worst targeting (see @fig-targeting1)</span>
<span id="cb64-106"><a href="#cb64-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-107"><a href="#cb64-107" aria-hidden="true" tabindex="-1"></a><span class="fu">### Reduced sample</span></span>
<span id="cb64-108"><a href="#cb64-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-109"><a href="#cb64-109" aria-hidden="true" tabindex="-1"></a>Our sample size is 300. What happens if we reduce that to 100?</span>
<span id="cb64-110"><a href="#cb64-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-113"><a href="#cb64-113" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-114"><a href="#cb64-114" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1324</span>)</span>
<span id="cb64-115"><a href="#cb64-115" aria-hidden="true" tabindex="-1"></a>d100 <span class="ot">&lt;-</span> pcmdat2[<span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">300</span>, <span class="dv">100</span>), ]</span>
<span id="cb64-116"><a href="#cb64-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-117"><a href="#cb64-117" aria-hidden="true" tabindex="-1"></a>test2 <span class="ot">&lt;-</span> <span class="fu">testfit</span>(d100)</span>
<span id="cb64-118"><a href="#cb64-118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-119"><a href="#cb64-119" aria-hidden="true" tabindex="-1"></a>test2<span class="sc">$</span>item_restscore</span>
<span id="cb64-120"><a href="#cb64-120" aria-hidden="true" tabindex="-1"></a>test2<span class="sc">$</span>boot_fit</span>
<span id="cb64-121"><a href="#cb64-121" aria-hidden="true" tabindex="-1"></a><span class="fu">RIitemfit</span>(d100,test2<span class="sc">$</span>sfit)</span>
<span id="cb64-122"><a href="#cb64-122" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-123"><a href="#cb64-123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-124"><a href="#cb64-124" aria-hidden="true" tabindex="-1"></a>Everything now looks ok. This could of course be due to random sampling. Let's use the sample size of 100 and do 1000 iterations of random samples to see how many show misfit for item 3. We should really use a simulated dataset with induced (known) misfit, but let's do that later.</span>
<span id="cb64-125"><a href="#cb64-125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-126"><a href="#cb64-126" aria-hidden="true" tabindex="-1"></a><span class="fu">## Non-parametric bootstrapping</span></span>
<span id="cb64-127"><a href="#cb64-127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-128"><a href="#cb64-128" aria-hidden="true" tabindex="-1"></a>First, we build a function to run multiple samples.</span>
<span id="cb64-129"><a href="#cb64-129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-132"><a href="#cb64-132" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-133"><a href="#cb64-133" aria-hidden="true" tabindex="-1"></a>testfit2 <span class="ot">&lt;-</span> <span class="cf">function</span>(dat, <span class="at">boot =</span> <span class="dv">100</span>, <span class="at">sfit =</span> <span class="dv">500</span>, <span class="at">iterations =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>) {</span>
<span id="cb64-134"><a href="#cb64-134" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb64-135"><a href="#cb64-135" aria-hidden="true" tabindex="-1"></a>  fit <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb64-136"><a href="#cb64-136" aria-hidden="true" tabindex="-1"></a>  fit <span class="ot">&lt;-</span> <span class="fu">foreach</span>(iterations) <span class="sc">%do%</span> {</span>
<span id="cb64-137"><a href="#cb64-137" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb64-138"><a href="#cb64-138" aria-hidden="true" tabindex="-1"></a>    data <span class="ot">&lt;-</span> dat[<span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(dat), <span class="dv">100</span>), ]</span>
<span id="cb64-139"><a href="#cb64-139" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb64-140"><a href="#cb64-140" aria-hidden="true" tabindex="-1"></a>    i1 <span class="ot">&lt;-</span> <span class="fu">item_restscore</span>(<span class="fu">PCM</span>(data))</span>
<span id="cb64-141"><a href="#cb64-141" aria-hidden="true" tabindex="-1"></a>    i1 <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(i1)</span>
<span id="cb64-142"><a href="#cb64-142" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb64-143"><a href="#cb64-143" aria-hidden="true" tabindex="-1"></a>    i2 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="st">"observed"</span> <span class="ot">=</span> <span class="fu">as.numeric</span>(i1[[<span class="dv">1</span>]][<span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(data),<span class="dv">1</span>]),</span>
<span id="cb64-144"><a href="#cb64-144" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"expected"</span> <span class="ot">=</span> <span class="fu">as.numeric</span>(i1[[<span class="dv">1</span>]][<span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(data),<span class="dv">2</span>]),</span>
<span id="cb64-145"><a href="#cb64-145" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"se"</span> <span class="ot">=</span> <span class="fu">as.numeric</span>(i1[[<span class="dv">1</span>]][<span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(data),<span class="dv">3</span>]),</span>
<span id="cb64-146"><a href="#cb64-146" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"p.value"</span> <span class="ot">=</span> <span class="fu">as.numeric</span>(i1[[<span class="dv">1</span>]][<span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(data),<span class="dv">4</span>]),</span>
<span id="cb64-147"><a href="#cb64-147" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"p.adj.BH"</span> <span class="ot">=</span> <span class="fu">as.numeric</span>(i1[[<span class="dv">1</span>]][<span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(data),<span class="dv">5</span>])</span>
<span id="cb64-148"><a href="#cb64-148" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span> </span>
<span id="cb64-149"><a href="#cb64-149" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="at">diff_abs =</span> <span class="fu">abs</span>(expected <span class="sc">-</span> observed),</span>
<span id="cb64-150"><a href="#cb64-150" aria-hidden="true" tabindex="-1"></a>             <span class="at">diff =</span> expected <span class="sc">-</span> observed,</span>
<span id="cb64-151"><a href="#cb64-151" aria-hidden="true" tabindex="-1"></a>             <span class="at">ir_padj =</span> <span class="fu">ifelse</span>(p.adj.BH <span class="sc">&lt;</span> .<span class="dv">05</span>, <span class="st">"sign. misfit"</span>,<span class="st">"no misfit"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb64-152"><a href="#cb64-152" aria-hidden="true" tabindex="-1"></a>      <span class="fu">select</span>(ir_padj, diff, diff_abs) <span class="sc">%&gt;%</span> </span>
<span id="cb64-153"><a href="#cb64-153" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="at">item =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(data))</span>
<span id="cb64-154"><a href="#cb64-154" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb64-155"><a href="#cb64-155" aria-hidden="true" tabindex="-1"></a>    <span class="co">#ifit &lt;- out_infit(PCM(data))</span></span>
<span id="cb64-156"><a href="#cb64-156" aria-hidden="true" tabindex="-1"></a>    bfit <span class="ot">&lt;-</span> <span class="fu">boot_fit</span>(<span class="fu">PCM</span>(data),boot)</span>
<span id="cb64-157"><a href="#cb64-157" aria-hidden="true" tabindex="-1"></a>    bfit <span class="ot">&lt;-</span> bfit[[<span class="dv">1</span>]] <span class="sc">%&gt;%</span> </span>
<span id="cb64-158"><a href="#cb64-158" aria-hidden="true" tabindex="-1"></a>      <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb64-159"><a href="#cb64-159" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="at">bfit_sig =</span> <span class="fu">case_when</span>(out.pkorr <span class="sc">&lt;</span> .<span class="dv">05</span> <span class="sc">~</span> <span class="st">"sign. outfit"</span>,</span>
<span id="cb64-160"><a href="#cb64-160" aria-hidden="true" tabindex="-1"></a>                             in.pkorr <span class="sc">&lt;</span> .<span class="dv">05</span> <span class="sc">~</span> <span class="st">"sign. infit"</span>,</span>
<span id="cb64-161"><a href="#cb64-161" aria-hidden="true" tabindex="-1"></a>                             out.pkorr <span class="sc">&lt;</span> .<span class="dv">05</span> <span class="sc">&amp;</span> in.pkorr <span class="sc">&lt;</span> .<span class="dv">05</span> <span class="sc">~</span> <span class="st">"sign. inoutfit"</span>,</span>
<span id="cb64-162"><a href="#cb64-162" aria-hidden="true" tabindex="-1"></a>                             <span class="at">.default =</span> <span class="st">"no misfit"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb64-163"><a href="#cb64-163" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="at">item =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(data)) <span class="sc">%&gt;%</span> </span>
<span id="cb64-164"><a href="#cb64-164" aria-hidden="true" tabindex="-1"></a>      <span class="fu">select</span>(item,bfit_sig,Outfit,Infit)</span>
<span id="cb64-165"><a href="#cb64-165" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb64-166"><a href="#cb64-166" aria-hidden="true" tabindex="-1"></a>    simfit <span class="ot">&lt;-</span> <span class="fu">RIgetfit</span>(data,sfit,<span class="dv">8</span>)</span>
<span id="cb64-167"><a href="#cb64-167" aria-hidden="true" tabindex="-1"></a>    rfit <span class="ot">&lt;-</span> <span class="fu">RIitemfit</span>(data,simfit,<span class="at">output =</span> <span class="st">"dataframe"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb64-168"><a href="#cb64-168" aria-hidden="true" tabindex="-1"></a>      <span class="fu">select</span>(infit_diff,outfit_diff) <span class="sc">%&gt;%</span> </span>
<span id="cb64-169"><a href="#cb64-169" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="at">item =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(data))</span>
<span id="cb64-170"><a href="#cb64-170" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb64-171"><a href="#cb64-171" aria-hidden="true" tabindex="-1"></a>    <span class="fu">list</span>(<span class="st">"item_restscore"</span> <span class="ot">=</span> i2,</span>
<span id="cb64-172"><a href="#cb64-172" aria-hidden="true" tabindex="-1"></a>         <span class="co">#"out_infit" = ifit,</span></span>
<span id="cb64-173"><a href="#cb64-173" aria-hidden="true" tabindex="-1"></a>         <span class="st">"boot_fit"</span> <span class="ot">=</span> bfit,</span>
<span id="cb64-174"><a href="#cb64-174" aria-hidden="true" tabindex="-1"></a>         <span class="st">"rfit"</span> <span class="ot">=</span> rfit)</span>
<span id="cb64-175"><a href="#cb64-175" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb64-176"><a href="#cb64-176" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(fit)</span>
<span id="cb64-177"><a href="#cb64-177" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb64-178"><a href="#cb64-178" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-179"><a href="#cb64-179" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-180"><a href="#cb64-180" aria-hidden="true" tabindex="-1"></a>Then we run it for 1000 iterations.</span>
<span id="cb64-181"><a href="#cb64-181" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-184"><a href="#cb64-184" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-185"><a href="#cb64-185" aria-hidden="true" tabindex="-1"></a><span class="co">#test3 &lt;- testfit2(pcmdat2, iterations = 1:1000)</span></span>
<span id="cb64-186"><a href="#cb64-186" aria-hidden="true" tabindex="-1"></a><span class="co">#saveRDS(test3,"irscore.Rdata")</span></span>
<span id="cb64-187"><a href="#cb64-187" aria-hidden="true" tabindex="-1"></a>test3 <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"irscore.Rdata"</span>)</span>
<span id="cb64-188"><a href="#cb64-188" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-189"><a href="#cb64-189" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-190"><a href="#cb64-190" aria-hidden="true" tabindex="-1"></a><span class="fu">### Results</span></span>
<span id="cb64-191"><a href="#cb64-191" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-192"><a href="#cb64-192" aria-hidden="true" tabindex="-1"></a>Join results to a dataframe.</span>
<span id="cb64-193"><a href="#cb64-193" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-196"><a href="#cb64-196" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-197"><a href="#cb64-197" aria-hidden="true" tabindex="-1"></a>iterations <span class="ot">=</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span></span>
<span id="cb64-198"><a href="#cb64-198" aria-hidden="true" tabindex="-1"></a>result_irscore <span class="ot">&lt;-</span> <span class="fu">map_dfr</span>(iterations, <span class="sc">~</span> <span class="fu">bind_rows</span>(test3[[.x]]<span class="sc">$</span>item_restscore) <span class="sc">%&gt;%</span> </span>
<span id="cb64-199"><a href="#cb64-199" aria-hidden="true" tabindex="-1"></a>          <span class="fu">add_column</span>(<span class="at">iteration =</span> .x))</span>
<span id="cb64-200"><a href="#cb64-200" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-201"><a href="#cb64-201" aria-hidden="true" tabindex="-1"></a>result_bfit <span class="ot">&lt;-</span> <span class="fu">map_dfr</span>(iterations, <span class="sc">~</span> <span class="fu">bind_rows</span>(test3[[.x]]<span class="sc">$</span>boot_fit) <span class="sc">%&gt;%</span> </span>
<span id="cb64-202"><a href="#cb64-202" aria-hidden="true" tabindex="-1"></a>          <span class="fu">add_column</span>(<span class="at">iteration =</span> .x))</span>
<span id="cb64-203"><a href="#cb64-203" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-204"><a href="#cb64-204" aria-hidden="true" tabindex="-1"></a>result_sfit <span class="ot">&lt;-</span> <span class="fu">map_dfr</span>(iterations, <span class="sc">~</span> <span class="fu">bind_rows</span>(test3[[.x]]<span class="sc">$</span>rfit) <span class="sc">%&gt;%</span> </span>
<span id="cb64-205"><a href="#cb64-205" aria-hidden="true" tabindex="-1"></a>          <span class="fu">add_column</span>(<span class="at">iteration =</span> .x))</span>
<span id="cb64-206"><a href="#cb64-206" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-207"><a href="#cb64-207" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">left_join</span>(result_irscore,result_bfit, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"iteration"</span>,<span class="st">"item"</span>))</span>
<span id="cb64-208"><a href="#cb64-208" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">left_join</span>(results, result_sfit, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"iteration"</span>,<span class="st">"item"</span>))</span>
<span id="cb64-209"><a href="#cb64-209" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(results, <span class="dv">24</span>)</span>
<span id="cb64-210"><a href="#cb64-210" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-211"><a href="#cb64-211" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-212"><a href="#cb64-212" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-213"><a href="#cb64-213" aria-hidden="true" tabindex="-1"></a>Ok, we have some results to summarise. First, we filter on item-restscore misfit and look at the first 25 rows.</span>
<span id="cb64-214"><a href="#cb64-214" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-217"><a href="#cb64-217" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-218"><a href="#cb64-218" aria-hidden="true" tabindex="-1"></a>results <span class="sc">%&gt;%</span> </span>
<span id="cb64-219"><a href="#cb64-219" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(ir_padj <span class="sc">==</span> <span class="st">"sign. misfit"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb64-220"><a href="#cb64-220" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">25</span>)</span>
<span id="cb64-221"><a href="#cb64-221" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-222"><a href="#cb64-222" aria-hidden="true" tabindex="-1"></a>results <span class="sc">%&gt;%</span> </span>
<span id="cb64-223"><a href="#cb64-223" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(ir_padj <span class="sc">==</span> <span class="st">"sign. misfit"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb64-224"><a href="#cb64-224" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(item)</span>
<span id="cb64-225"><a href="#cb64-225" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-226"><a href="#cb64-226" aria-hidden="true" tabindex="-1"></a>ir <span class="ot">&lt;-</span> results <span class="sc">%&gt;%</span> </span>
<span id="cb64-227"><a href="#cb64-227" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(ir_padj <span class="sc">==</span> <span class="st">"sign. misfit"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb64-228"><a href="#cb64-228" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nrow</span>()</span>
<span id="cb64-229"><a href="#cb64-229" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-230"><a href="#cb64-230" aria-hidden="true" tabindex="-1"></a>bf <span class="ot">&lt;-</span> results <span class="sc">%&gt;%</span> </span>
<span id="cb64-231"><a href="#cb64-231" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(ir_padj <span class="sc">==</span> <span class="st">"sign. misfit"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb64-232"><a href="#cb64-232" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(bfit_sig <span class="sc">==</span> <span class="st">"no misfit"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb64-233"><a href="#cb64-233" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nrow</span>()</span>
<span id="cb64-234"><a href="#cb64-234" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-235"><a href="#cb64-235" aria-hidden="true" tabindex="-1"></a>bfout <span class="ot">&lt;-</span> results <span class="sc">%&gt;%</span> </span>
<span id="cb64-236"><a href="#cb64-236" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(ir_padj <span class="sc">==</span> <span class="st">"sign. misfit"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb64-237"><a href="#cb64-237" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(bfit_sig <span class="sc">==</span> <span class="st">"sign. outfit"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb64-238"><a href="#cb64-238" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nrow</span>()</span>
<span id="cb64-239"><a href="#cb64-239" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-240"><a href="#cb64-240" aria-hidden="true" tabindex="-1"></a>simfitin <span class="ot">&lt;-</span> results <span class="sc">%&gt;%</span> </span>
<span id="cb64-241"><a href="#cb64-241" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(ir_padj <span class="sc">==</span> <span class="st">"sign. misfit"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb64-242"><a href="#cb64-242" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>infit_diff <span class="sc">==</span> <span class="st">"no misfit"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb64-243"><a href="#cb64-243" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nrow</span>()</span>
<span id="cb64-244"><a href="#cb64-244" aria-hidden="true" tabindex="-1"></a>simfitout <span class="ot">&lt;-</span> results <span class="sc">%&gt;%</span> </span>
<span id="cb64-245"><a href="#cb64-245" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(ir_padj <span class="sc">==</span> <span class="st">"sign. misfit"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb64-246"><a href="#cb64-246" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>outfit_diff <span class="sc">==</span> <span class="st">"no misfit"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb64-247"><a href="#cb64-247" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nrow</span>()</span>
<span id="cb64-248"><a href="#cb64-248" aria-hidden="true" tabindex="-1"></a>simfitboth <span class="ot">&lt;-</span> results <span class="sc">%&gt;%</span> </span>
<span id="cb64-249"><a href="#cb64-249" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(ir_padj <span class="sc">==</span> <span class="st">"sign. misfit"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb64-250"><a href="#cb64-250" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>outfit_diff <span class="sc">==</span> <span class="st">"no misfit"</span> <span class="sc">|</span> <span class="sc">!</span>infit_diff <span class="sc">==</span> <span class="st">"no misfit"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb64-251"><a href="#cb64-251" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nrow</span>()</span>
<span id="cb64-252"><a href="#cb64-252" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-253"><a href="#cb64-253" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-254"><a href="#cb64-254" aria-hidden="true" tabindex="-1"></a>Item 3 misfit almost exclusively, except for one instance of item 4. Item-restscore shows misfit in <span class="in">`r ir`</span> (out of 1000) datasets, <span class="in">`r round(ir/1000*100,3)`</span>%.</span>
<span id="cb64-255"><a href="#cb64-255" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-256"><a href="#cb64-256" aria-hidden="true" tabindex="-1"></a>Bootstrapped (using 100 bootstraps per dataset) item infit/outfit p-values also indicate significant misfit amongst the datasets identified by item-restscore, and agrees with item-restscore all but 24 cases.</span>
<span id="cb64-257"><a href="#cb64-257" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-258"><a href="#cb64-258" aria-hidden="true" tabindex="-1"></a>Simulation based cutoffs using 500 iterations (per dataset) indicate less misfit in this sample of item-restscore misfits. <span class="in">`r simfitboth`</span> out of <span class="in">`r ir`</span>, of which <span class="in">`r simfitin`</span> were flagged for infit, and <span class="in">`r simfitout`</span> for outfit.</span>
<span id="cb64-259"><a href="#cb64-259" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-260"><a href="#cb64-260" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Item-restscore</span></span>
<span id="cb64-261"><a href="#cb64-261" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-262"><a href="#cb64-262" aria-hidden="true" tabindex="-1"></a>Let's review the observed/expected differences.</span>
<span id="cb64-263"><a href="#cb64-263" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-266"><a href="#cb64-266" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-267"><a href="#cb64-267" aria-hidden="true" tabindex="-1"></a>results <span class="sc">%&gt;%</span> </span>
<span id="cb64-268"><a href="#cb64-268" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(ir_padj <span class="sc">==</span> <span class="st">"sign. misfit"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb64-269"><a href="#cb64-269" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Median =</span> <span class="fu">median</span>(diff_abs),</span>
<span id="cb64-270"><a href="#cb64-270" aria-hidden="true" tabindex="-1"></a>            <span class="at">MAD =</span> <span class="fu">mad</span>(diff_abs),</span>
<span id="cb64-271"><a href="#cb64-271" aria-hidden="true" tabindex="-1"></a>            <span class="at">Mean =</span> <span class="fu">mean</span>(diff_abs),</span>
<span id="cb64-272"><a href="#cb64-272" aria-hidden="true" tabindex="-1"></a>            <span class="at">SD =</span> <span class="fu">sd</span>(diff_abs),</span>
<span id="cb64-273"><a href="#cb64-273" aria-hidden="true" tabindex="-1"></a>            <span class="at">Max =</span> <span class="fu">max</span>(diff_abs),</span>
<span id="cb64-274"><a href="#cb64-274" aria-hidden="true" tabindex="-1"></a>            <span class="at">Min =</span> <span class="fu">min</span>(diff_abs)) <span class="sc">%&gt;%</span> </span>
<span id="cb64-275"><a href="#cb64-275" aria-hidden="true" tabindex="-1"></a>  <span class="fu">round</span>(<span class="dv">3</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb64-276"><a href="#cb64-276" aria-hidden="true" tabindex="-1"></a>  knitr<span class="sc">::</span><span class="fu">kable</span>()</span>
<span id="cb64-277"><a href="#cb64-277" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-278"><a href="#cb64-278" aria-hidden="true" tabindex="-1"></a>results <span class="sc">%&gt;%</span> </span>
<span id="cb64-279"><a href="#cb64-279" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(ir_padj <span class="sc">==</span> <span class="st">"sign. misfit"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb64-280"><a href="#cb64-280" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb64-281"><a href="#cb64-281" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_dotsinterval</span>(<span class="fu">aes</span>(<span class="at">x =</span> diff_abs)) <span class="sc">+</span></span>
<span id="cb64-282"><a href="#cb64-282" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="st">'Distribution of absolut differences'</span>, <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.4</span>)) <span class="sc">+</span></span>
<span id="cb64-283"><a href="#cb64-283" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb64-284"><a href="#cb64-284" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Observed vs expected item-restscore values"</span>)</span>
<span id="cb64-285"><a href="#cb64-285" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-286"><a href="#cb64-286" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-287"><a href="#cb64-287" aria-hidden="true" tabindex="-1"></a>The results above were filtered on only item-restscore, so there may be other results for the other methods.</span>
<span id="cb64-288"><a href="#cb64-288" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-289"><a href="#cb64-289" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Bootfit</span></span>
<span id="cb64-290"><a href="#cb64-290" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-293"><a href="#cb64-293" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-294"><a href="#cb64-294" aria-hidden="true" tabindex="-1"></a>bfo <span class="ot">&lt;-</span> results <span class="sc">%&gt;%</span> </span>
<span id="cb64-295"><a href="#cb64-295" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(bfit_sig <span class="sc">==</span> <span class="st">"sign. outfit"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb64-296"><a href="#cb64-296" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nrow</span>()</span>
<span id="cb64-297"><a href="#cb64-297" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-298"><a href="#cb64-298" aria-hidden="true" tabindex="-1"></a>results <span class="sc">%&gt;%</span> </span>
<span id="cb64-299"><a href="#cb64-299" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(bfit_sig <span class="sc">==</span> <span class="st">"sign. outfit"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb64-300"><a href="#cb64-300" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(item) <span class="sc">%&gt;%</span> </span>
<span id="cb64-301"><a href="#cb64-301" aria-hidden="true" tabindex="-1"></a>  knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="at">caption =</span> <span class="st">"Items with statistically significant outfit"</span>)</span>
<span id="cb64-302"><a href="#cb64-302" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-303"><a href="#cb64-303" aria-hidden="true" tabindex="-1"></a>bfi <span class="ot">&lt;-</span> results <span class="sc">%&gt;%</span> </span>
<span id="cb64-304"><a href="#cb64-304" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(bfit_sig <span class="sc">==</span> <span class="st">"sign. infit"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb64-305"><a href="#cb64-305" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nrow</span>()</span>
<span id="cb64-306"><a href="#cb64-306" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-307"><a href="#cb64-307" aria-hidden="true" tabindex="-1"></a>results <span class="sc">%&gt;%</span> </span>
<span id="cb64-308"><a href="#cb64-308" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(bfit_sig <span class="sc">==</span> <span class="st">"sign. infit"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb64-309"><a href="#cb64-309" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(item) <span class="sc">%&gt;%</span> </span>
<span id="cb64-310"><a href="#cb64-310" aria-hidden="true" tabindex="-1"></a>  knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="at">caption =</span> <span class="st">"Items with statistically significant infit"</span>)</span>
<span id="cb64-311"><a href="#cb64-311" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-312"><a href="#cb64-312" aria-hidden="true" tabindex="-1"></a>bfboth <span class="ot">&lt;-</span> results <span class="sc">%&gt;%</span> </span>
<span id="cb64-313"><a href="#cb64-313" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(bfit_sig <span class="sc">==</span> <span class="st">"sign. infit"</span> <span class="sc">|</span> bfit_sig <span class="sc">==</span> <span class="st">"sign. outfit"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb64-314"><a href="#cb64-314" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nrow</span>()</span>
<span id="cb64-315"><a href="#cb64-315" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-316"><a href="#cb64-316" aria-hidden="true" tabindex="-1"></a>results <span class="sc">%&gt;%</span> </span>
<span id="cb64-317"><a href="#cb64-317" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(bfit_sig <span class="sc">==</span> <span class="st">"sign. infit"</span> <span class="sc">|</span> bfit_sig <span class="sc">==</span> <span class="st">"sign. outfit"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb64-318"><a href="#cb64-318" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(item) <span class="sc">%&gt;%</span> </span>
<span id="cb64-319"><a href="#cb64-319" aria-hidden="true" tabindex="-1"></a>  knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="at">caption =</span> <span class="st">"Items with statistically significant infit and/or outfit"</span>)</span>
<span id="cb64-320"><a href="#cb64-320" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-321"><a href="#cb64-321" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-322"><a href="#cb64-322" aria-hidden="true" tabindex="-1"></a><span class="in">`r bfo`</span> datasets with significant outfit and <span class="in">`r bfi`</span> with significant infit.</span>
<span id="cb64-323"><a href="#cb64-323" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-324"><a href="#cb64-324" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Simulation based cutoff</span></span>
<span id="cb64-325"><a href="#cb64-325" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-328"><a href="#cb64-328" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-329"><a href="#cb64-329" aria-hidden="true" tabindex="-1"></a>sfo <span class="ot">&lt;-</span> results <span class="sc">%&gt;%</span> </span>
<span id="cb64-330"><a href="#cb64-330" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>outfit_diff <span class="sc">==</span> <span class="st">"no misfit"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb64-331"><a href="#cb64-331" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nrow</span>()</span>
<span id="cb64-332"><a href="#cb64-332" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-333"><a href="#cb64-333" aria-hidden="true" tabindex="-1"></a>results <span class="sc">%&gt;%</span> </span>
<span id="cb64-334"><a href="#cb64-334" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>outfit_diff <span class="sc">==</span> <span class="st">"no misfit"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb64-335"><a href="#cb64-335" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(item) <span class="sc">%&gt;%</span> </span>
<span id="cb64-336"><a href="#cb64-336" aria-hidden="true" tabindex="-1"></a>  knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="at">caption =</span> <span class="st">"Items with deviant outfit"</span>)</span>
<span id="cb64-337"><a href="#cb64-337" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-338"><a href="#cb64-338" aria-hidden="true" tabindex="-1"></a>sfi <span class="ot">&lt;-</span> results <span class="sc">%&gt;%</span> </span>
<span id="cb64-339"><a href="#cb64-339" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>infit_diff <span class="sc">==</span> <span class="st">"no misfit"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb64-340"><a href="#cb64-340" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nrow</span>()</span>
<span id="cb64-341"><a href="#cb64-341" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-342"><a href="#cb64-342" aria-hidden="true" tabindex="-1"></a>results <span class="sc">%&gt;%</span> </span>
<span id="cb64-343"><a href="#cb64-343" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>infit_diff <span class="sc">==</span> <span class="st">"no misfit"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb64-344"><a href="#cb64-344" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(item) <span class="sc">%&gt;%</span> </span>
<span id="cb64-345"><a href="#cb64-345" aria-hidden="true" tabindex="-1"></a>  knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="at">caption =</span> <span class="st">"Items with deviant infit"</span>)</span>
<span id="cb64-346"><a href="#cb64-346" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-347"><a href="#cb64-347" aria-hidden="true" tabindex="-1"></a>sfboth <span class="ot">&lt;-</span> results <span class="sc">%&gt;%</span> </span>
<span id="cb64-348"><a href="#cb64-348" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>infit_diff <span class="sc">==</span> <span class="st">"no misfit"</span> <span class="sc">|</span> <span class="sc">!</span>outfit_diff <span class="sc">==</span> <span class="st">"no misfit"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb64-349"><a href="#cb64-349" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nrow</span>()</span>
<span id="cb64-350"><a href="#cb64-350" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-351"><a href="#cb64-351" aria-hidden="true" tabindex="-1"></a>results <span class="sc">%&gt;%</span> </span>
<span id="cb64-352"><a href="#cb64-352" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>infit_diff <span class="sc">==</span> <span class="st">"no misfit"</span> <span class="sc">|</span> <span class="sc">!</span>outfit_diff <span class="sc">==</span> <span class="st">"no misfit"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb64-353"><a href="#cb64-353" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(item) <span class="sc">%&gt;%</span> </span>
<span id="cb64-354"><a href="#cb64-354" aria-hidden="true" tabindex="-1"></a>  knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="at">caption =</span> <span class="st">"Items with deviant infit and/or outfit"</span>)</span>
<span id="cb64-355"><a href="#cb64-355" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-356"><a href="#cb64-356" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-357"><a href="#cb64-357" aria-hidden="true" tabindex="-1"></a><span class="in">`r sfo`</span> datasets with significant outfit and <span class="in">`r sfi`</span> with significant infit, resulting in <span class="in">`r sfboth`</span> with either type of misfit.</span>
<span id="cb64-358"><a href="#cb64-358" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-359"><a href="#cb64-359" aria-hidden="true" tabindex="-1"></a>We can review the distribution of infit/outfit for misfitting items.</span>
<span id="cb64-360"><a href="#cb64-360" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-361"><a href="#cb64-361" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Infit</span></span>
<span id="cb64-362"><a href="#cb64-362" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-365"><a href="#cb64-365" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-366"><a href="#cb64-366" aria-hidden="true" tabindex="-1"></a>results <span class="sc">%&gt;%</span> </span>
<span id="cb64-367"><a href="#cb64-367" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(ir_padj <span class="sc">==</span> <span class="st">"sign. misfit"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb64-368"><a href="#cb64-368" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Median =</span> <span class="fu">median</span>(Infit),</span>
<span id="cb64-369"><a href="#cb64-369" aria-hidden="true" tabindex="-1"></a>            <span class="at">MAD =</span> <span class="fu">mad</span>(Infit),</span>
<span id="cb64-370"><a href="#cb64-370" aria-hidden="true" tabindex="-1"></a>            <span class="at">Mean =</span> <span class="fu">mean</span>(Infit),</span>
<span id="cb64-371"><a href="#cb64-371" aria-hidden="true" tabindex="-1"></a>            <span class="at">SD =</span> <span class="fu">sd</span>(Infit),</span>
<span id="cb64-372"><a href="#cb64-372" aria-hidden="true" tabindex="-1"></a>            <span class="at">Max =</span> <span class="fu">max</span>(Infit),</span>
<span id="cb64-373"><a href="#cb64-373" aria-hidden="true" tabindex="-1"></a>            <span class="at">Min =</span> <span class="fu">min</span>(Infit)) <span class="sc">%&gt;%</span> </span>
<span id="cb64-374"><a href="#cb64-374" aria-hidden="true" tabindex="-1"></a>  <span class="fu">round</span>(<span class="dv">3</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb64-375"><a href="#cb64-375" aria-hidden="true" tabindex="-1"></a>  knitr<span class="sc">::</span><span class="fu">kable</span>()</span>
<span id="cb64-376"><a href="#cb64-376" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-377"><a href="#cb64-377" aria-hidden="true" tabindex="-1"></a>results <span class="sc">%&gt;%</span> </span>
<span id="cb64-378"><a href="#cb64-378" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(ir_padj <span class="sc">==</span> <span class="st">"sign. misfit"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb64-379"><a href="#cb64-379" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb64-380"><a href="#cb64-380" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_dotsinterval</span>(<span class="fu">aes</span>(<span class="at">x =</span> Infit)) <span class="sc">+</span></span>
<span id="cb64-381"><a href="#cb64-381" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="st">'Distribution conditional infit MSQ'</span>, <span class="at">limits =</span> <span class="fu">c</span>(<span class="fl">0.5</span>,<span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb64-382"><a href="#cb64-382" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb64-383"><a href="#cb64-383" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-384"><a href="#cb64-384" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-385"><a href="#cb64-385" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Outfit</span></span>
<span id="cb64-386"><a href="#cb64-386" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-389"><a href="#cb64-389" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-390"><a href="#cb64-390" aria-hidden="true" tabindex="-1"></a>results <span class="sc">%&gt;%</span> </span>
<span id="cb64-391"><a href="#cb64-391" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(ir_padj <span class="sc">==</span> <span class="st">"sign. misfit"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb64-392"><a href="#cb64-392" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Median =</span> <span class="fu">median</span>(Outfit),</span>
<span id="cb64-393"><a href="#cb64-393" aria-hidden="true" tabindex="-1"></a>            <span class="at">MAD =</span> <span class="fu">mad</span>(Outfit),</span>
<span id="cb64-394"><a href="#cb64-394" aria-hidden="true" tabindex="-1"></a>            <span class="at">Mean =</span> <span class="fu">mean</span>(Outfit),</span>
<span id="cb64-395"><a href="#cb64-395" aria-hidden="true" tabindex="-1"></a>            <span class="at">SD =</span> <span class="fu">sd</span>(Outfit),</span>
<span id="cb64-396"><a href="#cb64-396" aria-hidden="true" tabindex="-1"></a>            <span class="at">Max =</span> <span class="fu">max</span>(Outfit),</span>
<span id="cb64-397"><a href="#cb64-397" aria-hidden="true" tabindex="-1"></a>            <span class="at">Min =</span> <span class="fu">min</span>(Outfit)) <span class="sc">%&gt;%</span> </span>
<span id="cb64-398"><a href="#cb64-398" aria-hidden="true" tabindex="-1"></a>  <span class="fu">round</span>(<span class="dv">3</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb64-399"><a href="#cb64-399" aria-hidden="true" tabindex="-1"></a>  knitr<span class="sc">::</span><span class="fu">kable</span>()</span>
<span id="cb64-400"><a href="#cb64-400" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-401"><a href="#cb64-401" aria-hidden="true" tabindex="-1"></a>results <span class="sc">%&gt;%</span> </span>
<span id="cb64-402"><a href="#cb64-402" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(ir_padj <span class="sc">==</span> <span class="st">"sign. misfit"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb64-403"><a href="#cb64-403" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb64-404"><a href="#cb64-404" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_dotsinterval</span>(<span class="fu">aes</span>(<span class="at">x =</span> Outfit)) <span class="sc">+</span></span>
<span id="cb64-405"><a href="#cb64-405" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="st">'Distribution conditional outfit MSQ'</span>, <span class="at">limits =</span> <span class="fu">c</span>(<span class="fl">0.5</span>,<span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb64-406"><a href="#cb64-406" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb64-407"><a href="#cb64-407" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-408"><a href="#cb64-408" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-409"><a href="#cb64-409" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-410"><a href="#cb64-410" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-411"><a href="#cb64-411" aria-hidden="true" tabindex="-1"></a><span class="fu">## Test 2</span></span>
<span id="cb64-412"><a href="#cb64-412" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-413"><a href="#cb64-413" aria-hidden="true" tabindex="-1"></a>What happens if we increase the number of iterations for simulation based cutoffs? We've been running at 500 to shorten runtime, but could go to 1000 iteration while cutting the number of datasets down from 1000 to 500. We'll also try using 50 bootstrap samples for <span class="in">`bootfit()`</span> and see how that affects its p-values.</span>
<span id="cb64-414"><a href="#cb64-414" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-417"><a href="#cb64-417" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-418"><a href="#cb64-418" aria-hidden="true" tabindex="-1"></a><span class="co">#test4 &lt;- testfit2(pcmdat2, iterations = 1:500, sfit = 1000, boot = 50)</span></span>
<span id="cb64-419"><a href="#cb64-419" aria-hidden="true" tabindex="-1"></a><span class="co">#saveRDS(test4,"irscore500.Rdata")</span></span>
<span id="cb64-420"><a href="#cb64-420" aria-hidden="true" tabindex="-1"></a>test4 <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"irscore500.Rdata"</span>)</span>
<span id="cb64-421"><a href="#cb64-421" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-422"><a href="#cb64-422" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-423"><a href="#cb64-423" aria-hidden="true" tabindex="-1"></a><span class="fu">### Results</span></span>
<span id="cb64-424"><a href="#cb64-424" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-425"><a href="#cb64-425" aria-hidden="true" tabindex="-1"></a>Join results to a dataframe.</span>
<span id="cb64-426"><a href="#cb64-426" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-429"><a href="#cb64-429" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-430"><a href="#cb64-430" aria-hidden="true" tabindex="-1"></a>iterations <span class="ot">=</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">500</span></span>
<span id="cb64-431"><a href="#cb64-431" aria-hidden="true" tabindex="-1"></a>result_irscore <span class="ot">&lt;-</span> <span class="fu">map_dfr</span>(iterations, <span class="sc">~</span> <span class="fu">bind_rows</span>(test4[[.x]]<span class="sc">$</span>item_restscore) <span class="sc">%&gt;%</span> </span>
<span id="cb64-432"><a href="#cb64-432" aria-hidden="true" tabindex="-1"></a>          <span class="fu">add_column</span>(<span class="at">iteration =</span> .x))</span>
<span id="cb64-433"><a href="#cb64-433" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-434"><a href="#cb64-434" aria-hidden="true" tabindex="-1"></a>result_bfit <span class="ot">&lt;-</span> <span class="fu">map_dfr</span>(iterations, <span class="sc">~</span> <span class="fu">bind_rows</span>(test4[[.x]]<span class="sc">$</span>boot_fit) <span class="sc">%&gt;%</span> </span>
<span id="cb64-435"><a href="#cb64-435" aria-hidden="true" tabindex="-1"></a>          <span class="fu">add_column</span>(<span class="at">iteration =</span> .x))</span>
<span id="cb64-436"><a href="#cb64-436" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-437"><a href="#cb64-437" aria-hidden="true" tabindex="-1"></a>result_sfit <span class="ot">&lt;-</span> <span class="fu">map_dfr</span>(iterations, <span class="sc">~</span> <span class="fu">bind_rows</span>(test4[[.x]]<span class="sc">$</span>rfit) <span class="sc">%&gt;%</span> </span>
<span id="cb64-438"><a href="#cb64-438" aria-hidden="true" tabindex="-1"></a>          <span class="fu">add_column</span>(<span class="at">iteration =</span> .x))</span>
<span id="cb64-439"><a href="#cb64-439" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-440"><a href="#cb64-440" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">left_join</span>(result_irscore,result_bfit, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"iteration"</span>,<span class="st">"item"</span>))</span>
<span id="cb64-441"><a href="#cb64-441" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">left_join</span>(results, result_sfit, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"iteration"</span>,<span class="st">"item"</span>))</span>
<span id="cb64-442"><a href="#cb64-442" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(results, <span class="dv">24</span>)</span>
<span id="cb64-443"><a href="#cb64-443" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-444"><a href="#cb64-444" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-445"><a href="#cb64-445" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-446"><a href="#cb64-446" aria-hidden="true" tabindex="-1"></a>Ok, we have some results to summarise. First, we filter on item-restscore misfit and look at the first 25 rows.</span>
<span id="cb64-447"><a href="#cb64-447" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-450"><a href="#cb64-450" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-451"><a href="#cb64-451" aria-hidden="true" tabindex="-1"></a>results <span class="sc">%&gt;%</span> </span>
<span id="cb64-452"><a href="#cb64-452" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(ir_padj <span class="sc">==</span> <span class="st">"sign. misfit"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb64-453"><a href="#cb64-453" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">25</span>)</span>
<span id="cb64-454"><a href="#cb64-454" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-455"><a href="#cb64-455" aria-hidden="true" tabindex="-1"></a>results <span class="sc">%&gt;%</span> </span>
<span id="cb64-456"><a href="#cb64-456" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(ir_padj <span class="sc">==</span> <span class="st">"sign. misfit"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb64-457"><a href="#cb64-457" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(item) <span class="sc">%&gt;%</span> </span>
<span id="cb64-458"><a href="#cb64-458" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Percent =</span> n<span class="sc">*</span><span class="dv">100</span><span class="sc">/</span><span class="dv">500</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb64-459"><a href="#cb64-459" aria-hidden="true" tabindex="-1"></a>  knitr<span class="sc">::</span><span class="fu">kable</span>()</span>
<span id="cb64-460"><a href="#cb64-460" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-461"><a href="#cb64-461" aria-hidden="true" tabindex="-1"></a>ir <span class="ot">&lt;-</span> results <span class="sc">%&gt;%</span> </span>
<span id="cb64-462"><a href="#cb64-462" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(ir_padj <span class="sc">==</span> <span class="st">"sign. misfit"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb64-463"><a href="#cb64-463" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nrow</span>()</span>
<span id="cb64-464"><a href="#cb64-464" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-465"><a href="#cb64-465" aria-hidden="true" tabindex="-1"></a>bf <span class="ot">&lt;-</span> results <span class="sc">%&gt;%</span> </span>
<span id="cb64-466"><a href="#cb64-466" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(ir_padj <span class="sc">==</span> <span class="st">"sign. misfit"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb64-467"><a href="#cb64-467" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(bfit_sig <span class="sc">==</span> <span class="st">"no misfit"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb64-468"><a href="#cb64-468" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nrow</span>()</span>
<span id="cb64-469"><a href="#cb64-469" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-470"><a href="#cb64-470" aria-hidden="true" tabindex="-1"></a>bfout <span class="ot">&lt;-</span> results <span class="sc">%&gt;%</span> </span>
<span id="cb64-471"><a href="#cb64-471" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(ir_padj <span class="sc">==</span> <span class="st">"sign. misfit"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb64-472"><a href="#cb64-472" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(bfit_sig <span class="sc">==</span> <span class="st">"sign. outfit"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb64-473"><a href="#cb64-473" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nrow</span>()</span>
<span id="cb64-474"><a href="#cb64-474" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-475"><a href="#cb64-475" aria-hidden="true" tabindex="-1"></a>simfitin <span class="ot">&lt;-</span> results <span class="sc">%&gt;%</span> </span>
<span id="cb64-476"><a href="#cb64-476" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(ir_padj <span class="sc">==</span> <span class="st">"sign. misfit"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb64-477"><a href="#cb64-477" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>infit_diff <span class="sc">==</span> <span class="st">"no misfit"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb64-478"><a href="#cb64-478" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nrow</span>()</span>
<span id="cb64-479"><a href="#cb64-479" aria-hidden="true" tabindex="-1"></a>simfitout <span class="ot">&lt;-</span> results <span class="sc">%&gt;%</span> </span>
<span id="cb64-480"><a href="#cb64-480" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(ir_padj <span class="sc">==</span> <span class="st">"sign. misfit"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb64-481"><a href="#cb64-481" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>outfit_diff <span class="sc">==</span> <span class="st">"no misfit"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb64-482"><a href="#cb64-482" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nrow</span>()</span>
<span id="cb64-483"><a href="#cb64-483" aria-hidden="true" tabindex="-1"></a>simfitboth <span class="ot">&lt;-</span> results <span class="sc">%&gt;%</span> </span>
<span id="cb64-484"><a href="#cb64-484" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(ir_padj <span class="sc">==</span> <span class="st">"sign. misfit"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb64-485"><a href="#cb64-485" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>outfit_diff <span class="sc">==</span> <span class="st">"no misfit"</span> <span class="sc">|</span> <span class="sc">!</span>infit_diff <span class="sc">==</span> <span class="st">"no misfit"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb64-486"><a href="#cb64-486" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nrow</span>()</span>
<span id="cb64-487"><a href="#cb64-487" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-488"><a href="#cb64-488" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-489"><a href="#cb64-489" aria-hidden="true" tabindex="-1"></a>Item 3 misfit almost exclusively, except for one instance of item 4. Item-restscore shows misfit in <span class="in">`r ir`</span> (out of 1000) datasets, <span class="in">`r round(ir/500*100,3)`</span>%.</span>
<span id="cb64-490"><a href="#cb64-490" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-491"><a href="#cb64-491" aria-hidden="true" tabindex="-1"></a>Bootstrapped (using 100 bootstraps per dataset) item infit/outfit p-values also indicate significant misfit amongst the datasets identified by item-restscore, and agrees with item-restscore all but 24 cases.</span>
<span id="cb64-492"><a href="#cb64-492" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-493"><a href="#cb64-493" aria-hidden="true" tabindex="-1"></a>Simulation based cutoffs using 500 iterations (per dataset) indicate less misfit in this sample of item-restscore misfits. <span class="in">`r simfitboth`</span> out of <span class="in">`r ir`</span>, of which <span class="in">`r simfitin`</span> were flagged for infit, and <span class="in">`r simfitout`</span> for outfit.</span>
<span id="cb64-494"><a href="#cb64-494" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-495"><a href="#cb64-495" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Item-restscore</span></span>
<span id="cb64-496"><a href="#cb64-496" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-497"><a href="#cb64-497" aria-hidden="true" tabindex="-1"></a>Let's review the observed/expected differences.</span>
<span id="cb64-498"><a href="#cb64-498" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-501"><a href="#cb64-501" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-502"><a href="#cb64-502" aria-hidden="true" tabindex="-1"></a>results <span class="sc">%&gt;%</span> </span>
<span id="cb64-503"><a href="#cb64-503" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(ir_padj <span class="sc">==</span> <span class="st">"sign. misfit"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb64-504"><a href="#cb64-504" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(item) <span class="sc">%&gt;%</span> </span>
<span id="cb64-505"><a href="#cb64-505" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Percent =</span> n<span class="sc">*</span><span class="dv">100</span><span class="sc">/</span><span class="dv">500</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb64-506"><a href="#cb64-506" aria-hidden="true" tabindex="-1"></a>  knitr<span class="sc">::</span><span class="fu">kable</span>()</span>
<span id="cb64-507"><a href="#cb64-507" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-508"><a href="#cb64-508" aria-hidden="true" tabindex="-1"></a>results <span class="sc">%&gt;%</span> </span>
<span id="cb64-509"><a href="#cb64-509" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(ir_padj <span class="sc">==</span> <span class="st">"sign. misfit"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb64-510"><a href="#cb64-510" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Median =</span> <span class="fu">median</span>(diff_abs),</span>
<span id="cb64-511"><a href="#cb64-511" aria-hidden="true" tabindex="-1"></a>            <span class="at">MAD =</span> <span class="fu">mad</span>(diff_abs),</span>
<span id="cb64-512"><a href="#cb64-512" aria-hidden="true" tabindex="-1"></a>            <span class="at">Mean =</span> <span class="fu">mean</span>(diff_abs),</span>
<span id="cb64-513"><a href="#cb64-513" aria-hidden="true" tabindex="-1"></a>            <span class="at">SD =</span> <span class="fu">sd</span>(diff_abs),</span>
<span id="cb64-514"><a href="#cb64-514" aria-hidden="true" tabindex="-1"></a>            <span class="at">Max =</span> <span class="fu">max</span>(diff_abs),</span>
<span id="cb64-515"><a href="#cb64-515" aria-hidden="true" tabindex="-1"></a>            <span class="at">Min =</span> <span class="fu">min</span>(diff_abs)) <span class="sc">%&gt;%</span> </span>
<span id="cb64-516"><a href="#cb64-516" aria-hidden="true" tabindex="-1"></a>  <span class="fu">round</span>(<span class="dv">3</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb64-517"><a href="#cb64-517" aria-hidden="true" tabindex="-1"></a>  knitr<span class="sc">::</span><span class="fu">kable</span>()</span>
<span id="cb64-518"><a href="#cb64-518" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-519"><a href="#cb64-519" aria-hidden="true" tabindex="-1"></a>results <span class="sc">%&gt;%</span> </span>
<span id="cb64-520"><a href="#cb64-520" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(ir_padj <span class="sc">==</span> <span class="st">"sign. misfit"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb64-521"><a href="#cb64-521" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb64-522"><a href="#cb64-522" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_dotsinterval</span>(<span class="fu">aes</span>(<span class="at">x =</span> diff_abs)) <span class="sc">+</span></span>
<span id="cb64-523"><a href="#cb64-523" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="st">'Distribution of absolut differences'</span>, <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.4</span>)) <span class="sc">+</span></span>
<span id="cb64-524"><a href="#cb64-524" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb64-525"><a href="#cb64-525" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Observed vs expected item-restscore values"</span>)</span>
<span id="cb64-526"><a href="#cb64-526" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-527"><a href="#cb64-527" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-528"><a href="#cb64-528" aria-hidden="true" tabindex="-1"></a>The results above were filtered on only item-restscore, so there may be other results for the other methods.</span>
<span id="cb64-529"><a href="#cb64-529" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-530"><a href="#cb64-530" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Bootfit</span></span>
<span id="cb64-531"><a href="#cb64-531" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-534"><a href="#cb64-534" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-535"><a href="#cb64-535" aria-hidden="true" tabindex="-1"></a>bfo <span class="ot">&lt;-</span> results <span class="sc">%&gt;%</span> </span>
<span id="cb64-536"><a href="#cb64-536" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(bfit_sig <span class="sc">==</span> <span class="st">"sign. outfit"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb64-537"><a href="#cb64-537" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nrow</span>()</span>
<span id="cb64-538"><a href="#cb64-538" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-539"><a href="#cb64-539" aria-hidden="true" tabindex="-1"></a>results <span class="sc">%&gt;%</span> </span>
<span id="cb64-540"><a href="#cb64-540" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(bfit_sig <span class="sc">==</span> <span class="st">"sign. outfit"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb64-541"><a href="#cb64-541" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(item) <span class="sc">%&gt;%</span> </span>
<span id="cb64-542"><a href="#cb64-542" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Percent =</span> n<span class="sc">*</span><span class="dv">100</span><span class="sc">/</span><span class="dv">500</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb64-543"><a href="#cb64-543" aria-hidden="true" tabindex="-1"></a>  knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="at">caption =</span> <span class="st">"Items with statistically significant outfit"</span>)</span>
<span id="cb64-544"><a href="#cb64-544" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-545"><a href="#cb64-545" aria-hidden="true" tabindex="-1"></a>bfi <span class="ot">&lt;-</span> results <span class="sc">%&gt;%</span> </span>
<span id="cb64-546"><a href="#cb64-546" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(bfit_sig <span class="sc">==</span> <span class="st">"sign. infit"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb64-547"><a href="#cb64-547" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nrow</span>()</span>
<span id="cb64-548"><a href="#cb64-548" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-549"><a href="#cb64-549" aria-hidden="true" tabindex="-1"></a>results <span class="sc">%&gt;%</span> </span>
<span id="cb64-550"><a href="#cb64-550" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(bfit_sig <span class="sc">==</span> <span class="st">"sign. infit"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb64-551"><a href="#cb64-551" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(item) <span class="sc">%&gt;%</span> </span>
<span id="cb64-552"><a href="#cb64-552" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Percent =</span> n<span class="sc">*</span><span class="dv">100</span><span class="sc">/</span><span class="dv">500</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb64-553"><a href="#cb64-553" aria-hidden="true" tabindex="-1"></a>  knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="at">caption =</span> <span class="st">"Items with statistically significant infit"</span>)</span>
<span id="cb64-554"><a href="#cb64-554" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-555"><a href="#cb64-555" aria-hidden="true" tabindex="-1"></a>bfboth <span class="ot">&lt;-</span> results <span class="sc">%&gt;%</span> </span>
<span id="cb64-556"><a href="#cb64-556" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(bfit_sig <span class="sc">==</span> <span class="st">"sign. infit"</span> <span class="sc">|</span> bfit_sig <span class="sc">==</span> <span class="st">"sign. outfit"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb64-557"><a href="#cb64-557" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nrow</span>()</span>
<span id="cb64-558"><a href="#cb64-558" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-559"><a href="#cb64-559" aria-hidden="true" tabindex="-1"></a>results <span class="sc">%&gt;%</span> </span>
<span id="cb64-560"><a href="#cb64-560" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(bfit_sig <span class="sc">==</span> <span class="st">"sign. infit"</span> <span class="sc">|</span> bfit_sig <span class="sc">==</span> <span class="st">"sign. outfit"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb64-561"><a href="#cb64-561" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(item) <span class="sc">%&gt;%</span></span>
<span id="cb64-562"><a href="#cb64-562" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Percent =</span> n<span class="sc">*</span><span class="dv">100</span><span class="sc">/</span><span class="dv">500</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb64-563"><a href="#cb64-563" aria-hidden="true" tabindex="-1"></a>  knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="at">caption =</span> <span class="st">"Items with statistically significant infit and/or outfit"</span>)</span>
<span id="cb64-564"><a href="#cb64-564" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-565"><a href="#cb64-565" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-566"><a href="#cb64-566" aria-hidden="true" tabindex="-1"></a><span class="in">`r bfo`</span> datasets with significant outfit and <span class="in">`r bfi`</span> with significant infit.</span>
<span id="cb64-567"><a href="#cb64-567" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-568"><a href="#cb64-568" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Simulation based cutoff</span></span>
<span id="cb64-569"><a href="#cb64-569" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-572"><a href="#cb64-572" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-573"><a href="#cb64-573" aria-hidden="true" tabindex="-1"></a>sfo <span class="ot">&lt;-</span> results <span class="sc">%&gt;%</span> </span>
<span id="cb64-574"><a href="#cb64-574" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>outfit_diff <span class="sc">==</span> <span class="st">"no misfit"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb64-575"><a href="#cb64-575" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nrow</span>()</span>
<span id="cb64-576"><a href="#cb64-576" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-577"><a href="#cb64-577" aria-hidden="true" tabindex="-1"></a>results <span class="sc">%&gt;%</span> </span>
<span id="cb64-578"><a href="#cb64-578" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>outfit_diff <span class="sc">==</span> <span class="st">"no misfit"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb64-579"><a href="#cb64-579" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(item) <span class="sc">%&gt;%</span> </span>
<span id="cb64-580"><a href="#cb64-580" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Percent =</span> n<span class="sc">*</span><span class="dv">100</span><span class="sc">/</span><span class="dv">500</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb64-581"><a href="#cb64-581" aria-hidden="true" tabindex="-1"></a>  knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="at">caption =</span> <span class="st">"Items with deviant outfit"</span>)</span>
<span id="cb64-582"><a href="#cb64-582" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-583"><a href="#cb64-583" aria-hidden="true" tabindex="-1"></a>sfi <span class="ot">&lt;-</span> results <span class="sc">%&gt;%</span> </span>
<span id="cb64-584"><a href="#cb64-584" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>infit_diff <span class="sc">==</span> <span class="st">"no misfit"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb64-585"><a href="#cb64-585" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nrow</span>()</span>
<span id="cb64-586"><a href="#cb64-586" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-587"><a href="#cb64-587" aria-hidden="true" tabindex="-1"></a>results <span class="sc">%&gt;%</span> </span>
<span id="cb64-588"><a href="#cb64-588" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>infit_diff <span class="sc">==</span> <span class="st">"no misfit"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb64-589"><a href="#cb64-589" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(item) <span class="sc">%&gt;%</span> </span>
<span id="cb64-590"><a href="#cb64-590" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Percent =</span> n<span class="sc">*</span><span class="dv">100</span><span class="sc">/</span><span class="dv">500</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb64-591"><a href="#cb64-591" aria-hidden="true" tabindex="-1"></a>  knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="at">caption =</span> <span class="st">"Items with deviant infit"</span>)</span>
<span id="cb64-592"><a href="#cb64-592" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-593"><a href="#cb64-593" aria-hidden="true" tabindex="-1"></a>sfboth <span class="ot">&lt;-</span> results <span class="sc">%&gt;%</span> </span>
<span id="cb64-594"><a href="#cb64-594" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>infit_diff <span class="sc">==</span> <span class="st">"no misfit"</span> <span class="sc">|</span> <span class="sc">!</span>outfit_diff <span class="sc">==</span> <span class="st">"no misfit"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb64-595"><a href="#cb64-595" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nrow</span>()</span>
<span id="cb64-596"><a href="#cb64-596" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-597"><a href="#cb64-597" aria-hidden="true" tabindex="-1"></a>results <span class="sc">%&gt;%</span> </span>
<span id="cb64-598"><a href="#cb64-598" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>infit_diff <span class="sc">==</span> <span class="st">"no misfit"</span> <span class="sc">|</span> <span class="sc">!</span>outfit_diff <span class="sc">==</span> <span class="st">"no misfit"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb64-599"><a href="#cb64-599" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(item) <span class="sc">%&gt;%</span> </span>
<span id="cb64-600"><a href="#cb64-600" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Percent =</span> n<span class="sc">*</span><span class="dv">100</span><span class="sc">/</span><span class="dv">500</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb64-601"><a href="#cb64-601" aria-hidden="true" tabindex="-1"></a>  knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="at">caption =</span> <span class="st">"Items with deviant infit and/or outfit"</span>)</span>
<span id="cb64-602"><a href="#cb64-602" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-603"><a href="#cb64-603" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-604"><a href="#cb64-604" aria-hidden="true" tabindex="-1"></a><span class="in">`r sfo`</span> datasets with significant outfit and <span class="in">`r sfi`</span> with significant infit, resulting in <span class="in">`r sfboth`</span> with either type of misfit.</span>
<span id="cb64-605"><a href="#cb64-605" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-606"><a href="#cb64-606" aria-hidden="true" tabindex="-1"></a>We can review the distribution of infit/outfit for misfitting items.</span>
<span id="cb64-607"><a href="#cb64-607" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-608"><a href="#cb64-608" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Infit</span></span>
<span id="cb64-609"><a href="#cb64-609" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-612"><a href="#cb64-612" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-613"><a href="#cb64-613" aria-hidden="true" tabindex="-1"></a>results <span class="sc">%&gt;%</span> </span>
<span id="cb64-614"><a href="#cb64-614" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(ir_padj <span class="sc">==</span> <span class="st">"sign. misfit"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb64-615"><a href="#cb64-615" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Median =</span> <span class="fu">median</span>(Infit),</span>
<span id="cb64-616"><a href="#cb64-616" aria-hidden="true" tabindex="-1"></a>            <span class="at">MAD =</span> <span class="fu">mad</span>(Infit),</span>
<span id="cb64-617"><a href="#cb64-617" aria-hidden="true" tabindex="-1"></a>            <span class="at">Mean =</span> <span class="fu">mean</span>(Infit),</span>
<span id="cb64-618"><a href="#cb64-618" aria-hidden="true" tabindex="-1"></a>            <span class="at">SD =</span> <span class="fu">sd</span>(Infit),</span>
<span id="cb64-619"><a href="#cb64-619" aria-hidden="true" tabindex="-1"></a>            <span class="at">Max =</span> <span class="fu">max</span>(Infit),</span>
<span id="cb64-620"><a href="#cb64-620" aria-hidden="true" tabindex="-1"></a>            <span class="at">Min =</span> <span class="fu">min</span>(Infit)) <span class="sc">%&gt;%</span> </span>
<span id="cb64-621"><a href="#cb64-621" aria-hidden="true" tabindex="-1"></a>  <span class="fu">round</span>(<span class="dv">3</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb64-622"><a href="#cb64-622" aria-hidden="true" tabindex="-1"></a>  knitr<span class="sc">::</span><span class="fu">kable</span>()</span>
<span id="cb64-623"><a href="#cb64-623" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-624"><a href="#cb64-624" aria-hidden="true" tabindex="-1"></a>results <span class="sc">%&gt;%</span> </span>
<span id="cb64-625"><a href="#cb64-625" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(ir_padj <span class="sc">==</span> <span class="st">"sign. misfit"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb64-626"><a href="#cb64-626" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb64-627"><a href="#cb64-627" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_dotsinterval</span>(<span class="fu">aes</span>(<span class="at">x =</span> Infit)) <span class="sc">+</span></span>
<span id="cb64-628"><a href="#cb64-628" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="st">'Distribution conditional infit MSQ'</span>, <span class="at">limits =</span> <span class="fu">c</span>(<span class="fl">0.5</span>,<span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb64-629"><a href="#cb64-629" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb64-630"><a href="#cb64-630" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-631"><a href="#cb64-631" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-632"><a href="#cb64-632" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Outfit</span></span>
<span id="cb64-633"><a href="#cb64-633" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-636"><a href="#cb64-636" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-637"><a href="#cb64-637" aria-hidden="true" tabindex="-1"></a>results <span class="sc">%&gt;%</span> </span>
<span id="cb64-638"><a href="#cb64-638" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(ir_padj <span class="sc">==</span> <span class="st">"sign. misfit"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb64-639"><a href="#cb64-639" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Median =</span> <span class="fu">median</span>(Outfit),</span>
<span id="cb64-640"><a href="#cb64-640" aria-hidden="true" tabindex="-1"></a>            <span class="at">MAD =</span> <span class="fu">mad</span>(Outfit),</span>
<span id="cb64-641"><a href="#cb64-641" aria-hidden="true" tabindex="-1"></a>            <span class="at">Mean =</span> <span class="fu">mean</span>(Outfit),</span>
<span id="cb64-642"><a href="#cb64-642" aria-hidden="true" tabindex="-1"></a>            <span class="at">SD =</span> <span class="fu">sd</span>(Outfit),</span>
<span id="cb64-643"><a href="#cb64-643" aria-hidden="true" tabindex="-1"></a>            <span class="at">Max =</span> <span class="fu">max</span>(Outfit),</span>
<span id="cb64-644"><a href="#cb64-644" aria-hidden="true" tabindex="-1"></a>            <span class="at">Min =</span> <span class="fu">min</span>(Outfit)) <span class="sc">%&gt;%</span> </span>
<span id="cb64-645"><a href="#cb64-645" aria-hidden="true" tabindex="-1"></a>  <span class="fu">round</span>(<span class="dv">3</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb64-646"><a href="#cb64-646" aria-hidden="true" tabindex="-1"></a>  knitr<span class="sc">::</span><span class="fu">kable</span>()</span>
<span id="cb64-647"><a href="#cb64-647" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-648"><a href="#cb64-648" aria-hidden="true" tabindex="-1"></a>results <span class="sc">%&gt;%</span> </span>
<span id="cb64-649"><a href="#cb64-649" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(ir_padj <span class="sc">==</span> <span class="st">"sign. misfit"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb64-650"><a href="#cb64-650" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb64-651"><a href="#cb64-651" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_dotsinterval</span>(<span class="fu">aes</span>(<span class="at">x =</span> Outfit)) <span class="sc">+</span></span>
<span id="cb64-652"><a href="#cb64-652" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="st">'Distribution conditional outfit MSQ'</span>, <span class="at">limits =</span> <span class="fu">c</span>(<span class="fl">0.5</span>,<span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb64-653"><a href="#cb64-653" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb64-654"><a href="#cb64-654" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-655"><a href="#cb64-655" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-656"><a href="#cb64-656" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-657"><a href="#cb64-657" aria-hidden="true" tabindex="-1"></a><span class="fu">## Item-restscore sample size variation</span></span>
<span id="cb64-658"><a href="#cb64-658" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-659"><a href="#cb64-659" aria-hidden="true" tabindex="-1"></a>Let us look only at item-restscore and see how sample size affects the percentage of significant deviations indicated for item 3. We'll do 50-250 in steps of 25.</span>
<span id="cb64-660"><a href="#cb64-660" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-663"><a href="#cb64-663" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-664"><a href="#cb64-664" aria-hidden="true" tabindex="-1"></a>testfit3 <span class="ot">&lt;-</span> <span class="cf">function</span>(dat, iterations, samplesize, <span class="at">cpu =</span> <span class="dv">8</span>) {</span>
<span id="cb64-665"><a href="#cb64-665" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb64-666"><a href="#cb64-666" aria-hidden="true" tabindex="-1"></a>  <span class="fu">require</span>(doParallel)</span>
<span id="cb64-667"><a href="#cb64-667" aria-hidden="true" tabindex="-1"></a>  <span class="fu">registerDoParallel</span>(<span class="at">cores =</span> cpu)</span>
<span id="cb64-668"><a href="#cb64-668" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb64-669"><a href="#cb64-669" aria-hidden="true" tabindex="-1"></a>  fit <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb64-670"><a href="#cb64-670" aria-hidden="true" tabindex="-1"></a>  fit <span class="ot">&lt;-</span> <span class="fu">foreach</span>(<span class="at">i =</span> <span class="dv">1</span><span class="sc">:</span>iterations, <span class="at">.combine =</span> rbind) <span class="sc">%dopar%</span> {</span>
<span id="cb64-671"><a href="#cb64-671" aria-hidden="true" tabindex="-1"></a>    data <span class="ot">&lt;-</span> dat[<span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(dat), samplesize), ]</span>
<span id="cb64-672"><a href="#cb64-672" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb64-673"><a href="#cb64-673" aria-hidden="true" tabindex="-1"></a>    i1 <span class="ot">&lt;-</span> <span class="fu">item_restscore</span>(<span class="fu">PCM</span>(data))</span>
<span id="cb64-674"><a href="#cb64-674" aria-hidden="true" tabindex="-1"></a>    i1 <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(i1)</span>
<span id="cb64-675"><a href="#cb64-675" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb64-676"><a href="#cb64-676" aria-hidden="true" tabindex="-1"></a>    <span class="fu">data.frame</span>(<span class="st">"observed"</span> <span class="ot">=</span> <span class="fu">as.numeric</span>(i1[[<span class="dv">1</span>]][<span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(data),<span class="dv">1</span>]),</span>
<span id="cb64-677"><a href="#cb64-677" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"expected"</span> <span class="ot">=</span> <span class="fu">as.numeric</span>(i1[[<span class="dv">1</span>]][<span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(data),<span class="dv">2</span>]),</span>
<span id="cb64-678"><a href="#cb64-678" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"se"</span> <span class="ot">=</span> <span class="fu">as.numeric</span>(i1[[<span class="dv">1</span>]][<span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(data),<span class="dv">3</span>]),</span>
<span id="cb64-679"><a href="#cb64-679" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"p.value"</span> <span class="ot">=</span> <span class="fu">as.numeric</span>(i1[[<span class="dv">1</span>]][<span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(data),<span class="dv">4</span>]),</span>
<span id="cb64-680"><a href="#cb64-680" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"p.adj.BH"</span> <span class="ot">=</span> <span class="fu">as.numeric</span>(i1[[<span class="dv">1</span>]][<span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(data),<span class="dv">5</span>])</span>
<span id="cb64-681"><a href="#cb64-681" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span> </span>
<span id="cb64-682"><a href="#cb64-682" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="at">diff_abs =</span> <span class="fu">abs</span>(expected <span class="sc">-</span> observed),</span>
<span id="cb64-683"><a href="#cb64-683" aria-hidden="true" tabindex="-1"></a>             <span class="at">diff =</span> expected <span class="sc">-</span> observed,</span>
<span id="cb64-684"><a href="#cb64-684" aria-hidden="true" tabindex="-1"></a>             <span class="at">ir_padj =</span> <span class="fu">ifelse</span>(p.adj.BH <span class="sc">&lt;</span> .<span class="dv">05</span>, <span class="st">"sign. misfit"</span>,<span class="st">"no misfit"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb64-685"><a href="#cb64-685" aria-hidden="true" tabindex="-1"></a>      <span class="fu">select</span>(ir_padj, diff, diff_abs) <span class="sc">%&gt;%</span> </span>
<span id="cb64-686"><a href="#cb64-686" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="at">item =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(data)) <span class="sc">%&gt;%</span> </span>
<span id="cb64-687"><a href="#cb64-687" aria-hidden="true" tabindex="-1"></a>      <span class="fu">add_column</span>(<span class="at">iteration =</span> i,</span>
<span id="cb64-688"><a href="#cb64-688" aria-hidden="true" tabindex="-1"></a>                 <span class="at">samplesize =</span> samplesize)</span>
<span id="cb64-689"><a href="#cb64-689" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb64-690"><a href="#cb64-690" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(fit)</span>
<span id="cb64-691"><a href="#cb64-691" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb64-692"><a href="#cb64-692" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-693"><a href="#cb64-693" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-694"><a href="#cb64-694" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-697"><a href="#cb64-697" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-698"><a href="#cb64-698" aria-hidden="true" tabindex="-1"></a><span class="co">#irscoreonly &lt;- list()</span></span>
<span id="cb64-699"><a href="#cb64-699" aria-hidden="true" tabindex="-1"></a><span class="co">#irscoreonly &lt;- map(samplesizes, ~ testfit3(pcmdat2, iterations = 1000, samplesize = .x))</span></span>
<span id="cb64-700"><a href="#cb64-700" aria-hidden="true" tabindex="-1"></a><span class="co">#saveRDS(irscoreonly,"item_restscore1000.Rdata")</span></span>
<span id="cb64-701"><a href="#cb64-701" aria-hidden="true" tabindex="-1"></a>irscoreonly <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"item_restscore1000.Rdata"</span>)</span>
<span id="cb64-702"><a href="#cb64-702" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-703"><a href="#cb64-703" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-706"><a href="#cb64-706" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-707"><a href="#cb64-707" aria-hidden="true" tabindex="-1"></a>results_ir <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(irscoreonly) <span class="sc">%&gt;%</span> </span>
<span id="cb64-708"><a href="#cb64-708" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(item <span class="sc">==</span> <span class="dv">3</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb64-709"><a href="#cb64-709" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(ir_padj <span class="sc">==</span> <span class="st">"sign. misfit"</span>)</span>
<span id="cb64-710"><a href="#cb64-710" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-711"><a href="#cb64-711" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-712"><a href="#cb64-712" aria-hidden="true" tabindex="-1"></a><span class="fu">### Results </span></span>
<span id="cb64-715"><a href="#cb64-715" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-716"><a href="#cb64-716" aria-hidden="true" tabindex="-1"></a>results_ir <span class="sc">%&gt;%</span> </span>
<span id="cb64-717"><a href="#cb64-717" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(samplesize) <span class="sc">%&gt;%</span> </span>
<span id="cb64-718"><a href="#cb64-718" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">n =</span> <span class="fu">n</span>(),</span>
<span id="cb64-719"><a href="#cb64-719" aria-hidden="true" tabindex="-1"></a>            <span class="at">Percent =</span> n<span class="sc">*</span><span class="dv">100</span><span class="sc">/</span><span class="dv">1000</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb64-720"><a href="#cb64-720" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> samplesize, <span class="at">y =</span> Percent)) <span class="sc">+</span></span>
<span id="cb64-721"><a href="#cb64-721" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb64-722"><a href="#cb64-722" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb64-723"><a href="#cb64-723" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">100</span>)) <span class="sc">+</span></span>
<span id="cb64-724"><a href="#cb64-724" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">100</span>,<span class="dv">20</span>)) <span class="sc">+</span></span>
<span id="cb64-725"><a href="#cb64-725" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb64-726"><a href="#cb64-726" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Percentage of datasets with indicated misfit for item 3"</span>,</span>
<span id="cb64-727"><a href="#cb64-727" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Sample size"</span>,</span>
<span id="cb64-728"><a href="#cb64-728" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">"Note: 1000 non-parametric bootstrap samples for each sample size"</span>,</span>
<span id="cb64-729"><a href="#cb64-729" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Item-restscore"</span>,</span>
<span id="cb64-730"><a href="#cb64-730" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Sample size affects identification of misfitting item?"</span>)</span>
<span id="cb64-731"><a href="#cb64-731" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-732"><a href="#cb64-732" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-735"><a href="#cb64-735" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-736"><a href="#cb64-736" aria-hidden="true" tabindex="-1"></a>p01 <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">quantile</span>(results_ir<span class="sc">$</span>diff_abs, .<span class="dv">01</span>),<span class="dv">3</span>)</span>
<span id="cb64-737"><a href="#cb64-737" aria-hidden="true" tabindex="-1"></a>p05 <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">quantile</span>(results_ir<span class="sc">$</span>diff_abs, .<span class="dv">05</span>),<span class="dv">3</span>)</span>
<span id="cb64-738"><a href="#cb64-738" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-739"><a href="#cb64-739" aria-hidden="true" tabindex="-1"></a>results_ir <span class="sc">%&gt;%</span> </span>
<span id="cb64-740"><a href="#cb64-740" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb64-741"><a href="#cb64-741" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_dotsinterval</span>(<span class="fu">aes</span>(<span class="at">x =</span> diff_abs)) <span class="sc">+</span></span>
<span id="cb64-742"><a href="#cb64-742" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="st">'Distribution of absolute differences'</span>, <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.4</span>), <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="fl">0.4</span>,<span class="fl">0.05</span>)) <span class="sc">+</span></span>
<span id="cb64-743"><a href="#cb64-743" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_rise</span>() <span class="sc">+</span></span>
<span id="cb64-744"><a href="#cb64-744" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Observed vs expected item-restscore values"</span>,</span>
<span id="cb64-745"><a href="#cb64-745" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Only statistically significant values included in plot"</span>,</span>
<span id="cb64-746"><a href="#cb64-746" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">""</span>,</span>
<span id="cb64-747"><a href="#cb64-747" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="fu">paste0</span>(<span class="st">"Note: 1st percentile of the absolute difference between observed and expected item-restscore is "</span>,p01,<span class="st">". 5th percentile is "</span>,p05,<span class="st">"."</span>))</span>
<span id="cb64-748"><a href="#cb64-748" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-749"><a href="#cb64-749" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-750"><a href="#cb64-750" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-751"><a href="#cb64-751" aria-hidden="true" tabindex="-1"></a>Now, let's dig up a simulation function that allows us to specify a misfitting item.</span>
<span id="cb64-752"><a href="#cb64-752" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-755"><a href="#cb64-755" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-756"><a href="#cb64-756" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-757"><a href="#cb64-757" aria-hidden="true" tabindex="-1"></a></span>
</code><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->



</body></html>