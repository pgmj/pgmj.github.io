<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="author" content="Magnus Johansson">
<meta name="dcterms.date" content="2024-10-23">
<title>Rasch DIF magnitude, item split, and theta difference – R, Rasch, etc</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><script src="site_libs/kePrint-0.0.1/kePrint.js"></script><link href="site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<link rel="stylesheet" href="styles.css">
<meta property="og:title" content="Rasch DIF magnitude, item split, and theta difference – R, Rasch, etc">
<meta property="og:description" content="Brief exploration of Differential Item Functioning in R">
<meta property="og:image" content="https://pgmj.github.io/data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg==">
<meta property="og:site_name" content="R, Rasch, etc">
<meta name="twitter:title" content="Rasch DIF magnitude, item split, and theta difference – R, Rasch, etc">
<meta name="twitter:description" content="Brief exploration of Differential Item Functioning in R">
<meta name="twitter:image" content="https://pgmj.github.io/data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg==">
<meta name="twitter:card" content="summary_large_image">
</head>
<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="navbar navbar-expand-lg " data-bs-theme="dark"><div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">R, Rasch, etc</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
<li class="nav-item">
    <a class="nav-link" href="./index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./raschrvignette/RaschRvign.html"> 
<span class="menu-text">RISEkbmRasch vignette</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./about.html"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-blog" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Blog</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-blog">
<li>
    <a class="dropdown-item" href="./parameterizedQ.html">
 <span class="dropdown-text">Automating reports with Quarto</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./latentResp/LatentResponse.html">
 <span class="dropdown-text">What’s in a latent trait score?</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./SkolverketAPI/skolverketapi.html">
 <span class="dropdown-text">Data retrieval with R using API calls</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./powerviz.html">
 <span class="dropdown-text">Power analysis for multilevel models</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./datawrangling.html">
 <span class="dropdown-text">Data wrangling for psychometrics in R</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./simcutoffs.html">
 <span class="dropdown-text">Simulation based cutoff values for Rasch item fit and residual correlations</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./est_comp.html">
 <span class="dropdown-text">Comparing Rasch packages/estimators</span></a>
  </li>  
    </ul>
</li>
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/pgmj/pgmj.github.io"> <i class="bi bi-github" role="img" aria-label="GitHub">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
</div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav><div id="quarto-announcement" data-announcement-id="f2201fbbefb1e9b8685bd91e4d0da5c8" class="alert alert-primary hidden">
<i class="bi bi-info-circle quarto-announcement-icon"></i><div class="quarto-announcement-content">
<p><strong>Note:</strong> The RISEkbmRasch vignette has new material on conditional item fit and simulation based cutoff values.</p>
</div>
<i class="bi bi-x-lg quarto-announcement-action"></i>
</div>
</header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Table of contents</h2>
   
  <ul>
<li>
<a href="#background" id="toc-background" class="nav-link active" data-scroll-target="#background"><span class="header-section-number">1</span> Background</a>
  <ul class="collapse">
<li><a href="#simulate-response-data" id="toc-simulate-response-data" class="nav-link" data-scroll-target="#simulate-response-data"><span class="header-section-number">1.1</span> Simulate response data</a></li>
  </ul>
</li>
  <li>
<a href="#dif-assessment" id="toc-dif-assessment" class="nav-link" data-scroll-target="#dif-assessment"><span class="header-section-number">2</span> DIF assessment</a>
  <ul class="collapse">
<li><a href="#lr-test" id="toc-lr-test" class="nav-link" data-scroll-target="#lr-test"><span class="header-section-number">2.1</span> LR-test</a></li>
  <li><a href="#partial-gamma" id="toc-partial-gamma" class="nav-link" data-scroll-target="#partial-gamma"><span class="header-section-number">2.2</span> Partial gamma</a></li>
  <li><a href="#psychotree" id="toc-psychotree" class="nav-link" data-scroll-target="#psychotree"><span class="header-section-number">2.3</span> Psychotree</a></li>
  <li><a href="#item-split" id="toc-item-split" class="nav-link" data-scroll-target="#item-split"><span class="header-section-number">2.4</span> Item split</a></li>
  <li><a href="#estimating-thetas" id="toc-estimating-thetas" class="nav-link" data-scroll-target="#estimating-thetas"><span class="header-section-number">2.5</span> Estimating thetas</a></li>
  <li><a href="#comparing-item-parameters" id="toc-comparing-item-parameters" class="nav-link" data-scroll-target="#comparing-item-parameters"><span class="header-section-number">2.6</span> Comparing item parameters</a></li>
  </ul>
</li>
  <li>
<a href="#results" id="toc-results" class="nav-link" data-scroll-target="#results"><span class="header-section-number">3</span> Results</a>
  <ul class="collapse">
<li><a href="#summarised" id="toc-summarised" class="nav-link" data-scroll-target="#summarised"><span class="header-section-number">3.1</span> Summarised</a></li>
  <li><a href="#across-the-latent-continuum" id="toc-across-the-latent-continuum" class="nav-link" data-scroll-target="#across-the-latent-continuum"><span class="header-section-number">3.2</span> Across the latent continuum</a></li>
  </ul>
</li>
  </ul></nav>
    </div>
<!-- main -->
<main class="content column-page-left" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Rasch DIF magnitude, item split, and theta difference</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
<p class="subtitle lead">Brief exploration of Differential Item Functioning in R</p>
</div>


<div class="quarto-title-meta-author column-page-left">
  <div class="quarto-title-meta-heading">Author</div>
  <div class="quarto-title-meta-heading">Affiliation</div>
  
    <div class="quarto-title-meta-contents">
    <p class="author">Magnus Johansson <a href="https://orcid.org/0000-0003-1669-592X" class="quarto-title-author-orcid"> <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg=="></a></p>
  </div>
  <div class="quarto-title-meta-contents">
        <p class="affiliation">
            <a href="https://www.ri.se/en/shic">
            RISE Research Institutes of Sweden
            </a>
          </p>
      </div>
  </div>

<div class="quarto-title-meta column-page-left">

      
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">October 23, 2024</p>
    </div>
  </div>
  
    
  </div>
  


</header><section id="background" class="level2" data-number="1"><h2 data-number="1" class="anchored" data-anchor-id="background">
<span class="header-section-number">1</span> Background</h2>
<p>Out of interest of better understanding som aspects of differential item functioning (DIF, a form of invariance test):</p>
<ul>
<li>how much does DIF affect estimated thetas (factor scores)?</li>
<li>how to do item-split in R (creating separate items for subgroups from one item with problematic DIF)</li>
<li>how an item-split compares to removing the item (and keeping the DIF item) in terms of absolute differences in estimated thetas</li>
</ul>
<p>We’ll use simulated data in order to have knowledge of the thetas used to generate response data (“input thetas” in the text below), and make objective comparisons using the different estimated thetas.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">eRm</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">iarm</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/pgmj/RISEkbmRasch">RISEkbmRasch</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/dcomtois/summarytools">summarytools</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ewenme.github.io/ghibli/">ghibli</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co">### some commands exist in multiple packages, here we define preferred ones that are frequently used</span></span>
<span><span class="va">select</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="va"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span></span>
<span><span class="va">count</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="va"><a href="https://dplyr.tidyverse.org/reference/count.html">count</a></span></span>
<span><span class="va">recode</span> <span class="op">&lt;-</span> <span class="fu">car</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/car/man/recode.html">recode</a></span></span>
<span><span class="va">rename</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="va"><a href="https://dplyr.tidyverse.org/reference/rename.html">rename</a></span></span>
<span></span>
<span><span class="va">theme_rise</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">fontfamily</span> <span class="op">=</span> <span class="st">"Lato"</span>, <span class="va">axissize</span> <span class="op">=</span> <span class="fl">13</span>, <span class="va">titlesize</span> <span class="op">=</span> <span class="fl">15</span>,</span>
<span>                       <span class="va">margins</span> <span class="op">=</span> <span class="fl">12</span>, <span class="va">axisface</span> <span class="op">=</span> <span class="st">"plain"</span>, <span class="va">panelDist</span> <span class="op">=</span> <span class="fl">0.6</span>, <span class="va">...</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span></span>
<span>    text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>family <span class="op">=</span> <span class="va">fontfamily</span><span class="op">)</span>,</span>
<span>    axis.title.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span></span>
<span>      margin <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">margin</a></span><span class="op">(</span>t <span class="op">=</span> <span class="va">margins</span><span class="op">)</span>,</span>
<span>      size <span class="op">=</span> <span class="va">axissize</span></span>
<span>    <span class="op">)</span>,</span>
<span>    axis.title.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span></span>
<span>      margin <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">margin</a></span><span class="op">(</span>r <span class="op">=</span> <span class="va">margins</span><span class="op">)</span>,</span>
<span>      size <span class="op">=</span> <span class="va">axissize</span></span>
<span>    <span class="op">)</span>,</span>
<span>    plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span></span>
<span>      face <span class="op">=</span> <span class="st">"bold"</span>,</span>
<span>      size <span class="op">=</span> <span class="va">titlesize</span></span>
<span>    <span class="op">)</span>,</span>
<span>    axis.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span></span>
<span>      face <span class="op">=</span> <span class="va">axisface</span></span>
<span>    <span class="op">)</span>,</span>
<span>    plot.caption <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span></span>
<span>      face <span class="op">=</span> <span class="st">"italic"</span></span>
<span>    <span class="op">)</span>,</span>
<span>    legend.text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>family <span class="op">=</span> <span class="va">fontfamily</span><span class="op">)</span>,</span>
<span>    legend.background <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_rect</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"lightgrey"</span><span class="op">)</span>,</span>
<span>    strip.background <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_rect</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"lightgrey"</span><span class="op">)</span>,</span>
<span>    panel.spacing <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html">unit</a></span><span class="op">(</span><span class="va">panelDist</span>, <span class="st">"cm"</span>, data <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span>,</span>
<span>    panel.border <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_rect</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"grey"</span>, fill <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span>,</span>
<span>    <span class="va">...</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme_get.html">theme_set</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/RISEkbmRasch/man/theme_rise.html">theme_rise</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="simulate-response-data" class="level3" data-number="1.1"><h3 data-number="1.1" class="anchored" data-anchor-id="simulate-response-data">
<span class="header-section-number">1.1</span> Simulate response data</h3>
<p>First define input parameters for items.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># item list for simulation for group 1</span></span>
<span><span class="va">tlist1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>  q1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fl">1.2</span>, <span class="fl">1.8</span>, <span class="fl">2.4</span><span class="op">)</span>,</span>
<span>  q2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1.3</span>, <span class="op">-</span><span class="fl">0.5</span>, <span class="fl">0.5</span><span class="op">)</span>,</span>
<span>  q3 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.3</span>, <span class="fl">0.3</span>, <span class="fl">1.2</span><span class="op">)</span>,</span>
<span>  q4 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">0.6</span>, <span class="fl">1.6</span><span class="op">)</span>,</span>
<span>  q5 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.3</span>, <span class="fl">0.7</span>, <span class="fl">1.5</span><span class="op">)</span>,</span>
<span>  q6 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1.6</span>, <span class="op">-</span><span class="fl">1</span>, <span class="op">-</span><span class="fl">0.3</span><span class="op">)</span>,</span>
<span>  q7 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1.8</span>, <span class="fl">2.5</span><span class="op">)</span>,</span>
<span>  q8 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1.3</span>, <span class="op">-</span><span class="fl">0.7</span>, <span class="fl">0.4</span><span class="op">)</span>,</span>
<span>  q9 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.8</span>, <span class="fl">1.4</span>, <span class="fl">1.9</span><span class="op">)</span>,</span>
<span>  q10 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fl">0.25</span>, <span class="fl">1.25</span>, <span class="fl">2.15</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># make a tibble/dataframe also, for possible later use</span></span>
<span><span class="va">inputParams1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span></span>
<span>  q1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1.2</span>, <span class="fl">1.8</span>, <span class="fl">2.4</span><span class="op">)</span>,</span>
<span>  q2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1.3</span>, <span class="op">-</span><span class="fl">0.5</span>, <span class="fl">0.5</span><span class="op">)</span>,</span>
<span>  q4 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">0.6</span>, <span class="fl">1.6</span><span class="op">)</span>,</span>
<span>  q5 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.3</span>, <span class="fl">0.7</span>, <span class="fl">1.5</span><span class="op">)</span>,</span>
<span>  q6 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1.6</span>, <span class="op">-</span><span class="fl">1</span>, <span class="op">-</span><span class="fl">0.3</span><span class="op">)</span>,</span>
<span>  q7 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1.8</span>, <span class="fl">2.5</span><span class="op">)</span>,</span>
<span>  q8 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1.3</span>, <span class="op">-</span><span class="fl">0.7</span>, <span class="fl">0.4</span><span class="op">)</span>,</span>
<span>  q9 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.8</span>, <span class="fl">1.4</span>, <span class="fl">1.9</span><span class="op">)</span>,</span>
<span>  q10 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.25</span>, <span class="fl">1.25</span>, <span class="fl">2.15</span><span class="op">)</span>,</span>
<span>  q3a <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.3</span>, <span class="fl">0.3</span>, <span class="fl">1.2</span><span class="op">)</span>,</span>
<span>  q3b <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.3</span><span class="op">+</span><span class="fl">1</span>, <span class="fl">0.3</span><span class="op">+</span><span class="fl">1</span>, <span class="fl">1.2</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># center to 0</span></span>
<span><span class="va">inputParams1c</span> <span class="op">&lt;-</span> <span class="va">inputParams1</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">inputParams1</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># item list for simulation for group 2</span></span>
<span><span class="va">tlist2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>  q1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fl">1.2</span>, <span class="fl">1.8</span>, <span class="fl">2.4</span><span class="op">)</span>,</span>
<span>  q2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1.3</span>, <span class="op">-</span><span class="fl">0.5</span>, <span class="fl">0.5</span><span class="op">)</span>,</span>
<span>  q3 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.3</span><span class="op">+</span><span class="fl">1</span>, <span class="fl">0.3</span><span class="op">+</span><span class="fl">1</span>, <span class="fl">1.2</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span>,</span>
<span>  q4 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">0.6</span>, <span class="fl">1.6</span><span class="op">)</span>,</span>
<span>  q5 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.3</span>, <span class="fl">0.7</span>, <span class="fl">1.5</span><span class="op">)</span>,</span>
<span>  q6 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1.6</span>, <span class="op">-</span><span class="fl">1</span>, <span class="op">-</span><span class="fl">0.3</span><span class="op">)</span>,</span>
<span>  q7 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1.8</span>, <span class="fl">2.5</span><span class="op">)</span>,</span>
<span>  q8 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1.3</span>, <span class="op">-</span><span class="fl">0.7</span>, <span class="fl">0.4</span><span class="op">)</span>,</span>
<span>  q9 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.8</span>, <span class="fl">1.4</span>, <span class="fl">1.9</span><span class="op">)</span>,</span>
<span>  q10 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fl">0.25</span>, <span class="fl">1.25</span>, <span class="fl">2.15</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Then generate random thetas that we save to file to be able to reproduce the analysis.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># simulate thetas</span></span>
<span><span class="va">thetas1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">300</span>, mean <span class="op">=</span> <span class="fl">0</span>, sd <span class="op">=</span> <span class="fl">1.5</span><span class="op">)</span></span>
<span><span class="va">thetas2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">300</span>, mean <span class="op">=</span> <span class="fl">0</span>, sd <span class="op">=</span> <span class="fl">1.5</span><span class="op">)</span></span>
<span></span>
<span><span class="va">input_thetas</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">thetas1</span>,<span class="va">thetas2</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># simulate response data based on the above defined item thresholds</span></span>
<span><span class="va">td1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/RISEkbmRasch/man/SimPartialScore.html">SimPartialScore</a></span><span class="op">(</span></span>
<span>  deltaslist <span class="op">=</span> <span class="va">tlist1</span>,</span>
<span>  thetavec <span class="op">=</span> <span class="va">thetas1</span></span>
<span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">td2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/RISEkbmRasch/man/SimPartialScore.html">SimPartialScore</a></span><span class="op">(</span></span>
<span>  deltaslist <span class="op">=</span> <span class="va">tlist2</span>,</span>
<span>  thetavec <span class="op">=</span> <span class="va">thetas2</span></span>
<span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="va">td1</span>,<span class="va">td2</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://tibble.tidyverse.org/reference/add_column.html">add_column</a></span><span class="op">(</span>group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, each <span class="op">=</span> <span class="fl">300</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">dif.group</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">d</span><span class="op">$</span><span class="va">group</span><span class="op">)</span></span>
<span><span class="va">d</span><span class="op">$</span><span class="va">group</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span></span>
<span><span class="va">all_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>simResponses <span class="op">=</span> <span class="va">d</span>,</span>
<span>                 dif_group <span class="op">=</span> <span class="va">dif.group</span>,</span>
<span>                 input_thetas <span class="op">=</span> <span class="va">input_thetas</span><span class="op">)</span></span>
<span><span class="co"># save simulated data for reproducibility</span></span>
<span><span class="co">#saveRDS(all_data,"dif_magnitude_1_0.Rdata")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">all_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span><span class="op">(</span><span class="st">"dif_magnitude_1_0.Rdata"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">d</span> <span class="op">&lt;-</span> <span class="va">all_data</span><span class="op">$</span><span class="va">simResponses</span></span>
<span><span class="va">dif.group</span> <span class="op">&lt;-</span> <span class="va">all_data</span><span class="op">$</span><span class="va">dif_group</span></span>
<span><span class="va">input_thetas</span> <span class="op">&lt;-</span> <span class="va">all_data</span><span class="op">$</span><span class="va">input_thetas</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>We now have 10 items with 4 categories each, 600 respondents with half of respondents having differential item functioning for one item (item q3), with 1 logit uniform difference in location (all thresholds for item q3 are + 1 logits).</p>
</section></section><section id="dif-assessment" class="level2" data-number="2"><h2 data-number="2" class="anchored" data-anchor-id="dif-assessment">
<span class="header-section-number">2</span> DIF assessment</h2>
<p>Let’s test for DIF with some different methods.</p>
<section id="lr-test" class="level3" data-number="2.1"><h3 data-number="2.1" class="anchored" data-anchor-id="lr-test">
<span class="header-section-number">2.1</span> LR-test</h3>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/RISEkbmRasch/man/RIdifTableLR.html">RIdifTableLR</a></span><span class="op">(</span><span class="va">d</span>, <span class="va">dif.group</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table data-quarto-disable-processing="true" style="width:65%; font-size: 14px;  font-family: Arial; margin-left: auto; margin-right: auto;border-bottom: 0;" class="table table-striped table-hover lightable-classic">
<thead>
<tr>
<th style="empty-cells: hide;" colspan="1"></th>
<th style="padding-bottom:0; padding-left:5px;padding-right:5px;text-align: center; font-weight: bold; " colspan="4"><div style="border-bottom: 1px solid #111111; margin-bottom: -1px; ">Item locations</div></th>
<th style="padding-bottom:0; padding-left:5px;padding-right:5px;text-align: center; font-weight: bold; " colspan="3"><div style="border-bottom: 1px solid #111111; margin-bottom: -1px; ">Standard errors</div></th>
</tr>
<tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> Item </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> 1 </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> 2 </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> MaxDiff </th>
   <th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> All </th>
   <th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> SE_1 </th>
   <th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> SE_2 </th>
   <th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> SE_All </th>
  </tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;"> q1 </td>
   <td style="text-align:left;"> <span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: lightblue !important;">1.445</span> </td>
   <td style="text-align:left;"> <span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: burlywood !important;">1.418</span> </td>
   <td style="text-align:left;font-weight: bold;"> <span style="     color: black !important;">0.027</span> </td>
   <td style="text-align:right;font-style: italic;"> 1.394 </td>
   <td style="text-align:right;"> 0.255 </td>
   <td style="text-align:right;"> 0.256 </td>
   <td style="text-align:right;font-style: italic;"> 0.178 </td>
  </tr>
<tr>
<td style="text-align:left;"> q2 </td>
   <td style="text-align:left;"> <span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: lightblue !important;">-0.542</span> </td>
   <td style="text-align:left;"> <span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: burlywood !important;">-0.677</span> </td>
   <td style="text-align:left;font-weight: bold;"> <span style="     color: black !important;">0.135</span> </td>
   <td style="text-align:right;font-style: italic;"> -0.599 </td>
   <td style="text-align:right;"> 0.192 </td>
   <td style="text-align:right;"> 0.186 </td>
   <td style="text-align:right;font-style: italic;"> 0.133 </td>
  </tr>
<tr>
<td style="text-align:left;"> q3 </td>
   <td style="text-align:left;"> <span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: burlywood !important;">0.081</span> </td>
   <td style="text-align:left;"> <span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: lightblue !important;">1.073</span> </td>
   <td style="text-align:left;font-weight: bold;"> <span style="     color: red !important;">0.992</span> </td>
   <td style="text-align:right;font-style: italic;"> 0.551 </td>
   <td style="text-align:right;"> 0.186 </td>
   <td style="text-align:right;"> 0.221 </td>
   <td style="text-align:right;font-style: italic;"> 0.138 </td>
  </tr>
<tr>
<td style="text-align:left;"> q4 </td>
   <td style="text-align:left;"> <span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: lightblue !important;">0.557</span> </td>
   <td style="text-align:left;"> <span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: burlywood !important;">0.468</span> </td>
   <td style="text-align:left;font-weight: bold;"> <span style="     color: black !important;">0.089</span> </td>
   <td style="text-align:right;font-style: italic;"> 0.499 </td>
   <td style="text-align:right;"> 0.201 </td>
   <td style="text-align:right;"> 0.193 </td>
   <td style="text-align:right;font-style: italic;"> 0.138 </td>
  </tr>
<tr>
<td style="text-align:left;"> q5 </td>
   <td style="text-align:left;"> <span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: lightblue !important;">0.419</span> </td>
   <td style="text-align:left;"> <span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: burlywood !important;">0.275</span> </td>
   <td style="text-align:left;font-weight: bold;"> <span style="     color: black !important;">0.144</span> </td>
   <td style="text-align:right;font-style: italic;"> 0.338 </td>
   <td style="text-align:right;"> 0.191 </td>
   <td style="text-align:right;"> 0.187 </td>
   <td style="text-align:right;font-style: italic;"> 0.133 </td>
  </tr>
<tr>
<td style="text-align:left;"> q6 </td>
   <td style="text-align:left;"> <span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: lightblue !important;">-1.27</span> </td>
   <td style="text-align:left;"> <span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: burlywood !important;">-1.348</span> </td>
   <td style="text-align:left;font-weight: bold;"> <span style="     color: black !important;">0.078</span> </td>
   <td style="text-align:right;font-style: italic;"> -1.288 </td>
   <td style="text-align:right;"> 0.206 </td>
   <td style="text-align:right;"> 0.206 </td>
   <td style="text-align:right;font-style: italic;"> 0.145 </td>
  </tr>
<tr>
<td style="text-align:left;"> q7 </td>
   <td style="text-align:left;"> <span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: lightblue !important;">1.524</span> </td>
   <td style="text-align:left;"> <span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: burlywood !important;">1.39</span> </td>
   <td style="text-align:left;font-weight: bold;"> <span style="     color: black !important;">0.134</span> </td>
   <td style="text-align:right;font-style: italic;"> 1.421 </td>
   <td style="text-align:right;"> 0.253 </td>
   <td style="text-align:right;"> 0.248 </td>
   <td style="text-align:right;font-style: italic;"> 0.175 </td>
  </tr>
<tr>
<td style="text-align:left;"> q8 </td>
   <td style="text-align:left;"> <span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: lightblue !important;">-0.9</span> </td>
   <td style="text-align:left;"> <span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: burlywood !important;">-1.034</span> </td>
   <td style="text-align:left;font-weight: bold;"> <span style="     color: black !important;">0.134</span> </td>
   <td style="text-align:right;font-style: italic;"> -0.952 </td>
   <td style="text-align:right;"> 0.193 </td>
   <td style="text-align:right;"> 0.194 </td>
   <td style="text-align:right;font-style: italic;"> 0.136 </td>
  </tr>
<tr>
<td style="text-align:left;"> q9 </td>
   <td style="text-align:left;"> <span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: lightblue !important;">0.616</span> </td>
   <td style="text-align:left;"> <span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: burlywood !important;">0.392</span> </td>
   <td style="text-align:left;font-weight: bold;"> <span style="     color: black !important;">0.224</span> </td>
   <td style="text-align:right;font-style: italic;"> 0.486 </td>
   <td style="text-align:right;"> 0.202 </td>
   <td style="text-align:right;"> 0.194 </td>
   <td style="text-align:right;font-style: italic;"> 0.139 </td>
  </tr>
<tr>
<td style="text-align:left;"> q10 </td>
   <td style="text-align:left;"> <span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: lightblue !important;">1.054</span> </td>
   <td style="text-align:left;"> <span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: burlywood !important;">0.968</span> </td>
   <td style="text-align:left;font-weight: bold;"> <span style="     color: black !important;">0.086</span> </td>
   <td style="text-align:right;font-style: italic;"> 0.994 </td>
   <td style="text-align:right;"> 0.214 </td>
   <td style="text-align:right;"> 0.212 </td>
   <td style="text-align:right;font-style: italic;"> 0.150 </td>
  </tr>
</tbody>
<tfoot>
<tr><td style="padding: 0; " colspan="100%"><span style="font-style: italic;">Note: </span></td></tr>
<tr><td style="padding: 0; " colspan="100%">
<sup></sup> Values highlighted in red are above the chosen cutoff 0.5 logits. Background color brown and blue indicate the lowest and highest values among the DIF groups.</td></tr>
</tfoot>
</table>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/RISEkbmRasch/man/RIdifThreshFigLR.html">RIdifThreshFigLR</a></span><span class="op">(</span><span class="va">d</span>, <span class="va">dif.group</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="dif_magnitude_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="1050"></p>
</figure>
</div>
</div>
</div>
</section><section id="partial-gamma" class="level3" data-number="2.2"><h3 data-number="2.2" class="anchored" data-anchor-id="partial-gamma">
<span class="header-section-number">2.2</span> Partial gamma</h3>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/RISEkbmRasch/man/RIpartgamDIF.html">RIpartgamDIF</a></span><span class="op">(</span><span class="va">d</span>, <span class="va">dif.group</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table data-quarto-disable-processing="true" style="width:65%; font-size: 14px;  font-family: Arial; margin-left: auto; margin-right: auto;" class="table table-striped table-hover lightable-classic">
<thead><tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> Item </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> Partial gamma </th>
   <th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> SE </th>
   <th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> Lower CI </th>
   <th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> Upper CI </th>
   <th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> Adjusted p-value (BH) </th>
  </tr></thead>
<tbody><tr>
<td style="text-align:left;"> q3 </td>
   <td style="text-align:left;"> <span style="     color: red !important;">-0.673</span> </td>
   <td style="text-align:right;"> 0.053 </td>
   <td style="text-align:right;"> -0.776 </td>
   <td style="text-align:right;"> -0.569 </td>
   <td style="text-align:right;"> 0 </td>
  </tr></tbody>
</table>
</div>
</div>
</section><section id="psychotree" class="level3" data-number="2.3"><h3 data-number="2.3" class="anchored" data-anchor-id="psychotree">
<span class="header-section-number">2.3</span> Psychotree</h3>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/RISEkbmRasch/man/RIdifTable.html">RIdifTable</a></span><span class="op">(</span><span class="va">d</span>, <span class="va">dif.group</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="dif_magnitude_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="1050"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<table class="table table-striped" style="font-size: 15px; font-family: Lato">
<thead><tr>
<th style="text-align:right;">
Item
</th>
<th style="text-align:right;">
2
</th>
<th style="text-align:right;">
3
</th>
<th style="text-align:right;">
Mean location
</th>
<th style="text-align:right;">
StDev
</th>
<th style="text-align:right;">
MaxDiff
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:right;">
q1
</td>
<td style="text-align:right;">
1.147
</td>
<td style="text-align:right;">
1.125
</td>
<td style="text-align:right;">
1.136
</td>
<td style="text-align:right;">
0.015
</td>
<td style="text-align:right;">
<span style="color: black">0.021</span>
</td>
</tr>
<tr>
<td style="text-align:right;">
q2
</td>
<td style="text-align:right;">
-0.841
</td>
<td style="text-align:right;">
-0.970
</td>
<td style="text-align:right;">
-0.905
</td>
<td style="text-align:right;">
0.091
</td>
<td style="text-align:right;">
<span style="color: black">0.129</span>
</td>
</tr>
<tr>
<td style="text-align:right;">
q3
</td>
<td style="text-align:right;">
-0.218
</td>
<td style="text-align:right;">
0.780
</td>
<td style="text-align:right;">
0.281
</td>
<td style="text-align:right;">
0.706
</td>
<td style="text-align:right;">
<span style="color: red">0.998</span>
</td>
</tr>
<tr>
<td style="text-align:right;">
q4
</td>
<td style="text-align:right;">
0.258
</td>
<td style="text-align:right;">
0.176
</td>
<td style="text-align:right;">
0.217
</td>
<td style="text-align:right;">
0.059
</td>
<td style="text-align:right;">
<span style="color: black">0.083</span>
</td>
</tr>
<tr>
<td style="text-align:right;">
q5
</td>
<td style="text-align:right;">
0.121
</td>
<td style="text-align:right;">
-0.017
</td>
<td style="text-align:right;">
0.052
</td>
<td style="text-align:right;">
0.098
</td>
<td style="text-align:right;">
<span style="color: black">0.138</span>
</td>
</tr>
<tr>
<td style="text-align:right;">
q6
</td>
<td style="text-align:right;">
-1.568
</td>
<td style="text-align:right;">
-1.640
</td>
<td style="text-align:right;">
-1.604
</td>
<td style="text-align:right;">
0.051
</td>
<td style="text-align:right;">
<span style="color: black">0.072</span>
</td>
</tr>
<tr>
<td style="text-align:right;">
q7
</td>
<td style="text-align:right;">
1.226
</td>
<td style="text-align:right;">
1.098
</td>
<td style="text-align:right;">
1.162
</td>
<td style="text-align:right;">
0.090
</td>
<td style="text-align:right;">
<span style="color: black">0.128</span>
</td>
</tr>
<tr>
<td style="text-align:right;">
q8
</td>
<td style="text-align:right;">
-1.198
</td>
<td style="text-align:right;">
-1.326
</td>
<td style="text-align:right;">
-1.262
</td>
<td style="text-align:right;">
0.091
</td>
<td style="text-align:right;">
<span style="color: black">0.129</span>
</td>
</tr>
<tr>
<td style="text-align:right;">
q9
</td>
<td style="text-align:right;">
0.317
</td>
<td style="text-align:right;">
0.099
</td>
<td style="text-align:right;">
0.208
</td>
<td style="text-align:right;">
0.154
</td>
<td style="text-align:right;">
<span style="color: black">0.218</span>
</td>
</tr>
<tr>
<td style="text-align:right;">
q10
</td>
<td style="text-align:right;">
0.756
</td>
<td style="text-align:right;">
0.675
</td>
<td style="text-align:right;">
0.715
</td>
<td style="text-align:right;">
0.057
</td>
<td style="text-align:right;">
<span style="color: black">0.080</span>
</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>DIF clearly shown.</p>
</section><section id="item-split" class="level3" data-number="2.4"><h3 data-number="2.4" class="anchored" data-anchor-id="item-split">
<span class="header-section-number">2.4</span> Item split</h3>
<p>Now, we’ll do an item split and compare thetas for both groups with and without split, and also with the DIF item removed.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">thetas_together</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/RISEkbmRasch/man/RIestThetas.html">RIestThetas</a></span><span class="op">(</span><span class="va">d</span><span class="op">)</span></span>
<span></span>
<span><span class="va">thetas_q3_removed</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/RISEkbmRasch/man/RIestThetas.html">RIestThetas</a></span><span class="op">(</span><span class="va">d</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="op">!</span><span class="va">q3</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">d2</span> <span class="op">&lt;-</span> <span class="va">d</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://tibble.tidyverse.org/reference/add_column.html">add_column</a></span><span class="op">(</span>group <span class="op">=</span> <span class="va">dif.group</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>q3a <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/if_else.html">if_else</a></span><span class="op">(</span><span class="va">group</span> <span class="op">==</span> <span class="fl">1</span>, <span class="va">q3</span>, <span class="cn">NA</span><span class="op">)</span>, </span>
<span>         q3b <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/if_else.html">if_else</a></span><span class="op">(</span><span class="va">group</span> <span class="op">==</span> <span class="fl">2</span>, <span class="va">q3</span>, <span class="cn">NA</span><span class="op">)</span></span>
<span>         <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="op">!</span><span class="va">group</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="op">!</span><span class="va">q3</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Let’s look at the data and a targeting plot.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/RISEkbmRasch/man/RItileplot.html">RItileplot</a></span><span class="op">(</span><span class="va">d2</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="dif_magnitude_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="1050"></p>
</figure>
</div>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/RISEkbmRasch/man/RImissing.html">RImissing</a></span><span class="op">(</span><span class="va">d2</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="dif_magnitude_files/figure-html/unnamed-chunk-9-2.png" class="img-fluid figure-img" width="1050"></p>
</figure>
</div>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/RISEkbmRasch/man/RItargeting.html">RItargeting</a></span><span class="op">(</span><span class="va">d2</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="dif_magnitude_files/figure-html/unnamed-chunk-9-3.png" class="img-fluid figure-img" width="1050"></p>
</figure>
</div>
</div>
</div>
<p>Comparing to non-split data.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/RISEkbmRasch/man/RItargeting.html">RItargeting</a></span><span class="op">(</span><span class="va">d</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="dif_magnitude_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="1050"></p>
</figure>
</div>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb14"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">itemlabels</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>itemnr <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">d</span><span class="op">)</span>, item <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/RISEkbmRasch/man/RIitemHierarchy.html">RIitemHierarchy</a></span><span class="op">(</span><span class="va">d</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="dif_magnitude_files/figure-html/unnamed-chunk-10-2.png" class="img-fluid figure-img" width="1050"></p>
</figure>
</div>
</div>
</div>
</section><section id="estimating-thetas" class="level3" data-number="2.5"><h3 data-number="2.5" class="anchored" data-anchor-id="estimating-thetas">
<span class="header-section-number">2.5</span> Estimating thetas</h3>
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb15"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">thetas_separate</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/RISEkbmRasch/man/RIestThetas.html">RIestThetas</a></span><span class="op">(</span><span class="va">d2</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">thetas_separate</span><span class="op">$</span><span class="va">WLE</span>, breaks <span class="op">=</span> <span class="fl">30</span>, col <span class="op">=</span> <span class="st">"lightblue"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">thetas_together</span><span class="op">$</span><span class="va">WLE</span>, breaks <span class="op">=</span> <span class="fl">30</span>, col <span class="op">=</span> <span class="st">"lightpink"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">thetas_q3_removed</span><span class="op">$</span><span class="va">WLE</span>, breaks <span class="op">=</span> <span class="fl">30</span>, , col <span class="op">=</span> <span class="st">"sienna4"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">thetas_separate</span><span class="op">$</span><span class="va">WLE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">thetas_together</span><span class="op">$</span><span class="va">WLE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">thetas_q3_removed</span><span class="op">$</span><span class="va">WLE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell quarto-layout-panel" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="dif_magnitude_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid" width="1050"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="dif_magnitude_files/figure-html/unnamed-chunk-11-2.png" class="img-fluid" width="1050"></p>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="dif_magnitude_files/figure-html/unnamed-chunk-11-3.png" class="img-fluid" width="1050"></p>
</div>
<div class="cell-output cell-output-stdout quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
-4.3612 -1.6587 -0.7658 -0.8223  0.2691  2.2954 </code></pre>
</div>
</div>
<div class="quarto-layout-row">
<div class="cell-output cell-output-stdout quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
-4.2351 -1.5175 -0.5810 -0.5954  0.5084  4.1459 </code></pre>
</div>
<div class="cell-output cell-output-stdout quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
-4.1900 -1.4352 -0.6010 -0.5733  0.5012  4.1074 </code></pre>
</div>
</div>
</div>
<p>The upper range is rather different for the item split subgroup when using this method. Let’s review the threshold locations.</p>
</section><section id="comparing-item-parameters" class="level3" data-number="2.6"><h3 data-number="2.6" class="anchored" data-anchor-id="comparing-item-parameters">
<span class="header-section-number">2.6</span> Comparing item parameters</h3>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true">Original data</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">Item split</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-3" role="tab" aria-controls="tabset-1-3" aria-selected="false">DIF item removed</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-4" role="tab" aria-controls="tabset-1-4" aria-selected="false">Threshold differences</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-5" role="tab" aria-controls="tabset-1-5" aria-selected="false">Plot estimation bias</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-6-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-6" role="tab" aria-controls="tabset-1-6" aria-selected="false">Summary plot estimation bias</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-7-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-7" role="tab" aria-controls="tabset-1-7" aria-selected="false"></a></li>
</ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb19"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/RISEkbmRasch/man/RIitemparams.html">RIitemparams</a></span><span class="op">(</span><span class="va">d</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table data-quarto-disable-processing="true" style="width:90%; font-size: 15px; width: auto !important;  font-family: Lato; margin-left: auto; margin-right: auto; margin-left: auto; margin-right: auto;border-bottom: 0;" class="table table-striped table-hover lightable-classic table">
<thead><tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">   </th>
   <th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;"> Threshold 1 </th>
   <th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;"> Threshold 2 </th>
   <th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;"> Threshold 3 </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"> Item location </th>
  </tr></thead>
<tbody>
<tr>
<td style="text-align:left;font-weight: bold;"> q1 </td>
   <td style="text-align:right;"> 0.65 </td>
   <td style="text-align:right;"> 1.31 </td>
   <td style="text-align:right;"> 1.37 </td>
   <td style="text-align:left;"> <span style=" font-weight: bold;    text-align: right;">1.11</span> </td>
  </tr>
<tr>
<td style="text-align:left;font-weight: bold;"> q2 </td>
   <td style="text-align:right;"> -1.45 </td>
   <td style="text-align:right;"> -1.19 </td>
   <td style="text-align:right;"> -0.02 </td>
   <td style="text-align:left;"> <span style=" font-weight: bold;    text-align: right;">-0.88</span> </td>
  </tr>
<tr>
<td style="text-align:left;font-weight: bold;"> q3 </td>
   <td style="text-align:right;"> -0.42 </td>
   <td style="text-align:right;"> 0.13 </td>
   <td style="text-align:right;"> 1.09 </td>
   <td style="text-align:left;"> <span style=" font-weight: bold;    text-align: right;">0.27</span> </td>
  </tr>
<tr>
<td style="text-align:left;font-weight: bold;"> q4 </td>
   <td style="text-align:right;"> -0.52 </td>
   <td style="text-align:right;"> 0.31 </td>
   <td style="text-align:right;"> 0.85 </td>
   <td style="text-align:left;"> <span style=" font-weight: bold;    text-align: right;">0.21</span> </td>
  </tr>
<tr>
<td style="text-align:left;font-weight: bold;"> q5 </td>
   <td style="text-align:right;"> -0.95 </td>
   <td style="text-align:right;"> 0.19 </td>
   <td style="text-align:right;"> 0.93 </td>
   <td style="text-align:left;"> <span style=" font-weight: bold;    text-align: right;">0.05</span> </td>
  </tr>
<tr>
<td style="text-align:left;font-weight: bold;"> q6 </td>
   <td style="text-align:right;"> -2.24 </td>
   <td style="text-align:right;"> -1.71 </td>
   <td style="text-align:right;"> -0.77 </td>
   <td style="text-align:left;"> <span style=" font-weight: bold;    text-align: right;">-1.57</span> </td>
  </tr>
<tr>
<td style="text-align:left;font-weight: bold;"> q7 </td>
   <td style="text-align:right;"> 0.19 </td>
   <td style="text-align:right;"> 1.36 </td>
   <td style="text-align:right;"> 1.86 </td>
   <td style="text-align:left;"> <span style=" font-weight: bold;    text-align: right;">1.14</span> </td>
  </tr>
<tr>
<td style="text-align:left;font-weight: bold;"> q8 </td>
   <td style="text-align:right;"> -2.04 </td>
   <td style="text-align:right;"> -1.52 </td>
   <td style="text-align:right;"> -0.15 </td>
   <td style="text-align:left;"> <span style=" font-weight: bold;    text-align: right;">-1.24</span> </td>
  </tr>
<tr>
<td style="text-align:left;font-weight: bold;"> q9 </td>
   <td style="text-align:right;"> -1.50 </td>
   <td style="text-align:right;"> 0.77 </td>
   <td style="text-align:right;"> 1.33 </td>
   <td style="text-align:left;"> <span style=" font-weight: bold;    text-align: right;">0.2</span> </td>
  </tr>
<tr>
<td style="text-align:left;font-weight: bold;"> q10 </td>
   <td style="text-align:right;"> -0.33 </td>
   <td style="text-align:right;"> 0.50 </td>
   <td style="text-align:right;"> 1.96 </td>
   <td style="text-align:left;"> <span style=" font-weight: bold;    text-align: right;">0.71</span> </td>
  </tr>
</tbody>
<tfoot>
<tr><td style="padding: 0; " colspan="100%"><span style="font-style: italic;">Note: </span></td></tr>
<tr><td style="padding: 0; " colspan="100%">
<sup></sup> Item location is the average of the thresholds for each item.</td></tr>
</tfoot>
</table>
</div>
</div>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb20"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/RISEkbmRasch/man/RIitemparams.html">RIitemparams</a></span><span class="op">(</span><span class="va">d2</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table data-quarto-disable-processing="true" style="width:90%; font-size: 15px; width: auto !important;  font-family: Lato; margin-left: auto; margin-right: auto; margin-left: auto; margin-right: auto;border-bottom: 0;" class="table table-striped table-hover lightable-classic table">
<thead><tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">   </th>
   <th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;"> Threshold 1 </th>
   <th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;"> Threshold 2 </th>
   <th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;"> Threshold 3 </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"> Item location </th>
  </tr></thead>
<tbody>
<tr>
<td style="text-align:left;font-weight: bold;"> q1 </td>
   <td style="text-align:right;"> 0.62 </td>
   <td style="text-align:right;"> 1.31 </td>
   <td style="text-align:right;"> 1.38 </td>
   <td style="text-align:left;"> <span style=" font-weight: bold;    text-align: right;">1.1</span> </td>
  </tr>
<tr>
<td style="text-align:left;font-weight: bold;"> q2 </td>
   <td style="text-align:right;"> -1.51 </td>
   <td style="text-align:right;"> -1.24 </td>
   <td style="text-align:right;"> -0.03 </td>
   <td style="text-align:left;"> <span style=" font-weight: bold;    text-align: right;">-0.93</span> </td>
  </tr>
<tr>
<td style="text-align:left;font-weight: bold;"> q4 </td>
   <td style="text-align:right;"> -0.57 </td>
   <td style="text-align:right;"> 0.29 </td>
   <td style="text-align:right;"> 0.86 </td>
   <td style="text-align:left;"> <span style=" font-weight: bold;    text-align: right;">0.19</span> </td>
  </tr>
<tr>
<td style="text-align:left;font-weight: bold;"> q5 </td>
   <td style="text-align:right;"> -1.01 </td>
   <td style="text-align:right;"> 0.16 </td>
   <td style="text-align:right;"> 0.93 </td>
   <td style="text-align:left;"> <span style=" font-weight: bold;    text-align: right;">0.03</span> </td>
  </tr>
<tr>
<td style="text-align:left;font-weight: bold;"> q6 </td>
   <td style="text-align:right;"> -2.31 </td>
   <td style="text-align:right;"> -1.76 </td>
   <td style="text-align:right;"> -0.80 </td>
   <td style="text-align:left;"> <span style=" font-weight: bold;    text-align: right;">-1.63</span> </td>
  </tr>
<tr>
<td style="text-align:left;font-weight: bold;"> q7 </td>
   <td style="text-align:right;"> 0.16 </td>
   <td style="text-align:right;"> 1.35 </td>
   <td style="text-align:right;"> 1.87 </td>
   <td style="text-align:left;"> <span style=" font-weight: bold;    text-align: right;">1.12</span> </td>
  </tr>
<tr>
<td style="text-align:left;font-weight: bold;"> q8 </td>
   <td style="text-align:right;"> -2.11 </td>
   <td style="text-align:right;"> -1.57 </td>
   <td style="text-align:right;"> -0.17 </td>
   <td style="text-align:left;"> <span style=" font-weight: bold;    text-align: right;">-1.28</span> </td>
  </tr>
<tr>
<td style="text-align:left;font-weight: bold;"> q9 </td>
   <td style="text-align:right;"> -1.55 </td>
   <td style="text-align:right;"> 0.75 </td>
   <td style="text-align:right;"> 1.33 </td>
   <td style="text-align:left;"> <span style=" font-weight: bold;    text-align: right;">0.18</span> </td>
  </tr>
<tr>
<td style="text-align:left;font-weight: bold;"> q10 </td>
   <td style="text-align:right;"> -0.38 </td>
   <td style="text-align:right;"> 0.49 </td>
   <td style="text-align:right;"> 1.97 </td>
   <td style="text-align:left;"> <span style=" font-weight: bold;    text-align: right;">0.69</span> </td>
  </tr>
<tr>
<td style="text-align:left;font-weight: bold;"> q3a </td>
   <td style="text-align:right;"> -1.15 </td>
   <td style="text-align:right;"> -0.48 </td>
   <td style="text-align:right;"> 0.73 </td>
   <td style="text-align:left;"> <span style=" font-weight: bold;    text-align: right;">-0.3</span> </td>
  </tr>
<tr>
<td style="text-align:left;font-weight: bold;"> q3b </td>
   <td style="text-align:right;"> 0.10 </td>
   <td style="text-align:right;"> 0.77 </td>
   <td style="text-align:right;"> 1.60 </td>
   <td style="text-align:left;"> <span style=" font-weight: bold;    text-align: right;">0.82</span> </td>
  </tr>
</tbody>
<tfoot>
<tr><td style="padding: 0; " colspan="100%"><span style="font-style: italic;">Note: </span></td></tr>
<tr><td style="padding: 0; " colspan="100%">
<sup></sup> Item location is the average of the thresholds for each item.</td></tr>
</tfoot>
</table>
</div>
</div>
</div>
<div id="tabset-1-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-3-tab">
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb21"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/RISEkbmRasch/man/RIitemparams.html">RIitemparams</a></span><span class="op">(</span><span class="va">d</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="op">!</span><span class="va">q3</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table data-quarto-disable-processing="true" style="width:90%; font-size: 15px; width: auto !important;  font-family: Lato; margin-left: auto; margin-right: auto; margin-left: auto; margin-right: auto;border-bottom: 0;" class="table table-striped table-hover lightable-classic table">
<thead><tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">   </th>
   <th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;"> Threshold 1 </th>
   <th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;"> Threshold 2 </th>
   <th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;"> Threshold 3 </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"> Item location </th>
  </tr></thead>
<tbody>
<tr>
<td style="text-align:left;font-weight: bold;"> q1 </td>
   <td style="text-align:right;"> 0.67 </td>
   <td style="text-align:right;"> 1.37 </td>
   <td style="text-align:right;"> 1.44 </td>
   <td style="text-align:left;"> <span style=" font-weight: bold;    text-align: right;">1.16</span> </td>
  </tr>
<tr>
<td style="text-align:left;font-weight: bold;"> q2 </td>
   <td style="text-align:right;"> -1.45 </td>
   <td style="text-align:right;"> -1.18 </td>
   <td style="text-align:right;"> 0.02 </td>
   <td style="text-align:left;"> <span style=" font-weight: bold;    text-align: right;">-0.87</span> </td>
  </tr>
<tr>
<td style="text-align:left;font-weight: bold;"> q4 </td>
   <td style="text-align:right;"> -0.51 </td>
   <td style="text-align:right;"> 0.34 </td>
   <td style="text-align:right;"> 0.91 </td>
   <td style="text-align:left;"> <span style=" font-weight: bold;    text-align: right;">0.25</span> </td>
  </tr>
<tr>
<td style="text-align:left;font-weight: bold;"> q5 </td>
   <td style="text-align:right;"> -0.94 </td>
   <td style="text-align:right;"> 0.21 </td>
   <td style="text-align:right;"> 0.98 </td>
   <td style="text-align:left;"> <span style=" font-weight: bold;    text-align: right;">0.08</span> </td>
  </tr>
<tr>
<td style="text-align:left;font-weight: bold;"> q6 </td>
   <td style="text-align:right;"> -2.24 </td>
   <td style="text-align:right;"> -1.71 </td>
   <td style="text-align:right;"> -0.75 </td>
   <td style="text-align:left;"> <span style=" font-weight: bold;    text-align: right;">-1.56</span> </td>
  </tr>
<tr>
<td style="text-align:left;font-weight: bold;"> q7 </td>
   <td style="text-align:right;"> 0.21 </td>
   <td style="text-align:right;"> 1.42 </td>
   <td style="text-align:right;"> 1.92 </td>
   <td style="text-align:left;"> <span style=" font-weight: bold;    text-align: right;">1.18</span> </td>
  </tr>
<tr>
<td style="text-align:left;font-weight: bold;"> q8 </td>
   <td style="text-align:right;"> -2.04 </td>
   <td style="text-align:right;"> -1.52 </td>
   <td style="text-align:right;"> -0.12 </td>
   <td style="text-align:left;"> <span style=" font-weight: bold;    text-align: right;">-1.23</span> </td>
  </tr>
<tr>
<td style="text-align:left;font-weight: bold;"> q9 </td>
   <td style="text-align:right;"> -1.49 </td>
   <td style="text-align:right;"> 0.80 </td>
   <td style="text-align:right;"> 1.39 </td>
   <td style="text-align:left;"> <span style=" font-weight: bold;    text-align: right;">0.23</span> </td>
  </tr>
<tr>
<td style="text-align:left;font-weight: bold;"> q10 </td>
   <td style="text-align:right;"> -0.32 </td>
   <td style="text-align:right;"> 0.54 </td>
   <td style="text-align:right;"> 2.02 </td>
   <td style="text-align:left;"> <span style=" font-weight: bold;    text-align: right;">0.75</span> </td>
  </tr>
</tbody>
<tfoot>
<tr><td style="padding: 0; " colspan="100%"><span style="font-style: italic;">Note: </span></td></tr>
<tr><td style="padding: 0; " colspan="100%">
<sup></sup> Item location is the average of the thresholds for each item.</td></tr>
</tfoot>
</table>
</div>
</div>
</div>
<div id="tabset-1-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-4-tab">
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb22"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">dp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/RISEkbmRasch/man/RIitemparams.html">RIitemparams</a></span><span class="op">(</span><span class="va">d</span>, output <span class="op">=</span> <span class="st">"dataframe"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="op">!</span><span class="va">Location</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rlang.r-lib.org/reference/set_names.html">set_names</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"orig_"</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html">rownames_to_column</a></span><span class="op">(</span><span class="st">"item"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html">str_detect</a></span><span class="op">(</span><span class="va">item</span>,<span class="st">"q3"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">dp2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/RISEkbmRasch/man/RIitemparams.html">RIitemparams</a></span><span class="op">(</span><span class="va">d2</span>, output <span class="op">=</span> <span class="st">"dataframe"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="op">!</span><span class="va">Location</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rlang.r-lib.org/reference/set_names.html">set_names</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"split_"</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html">rownames_to_column</a></span><span class="op">(</span><span class="st">"item"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html">str_detect</a></span><span class="op">(</span><span class="va">item</span>,<span class="st">"q3"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">dp3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/RISEkbmRasch/man/RIitemparams.html">RIitemparams</a></span><span class="op">(</span><span class="va">d</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="op">!</span><span class="va">q3</span><span class="op">)</span>, output <span class="op">=</span> <span class="st">"dataframe"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="op">!</span><span class="va">Location</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rlang.r-lib.org/reference/set_names.html">set_names</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"q3rem_"</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span><span class="op">)</span>  <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html">rownames_to_column</a></span><span class="op">(</span><span class="st">"item"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html">str_detect</a></span><span class="op">(</span><span class="va">item</span>,<span class="st">"q3"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">d_params</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">dp</span>,<span class="va">dp2</span><span class="op">[</span>,<span class="op">-</span><span class="fl">1</span><span class="op">]</span>,<span class="va">dp3</span><span class="op">[</span>,<span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span> <span class="co"># bind columns, keeping one "item" column</span></span>
<span></span>
<span><span class="va">dpin</span> <span class="op">&lt;-</span> <span class="va">inputParams1c</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rlang.r-lib.org/reference/set_names.html">set_names</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"input_"</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html">rownames_to_column</a></span><span class="op">(</span><span class="st">"item"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html">str_detect</a></span><span class="op">(</span><span class="va">item</span>,<span class="st">"q3"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">dpin_long</span> <span class="op">&lt;-</span> <span class="va">dpin</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span><span class="op">!</span><span class="va">item</span>,</span>
<span>               names_sep <span class="op">=</span> <span class="st">"_"</span>,</span>
<span>               names_to <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"source"</span>,<span class="st">"threshold"</span><span class="op">)</span>,</span>
<span>               values_to <span class="op">=</span> <span class="st">"input"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-1-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-5-tab">
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb23"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">d_params</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span><span class="op">!</span><span class="va">item</span>, </span>
<span>               names_sep <span class="op">=</span> <span class="st">"_"</span>,</span>
<span>               names_to <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"source"</span>,<span class="st">"threshold"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">left_join</a></span><span class="op">(</span><span class="va">dpin_long</span><span class="op">[</span>,<span class="op">-</span><span class="fl">2</span><span class="op">]</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"item"</span>,<span class="st">"threshold"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">source</span>,<span class="va">item</span>,<span class="va">threshold</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span>abs_diff <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="va">input</span> <span class="op">-</span> <span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">threshold</span>, y <span class="op">=</span> <span class="va">abs_diff</span>, color <span class="op">=</span> <span class="va">source</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.85</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="op">~</span> <span class="va">item</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="dif_magnitude_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid figure-img" width="1050"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-1-6" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-6-tab">
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb24"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">itemlocs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/RISEkbmRasch/man/RIitemparams.html">RIitemparams</a></span><span class="op">(</span><span class="va">d</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="op">!</span><span class="va">q3</span><span class="op">)</span>, output <span class="op">=</span> <span class="st">"dataframe"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html">pull</a></span><span class="op">(</span><span class="va">Location</span><span class="op">)</span></span>
<span></span>
<span><span class="va">item_order</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sort.html">sort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">itemlocs</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">d_params</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span><span class="op">!</span><span class="va">item</span>, </span>
<span>               names_sep <span class="op">=</span> <span class="st">"_"</span>,</span>
<span>               names_to <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"source"</span>,<span class="st">"threshold"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">left_join</a></span><span class="op">(</span><span class="va">dpin_long</span><span class="op">[</span>,<span class="op">-</span><span class="fl">2</span><span class="op">]</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"item"</span>,<span class="st">"threshold"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">source</span>,<span class="va">item</span>,<span class="va">threshold</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span>abs_diff <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="va">input</span> <span class="op">-</span> <span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">ungroup</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">source</span>,<span class="va">item</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span>sum_diff <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">abs_diff</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">ungroup</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html">pivot_wider</a></span><span class="op">(</span>values_from <span class="op">=</span> <span class="st">"sum_diff"</span>,</span>
<span>              names_from <span class="op">=</span> <span class="st">"source"</span>,</span>
<span>              id_cols <span class="op">=</span> <span class="st">"item"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span><span class="op">!</span><span class="va">item</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>item <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">item</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">itemlocs</span><span class="op">)</span>, </span>
<span>                        labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">itemlocs</span><span class="op">)</span>,<span class="st">"_"</span>,<span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">itemlocs</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">item</span>, </span>
<span>             y <span class="op">=</span> <span class="va">value</span>, </span>
<span>             color <span class="op">=</span> <span class="va">name</span><span class="op">)</span></span>
<span>         <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Total estimation bias for each item and item set"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="dif_magnitude_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid figure-img" width="1050"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-1-7" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-7-tab">

</div>
</div>
</div>
<p>Maybe we can see some pattern here. Item split results in misestimation of items q6 and q8, which have low locations. On the other hand, item 2 has a lower location than 4, yet the item split data results in less bias for item 2.</p>
<p>Then again, as with this whole experiment, all of this should be run through hundreds of simulated datasets to see the patterns correctly.</p>
<p>The method for estimating item parameters and thetas used in the function <code><a href="https://rdrr.io/pkg/RISEkbmRasch/man/RIestThetas.html">RIestThetas()</a></code> may be at fault? We can separate the two steps, and use a separate function for theta estimation with manual input of item parameters.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb25"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">itemps</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/RISEkbmRasch/man/RIitemparams.html">RIitemparams</a></span><span class="op">(</span><span class="va">d2</span>, output <span class="op">=</span> <span class="st">"dataframe"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="op">!</span><span class="va">Location</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">thetas_separate_catR</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/RISEkbmRasch/man/RIestThetasOLD.html">RIestThetasOLD</a></span><span class="op">(</span><span class="va">d2</span>, itemParams <span class="op">=</span> <span class="va">itemps</span>, theta_range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">8</span>,<span class="fl">8</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">c</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>together_RIestThetas <span class="op">=</span> <span class="va">thetas_together</span><span class="op">$</span><span class="va">WLE</span>,</span>
<span>           together_q3_rem <span class="op">=</span> <span class="va">thetas_q3_removed</span><span class="op">$</span><span class="va">WLE</span>,</span>
<span>           separate_catR <span class="op">=</span> <span class="va">thetas_separate_catR</span>,</span>
<span>           separate_RIestThetas <span class="op">=</span> <span class="va">thetas_separate</span><span class="op">$</span><span class="va">WLE</span>,</span>
<span>           input_thetas <span class="op">=</span> <span class="va">input_thetas</span><span class="op">)</span></span>
<span></span>
<span><span class="va">c</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html">everything</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>               names_to <span class="op">=</span> <span class="st">"method"</span>,</span>
<span>               values_to <span class="op">=</span> <span class="st">"theta"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">theta</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span>bins <span class="op">=</span> <span class="fl">50</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">method</span>, axes <span class="op">=</span> <span class="st">"all_x"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">5</span>,<span class="fl">5</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="dif_magnitude_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid figure-img" width="1050"></p>
</figure>
</div>
</div>
</div>
<p>Looks like the two step approach worked a lot better. Since the item parameter estimation is identical (both are using <code><a href="https://rdrr.io/pkg/eRm/man/PCM.html">eRm::PCM()</a></code>), the reason should be the difference in theta estimation. The two-step approach uses <code><a href="https://rdrr.io/pkg/catR/man/thetaEst.html">catR::thetaEst()</a></code>, which probably is handling missing data in a more adequate way than <code><a href="https://rdrr.io/pkg/iarm/man/person_estimates.html">iarm::person_estimates()</a></code>. Both approaches use the Weighted Likelihood Estimation to minimize bias.</p>
</section></section><section id="results" class="level2" data-number="3"><h2 data-number="3" class="anchored" data-anchor-id="results">
<span class="header-section-number">3</span> Results</h2>
<section id="summarised" class="level3" data-number="3.1"><h3 data-number="3.1" class="anchored" data-anchor-id="summarised">
<span class="header-section-number">3.1</span> Summarised</h3>
<p>First, absolute differences in estimated thetas compared to input thetas.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb26"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">c_diff</span> <span class="op">&lt;-</span> <span class="va">c</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>with_q3 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="va">together_RIestThetas</span> <span class="op">-</span> <span class="va">input_thetas</span><span class="op">)</span>,</span>
<span>         q3_removed <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="va">together_q3_rem</span> <span class="op">-</span> <span class="va">input_thetas</span><span class="op">)</span>,</span>
<span>         q3_split <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="va">separate_catR</span> <span class="op">-</span> <span class="va">input_thetas</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">c</span><span class="op">)</span><span class="op">)</span></span>
<span>  </span>
<span><span class="va">c_diff</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html">everything</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span>bins <span class="op">=</span> <span class="fl">50</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="op">~</span> <span class="va">name</span>, ncol <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Absolute difference in logits"</span>,</span>
<span>       title <span class="op">=</span> <span class="st">"Comparing input thetas to estimated"</span>,</span>
<span>       subtitle <span class="op">=</span> <span class="st">"Distribution of bias"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="dif_magnitude_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid figure-img" width="1050"></p>
</figure>
</div>
</div>
</div>
<p>No clear pattern differentiating these histograms, from my ocular inspection of the plot at least.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb27"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">c_diff_descr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/summarytools/man/descr.html">descr</a></span><span class="op">(</span><span class="va">c_diff</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html">rownames_to_column</a></span><span class="op">(</span><span class="st">"Parameter"</span><span class="op">)</span> </span>
<span></span>
<span><span class="va">c_diff_descr</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">9</span>,<span class="op">]</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span><span class="op">!</span><span class="va">Parameter</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Parameter</span>, y <span class="op">=</span> <span class="va">value</span>, color <span class="op">=</span> <span class="va">name</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.85</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html">scale_color_viridis_d</a></span><span class="op">(</span><span class="st">'Item set'</span>, end <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>y <span class="op">=</span> <span class="st">"Logits"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="dif_magnitude_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid figure-img" width="1050"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb28"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">c_diff_descr</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">9</span>,<span class="op">]</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate_all.html">mutate_if</a></span><span class="op">(</span><span class="va">is.numeric</span>, <span class="va">round</span>, <span class="fl">3</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/RISEkbmRasch/man/kbl_rise.html">kbl_rise</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table data-quarto-disable-processing="true" style="width:65%; font-size: 14px;  font-family: Arial; margin-left: auto; margin-right: auto;" class="table table-striped table-hover lightable-classic">
<thead><tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> Parameter </th>
   <th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> q3_removed </th>
   <th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> q3_split </th>
   <th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> with_q3 </th>
  </tr></thead>
<tbody>
<tr>
<td style="text-align:left;"> Mean </td>
   <td style="text-align:right;"> 0.617 </td>
   <td style="text-align:right;"> 0.660 </td>
   <td style="text-align:right;"> 0.631 </td>
  </tr>
<tr>
<td style="text-align:left;"> Std.Dev </td>
   <td style="text-align:right;"> 0.450 </td>
   <td style="text-align:right;"> 0.460 </td>
   <td style="text-align:right;"> 0.448 </td>
  </tr>
<tr>
<td style="text-align:left;"> Min </td>
   <td style="text-align:right;"> 0.000 </td>
   <td style="text-align:right;"> 0.001 </td>
   <td style="text-align:right;"> 0.000 </td>
  </tr>
<tr>
<td style="text-align:left;"> Q1 </td>
   <td style="text-align:right;"> 0.260 </td>
   <td style="text-align:right;"> 0.318 </td>
   <td style="text-align:right;"> 0.296 </td>
  </tr>
<tr>
<td style="text-align:left;"> Median </td>
   <td style="text-align:right;"> 0.544 </td>
   <td style="text-align:right;"> 0.602 </td>
   <td style="text-align:right;"> 0.576 </td>
  </tr>
<tr>
<td style="text-align:left;"> Q3 </td>
   <td style="text-align:right;"> 0.878 </td>
   <td style="text-align:right;"> 0.919 </td>
   <td style="text-align:right;"> 0.870 </td>
  </tr>
<tr>
<td style="text-align:left;"> Max </td>
   <td style="text-align:right;"> 3.046 </td>
   <td style="text-align:right;"> 3.194 </td>
   <td style="text-align:right;"> 3.091 </td>
  </tr>
<tr>
<td style="text-align:left;"> MAD </td>
   <td style="text-align:right;"> 0.456 </td>
   <td style="text-align:right;"> 0.445 </td>
   <td style="text-align:right;"> 0.432 </td>
  </tr>
<tr>
<td style="text-align:left;"> IQR </td>
   <td style="text-align:right;"> 0.616 </td>
   <td style="text-align:right;"> 0.599 </td>
   <td style="text-align:right;"> 0.573 </td>
  </tr>
</tbody>
</table>
</div>
</div>
<p>Still not large differences anywhere.</p>
<p>We should look at the particular region where the DIF item is located, since it should have the most impact there.</p>
</section><section id="across-the-latent-continuum" class="level3" data-number="3.2"><h3 data-number="3.2" class="anchored" data-anchor-id="across-the-latent-continuum">
<span class="header-section-number">3.2</span> Across the latent continuum</h3>
<p>First, the test information function (TIF) curve could be of interest to understand what to expect in terms of estimation bias due to reliability limitations.</p>
<section id="tif-original-data" class="level4" data-number="3.2.1"><h4 data-number="3.2.1" class="anchored" data-anchor-id="tif-original-data">
<span class="header-section-number">3.2.1</span> TIF original data</h4>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb29"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/RISEkbmRasch/man/RItif.html">RItif</a></span><span class="op">(</span><span class="va">d</span>, samplePSI <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="dif_magnitude_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid figure-img" width="1350"></p>
</figure>
</div>
</div>
</div>
</section><section id="theta-estimation-bias" class="level4" data-number="3.2.2"><h4 data-number="3.2.2" class="anchored" data-anchor-id="theta-estimation-bias">
<span class="header-section-number">3.2.2</span> Theta estimation bias</h4>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb30"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">c_diff</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://tibble.tidyverse.org/reference/add_column.html">add_column</a></span><span class="op">(</span>Theta <span class="op">=</span> <span class="va">input_thetas</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span><span class="op">!</span><span class="va">Theta</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Theta</span>, y <span class="op">=</span> <span class="va">value</span>, color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">name</span><span class="op">)</span>, fill <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">name</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.85</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"loess"</span>,</span>
<span>              <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>linetype <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">name</span><span class="op">)</span><span class="op">)</span>, alpha <span class="op">=</span> <span class="fl">0.15</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ewenme.github.io/ghibli/reference/ggplot2-scales-discrete.html">scale_color_ghibli_d</a></span><span class="op">(</span><span class="st">"MononokeMedium"</span>, direction <span class="op">=</span> <span class="op">-</span><span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ewenme.github.io/ghibli/reference/ggplot2-scales-discrete.html">scale_fill_ghibli_d</a></span><span class="op">(</span><span class="st">"MononokeMedium"</span>, direction <span class="op">=</span> <span class="op">-</span><span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"Item set"</span>,</span>
<span>       title <span class="op">=</span> <span class="st">"Theta estimation bias"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Absolute difference in logits"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html">guides</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"none"</span>, linetype <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">5</span>,<span class="fl">5</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="dif_magnitude_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid figure-img" width="1050"></p>
</figure>
</div>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb31"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">c_diff</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://tibble.tidyverse.org/reference/add_column.html">add_column</a></span><span class="op">(</span>Theta <span class="op">=</span> <span class="va">input_thetas</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span><span class="op">!</span><span class="va">Theta</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Theta</span>, y <span class="op">=</span> <span class="va">value</span>, color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">name</span><span class="op">)</span>, fill <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">name</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co">#geom_point(alpha = 0.85) +</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"loess"</span>,</span>
<span>              <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>linetype <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">name</span><span class="op">)</span><span class="op">)</span>, alpha <span class="op">=</span> <span class="fl">0.15</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ewenme.github.io/ghibli/reference/ggplot2-scales-discrete.html">scale_color_ghibli_d</a></span><span class="op">(</span><span class="st">"MononokeMedium"</span>, direction <span class="op">=</span> <span class="op">-</span><span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ewenme.github.io/ghibli/reference/ggplot2-scales-discrete.html">scale_fill_ghibli_d</a></span><span class="op">(</span><span class="st">"MononokeMedium"</span>, direction <span class="op">=</span> <span class="op">-</span><span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"Item set"</span>,</span>
<span>       title <span class="op">=</span> <span class="st">"Theta estimation bias"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Absolute difference in logits"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html">guides</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"none"</span>, linetype <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">5</span>,<span class="fl">5</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="dif_magnitude_files/figure-html/unnamed-chunk-23-2.png" class="img-fluid figure-img" width="1050"></p>
</figure>
</div>
</div>
</div>
<p>Item split seems to increase bias in the lower range, from -4 to +1.</p>
<p>Keeping q3 and removing q3 are almost identical below 0.5, while removing q3 results in lower bias from 0.5 til 4 logits.</p>
</section><section id="lordif-package" class="level4" data-number="3.2.3"><h4 data-number="3.2.3" class="anchored" data-anchor-id="lordif-package">
<span class="header-section-number">3.2.3</span> <code>lordif</code> package</h4>
<p>Also, the <code>lordif</code> package has a function to produce relevant output.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb32"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">lordif</span><span class="op">)</span></span>
<span><span class="va">g_dif</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lordif/man/lordif.html">lordif</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="va">d</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">dif.group</span><span class="op">)</span>, <span class="co"># make sure that the data is in a dataframe-object and that the DIF variable is numeric</span></span>
<span>                criterion <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Chisqr"</span><span class="op">)</span>, </span>
<span>                alpha <span class="op">=</span> <span class="fl">0.01</span>, </span>
<span>                beta.change <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>                model <span class="op">=</span> <span class="st">"GPCM"</span>,</span>
<span>                R2.change <span class="op">=</span> <span class="fl">0.02</span><span class="op">)</span></span>
<span></span>
<span><span class="va">g_dif_sum</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">g_dif</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb33"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># threshold values for colorizing the table below</span></span>
<span><span class="va">alpha</span> <span class="op">=</span> <span class="fl">0.01</span></span>
<span><span class="va">beta.change</span> <span class="op">=</span> <span class="fl">0.1</span></span>
<span><span class="va">R2.change</span> <span class="op">=</span> <span class="fl">0.02</span></span>
<span></span>
<span><span class="va">g_dif_sum</span><span class="op">$</span><span class="va">stats</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/all_of.html">all_of</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"df12"</span>,<span class="st">"df13"</span>,<span class="st">"df23"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://tibble.tidyverse.org/reference/add_column.html">add_column</a></span><span class="op">(</span>itemnr <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span>, .before <span class="op">=</span> <span class="st">"ncat"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html">across</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">chi12</span>,<span class="va">chi13</span>,<span class="va">chi23</span><span class="op">)</span>, <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/cell_spec.html">cell_spec</a></span><span class="op">(</span><span class="va">.x</span>,</span>
<span>                               color <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html">case_when</a></span><span class="op">(</span></span>
<span>                                 <span class="va">.x</span> <span class="op">&lt;</span> <span class="va">alpha</span> <span class="op">~</span> <span class="st">"red"</span>,</span>
<span>                                 <span class="cn">TRUE</span> <span class="op">~</span> <span class="st">"black"</span></span>
<span>                               <span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html">across</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html">starts_with</a></span><span class="op">(</span><span class="st">"pseudo"</span><span class="op">)</span>, <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/cell_spec.html">cell_spec</a></span><span class="op">(</span><span class="va">.x</span>,</span>
<span>                               color <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html">case_when</a></span><span class="op">(</span></span>
<span>                                 <span class="va">.x</span> <span class="op">&gt;</span> <span class="va">R2.change</span> <span class="op">~</span> <span class="st">"red"</span>,</span>
<span>                                 <span class="cn">TRUE</span> <span class="op">~</span> <span class="st">"black"</span></span>
<span>                               <span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>beta12 <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/cell_spec.html">cell_spec</a></span><span class="op">(</span><span class="va">beta12</span>,</span>
<span>                               color <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html">case_when</a></span><span class="op">(</span></span>
<span>                                 <span class="va">beta12</span> <span class="op">&gt;</span> <span class="va">beta.change</span> <span class="op">~</span> <span class="st">"red"</span>,</span>
<span>                                 <span class="cn">TRUE</span> <span class="op">~</span> <span class="st">"black"</span></span>
<span>                               <span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/RISEkbmRasch/man/kbl_rise.html">kbl_rise</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table data-quarto-disable-processing="true" style="width:65%; font-size: 14px;  font-family: Arial; margin-left: auto; margin-right: auto;" class="table table-striped table-hover lightable-classic">
<thead><tr>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> item </th>
   <th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> ncat </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> chi12 </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> chi13 </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> chi23 </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> beta12 </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> pseudo12.McFadden </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> pseudo13.McFadden </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> pseudo23.McFadden </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> pseudo12.Nagelkerke </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> pseudo13.Nagelkerke </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> pseudo23.Nagelkerke </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> pseudo12.CoxSnell </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> pseudo13.CoxSnell </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> pseudo23.CoxSnell </th>
  </tr></thead>
<tbody>
<tr>
<td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 4 </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0.679</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0.063</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0.021</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0.005</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0.004</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0.006</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0.006</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0.005</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0.005</span> </td>
  </tr>
<tr>
<td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 4 </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0.973</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0.612</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0.322</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0.001</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0.001</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0.001</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0.001</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0.001</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0.001</span> </td>
  </tr>
<tr>
<td style="text-align:right;"> 3 </td>
   <td style="text-align:right;"> 4 </td>
   <td style="text-align:left;"> <span style="     color: red !important;">0</span> </td>
   <td style="text-align:left;"> <span style="     color: red !important;">0</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0.893</span> </td>
   <td style="text-align:left;"> <span style="     color: red !important;">0.15</span> </td>
   <td style="text-align:left;"> <span style="     color: red !important;">0.067</span> </td>
   <td style="text-align:left;"> <span style="     color: red !important;">0.067</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0</span> </td>
   <td style="text-align:left;"> <span style="     color: red !important;">0.085</span> </td>
   <td style="text-align:left;"> <span style="     color: red !important;">0.085</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0</span> </td>
   <td style="text-align:left;"> <span style="     color: red !important;">0.079</span> </td>
   <td style="text-align:left;"> <span style="     color: red !important;">0.079</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0</span> </td>
  </tr>
<tr>
<td style="text-align:right;"> 4 </td>
   <td style="text-align:right;"> 4 </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0.781</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0.868</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0.649</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0</span> </td>
  </tr>
<tr>
<td style="text-align:right;"> 5 </td>
   <td style="text-align:right;"> 4 </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0.837</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0.809</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0.536</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0</span> </td>
  </tr>
<tr>
<td style="text-align:right;"> 6 </td>
   <td style="text-align:right;"> 4 </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0.952</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0.807</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0.514</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0</span> </td>
  </tr>
<tr>
<td style="text-align:right;"> 7 </td>
   <td style="text-align:right;"> 4 </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0.249</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0.486</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0.737</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0.001</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0.001</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0.001</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0.002</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0.002</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0.001</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0.001</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0</span> </td>
  </tr>
<tr>
<td style="text-align:right;"> 8 </td>
   <td style="text-align:right;"> 4 </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0.965</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0.648</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0.352</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0.001</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0.001</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0.001</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0.001</span> </td>
  </tr>
<tr>
<td style="text-align:right;"> 9 </td>
   <td style="text-align:right;"> 4 </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0.933</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0.428</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0.194</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0.001</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0.001</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0.002</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0.002</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0.002</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0.002</span> </td>
  </tr>
<tr>
<td style="text-align:right;"> 10 </td>
   <td style="text-align:right;"> 4 </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0.114</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0.067</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0.089</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0.002</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0.002</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0.004</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0.002</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0.002</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0.004</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0.002</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0.002</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0.004</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0.002</span> </td>
  </tr>
</tbody>
</table>
</div>
</div>
<p>This plot does not work in Quarto rendering, for some reason. I’ll include a screenshot instead.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb34"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">g_dif</span>, <span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html">graphics.off</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="dif_magnitude_lordif.png" class="img-fluid figure-img"></p>
<figcaption>lordif_plot</figcaption></figure>
</div>


<!-- -->

</section></section></section><div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-reuse"><h2 class="anchored quarto-appendix-heading">Reuse</h2><div class="quarto-appendix-contents"><div><a rel="license" href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a></div></div></section><section class="quarto-appendix-contents" id="quarto-citation"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@online{johansson2024,
  author = {Johansson, Magnus},
  title = {Rasch {DIF} Magnitude, Item Split, and Theta Difference},
  date = {2024-10-23},
  url = {https://pgmj.github.io/dif_magnitude.html},
  langid = {en}
}
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-johansson2024" class="csl-entry quarto-appendix-citeas" role="listitem">
Johansson, M. (2024, October 23). <em>Rasch DIF magnitude, item split,
and theta difference</em>. <a href="https://pgmj.github.io/dif_magnitude.html">https://pgmj.github.io/dif_magnitude.html</a>
</div></div></section></div></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/pgmj\.github\.io");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><script src="https://giscus.app/client.js" data-repo="pgmj/pgmj.github.io" data-repo-id="R_kgDOGtKrEA" data-category="General" data-category-id="DIC_kwDOGtKrEM4CdX5K" data-mapping="title" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="top" data-theme="light" data-lang="en" crossorigin="anonymous" async="">
</script><input type="hidden" id="giscus-base-theme" value="light"><input type="hidden" id="giscus-alt-theme" value="dark"><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb35" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Rasch DIF magnitude, item split, and theta difference"</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a><span class="an">subtitle:</span><span class="co"> "Brief exploration of Differential Item Functioning in R"</span></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span><span class="co"> </span></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a><span class="co">  name: Magnus Johansson</span></span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a><span class="co">  affiliation: RISE Research Institutes of Sweden</span></span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a><span class="co">  affiliation-url: https://www.ri.se/en/shic</span></span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a><span class="co">  orcid: 0000-0003-1669-592X</span></span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a><span class="an">date:</span><span class="co"> last-modified</span></span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a><span class="an">citation:</span></span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a><span class="co">  type: 'webpage'</span></span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a><span class="an">csl:</span><span class="co"> apa.csl</span></span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a><span class="an">execute:</span><span class="co"> </span></span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a><span class="co">  cache: true</span></span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a><span class="co">  warning: false</span></span>
<span id="cb35-16"><a href="#cb35-16" aria-hidden="true" tabindex="-1"></a><span class="co">  message: false</span></span>
<span id="cb35-17"><a href="#cb35-17" aria-hidden="true" tabindex="-1"></a><span class="an">editor:</span><span class="co"> </span></span>
<span id="cb35-18"><a href="#cb35-18" aria-hidden="true" tabindex="-1"></a><span class="co">  markdown: </span></span>
<span id="cb35-19"><a href="#cb35-19" aria-hidden="true" tabindex="-1"></a><span class="co">    wrap: 72</span></span>
<span id="cb35-20"><a href="#cb35-20" aria-hidden="true" tabindex="-1"></a><span class="an">editor_options:</span><span class="co"> </span></span>
<span id="cb35-21"><a href="#cb35-21" aria-hidden="true" tabindex="-1"></a><span class="co">  chunk_output_type: console</span></span>
<span id="cb35-22"><a href="#cb35-22" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb35-23"><a href="#cb35-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-24"><a href="#cb35-24" aria-hidden="true" tabindex="-1"></a><span class="fu">## Background</span></span>
<span id="cb35-25"><a href="#cb35-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-26"><a href="#cb35-26" aria-hidden="true" tabindex="-1"></a>Out of interest of better understanding som aspects of differential item functioning (DIF, a form of invariance test):</span>
<span id="cb35-27"><a href="#cb35-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-28"><a href="#cb35-28" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>how much does DIF affect estimated thetas (factor scores)?</span>
<span id="cb35-29"><a href="#cb35-29" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>how to do item-split in R (creating separate items for subgroups from one item with problematic DIF)</span>
<span id="cb35-30"><a href="#cb35-30" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>how an item-split compares to removing the item (and keeping the DIF item) in terms of absolute differences in estimated thetas</span>
<span id="cb35-31"><a href="#cb35-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-32"><a href="#cb35-32" aria-hidden="true" tabindex="-1"></a>We'll use simulated data in order to have knowledge of the thetas used to generate response data ("input thetas" in the text below), and make objective comparisons using the different estimated thetas.</span>
<span id="cb35-33"><a href="#cb35-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-34"><a href="#cb35-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-37"><a href="#cb35-37" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb35-38"><a href="#cb35-38" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb35-39"><a href="#cb35-39" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb35-40"><a href="#cb35-40" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(eRm)</span>
<span id="cb35-41"><a href="#cb35-41" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(iarm)</span>
<span id="cb35-42"><a href="#cb35-42" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RISEkbmRasch)</span>
<span id="cb35-43"><a href="#cb35-43" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(summarytools)</span>
<span id="cb35-44"><a href="#cb35-44" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ghibli)</span>
<span id="cb35-45"><a href="#cb35-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-46"><a href="#cb35-46" aria-hidden="true" tabindex="-1"></a><span class="do">### some commands exist in multiple packages, here we define preferred ones that are frequently used</span></span>
<span id="cb35-47"><a href="#cb35-47" aria-hidden="true" tabindex="-1"></a>select <span class="ot">&lt;-</span> dplyr<span class="sc">::</span>select</span>
<span id="cb35-48"><a href="#cb35-48" aria-hidden="true" tabindex="-1"></a>count <span class="ot">&lt;-</span> dplyr<span class="sc">::</span>count</span>
<span id="cb35-49"><a href="#cb35-49" aria-hidden="true" tabindex="-1"></a>recode <span class="ot">&lt;-</span> car<span class="sc">::</span>recode</span>
<span id="cb35-50"><a href="#cb35-50" aria-hidden="true" tabindex="-1"></a>rename <span class="ot">&lt;-</span> dplyr<span class="sc">::</span>rename</span>
<span id="cb35-51"><a href="#cb35-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-52"><a href="#cb35-52" aria-hidden="true" tabindex="-1"></a>theme_rise <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">fontfamily =</span> <span class="st">"Lato"</span>, <span class="at">axissize =</span> <span class="dv">13</span>, <span class="at">titlesize =</span> <span class="dv">15</span>,</span>
<span id="cb35-53"><a href="#cb35-53" aria-hidden="true" tabindex="-1"></a>                       <span class="at">margins =</span> <span class="dv">12</span>, <span class="at">axisface =</span> <span class="st">"plain"</span>, <span class="at">panelDist =</span> <span class="fl">0.6</span>, ...) {</span>
<span id="cb35-54"><a href="#cb35-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb35-55"><a href="#cb35-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb35-56"><a href="#cb35-56" aria-hidden="true" tabindex="-1"></a>    <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">family =</span> fontfamily),</span>
<span id="cb35-57"><a href="#cb35-57" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(</span>
<span id="cb35-58"><a href="#cb35-58" aria-hidden="true" tabindex="-1"></a>      <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> margins),</span>
<span id="cb35-59"><a href="#cb35-59" aria-hidden="true" tabindex="-1"></a>      <span class="at">size =</span> axissize</span>
<span id="cb35-60"><a href="#cb35-60" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb35-61"><a href="#cb35-61" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(</span>
<span id="cb35-62"><a href="#cb35-62" aria-hidden="true" tabindex="-1"></a>      <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">r =</span> margins),</span>
<span id="cb35-63"><a href="#cb35-63" aria-hidden="true" tabindex="-1"></a>      <span class="at">size =</span> axissize</span>
<span id="cb35-64"><a href="#cb35-64" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb35-65"><a href="#cb35-65" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(</span>
<span id="cb35-66"><a href="#cb35-66" aria-hidden="true" tabindex="-1"></a>      <span class="at">face =</span> <span class="st">"bold"</span>,</span>
<span id="cb35-67"><a href="#cb35-67" aria-hidden="true" tabindex="-1"></a>      <span class="at">size =</span> titlesize</span>
<span id="cb35-68"><a href="#cb35-68" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb35-69"><a href="#cb35-69" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(</span>
<span id="cb35-70"><a href="#cb35-70" aria-hidden="true" tabindex="-1"></a>      <span class="at">face =</span> axisface</span>
<span id="cb35-71"><a href="#cb35-71" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb35-72"><a href="#cb35-72" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.caption =</span> <span class="fu">element_text</span>(</span>
<span id="cb35-73"><a href="#cb35-73" aria-hidden="true" tabindex="-1"></a>      <span class="at">face =</span> <span class="st">"italic"</span></span>
<span id="cb35-74"><a href="#cb35-74" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb35-75"><a href="#cb35-75" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">family =</span> fontfamily),</span>
<span id="cb35-76"><a href="#cb35-76" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">color =</span> <span class="st">"lightgrey"</span>),</span>
<span id="cb35-77"><a href="#cb35-77" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.background =</span> <span class="fu">element_rect</span>(<span class="at">color =</span> <span class="st">"lightgrey"</span>),</span>
<span id="cb35-78"><a href="#cb35-78" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.spacing =</span> <span class="fu">unit</span>(panelDist, <span class="st">"cm"</span>, <span class="at">data =</span> <span class="cn">NULL</span>),</span>
<span id="cb35-79"><a href="#cb35-79" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.border =</span> <span class="fu">element_rect</span>(<span class="at">color =</span> <span class="st">"grey"</span>, <span class="at">fill =</span> <span class="cn">NA</span>),</span>
<span id="cb35-80"><a href="#cb35-80" aria-hidden="true" tabindex="-1"></a>    ...</span>
<span id="cb35-81"><a href="#cb35-81" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb35-82"><a href="#cb35-82" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb35-83"><a href="#cb35-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-84"><a href="#cb35-84" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_set</span>(<span class="fu">theme_rise</span>())</span>
<span id="cb35-85"><a href="#cb35-85" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-86"><a href="#cb35-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-87"><a href="#cb35-87" aria-hidden="true" tabindex="-1"></a><span class="fu">### Simulate response data</span></span>
<span id="cb35-88"><a href="#cb35-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-89"><a href="#cb35-89" aria-hidden="true" tabindex="-1"></a>First define input parameters for items.</span>
<span id="cb35-90"><a href="#cb35-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-93"><a href="#cb35-93" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb35-94"><a href="#cb35-94" aria-hidden="true" tabindex="-1"></a><span class="co"># item list for simulation for group 1</span></span>
<span id="cb35-95"><a href="#cb35-95" aria-hidden="true" tabindex="-1"></a>tlist1 <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb35-96"><a href="#cb35-96" aria-hidden="true" tabindex="-1"></a>  <span class="at">q1 =</span> <span class="fu">list</span>(<span class="fl">1.2</span>, <span class="fl">1.8</span>, <span class="fl">2.4</span>),</span>
<span id="cb35-97"><a href="#cb35-97" aria-hidden="true" tabindex="-1"></a>  <span class="at">q2 =</span> <span class="fu">list</span>(<span class="sc">-</span><span class="fl">1.3</span>, <span class="sc">-</span><span class="fl">0.5</span>, <span class="fl">0.5</span>),</span>
<span id="cb35-98"><a href="#cb35-98" aria-hidden="true" tabindex="-1"></a>  <span class="at">q3 =</span> <span class="fu">list</span>(<span class="sc">-</span><span class="fl">0.3</span>, <span class="fl">0.3</span>, <span class="fl">1.2</span>),</span>
<span id="cb35-99"><a href="#cb35-99" aria-hidden="true" tabindex="-1"></a>  <span class="at">q4 =</span> <span class="fu">list</span>(<span class="fl">0.1</span>, <span class="fl">0.6</span>, <span class="fl">1.6</span>),</span>
<span id="cb35-100"><a href="#cb35-100" aria-hidden="true" tabindex="-1"></a>  <span class="at">q5 =</span> <span class="fu">list</span>(<span class="sc">-</span><span class="fl">0.3</span>, <span class="fl">0.7</span>, <span class="fl">1.5</span>),</span>
<span id="cb35-101"><a href="#cb35-101" aria-hidden="true" tabindex="-1"></a>  <span class="at">q6 =</span> <span class="fu">list</span>(<span class="sc">-</span><span class="fl">1.6</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="sc">-</span><span class="fl">0.3</span>),</span>
<span id="cb35-102"><a href="#cb35-102" aria-hidden="true" tabindex="-1"></a>  <span class="at">q7 =</span> <span class="fu">list</span>(<span class="dv">1</span>, <span class="fl">1.8</span>, <span class="fl">2.5</span>),</span>
<span id="cb35-103"><a href="#cb35-103" aria-hidden="true" tabindex="-1"></a>  <span class="at">q8 =</span> <span class="fu">list</span>(<span class="sc">-</span><span class="fl">1.3</span>, <span class="sc">-</span><span class="fl">0.7</span>, <span class="fl">0.4</span>),</span>
<span id="cb35-104"><a href="#cb35-104" aria-hidden="true" tabindex="-1"></a>  <span class="at">q9 =</span> <span class="fu">list</span>(<span class="sc">-</span><span class="fl">0.8</span>, <span class="fl">1.4</span>, <span class="fl">1.9</span>),</span>
<span id="cb35-105"><a href="#cb35-105" aria-hidden="true" tabindex="-1"></a>  <span class="at">q10 =</span> <span class="fu">list</span>(<span class="fl">0.25</span>, <span class="fl">1.25</span>, <span class="fl">2.15</span>)</span>
<span id="cb35-106"><a href="#cb35-106" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb35-107"><a href="#cb35-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-108"><a href="#cb35-108" aria-hidden="true" tabindex="-1"></a><span class="co"># make a tibble/dataframe also, for possible later use</span></span>
<span id="cb35-109"><a href="#cb35-109" aria-hidden="true" tabindex="-1"></a>inputParams1 <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb35-110"><a href="#cb35-110" aria-hidden="true" tabindex="-1"></a>  <span class="at">q1 =</span> <span class="fu">c</span>(<span class="fl">1.2</span>, <span class="fl">1.8</span>, <span class="fl">2.4</span>),</span>
<span id="cb35-111"><a href="#cb35-111" aria-hidden="true" tabindex="-1"></a>  <span class="at">q2 =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">1.3</span>, <span class="sc">-</span><span class="fl">0.5</span>, <span class="fl">0.5</span>),</span>
<span id="cb35-112"><a href="#cb35-112" aria-hidden="true" tabindex="-1"></a>  <span class="at">q4 =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.6</span>, <span class="fl">1.6</span>),</span>
<span id="cb35-113"><a href="#cb35-113" aria-hidden="true" tabindex="-1"></a>  <span class="at">q5 =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.3</span>, <span class="fl">0.7</span>, <span class="fl">1.5</span>),</span>
<span id="cb35-114"><a href="#cb35-114" aria-hidden="true" tabindex="-1"></a>  <span class="at">q6 =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">1.6</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="sc">-</span><span class="fl">0.3</span>),</span>
<span id="cb35-115"><a href="#cb35-115" aria-hidden="true" tabindex="-1"></a>  <span class="at">q7 =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">1.8</span>, <span class="fl">2.5</span>),</span>
<span id="cb35-116"><a href="#cb35-116" aria-hidden="true" tabindex="-1"></a>  <span class="at">q8 =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">1.3</span>, <span class="sc">-</span><span class="fl">0.7</span>, <span class="fl">0.4</span>),</span>
<span id="cb35-117"><a href="#cb35-117" aria-hidden="true" tabindex="-1"></a>  <span class="at">q9 =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.8</span>, <span class="fl">1.4</span>, <span class="fl">1.9</span>),</span>
<span id="cb35-118"><a href="#cb35-118" aria-hidden="true" tabindex="-1"></a>  <span class="at">q10 =</span> <span class="fu">c</span>(<span class="fl">0.25</span>, <span class="fl">1.25</span>, <span class="fl">2.15</span>),</span>
<span id="cb35-119"><a href="#cb35-119" aria-hidden="true" tabindex="-1"></a>  <span class="at">q3a =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.3</span>, <span class="fl">0.3</span>, <span class="fl">1.2</span>),</span>
<span id="cb35-120"><a href="#cb35-120" aria-hidden="true" tabindex="-1"></a>  <span class="at">q3b =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.3</span><span class="sc">+</span><span class="dv">1</span>, <span class="fl">0.3</span><span class="sc">+</span><span class="dv">1</span>, <span class="fl">1.2</span><span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb35-121"><a href="#cb35-121" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb35-122"><a href="#cb35-122" aria-hidden="true" tabindex="-1"></a>  <span class="fu">t</span>() <span class="sc">%&gt;%</span></span>
<span id="cb35-123"><a href="#cb35-123" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.matrix</span>()</span>
<span id="cb35-124"><a href="#cb35-124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-125"><a href="#cb35-125" aria-hidden="true" tabindex="-1"></a><span class="co"># center to 0</span></span>
<span id="cb35-126"><a href="#cb35-126" aria-hidden="true" tabindex="-1"></a>inputParams1c <span class="ot">&lt;-</span> inputParams1 <span class="sc">-</span> <span class="fu">mean</span>(inputParams1)</span>
<span id="cb35-127"><a href="#cb35-127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-128"><a href="#cb35-128" aria-hidden="true" tabindex="-1"></a><span class="co"># item list for simulation for group 2</span></span>
<span id="cb35-129"><a href="#cb35-129" aria-hidden="true" tabindex="-1"></a>tlist2 <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb35-130"><a href="#cb35-130" aria-hidden="true" tabindex="-1"></a>  <span class="at">q1 =</span> <span class="fu">list</span>(<span class="fl">1.2</span>, <span class="fl">1.8</span>, <span class="fl">2.4</span>),</span>
<span id="cb35-131"><a href="#cb35-131" aria-hidden="true" tabindex="-1"></a>  <span class="at">q2 =</span> <span class="fu">list</span>(<span class="sc">-</span><span class="fl">1.3</span>, <span class="sc">-</span><span class="fl">0.5</span>, <span class="fl">0.5</span>),</span>
<span id="cb35-132"><a href="#cb35-132" aria-hidden="true" tabindex="-1"></a>  <span class="at">q3 =</span> <span class="fu">list</span>(<span class="sc">-</span><span class="fl">0.3</span><span class="sc">+</span><span class="dv">1</span>, <span class="fl">0.3</span><span class="sc">+</span><span class="dv">1</span>, <span class="fl">1.2</span><span class="sc">+</span><span class="dv">1</span>),</span>
<span id="cb35-133"><a href="#cb35-133" aria-hidden="true" tabindex="-1"></a>  <span class="at">q4 =</span> <span class="fu">list</span>(<span class="fl">0.1</span>, <span class="fl">0.6</span>, <span class="fl">1.6</span>),</span>
<span id="cb35-134"><a href="#cb35-134" aria-hidden="true" tabindex="-1"></a>  <span class="at">q5 =</span> <span class="fu">list</span>(<span class="sc">-</span><span class="fl">0.3</span>, <span class="fl">0.7</span>, <span class="fl">1.5</span>),</span>
<span id="cb35-135"><a href="#cb35-135" aria-hidden="true" tabindex="-1"></a>  <span class="at">q6 =</span> <span class="fu">list</span>(<span class="sc">-</span><span class="fl">1.6</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="sc">-</span><span class="fl">0.3</span>),</span>
<span id="cb35-136"><a href="#cb35-136" aria-hidden="true" tabindex="-1"></a>  <span class="at">q7 =</span> <span class="fu">list</span>(<span class="dv">1</span>, <span class="fl">1.8</span>, <span class="fl">2.5</span>),</span>
<span id="cb35-137"><a href="#cb35-137" aria-hidden="true" tabindex="-1"></a>  <span class="at">q8 =</span> <span class="fu">list</span>(<span class="sc">-</span><span class="fl">1.3</span>, <span class="sc">-</span><span class="fl">0.7</span>, <span class="fl">0.4</span>),</span>
<span id="cb35-138"><a href="#cb35-138" aria-hidden="true" tabindex="-1"></a>  <span class="at">q9 =</span> <span class="fu">list</span>(<span class="sc">-</span><span class="fl">0.8</span>, <span class="fl">1.4</span>, <span class="fl">1.9</span>),</span>
<span id="cb35-139"><a href="#cb35-139" aria-hidden="true" tabindex="-1"></a>  <span class="at">q10 =</span> <span class="fu">list</span>(<span class="fl">0.25</span>, <span class="fl">1.25</span>, <span class="fl">2.15</span>)</span>
<span id="cb35-140"><a href="#cb35-140" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb35-141"><a href="#cb35-141" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-142"><a href="#cb35-142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-143"><a href="#cb35-143" aria-hidden="true" tabindex="-1"></a>Then generate random thetas that we save to file to be able to reproduce the analysis.</span>
<span id="cb35-144"><a href="#cb35-144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-147"><a href="#cb35-147" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb35-148"><a href="#cb35-148" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb35-149"><a href="#cb35-149" aria-hidden="true" tabindex="-1"></a><span class="co"># simulate thetas</span></span>
<span id="cb35-150"><a href="#cb35-150" aria-hidden="true" tabindex="-1"></a>thetas1 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">300</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="fl">1.5</span>)</span>
<span id="cb35-151"><a href="#cb35-151" aria-hidden="true" tabindex="-1"></a>thetas2 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">300</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="fl">1.5</span>)</span>
<span id="cb35-152"><a href="#cb35-152" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-153"><a href="#cb35-153" aria-hidden="true" tabindex="-1"></a>input_thetas <span class="ot">&lt;-</span> <span class="fu">c</span>(thetas1,thetas2)</span>
<span id="cb35-154"><a href="#cb35-154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-155"><a href="#cb35-155" aria-hidden="true" tabindex="-1"></a><span class="co"># simulate response data based on the above defined item thresholds</span></span>
<span id="cb35-156"><a href="#cb35-156" aria-hidden="true" tabindex="-1"></a>td1 <span class="ot">&lt;-</span> <span class="fu">SimPartialScore</span>(</span>
<span id="cb35-157"><a href="#cb35-157" aria-hidden="true" tabindex="-1"></a>  <span class="at">deltaslist =</span> tlist1,</span>
<span id="cb35-158"><a href="#cb35-158" aria-hidden="true" tabindex="-1"></a>  <span class="at">thetavec =</span> thetas1</span>
<span id="cb35-159"><a href="#cb35-159" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb35-160"><a href="#cb35-160" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>()</span>
<span id="cb35-161"><a href="#cb35-161" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-162"><a href="#cb35-162" aria-hidden="true" tabindex="-1"></a>td2 <span class="ot">&lt;-</span> <span class="fu">SimPartialScore</span>(</span>
<span id="cb35-163"><a href="#cb35-163" aria-hidden="true" tabindex="-1"></a>  <span class="at">deltaslist =</span> tlist2,</span>
<span id="cb35-164"><a href="#cb35-164" aria-hidden="true" tabindex="-1"></a>  <span class="at">thetavec =</span> thetas2</span>
<span id="cb35-165"><a href="#cb35-165" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb35-166"><a href="#cb35-166" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>()</span>
<span id="cb35-167"><a href="#cb35-167" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-168"><a href="#cb35-168" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">rbind</span>(td1,td2) <span class="sc">%&gt;%</span> </span>
<span id="cb35-169"><a href="#cb35-169" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_column</span>(<span class="at">group =</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="at">each =</span> <span class="dv">300</span>))</span>
<span id="cb35-170"><a href="#cb35-170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-171"><a href="#cb35-171" aria-hidden="true" tabindex="-1"></a>dif.group <span class="ot">&lt;-</span> <span class="fu">factor</span>(d<span class="sc">$</span>group)</span>
<span id="cb35-172"><a href="#cb35-172" aria-hidden="true" tabindex="-1"></a>d<span class="sc">$</span>group <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb35-173"><a href="#cb35-173" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-174"><a href="#cb35-174" aria-hidden="true" tabindex="-1"></a>all_data <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">simResponses =</span> d,</span>
<span id="cb35-175"><a href="#cb35-175" aria-hidden="true" tabindex="-1"></a>                 <span class="at">dif_group =</span> dif.group,</span>
<span id="cb35-176"><a href="#cb35-176" aria-hidden="true" tabindex="-1"></a>                 <span class="at">input_thetas =</span> input_thetas)</span>
<span id="cb35-177"><a href="#cb35-177" aria-hidden="true" tabindex="-1"></a><span class="co"># save simulated data for reproducibility</span></span>
<span id="cb35-178"><a href="#cb35-178" aria-hidden="true" tabindex="-1"></a><span class="co">#saveRDS(all_data,"dif_magnitude_1_0.Rdata")</span></span>
<span id="cb35-179"><a href="#cb35-179" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-180"><a href="#cb35-180" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-183"><a href="#cb35-183" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb35-184"><a href="#cb35-184" aria-hidden="true" tabindex="-1"></a>all_data <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"dif_magnitude_1_0.Rdata"</span>)</span>
<span id="cb35-185"><a href="#cb35-185" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-186"><a href="#cb35-186" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> all_data<span class="sc">$</span>simResponses</span>
<span id="cb35-187"><a href="#cb35-187" aria-hidden="true" tabindex="-1"></a>dif.group <span class="ot">&lt;-</span> all_data<span class="sc">$</span>dif_group</span>
<span id="cb35-188"><a href="#cb35-188" aria-hidden="true" tabindex="-1"></a>input_thetas <span class="ot">&lt;-</span> all_data<span class="sc">$</span>input_thetas</span>
<span id="cb35-189"><a href="#cb35-189" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-190"><a href="#cb35-190" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-191"><a href="#cb35-191" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-192"><a href="#cb35-192" aria-hidden="true" tabindex="-1"></a>We now have 10 items with 4 categories each, 600 respondents with half of respondents having differential item functioning for one item (item q3), with 1 logit uniform difference in location (all thresholds for item q3 are + 1 logits).</span>
<span id="cb35-193"><a href="#cb35-193" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-194"><a href="#cb35-194" aria-hidden="true" tabindex="-1"></a><span class="fu">## DIF assessment</span></span>
<span id="cb35-195"><a href="#cb35-195" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-196"><a href="#cb35-196" aria-hidden="true" tabindex="-1"></a>Let's test for DIF with some different methods.</span>
<span id="cb35-197"><a href="#cb35-197" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-198"><a href="#cb35-198" aria-hidden="true" tabindex="-1"></a><span class="fu">### LR-test</span></span>
<span id="cb35-201"><a href="#cb35-201" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb35-202"><a href="#cb35-202" aria-hidden="true" tabindex="-1"></a><span class="fu">RIdifTableLR</span>(d, dif.group)</span>
<span id="cb35-203"><a href="#cb35-203" aria-hidden="true" tabindex="-1"></a><span class="fu">RIdifThreshFigLR</span>(d, dif.group)</span>
<span id="cb35-204"><a href="#cb35-204" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-205"><a href="#cb35-205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-206"><a href="#cb35-206" aria-hidden="true" tabindex="-1"></a><span class="fu">### Partial gamma</span></span>
<span id="cb35-209"><a href="#cb35-209" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb35-210"><a href="#cb35-210" aria-hidden="true" tabindex="-1"></a><span class="fu">RIpartgamDIF</span>(d, dif.group)</span>
<span id="cb35-211"><a href="#cb35-211" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-212"><a href="#cb35-212" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-213"><a href="#cb35-213" aria-hidden="true" tabindex="-1"></a><span class="fu">### Psychotree</span></span>
<span id="cb35-216"><a href="#cb35-216" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb35-217"><a href="#cb35-217" aria-hidden="true" tabindex="-1"></a><span class="fu">RIdifTable</span>(d, dif.group)</span>
<span id="cb35-218"><a href="#cb35-218" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-219"><a href="#cb35-219" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-220"><a href="#cb35-220" aria-hidden="true" tabindex="-1"></a>DIF clearly shown.</span>
<span id="cb35-221"><a href="#cb35-221" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-222"><a href="#cb35-222" aria-hidden="true" tabindex="-1"></a><span class="fu">### Item split</span></span>
<span id="cb35-223"><a href="#cb35-223" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-224"><a href="#cb35-224" aria-hidden="true" tabindex="-1"></a>Now, we'll do an item split and compare thetas for both groups with and without split, and also with the DIF item removed.</span>
<span id="cb35-225"><a href="#cb35-225" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-226"><a href="#cb35-226" aria-hidden="true" tabindex="-1"></a><span class="in">``` {r}</span></span>
<span id="cb35-227"><a href="#cb35-227" aria-hidden="true" tabindex="-1"></a><span class="in">thetas_together &lt;- RIestThetas(d)</span></span>
<span id="cb35-228"><a href="#cb35-228" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-229"><a href="#cb35-229" aria-hidden="true" tabindex="-1"></a><span class="in">thetas_q3_removed &lt;- RIestThetas(d %&gt;% select(!q3))</span></span>
<span id="cb35-230"><a href="#cb35-230" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-231"><a href="#cb35-231" aria-hidden="true" tabindex="-1"></a><span class="in">d2 &lt;- d %&gt;% </span></span>
<span id="cb35-232"><a href="#cb35-232" aria-hidden="true" tabindex="-1"></a><span class="in">  add_column(group = dif.group) %&gt;% </span></span>
<span id="cb35-233"><a href="#cb35-233" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(q3a = if_else(group == 1, q3, NA), </span></span>
<span id="cb35-234"><a href="#cb35-234" aria-hidden="true" tabindex="-1"></a><span class="in">         q3b = if_else(group == 2, q3, NA)</span></span>
<span id="cb35-235"><a href="#cb35-235" aria-hidden="true" tabindex="-1"></a><span class="in">         ) %&gt;% </span></span>
<span id="cb35-236"><a href="#cb35-236" aria-hidden="true" tabindex="-1"></a><span class="in">  select(!group) %&gt;%</span></span>
<span id="cb35-237"><a href="#cb35-237" aria-hidden="true" tabindex="-1"></a><span class="in">  select(!q3)</span></span>
<span id="cb35-238"><a href="#cb35-238" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-239"><a href="#cb35-239" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-240"><a href="#cb35-240" aria-hidden="true" tabindex="-1"></a>Let's look at the data and a targeting plot.</span>
<span id="cb35-241"><a href="#cb35-241" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-242"><a href="#cb35-242" aria-hidden="true" tabindex="-1"></a><span class="in">``` {r}</span></span>
<span id="cb35-243"><a href="#cb35-243" aria-hidden="true" tabindex="-1"></a><span class="in">RItileplot(d2)</span></span>
<span id="cb35-244"><a href="#cb35-244" aria-hidden="true" tabindex="-1"></a><span class="in">RImissing(d2)</span></span>
<span id="cb35-245"><a href="#cb35-245" aria-hidden="true" tabindex="-1"></a><span class="in">RItargeting(d2)</span></span>
<span id="cb35-246"><a href="#cb35-246" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-247"><a href="#cb35-247" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-248"><a href="#cb35-248" aria-hidden="true" tabindex="-1"></a>Comparing to non-split data.</span>
<span id="cb35-249"><a href="#cb35-249" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-252"><a href="#cb35-252" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb35-253"><a href="#cb35-253" aria-hidden="true" tabindex="-1"></a><span class="fu">RItargeting</span>(d)</span>
<span id="cb35-254"><a href="#cb35-254" aria-hidden="true" tabindex="-1"></a>itemlabels <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">itemnr =</span> <span class="fu">names</span>(d), <span class="at">item =</span> <span class="st">""</span>)</span>
<span id="cb35-255"><a href="#cb35-255" aria-hidden="true" tabindex="-1"></a><span class="fu">RIitemHierarchy</span>(d)</span>
<span id="cb35-256"><a href="#cb35-256" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-257"><a href="#cb35-257" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-258"><a href="#cb35-258" aria-hidden="true" tabindex="-1"></a><span class="fu">### Estimating thetas</span></span>
<span id="cb35-259"><a href="#cb35-259" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-262"><a href="#cb35-262" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb35-263"><a href="#cb35-263" aria-hidden="true" tabindex="-1"></a><span class="co">#| layout-ncol: 2</span></span>
<span id="cb35-264"><a href="#cb35-264" aria-hidden="true" tabindex="-1"></a>thetas_separate <span class="ot">&lt;-</span> <span class="fu">RIestThetas</span>(d2)</span>
<span id="cb35-265"><a href="#cb35-265" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-266"><a href="#cb35-266" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(thetas_separate<span class="sc">$</span>WLE, <span class="at">breaks =</span> <span class="dv">30</span>, <span class="at">col =</span> <span class="st">"lightblue"</span>)</span>
<span id="cb35-267"><a href="#cb35-267" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(thetas_together<span class="sc">$</span>WLE, <span class="at">breaks =</span> <span class="dv">30</span>, <span class="at">col =</span> <span class="st">"lightpink"</span>)</span>
<span id="cb35-268"><a href="#cb35-268" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(thetas_q3_removed<span class="sc">$</span>WLE, <span class="at">breaks =</span> <span class="dv">30</span>, , <span class="at">col =</span> <span class="st">"sienna4"</span>)</span>
<span id="cb35-269"><a href="#cb35-269" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-270"><a href="#cb35-270" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(thetas_separate<span class="sc">$</span>WLE)</span>
<span id="cb35-271"><a href="#cb35-271" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(thetas_together<span class="sc">$</span>WLE)</span>
<span id="cb35-272"><a href="#cb35-272" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(thetas_q3_removed<span class="sc">$</span>WLE)</span>
<span id="cb35-273"><a href="#cb35-273" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-274"><a href="#cb35-274" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-275"><a href="#cb35-275" aria-hidden="true" tabindex="-1"></a>The upper range is rather different for the item split subgroup when using this method. Let's review the threshold locations.</span>
<span id="cb35-276"><a href="#cb35-276" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-277"><a href="#cb35-277" aria-hidden="true" tabindex="-1"></a><span class="fu">### Comparing item parameters</span></span>
<span id="cb35-278"><a href="#cb35-278" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-279"><a href="#cb35-279" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb35-280"><a href="#cb35-280" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Original data</span></span>
<span id="cb35-283"><a href="#cb35-283" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb35-284"><a href="#cb35-284" aria-hidden="true" tabindex="-1"></a><span class="fu">RIitemparams</span>(d)</span>
<span id="cb35-285"><a href="#cb35-285" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-286"><a href="#cb35-286" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-287"><a href="#cb35-287" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Item split</span></span>
<span id="cb35-290"><a href="#cb35-290" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb35-291"><a href="#cb35-291" aria-hidden="true" tabindex="-1"></a><span class="fu">RIitemparams</span>(d2)</span>
<span id="cb35-292"><a href="#cb35-292" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-293"><a href="#cb35-293" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-294"><a href="#cb35-294" aria-hidden="true" tabindex="-1"></a><span class="fu">#### DIF item removed</span></span>
<span id="cb35-297"><a href="#cb35-297" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb35-298"><a href="#cb35-298" aria-hidden="true" tabindex="-1"></a><span class="fu">RIitemparams</span>(d <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">!</span>q3))</span>
<span id="cb35-299"><a href="#cb35-299" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-300"><a href="#cb35-300" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Threshold differences</span></span>
<span id="cb35-303"><a href="#cb35-303" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb35-304"><a href="#cb35-304" aria-hidden="true" tabindex="-1"></a>dp <span class="ot">&lt;-</span> <span class="fu">RIitemparams</span>(d, <span class="at">output =</span> <span class="st">"dataframe"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb35-305"><a href="#cb35-305" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">!</span>Location) <span class="sc">%&gt;%</span> </span>
<span id="cb35-306"><a href="#cb35-306" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_names</span>(<span class="fu">paste0</span>(<span class="st">"orig_"</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb35-307"><a href="#cb35-307" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>(<span class="st">"item"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb35-308"><a href="#cb35-308" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(item,<span class="st">"q3"</span>))</span>
<span id="cb35-309"><a href="#cb35-309" aria-hidden="true" tabindex="-1"></a>dp2 <span class="ot">&lt;-</span> <span class="fu">RIitemparams</span>(d2, <span class="at">output =</span> <span class="st">"dataframe"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb35-310"><a href="#cb35-310" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">!</span>Location) <span class="sc">%&gt;%</span> </span>
<span id="cb35-311"><a href="#cb35-311" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_names</span>(<span class="fu">paste0</span>(<span class="st">"split_"</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb35-312"><a href="#cb35-312" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>(<span class="st">"item"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb35-313"><a href="#cb35-313" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(item,<span class="st">"q3"</span>))</span>
<span id="cb35-314"><a href="#cb35-314" aria-hidden="true" tabindex="-1"></a>dp3 <span class="ot">&lt;-</span> <span class="fu">RIitemparams</span>(d <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">!</span>q3), <span class="at">output =</span> <span class="st">"dataframe"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb35-315"><a href="#cb35-315" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">!</span>Location) <span class="sc">%&gt;%</span> </span>
<span id="cb35-316"><a href="#cb35-316" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_names</span>(<span class="fu">paste0</span>(<span class="st">"q3rem_"</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>))  <span class="sc">%&gt;%</span> </span>
<span id="cb35-317"><a href="#cb35-317" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>(<span class="st">"item"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb35-318"><a href="#cb35-318" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(item,<span class="st">"q3"</span>))</span>
<span id="cb35-319"><a href="#cb35-319" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-320"><a href="#cb35-320" aria-hidden="true" tabindex="-1"></a>d_params <span class="ot">&lt;-</span> <span class="fu">cbind</span>(dp,dp2[,<span class="sc">-</span><span class="dv">1</span>],dp3[,<span class="sc">-</span><span class="dv">1</span>]) <span class="co"># bind columns, keeping one "item" column</span></span>
<span id="cb35-321"><a href="#cb35-321" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-322"><a href="#cb35-322" aria-hidden="true" tabindex="-1"></a>dpin <span class="ot">&lt;-</span> inputParams1c <span class="sc">%&gt;%</span> </span>
<span id="cb35-323"><a href="#cb35-323" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb35-324"><a href="#cb35-324" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_names</span>(<span class="fu">paste0</span>(<span class="st">"input_"</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb35-325"><a href="#cb35-325" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>(<span class="st">"item"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb35-326"><a href="#cb35-326" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(item,<span class="st">"q3"</span>))</span>
<span id="cb35-327"><a href="#cb35-327" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-328"><a href="#cb35-328" aria-hidden="true" tabindex="-1"></a>dpin_long <span class="ot">&lt;-</span> dpin <span class="sc">%&gt;%</span> </span>
<span id="cb35-329"><a href="#cb35-329" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">!</span>item,</span>
<span id="cb35-330"><a href="#cb35-330" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_sep =</span> <span class="st">"_"</span>,</span>
<span id="cb35-331"><a href="#cb35-331" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="fu">c</span>(<span class="st">"source"</span>,<span class="st">"threshold"</span>),</span>
<span id="cb35-332"><a href="#cb35-332" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">"input"</span>)</span>
<span id="cb35-333"><a href="#cb35-333" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-334"><a href="#cb35-334" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-335"><a href="#cb35-335" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Plot estimation bias</span></span>
<span id="cb35-338"><a href="#cb35-338" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb35-339"><a href="#cb35-339" aria-hidden="true" tabindex="-1"></a>d_params <span class="sc">%&gt;%</span> </span>
<span id="cb35-340"><a href="#cb35-340" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">!</span>item, </span>
<span id="cb35-341"><a href="#cb35-341" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_sep =</span> <span class="st">"_"</span>,</span>
<span id="cb35-342"><a href="#cb35-342" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="fu">c</span>(<span class="st">"source"</span>,<span class="st">"threshold"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb35-343"><a href="#cb35-343" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(dpin_long[,<span class="sc">-</span><span class="dv">2</span>], <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"item"</span>,<span class="st">"threshold"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb35-344"><a href="#cb35-344" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(source,item,threshold) <span class="sc">%&gt;%</span> </span>
<span id="cb35-345"><a href="#cb35-345" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">abs_diff =</span> <span class="fu">abs</span>(input <span class="sc">-</span> value)) <span class="sc">%&gt;%</span> </span>
<span id="cb35-346"><a href="#cb35-346" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb35-347"><a href="#cb35-347" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> threshold, <span class="at">y =</span> abs_diff, <span class="at">color =</span> source)) <span class="sc">+</span></span>
<span id="cb35-348"><a href="#cb35-348" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.85</span>) <span class="sc">+</span></span>
<span id="cb35-349"><a href="#cb35-349" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> item)</span>
<span id="cb35-350"><a href="#cb35-350" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb35-351"><a href="#cb35-351" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-352"><a href="#cb35-352" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Summary plot estimation bias</span></span>
<span id="cb35-355"><a href="#cb35-355" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb35-356"><a href="#cb35-356" aria-hidden="true" tabindex="-1"></a>itemlocs <span class="ot">&lt;-</span> <span class="fu">RIitemparams</span>(d <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">!</span>q3), <span class="at">output =</span> <span class="st">"dataframe"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb35-357"><a href="#cb35-357" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(Location)</span>
<span id="cb35-358"><a href="#cb35-358" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-359"><a href="#cb35-359" aria-hidden="true" tabindex="-1"></a>item_order <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">as.numeric</span>(itemlocs))</span>
<span id="cb35-360"><a href="#cb35-360" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-361"><a href="#cb35-361" aria-hidden="true" tabindex="-1"></a>d_params <span class="sc">%&gt;%</span> </span>
<span id="cb35-362"><a href="#cb35-362" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">!</span>item, </span>
<span id="cb35-363"><a href="#cb35-363" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_sep =</span> <span class="st">"_"</span>,</span>
<span id="cb35-364"><a href="#cb35-364" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="fu">c</span>(<span class="st">"source"</span>,<span class="st">"threshold"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb35-365"><a href="#cb35-365" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(dpin_long[,<span class="sc">-</span><span class="dv">2</span>], <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"item"</span>,<span class="st">"threshold"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb35-366"><a href="#cb35-366" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(source,item,threshold) <span class="sc">%&gt;%</span> </span>
<span id="cb35-367"><a href="#cb35-367" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">abs_diff =</span> <span class="fu">abs</span>(input <span class="sc">-</span> value)) <span class="sc">%&gt;%</span> </span>
<span id="cb35-368"><a href="#cb35-368" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb35-369"><a href="#cb35-369" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(source,item) <span class="sc">%&gt;%</span> </span>
<span id="cb35-370"><a href="#cb35-370" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">sum_diff =</span> <span class="fu">sum</span>(abs_diff)) <span class="sc">%&gt;%</span> </span>
<span id="cb35-371"><a href="#cb35-371" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb35-372"><a href="#cb35-372" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">values_from =</span> <span class="st">"sum_diff"</span>,</span>
<span id="cb35-373"><a href="#cb35-373" aria-hidden="true" tabindex="-1"></a>              <span class="at">names_from =</span> <span class="st">"source"</span>,</span>
<span id="cb35-374"><a href="#cb35-374" aria-hidden="true" tabindex="-1"></a>              <span class="at">id_cols =</span> <span class="st">"item"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb35-375"><a href="#cb35-375" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">!</span>item) <span class="sc">%&gt;%</span> </span>
<span id="cb35-376"><a href="#cb35-376" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">item =</span> <span class="fu">factor</span>(item, <span class="at">levels =</span> <span class="fu">names</span>(itemlocs), </span>
<span id="cb35-377"><a href="#cb35-377" aria-hidden="true" tabindex="-1"></a>                        <span class="at">labels =</span> <span class="fu">paste0</span>(<span class="fu">names</span>(itemlocs),<span class="st">"_"</span>,<span class="fu">as.numeric</span>(itemlocs)))) <span class="sc">%&gt;%</span> </span>
<span id="cb35-378"><a href="#cb35-378" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> item, </span>
<span id="cb35-379"><a href="#cb35-379" aria-hidden="true" tabindex="-1"></a>             <span class="at">y =</span> value, </span>
<span id="cb35-380"><a href="#cb35-380" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> name)</span>
<span id="cb35-381"><a href="#cb35-381" aria-hidden="true" tabindex="-1"></a>         ) <span class="sc">+</span></span>
<span id="cb35-382"><a href="#cb35-382" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb35-383"><a href="#cb35-383" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Total estimation bias for each item and item set"</span>)</span>
<span id="cb35-384"><a href="#cb35-384" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-385"><a href="#cb35-385" aria-hidden="true" tabindex="-1"></a><span class="fu">#### </span></span>
<span id="cb35-386"><a href="#cb35-386" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb35-387"><a href="#cb35-387" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-388"><a href="#cb35-388" aria-hidden="true" tabindex="-1"></a>Maybe we can see some pattern here. Item split results in misestimation of items q6 and q8, which have low locations. On the other hand, item 2 has a lower location than 4, yet the item split data results in less bias for item 2.</span>
<span id="cb35-389"><a href="#cb35-389" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-390"><a href="#cb35-390" aria-hidden="true" tabindex="-1"></a>Then again, as with this whole experiment, all of this should be run through hundreds of simulated datasets to see the patterns correctly.</span>
<span id="cb35-391"><a href="#cb35-391" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-392"><a href="#cb35-392" aria-hidden="true" tabindex="-1"></a>The method for estimating item parameters and thetas used in the function <span class="in">`RIestThetas()`</span> may be at fault? We can separate the two steps, and use a separate function for theta estimation with manual input of item parameters.</span>
<span id="cb35-393"><a href="#cb35-393" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-396"><a href="#cb35-396" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb35-397"><a href="#cb35-397" aria-hidden="true" tabindex="-1"></a>itemps <span class="ot">&lt;-</span> <span class="fu">RIitemparams</span>(d2, <span class="at">output =</span> <span class="st">"dataframe"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb35-398"><a href="#cb35-398" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">!</span>Location) <span class="sc">%&gt;%</span> </span>
<span id="cb35-399"><a href="#cb35-399" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.matrix</span>()</span>
<span id="cb35-400"><a href="#cb35-400" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-401"><a href="#cb35-401" aria-hidden="true" tabindex="-1"></a>thetas_separate_catR <span class="ot">&lt;-</span> <span class="fu">RIestThetasOLD</span>(d2, <span class="at">itemParams =</span> itemps, <span class="at">theta_range =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">8</span>,<span class="dv">8</span>))</span>
<span id="cb35-402"><a href="#cb35-402" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-403"><a href="#cb35-403" aria-hidden="true" tabindex="-1"></a>c <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">together_RIestThetas =</span> thetas_together<span class="sc">$</span>WLE,</span>
<span id="cb35-404"><a href="#cb35-404" aria-hidden="true" tabindex="-1"></a>           <span class="at">together_q3_rem =</span> thetas_q3_removed<span class="sc">$</span>WLE,</span>
<span id="cb35-405"><a href="#cb35-405" aria-hidden="true" tabindex="-1"></a>           <span class="at">separate_catR =</span> thetas_separate_catR,</span>
<span id="cb35-406"><a href="#cb35-406" aria-hidden="true" tabindex="-1"></a>           <span class="at">separate_RIestThetas =</span> thetas_separate<span class="sc">$</span>WLE,</span>
<span id="cb35-407"><a href="#cb35-407" aria-hidden="true" tabindex="-1"></a>           <span class="at">input_thetas =</span> input_thetas)</span>
<span id="cb35-408"><a href="#cb35-408" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-409"><a href="#cb35-409" aria-hidden="true" tabindex="-1"></a>c <span class="sc">%&gt;%</span> </span>
<span id="cb35-410"><a href="#cb35-410" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">everything</span>(),</span>
<span id="cb35-411"><a href="#cb35-411" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">"method"</span>,</span>
<span id="cb35-412"><a href="#cb35-412" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">"theta"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb35-413"><a href="#cb35-413" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> theta)) <span class="sc">+</span></span>
<span id="cb35-414"><a href="#cb35-414" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">50</span>) <span class="sc">+</span></span>
<span id="cb35-415"><a href="#cb35-415" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>method, <span class="at">axes =</span> <span class="st">"all_x"</span>) <span class="sc">+</span></span>
<span id="cb35-416"><a href="#cb35-416" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">1</span>))</span>
<span id="cb35-417"><a href="#cb35-417" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-418"><a href="#cb35-418" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-419"><a href="#cb35-419" aria-hidden="true" tabindex="-1"></a>Looks like the two step approach worked a lot better. Since the item parameter estimation is identical (both are using <span class="in">`eRm::PCM()`</span>), the reason should be the difference in theta estimation. The two-step approach uses <span class="in">`catR::thetaEst()`</span>, which probably is handling missing data in a more adequate way than <span class="in">`iarm::person_estimates()`</span>. Both approaches use the Weighted Likelihood Estimation to minimize bias.</span>
<span id="cb35-420"><a href="#cb35-420" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-421"><a href="#cb35-421" aria-hidden="true" tabindex="-1"></a><span class="fu">## Results </span></span>
<span id="cb35-422"><a href="#cb35-422" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-423"><a href="#cb35-423" aria-hidden="true" tabindex="-1"></a><span class="fu">### Summarised</span></span>
<span id="cb35-424"><a href="#cb35-424" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-425"><a href="#cb35-425" aria-hidden="true" tabindex="-1"></a>First, absolute differences in estimated thetas compared to input thetas.</span>
<span id="cb35-426"><a href="#cb35-426" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-429"><a href="#cb35-429" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb35-430"><a href="#cb35-430" aria-hidden="true" tabindex="-1"></a>c_diff <span class="ot">&lt;-</span> c <span class="sc">%&gt;%</span> </span>
<span id="cb35-431"><a href="#cb35-431" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">with_q3 =</span> <span class="fu">abs</span>(together_RIestThetas <span class="sc">-</span> input_thetas),</span>
<span id="cb35-432"><a href="#cb35-432" aria-hidden="true" tabindex="-1"></a>         <span class="at">q3_removed =</span> <span class="fu">abs</span>(together_q3_rem <span class="sc">-</span> input_thetas),</span>
<span id="cb35-433"><a href="#cb35-433" aria-hidden="true" tabindex="-1"></a>         <span class="at">q3_split =</span> <span class="fu">abs</span>(separate_catR <span class="sc">-</span> input_thetas)) <span class="sc">%&gt;%</span> </span>
<span id="cb35-434"><a href="#cb35-434" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">!</span><span class="fu">names</span>(c))</span>
<span id="cb35-435"><a href="#cb35-435" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb35-436"><a href="#cb35-436" aria-hidden="true" tabindex="-1"></a>c_diff <span class="sc">%&gt;%</span> </span>
<span id="cb35-437"><a href="#cb35-437" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">everything</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb35-438"><a href="#cb35-438" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> value)) <span class="sc">+</span></span>
<span id="cb35-439"><a href="#cb35-439" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">50</span>) <span class="sc">+</span></span>
<span id="cb35-440"><a href="#cb35-440" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> name, <span class="at">ncol =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb35-441"><a href="#cb35-441" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Absolute difference in logits"</span>,</span>
<span id="cb35-442"><a href="#cb35-442" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Comparing input thetas to estimated"</span>,</span>
<span id="cb35-443"><a href="#cb35-443" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Distribution of bias"</span>)</span>
<span id="cb35-444"><a href="#cb35-444" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-445"><a href="#cb35-445" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-446"><a href="#cb35-446" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-447"><a href="#cb35-447" aria-hidden="true" tabindex="-1"></a>No clear pattern differentiating these histograms, from my ocular inspection of the plot at least.</span>
<span id="cb35-448"><a href="#cb35-448" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-451"><a href="#cb35-451" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb35-452"><a href="#cb35-452" aria-hidden="true" tabindex="-1"></a>c_diff_descr <span class="ot">&lt;-</span> <span class="fu">descr</span>(c_diff) <span class="sc">%&gt;%</span> </span>
<span id="cb35-453"><a href="#cb35-453" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb35-454"><a href="#cb35-454" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>(<span class="st">"Parameter"</span>) </span>
<span id="cb35-455"><a href="#cb35-455" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-456"><a href="#cb35-456" aria-hidden="true" tabindex="-1"></a>c_diff_descr[<span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>,] <span class="sc">%&gt;%</span> </span>
<span id="cb35-457"><a href="#cb35-457" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">!</span>Parameter) <span class="sc">%&gt;%</span> </span>
<span id="cb35-458"><a href="#cb35-458" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb35-459"><a href="#cb35-459" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Parameter, <span class="at">y =</span> value, <span class="at">color =</span> name)) <span class="sc">+</span></span>
<span id="cb35-460"><a href="#cb35-460" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.85</span>) <span class="sc">+</span></span>
<span id="cb35-461"><a href="#cb35-461" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_d</span>(<span class="st">'Item set'</span>, <span class="at">end =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb35-462"><a href="#cb35-462" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Logits"</span>)</span>
<span id="cb35-463"><a href="#cb35-463" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-464"><a href="#cb35-464" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-467"><a href="#cb35-467" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb35-468"><a href="#cb35-468" aria-hidden="true" tabindex="-1"></a>c_diff_descr[<span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>,] <span class="sc">%&gt;%</span> </span>
<span id="cb35-469"><a href="#cb35-469" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.numeric, round, <span class="dv">3</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb35-470"><a href="#cb35-470" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl_rise</span>()</span>
<span id="cb35-471"><a href="#cb35-471" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-472"><a href="#cb35-472" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-473"><a href="#cb35-473" aria-hidden="true" tabindex="-1"></a>Still not large differences anywhere.</span>
<span id="cb35-474"><a href="#cb35-474" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-475"><a href="#cb35-475" aria-hidden="true" tabindex="-1"></a>We should look at the particular region where the DIF item is located, since it should have the most impact there.</span>
<span id="cb35-476"><a href="#cb35-476" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-477"><a href="#cb35-477" aria-hidden="true" tabindex="-1"></a><span class="fu">### Across the latent continuum</span></span>
<span id="cb35-478"><a href="#cb35-478" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-479"><a href="#cb35-479" aria-hidden="true" tabindex="-1"></a>First, the test information function (TIF) curve could be of interest to understand what to expect in terms of estimation bias due to reliability limitations.</span>
<span id="cb35-480"><a href="#cb35-480" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-481"><a href="#cb35-481" aria-hidden="true" tabindex="-1"></a><span class="fu">#### TIF original data</span></span>
<span id="cb35-482"><a href="#cb35-482" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-485"><a href="#cb35-485" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb35-486"><a href="#cb35-486" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 9</span></span>
<span id="cb35-487"><a href="#cb35-487" aria-hidden="true" tabindex="-1"></a><span class="fu">RItif</span>(d, <span class="at">samplePSI =</span> <span class="cn">TRUE</span>)</span>
<span id="cb35-488"><a href="#cb35-488" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-489"><a href="#cb35-489" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-490"><a href="#cb35-490" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-491"><a href="#cb35-491" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Theta estimation bias</span></span>
<span id="cb35-492"><a href="#cb35-492" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-495"><a href="#cb35-495" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb35-496"><a href="#cb35-496" aria-hidden="true" tabindex="-1"></a>c_diff <span class="sc">%&gt;%</span> </span>
<span id="cb35-497"><a href="#cb35-497" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_column</span>(<span class="at">Theta =</span> input_thetas) <span class="sc">%&gt;%</span> </span>
<span id="cb35-498"><a href="#cb35-498" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">!</span>Theta) <span class="sc">%&gt;%</span> </span>
<span id="cb35-499"><a href="#cb35-499" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb35-500"><a href="#cb35-500" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Theta, <span class="at">y =</span> value, <span class="at">color =</span> <span class="fu">factor</span>(name), <span class="at">fill =</span> <span class="fu">factor</span>(name))) <span class="sc">+</span></span>
<span id="cb35-501"><a href="#cb35-501" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.85</span>) <span class="sc">+</span></span>
<span id="cb35-502"><a href="#cb35-502" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"loess"</span>,</span>
<span id="cb35-503"><a href="#cb35-503" aria-hidden="true" tabindex="-1"></a>              <span class="fu">aes</span>(<span class="at">linetype =</span> <span class="fu">factor</span>(name)), <span class="at">alpha =</span> <span class="fl">0.15</span>) <span class="sc">+</span></span>
<span id="cb35-504"><a href="#cb35-504" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_ghibli_d</span>(<span class="st">"MononokeMedium"</span>, <span class="at">direction =</span> <span class="sc">-</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb35-505"><a href="#cb35-505" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_ghibli_d</span>(<span class="st">"MononokeMedium"</span>, <span class="at">direction =</span> <span class="sc">-</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb35-506"><a href="#cb35-506" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">color =</span> <span class="st">"Item set"</span>,</span>
<span id="cb35-507"><a href="#cb35-507" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Theta estimation bias"</span>,</span>
<span id="cb35-508"><a href="#cb35-508" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Absolute difference in logits"</span>) <span class="sc">+</span></span>
<span id="cb35-509"><a href="#cb35-509" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="st">"none"</span>, <span class="at">linetype =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb35-510"><a href="#cb35-510" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">1</span>))</span>
<span id="cb35-511"><a href="#cb35-511" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-512"><a href="#cb35-512" aria-hidden="true" tabindex="-1"></a>c_diff <span class="sc">%&gt;%</span> </span>
<span id="cb35-513"><a href="#cb35-513" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_column</span>(<span class="at">Theta =</span> input_thetas) <span class="sc">%&gt;%</span> </span>
<span id="cb35-514"><a href="#cb35-514" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">!</span>Theta) <span class="sc">%&gt;%</span> </span>
<span id="cb35-515"><a href="#cb35-515" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb35-516"><a href="#cb35-516" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Theta, <span class="at">y =</span> value, <span class="at">color =</span> <span class="fu">factor</span>(name), <span class="at">fill =</span> <span class="fu">factor</span>(name))) <span class="sc">+</span></span>
<span id="cb35-517"><a href="#cb35-517" aria-hidden="true" tabindex="-1"></a>  <span class="co">#geom_point(alpha = 0.85) +</span></span>
<span id="cb35-518"><a href="#cb35-518" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"loess"</span>,</span>
<span id="cb35-519"><a href="#cb35-519" aria-hidden="true" tabindex="-1"></a>              <span class="fu">aes</span>(<span class="at">linetype =</span> <span class="fu">factor</span>(name)), <span class="at">alpha =</span> <span class="fl">0.15</span>) <span class="sc">+</span></span>
<span id="cb35-520"><a href="#cb35-520" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_ghibli_d</span>(<span class="st">"MononokeMedium"</span>, <span class="at">direction =</span> <span class="sc">-</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb35-521"><a href="#cb35-521" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_ghibli_d</span>(<span class="st">"MononokeMedium"</span>, <span class="at">direction =</span> <span class="sc">-</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb35-522"><a href="#cb35-522" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">color =</span> <span class="st">"Item set"</span>,</span>
<span id="cb35-523"><a href="#cb35-523" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Theta estimation bias"</span>,</span>
<span id="cb35-524"><a href="#cb35-524" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Absolute difference in logits"</span>) <span class="sc">+</span></span>
<span id="cb35-525"><a href="#cb35-525" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="st">"none"</span>, <span class="at">linetype =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb35-526"><a href="#cb35-526" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">1</span>))</span>
<span id="cb35-527"><a href="#cb35-527" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-528"><a href="#cb35-528" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-529"><a href="#cb35-529" aria-hidden="true" tabindex="-1"></a>Item split seems to increase bias in the lower range, from -4 to +1.</span>
<span id="cb35-530"><a href="#cb35-530" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-531"><a href="#cb35-531" aria-hidden="true" tabindex="-1"></a>Keeping q3 and removing q3 are almost identical below 0.5, while removing q3 results in lower bias from 0.5 til 4 logits.</span>
<span id="cb35-532"><a href="#cb35-532" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-533"><a href="#cb35-533" aria-hidden="true" tabindex="-1"></a><span class="fu">#### `lordif` package</span></span>
<span id="cb35-534"><a href="#cb35-534" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-535"><a href="#cb35-535" aria-hidden="true" tabindex="-1"></a>Also, the <span class="in">`lordif`</span> package has a function to produce relevant output.</span>
<span id="cb35-536"><a href="#cb35-536" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-539"><a href="#cb35-539" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb35-540"><a href="#cb35-540" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb35-541"><a href="#cb35-541" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lordif)</span>
<span id="cb35-542"><a href="#cb35-542" aria-hidden="true" tabindex="-1"></a>g_dif <span class="ot">&lt;-</span> <span class="fu">lordif</span>(<span class="fu">as.data.frame</span>(d), <span class="fu">as.numeric</span>(dif.group), <span class="co"># make sure that the data is in a dataframe-object and that the DIF variable is numeric</span></span>
<span id="cb35-543"><a href="#cb35-543" aria-hidden="true" tabindex="-1"></a>                <span class="at">criterion =</span> <span class="fu">c</span>(<span class="st">"Chisqr"</span>), </span>
<span id="cb35-544"><a href="#cb35-544" aria-hidden="true" tabindex="-1"></a>                <span class="at">alpha =</span> <span class="fl">0.01</span>, </span>
<span id="cb35-545"><a href="#cb35-545" aria-hidden="true" tabindex="-1"></a>                <span class="at">beta.change =</span> <span class="fl">0.1</span>,</span>
<span id="cb35-546"><a href="#cb35-546" aria-hidden="true" tabindex="-1"></a>                <span class="at">model =</span> <span class="st">"GPCM"</span>,</span>
<span id="cb35-547"><a href="#cb35-547" aria-hidden="true" tabindex="-1"></a>                <span class="at">R2.change =</span> <span class="fl">0.02</span>)</span>
<span id="cb35-548"><a href="#cb35-548" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-549"><a href="#cb35-549" aria-hidden="true" tabindex="-1"></a>g_dif_sum <span class="ot">&lt;-</span> <span class="fu">summary</span>(g_dif)</span>
<span id="cb35-550"><a href="#cb35-550" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-551"><a href="#cb35-551" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-554"><a href="#cb35-554" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb35-555"><a href="#cb35-555" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb35-556"><a href="#cb35-556" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: false</span></span>
<span id="cb35-557"><a href="#cb35-557" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lordif)</span>
<span id="cb35-558"><a href="#cb35-558" aria-hidden="true" tabindex="-1"></a>g_dif <span class="ot">&lt;-</span> <span class="fu">lordif</span>(<span class="fu">as.data.frame</span>(d), <span class="fu">as.numeric</span>(dif.group), <span class="co"># make sure that the data is in a dataframe-object and that the DIF variable is numeric</span></span>
<span id="cb35-559"><a href="#cb35-559" aria-hidden="true" tabindex="-1"></a>                <span class="at">criterion =</span> <span class="fu">c</span>(<span class="st">"Chisqr"</span>), </span>
<span id="cb35-560"><a href="#cb35-560" aria-hidden="true" tabindex="-1"></a>                <span class="at">alpha =</span> <span class="fl">0.01</span>, </span>
<span id="cb35-561"><a href="#cb35-561" aria-hidden="true" tabindex="-1"></a>                <span class="at">beta.change =</span> <span class="fl">0.1</span>,</span>
<span id="cb35-562"><a href="#cb35-562" aria-hidden="true" tabindex="-1"></a>                <span class="at">model =</span> <span class="st">"GPCM"</span>,</span>
<span id="cb35-563"><a href="#cb35-563" aria-hidden="true" tabindex="-1"></a>                <span class="at">R2.change =</span> <span class="fl">0.02</span>)</span>
<span id="cb35-564"><a href="#cb35-564" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-565"><a href="#cb35-565" aria-hidden="true" tabindex="-1"></a>g_dif_sum <span class="ot">&lt;-</span> <span class="fu">summary</span>(g_dif)</span>
<span id="cb35-566"><a href="#cb35-566" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-567"><a href="#cb35-567" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-570"><a href="#cb35-570" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb35-571"><a href="#cb35-571" aria-hidden="true" tabindex="-1"></a><span class="co"># threshold values for colorizing the table below</span></span>
<span id="cb35-572"><a href="#cb35-572" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">=</span> <span class="fl">0.01</span></span>
<span id="cb35-573"><a href="#cb35-573" aria-hidden="true" tabindex="-1"></a>beta.change <span class="ot">=</span> <span class="fl">0.1</span></span>
<span id="cb35-574"><a href="#cb35-574" aria-hidden="true" tabindex="-1"></a>R2.change <span class="ot">=</span> <span class="fl">0.02</span></span>
<span id="cb35-575"><a href="#cb35-575" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-576"><a href="#cb35-576" aria-hidden="true" tabindex="-1"></a>g_dif_sum<span class="sc">$</span>stats <span class="sc">%&gt;%</span> </span>
<span id="cb35-577"><a href="#cb35-577" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb35-578"><a href="#cb35-578" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">!</span><span class="fu">all_of</span>(<span class="fu">c</span>(<span class="st">"df12"</span>,<span class="st">"df13"</span>,<span class="st">"df23"</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb35-579"><a href="#cb35-579" aria-hidden="true" tabindex="-1"></a>  <span class="fu">round</span>(<span class="dv">3</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb35-580"><a href="#cb35-580" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_column</span>(<span class="at">itemnr =</span> <span class="fu">names</span>(df), <span class="at">.before =</span> <span class="st">"ncat"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb35-581"><a href="#cb35-581" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">c</span>(chi12,chi13,chi23), <span class="sc">~</span> <span class="fu">cell_spec</span>(.x,</span>
<span id="cb35-582"><a href="#cb35-582" aria-hidden="true" tabindex="-1"></a>                               <span class="at">color =</span> <span class="fu">case_when</span>(</span>
<span id="cb35-583"><a href="#cb35-583" aria-hidden="true" tabindex="-1"></a>                                 .x <span class="sc">&lt;</span> alpha <span class="sc">~</span> <span class="st">"red"</span>,</span>
<span id="cb35-584"><a href="#cb35-584" aria-hidden="true" tabindex="-1"></a>                                 <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"black"</span></span>
<span id="cb35-585"><a href="#cb35-585" aria-hidden="true" tabindex="-1"></a>                               )))) <span class="sc">%&gt;%</span></span>
<span id="cb35-586"><a href="#cb35-586" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">starts_with</span>(<span class="st">"pseudo"</span>), <span class="sc">~</span> <span class="fu">cell_spec</span>(.x,</span>
<span id="cb35-587"><a href="#cb35-587" aria-hidden="true" tabindex="-1"></a>                               <span class="at">color =</span> <span class="fu">case_when</span>(</span>
<span id="cb35-588"><a href="#cb35-588" aria-hidden="true" tabindex="-1"></a>                                 .x <span class="sc">&gt;</span> R2.change <span class="sc">~</span> <span class="st">"red"</span>,</span>
<span id="cb35-589"><a href="#cb35-589" aria-hidden="true" tabindex="-1"></a>                                 <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"black"</span></span>
<span id="cb35-590"><a href="#cb35-590" aria-hidden="true" tabindex="-1"></a>                               )))) <span class="sc">%&gt;%</span></span>
<span id="cb35-591"><a href="#cb35-591" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">beta12 =</span>  <span class="fu">cell_spec</span>(beta12,</span>
<span id="cb35-592"><a href="#cb35-592" aria-hidden="true" tabindex="-1"></a>                               <span class="at">color =</span> <span class="fu">case_when</span>(</span>
<span id="cb35-593"><a href="#cb35-593" aria-hidden="true" tabindex="-1"></a>                                 beta12 <span class="sc">&gt;</span> beta.change <span class="sc">~</span> <span class="st">"red"</span>,</span>
<span id="cb35-594"><a href="#cb35-594" aria-hidden="true" tabindex="-1"></a>                                 <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"black"</span></span>
<span id="cb35-595"><a href="#cb35-595" aria-hidden="true" tabindex="-1"></a>                               ))) <span class="sc">%&gt;%</span> </span>
<span id="cb35-596"><a href="#cb35-596" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl_rise</span>()</span>
<span id="cb35-597"><a href="#cb35-597" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-598"><a href="#cb35-598" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-599"><a href="#cb35-599" aria-hidden="true" tabindex="-1"></a>This plot does not work in Quarto rendering, for some reason. I'll include a screenshot instead.</span>
<span id="cb35-600"><a href="#cb35-600" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-603"><a href="#cb35-603" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb35-604"><a href="#cb35-604" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(g_dif, <span class="fu">graphics.off</span>())</span>
<span id="cb35-605"><a href="#cb35-605" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-606"><a href="#cb35-606" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-607"><a href="#cb35-607" aria-hidden="true" tabindex="-1"></a><span class="al">![lordif_plot](dif_magnitude_lordif.png)</span></span>
</code><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->



</body></html>