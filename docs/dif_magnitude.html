<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="author" content="Magnus Johansson">
<meta name="dcterms.date" content="2024-10-25">
<title>Rasch DIF magnitude &amp; item split – R, Rasch, etc</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><script src="site_libs/kePrint-0.0.1/kePrint.js"></script><link href="site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<link rel="stylesheet" href="styles.css">
<meta property="og:title" content="Rasch DIF magnitude &amp; item split – R, Rasch, etc">
<meta property="og:description" content="Brief exploration of Differential Item Functioning in R">
<meta property="og:image" content="https://pgmj.github.io/data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg==">
<meta property="og:site_name" content="R, Rasch, etc">
<meta name="twitter:title" content="Rasch DIF magnitude &amp; item split – R, Rasch, etc">
<meta name="twitter:description" content="Brief exploration of Differential Item Functioning in R">
<meta name="twitter:image" content="https://pgmj.github.io/data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg==">
<meta name="twitter:card" content="summary_large_image">
</head>
<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="navbar navbar-expand-lg " data-bs-theme="dark"><div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">R, Rasch, etc</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
<li class="nav-item">
    <a class="nav-link" href="./index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./raschrvignette/RaschRvign.html"> 
<span class="menu-text">RISEkbmRasch vignette</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./about.html"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-blog" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Blog</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-blog">
<li>
    <a class="dropdown-item" href="./parameterizedQ.html">
 <span class="dropdown-text">Automating reports with Quarto</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./latentResp/LatentResponse.html">
 <span class="dropdown-text">What’s in a latent trait score?</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./SkolverketAPI/skolverketapi.html">
 <span class="dropdown-text">Data retrieval with R using API calls</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./powerviz.html">
 <span class="dropdown-text">Power analysis for multilevel models</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./datawrangling.html">
 <span class="dropdown-text">Data wrangling for psychometrics in R</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./simcutoffs.html">
 <span class="dropdown-text">Simulation based cutoff values for Rasch item fit and residual correlations</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./est_comp.html">
 <span class="dropdown-text">Comparing Rasch packages/estimators</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./dif_magnitude.html">
 <span class="dropdown-text">Rasch DIF magnitude &amp; item split</span></a>
  </li>  
    </ul>
</li>
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/pgmj/pgmj.github.io"> <i class="bi bi-github" role="img" aria-label="GitHub">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
</div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav><div id="quarto-announcement" data-announcement-id="f2201fbbefb1e9b8685bd91e4d0da5c8" class="alert alert-primary hidden">
<i class="bi bi-info-circle quarto-announcement-icon"></i><div class="quarto-announcement-content">
<p><strong>Note:</strong> The RISEkbmRasch vignette has new material on conditional item fit and simulation based cutoff values.</p>
</div>
<i class="bi bi-x-lg quarto-announcement-action"></i>
</div>
</header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Table of contents</h2>
   
  <ul>
<li>
<a href="#background" id="toc-background" class="nav-link active" data-scroll-target="#background"><span class="header-section-number">1</span> Background</a>
  <ul class="collapse">
<li><a href="#simulate-response-data" id="toc-simulate-response-data" class="nav-link" data-scroll-target="#simulate-response-data"><span class="header-section-number">1.1</span> Simulate response data</a></li>
  </ul>
</li>
  <li>
<a href="#dif-assessment" id="toc-dif-assessment" class="nav-link" data-scroll-target="#dif-assessment"><span class="header-section-number">2</span> DIF assessment</a>
  <ul class="collapse">
<li><a href="#lr-test" id="toc-lr-test" class="nav-link" data-scroll-target="#lr-test"><span class="header-section-number">2.1</span> LR-test</a></li>
  <li><a href="#partial-gamma" id="toc-partial-gamma" class="nav-link" data-scroll-target="#partial-gamma"><span class="header-section-number">2.2</span> Partial gamma</a></li>
  <li><a href="#psychotree" id="toc-psychotree" class="nav-link" data-scroll-target="#psychotree"><span class="header-section-number">2.3</span> Psychotree</a></li>
  <li><a href="#item-split" id="toc-item-split" class="nav-link" data-scroll-target="#item-split"><span class="header-section-number">2.4</span> Item split</a></li>
  <li><a href="#estimating-thetas" id="toc-estimating-thetas" class="nav-link" data-scroll-target="#estimating-thetas"><span class="header-section-number">2.5</span> Estimating thetas</a></li>
  <li><a href="#comparing-item-parameters" id="toc-comparing-item-parameters" class="nav-link" data-scroll-target="#comparing-item-parameters"><span class="header-section-number">2.6</span> Comparing item parameters</a></li>
  <li><a href="#theta-estimation-investigated" id="toc-theta-estimation-investigated" class="nav-link" data-scroll-target="#theta-estimation-investigated"><span class="header-section-number">2.7</span> Theta estimation investigated</a></li>
  </ul>
</li>
  <li>
<a href="#results" id="toc-results" class="nav-link" data-scroll-target="#results"><span class="header-section-number">3</span> Results</a>
  <ul class="collapse">
<li><a href="#summarised" id="toc-summarised" class="nav-link" data-scroll-target="#summarised"><span class="header-section-number">3.1</span> Summarised</a></li>
  <li><a href="#across-the-latent-continuum" id="toc-across-the-latent-continuum" class="nav-link" data-scroll-target="#across-the-latent-continuum"><span class="header-section-number">3.2</span> Across the latent continuum</a></li>
  <li><a href="#statistical-analysis" id="toc-statistical-analysis" class="nav-link" data-scroll-target="#statistical-analysis"><span class="header-section-number">3.4</span> Statistical analysis</a></li>
  </ul>
</li>
  <li><a href="#session-info" id="toc-session-info" class="nav-link" data-scroll-target="#session-info"><span class="header-section-number">4</span> Session info</a></li>
  </ul></nav>
    </div>
<!-- main -->
<main class="content column-page-left" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Rasch DIF magnitude &amp; item split</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
<p class="subtitle lead">Brief exploration of Differential Item Functioning in R</p>
</div>


<div class="quarto-title-meta-author column-page-left">
  <div class="quarto-title-meta-heading">Author</div>
  <div class="quarto-title-meta-heading">Affiliation</div>
  
    <div class="quarto-title-meta-contents">
    <p class="author">Magnus Johansson <a href="https://orcid.org/0000-0003-1669-592X" class="quarto-title-author-orcid"> <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg=="></a></p>
  </div>
  <div class="quarto-title-meta-contents">
        <p class="affiliation">
            <a href="https://www.ri.se/en/shic">
            RISE Research Institutes of Sweden
            </a>
          </p>
      </div>
  </div>

<div class="quarto-title-meta column-page-left">

      
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">October 25, 2024</p>
    </div>
  </div>
  
    
  </div>
  


</header><section id="background" class="level2" data-number="1"><h2 data-number="1" class="anchored" data-anchor-id="background">
<span class="header-section-number">1</span> Background</h2>
<p>Out of interest of better understanding som aspects of differential item functioning (DIF, a form of invariance test):</p>
<ul>
<li>how much does DIF affect estimated thetas (factor scores)?</li>
<li>how to do item-split in R (creating separate items for subgroups from one item with problematic DIF)</li>
<li>how an item-split compares to removing the item (and keeping the DIF item) in terms of absolute differences in estimated thetas</li>
</ul>
<p>We’ll use simulated data in order to have knowledge of the thetas used to generate response data (“input thetas” in the text below), and make objective comparisons using the different estimated thetas.</p>
<p>Ideally, this would be a simulation study where we create lots of datasets with a systematic variation in some parameters to investigate effects. But maybe this is a first step towards that.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">eRm</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">iarm</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/pgmj/RISEkbmRasch">RISEkbmRasch</a></span><span class="op">)</span> <span class="co"># devtools::install_github("pgmj/RISEkbmRasch", dependencies = TRUE)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/dcomtois/summarytools">summarytools</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ewenme.github.io/ghibli/">ghibli</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co">### some commands exist in multiple packages, here we define preferred ones that are frequently used</span></span>
<span><span class="va">select</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="va"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span></span>
<span><span class="va">count</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="va"><a href="https://dplyr.tidyverse.org/reference/count.html">count</a></span></span>
<span><span class="va">recode</span> <span class="op">&lt;-</span> <span class="fu">car</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/car/man/recode.html">recode</a></span></span>
<span><span class="va">rename</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="va"><a href="https://dplyr.tidyverse.org/reference/rename.html">rename</a></span></span>
<span></span>
<span><span class="va">theme_rise</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">fontfamily</span> <span class="op">=</span> <span class="st">"Lato"</span>, <span class="va">axissize</span> <span class="op">=</span> <span class="fl">13</span>, <span class="va">titlesize</span> <span class="op">=</span> <span class="fl">15</span>,</span>
<span>                       <span class="va">margins</span> <span class="op">=</span> <span class="fl">12</span>, <span class="va">axisface</span> <span class="op">=</span> <span class="st">"plain"</span>, <span class="va">panelDist</span> <span class="op">=</span> <span class="fl">0.6</span>, <span class="va">...</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span></span>
<span>    text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>family <span class="op">=</span> <span class="va">fontfamily</span><span class="op">)</span>,</span>
<span>    axis.title.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span></span>
<span>      margin <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">margin</a></span><span class="op">(</span>t <span class="op">=</span> <span class="va">margins</span><span class="op">)</span>,</span>
<span>      size <span class="op">=</span> <span class="va">axissize</span></span>
<span>    <span class="op">)</span>,</span>
<span>    axis.title.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span></span>
<span>      margin <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">margin</a></span><span class="op">(</span>r <span class="op">=</span> <span class="va">margins</span><span class="op">)</span>,</span>
<span>      size <span class="op">=</span> <span class="va">axissize</span></span>
<span>    <span class="op">)</span>,</span>
<span>    plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span></span>
<span>      face <span class="op">=</span> <span class="st">"bold"</span>,</span>
<span>      size <span class="op">=</span> <span class="va">titlesize</span></span>
<span>    <span class="op">)</span>,</span>
<span>    axis.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span></span>
<span>      face <span class="op">=</span> <span class="va">axisface</span></span>
<span>    <span class="op">)</span>,</span>
<span>    plot.caption <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span></span>
<span>      face <span class="op">=</span> <span class="st">"italic"</span></span>
<span>    <span class="op">)</span>,</span>
<span>    legend.text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>family <span class="op">=</span> <span class="va">fontfamily</span><span class="op">)</span>,</span>
<span>    legend.background <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_rect</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"lightgrey"</span><span class="op">)</span>,</span>
<span>    strip.background <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_rect</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"lightgrey"</span><span class="op">)</span>,</span>
<span>    panel.spacing <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html">unit</a></span><span class="op">(</span><span class="va">panelDist</span>, <span class="st">"cm"</span>, data <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span>,</span>
<span>    panel.border <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_rect</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"grey"</span>, fill <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span>,</span>
<span>    <span class="va">...</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme_get.html">theme_set</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/RISEkbmRasch/man/theme_rise.html">theme_rise</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="simulate-response-data" class="level3" data-number="1.1"><h3 data-number="1.1" class="anchored" data-anchor-id="simulate-response-data">
<span class="header-section-number">1.1</span> Simulate response data</h3>
<p>First define input parameters for items.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># make a tibble/dataframe also, for possible later use</span></span>
<span><span class="va">inputParams1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span></span>
<span>  q1  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1.2</span>, <span class="fl">1.8</span>, <span class="fl">2.4</span><span class="op">)</span>,</span>
<span>  q2  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1.3</span>, <span class="op">-</span><span class="fl">0.5</span>, <span class="fl">0.5</span><span class="op">)</span>,</span>
<span>  q3a <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.3</span>, <span class="fl">0.3</span>, <span class="fl">1.2</span><span class="op">)</span>, <span class="co"># this is the DIF item</span></span>
<span>  q3b <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.3</span><span class="op">+</span><span class="fl">1</span>, <span class="fl">0.3</span><span class="op">+</span><span class="fl">1</span>, <span class="fl">1.2</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span>, <span class="co"># this is the DIF item</span></span>
<span>  q4  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">0.6</span>, <span class="fl">1.6</span><span class="op">)</span>,</span>
<span>  q5  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.3</span>, <span class="fl">0.7</span>, <span class="fl">1.5</span><span class="op">)</span>,</span>
<span>  q6  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1.6</span>, <span class="op">-</span><span class="fl">1</span>, <span class="op">-</span><span class="fl">0.3</span><span class="op">)</span>,</span>
<span>  q7  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1.8</span>, <span class="fl">2.5</span><span class="op">)</span>,</span>
<span>  q8  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1.3</span>, <span class="op">-</span><span class="fl">0.7</span>, <span class="fl">0.4</span><span class="op">)</span>,</span>
<span>  q9  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.8</span>, <span class="fl">1.4</span>, <span class="fl">1.9</span><span class="op">)</span>,</span>
<span>  q10 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.25</span>, <span class="fl">1.25</span>, <span class="fl">2.15</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># center to 0</span></span>
<span><span class="va">inputParams1c</span> <span class="op">&lt;-</span> <span class="va">inputParams1</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">inputParams1</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># item list for simulation for group 1</span></span>
<span><span class="va">tlist1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>  q1 <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">inputParams1c</span><span class="op">[</span><span class="fl">1</span>,<span class="op">]</span><span class="op">)</span>,</span>
<span>  q2 <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">inputParams1c</span><span class="op">[</span><span class="fl">2</span>,<span class="op">]</span><span class="op">)</span>,</span>
<span>  q3 <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">inputParams1c</span><span class="op">[</span><span class="fl">3</span>,<span class="op">]</span><span class="op">)</span>, <span class="co"># this is the DIF item</span></span>
<span>  q4 <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">inputParams1c</span><span class="op">[</span><span class="fl">5</span>,<span class="op">]</span><span class="op">)</span>,</span>
<span>  q5 <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">inputParams1c</span><span class="op">[</span><span class="fl">6</span>,<span class="op">]</span><span class="op">)</span>,</span>
<span>  q6 <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">inputParams1c</span><span class="op">[</span><span class="fl">7</span>,<span class="op">]</span><span class="op">)</span>,</span>
<span>  q7 <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">inputParams1c</span><span class="op">[</span><span class="fl">8</span>,<span class="op">]</span><span class="op">)</span>,</span>
<span>  q8 <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">inputParams1c</span><span class="op">[</span><span class="fl">9</span>,<span class="op">]</span><span class="op">)</span>,</span>
<span>  q9 <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">inputParams1c</span><span class="op">[</span><span class="fl">10</span>,<span class="op">]</span><span class="op">)</span>,</span>
<span>  q10 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">inputParams1c</span><span class="op">[</span><span class="fl">11</span>,<span class="op">]</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># item list for simulation for group 2</span></span>
<span><span class="va">tlist2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>  q1 <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">inputParams1c</span><span class="op">[</span><span class="fl">1</span>,<span class="op">]</span><span class="op">)</span>,</span>
<span>  q2 <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">inputParams1c</span><span class="op">[</span><span class="fl">2</span>,<span class="op">]</span><span class="op">)</span>,</span>
<span>  q3 <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">inputParams1c</span><span class="op">[</span><span class="fl">4</span>,<span class="op">]</span><span class="op">)</span>, <span class="co"># this is the DIF item</span></span>
<span>  q4 <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">inputParams1c</span><span class="op">[</span><span class="fl">5</span>,<span class="op">]</span><span class="op">)</span>,</span>
<span>  q5 <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">inputParams1c</span><span class="op">[</span><span class="fl">6</span>,<span class="op">]</span><span class="op">)</span>,</span>
<span>  q6 <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">inputParams1c</span><span class="op">[</span><span class="fl">7</span>,<span class="op">]</span><span class="op">)</span>,</span>
<span>  q7 <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">inputParams1c</span><span class="op">[</span><span class="fl">8</span>,<span class="op">]</span><span class="op">)</span>,</span>
<span>  q8 <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">inputParams1c</span><span class="op">[</span><span class="fl">9</span>,<span class="op">]</span><span class="op">)</span>,</span>
<span>  q9 <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">inputParams1c</span><span class="op">[</span><span class="fl">10</span>,<span class="op">]</span><span class="op">)</span>,</span>
<span>  q10 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">inputParams1c</span><span class="op">[</span><span class="fl">11</span>,<span class="op">]</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Then generate random thetas that we save to file to be able to reproduce the analysis.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># simulate thetas</span></span>
<span><span class="va">thetas1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">300</span>, mean <span class="op">=</span> <span class="fl">0</span>, sd <span class="op">=</span> <span class="fl">1.5</span><span class="op">)</span></span>
<span><span class="va">thetas2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">300</span>, mean <span class="op">=</span> <span class="fl">0</span>, sd <span class="op">=</span> <span class="fl">1.5</span><span class="op">)</span></span>
<span></span>
<span><span class="va">input_thetas</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">thetas1</span>,<span class="va">thetas2</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># simulate response data based on the above defined item thresholds</span></span>
<span><span class="va">td1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/RISEkbmRasch/man/SimPartialScore.html">SimPartialScore</a></span><span class="op">(</span></span>
<span>  deltaslist <span class="op">=</span> <span class="va">tlist1</span>,</span>
<span>  thetavec <span class="op">=</span> <span class="va">thetas1</span></span>
<span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">td2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/RISEkbmRasch/man/SimPartialScore.html">SimPartialScore</a></span><span class="op">(</span></span>
<span>  deltaslist <span class="op">=</span> <span class="va">tlist2</span>,</span>
<span>  thetavec <span class="op">=</span> <span class="va">thetas2</span></span>
<span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="va">td1</span>,<span class="va">td2</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://tibble.tidyverse.org/reference/add_column.html">add_column</a></span><span class="op">(</span>group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, each <span class="op">=</span> <span class="fl">300</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">dif.group</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">d</span><span class="op">$</span><span class="va">group</span><span class="op">)</span></span>
<span><span class="va">d</span><span class="op">$</span><span class="va">group</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span></span>
<span><span class="va">all_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>simResponses <span class="op">=</span> <span class="va">d</span>,</span>
<span>                 dif_group <span class="op">=</span> <span class="va">dif.group</span>,</span>
<span>                 input_thetas <span class="op">=</span> <span class="va">input_thetas</span><span class="op">)</span></span>
<span><span class="co"># save simulated data for reproducibility</span></span>
<span><span class="co">#saveRDS(all_data,"dif_magnitude_1_0.Rdata")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># read simulated data for reprodubility</span></span>
<span><span class="va">all_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span><span class="op">(</span><span class="st">"dif_magnitude_1_0.Rdata"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">d</span> <span class="op">&lt;-</span> <span class="va">all_data</span><span class="op">$</span><span class="va">simResponses</span></span>
<span><span class="va">dif.group</span> <span class="op">&lt;-</span> <span class="va">all_data</span><span class="op">$</span><span class="va">dif_group</span></span>
<span><span class="va">input_thetas</span> <span class="op">&lt;-</span> <span class="va">all_data</span><span class="op">$</span><span class="va">input_thetas</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>We now have 10 items with 4 categories each. There are 600 respondents in all, with 300 showing differential item functioning for one item (item q3). DIF is induced at +1 logit uniform difference in location (all thresholds for item q3 are +1 logits).</p>
</section></section><section id="dif-assessment" class="level2" data-number="2"><h2 data-number="2" class="anchored" data-anchor-id="dif-assessment">
<span class="header-section-number">2</span> DIF assessment</h2>
<p>Let’s test for DIF with some different methods.</p>
<section id="lr-test" class="level3" data-number="2.1"><h3 data-number="2.1" class="anchored" data-anchor-id="lr-test">
<span class="header-section-number">2.1</span> LR-test</h3>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/RISEkbmRasch/man/RIdifTableLR.html">RIdifTableLR</a></span><span class="op">(</span><span class="va">d</span>, <span class="va">dif.group</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table data-quarto-disable-processing="true" style="width:65%; font-size: 14px;  font-family: Arial; margin-left: auto; margin-right: auto;border-bottom: 0;" class="table table-striped table-hover lightable-classic">
<thead>
<tr>
<th style="empty-cells: hide;" colspan="1"></th>
<th style="padding-bottom:0; padding-left:5px;padding-right:5px;text-align: center; font-weight: bold; " colspan="4"><div style="border-bottom: 1px solid #111111; margin-bottom: -1px; ">Item locations</div></th>
<th style="padding-bottom:0; padding-left:5px;padding-right:5px;text-align: center; font-weight: bold; " colspan="3"><div style="border-bottom: 1px solid #111111; margin-bottom: -1px; ">Standard errors</div></th>
</tr>
<tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> Item </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> 1 </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> 2 </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> MaxDiff </th>
   <th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> All </th>
   <th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> SE_1 </th>
   <th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> SE_2 </th>
   <th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> SE_All </th>
  </tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;"> q1 </td>
   <td style="text-align:left;"> <span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: lightblue !important;">1.561</span> </td>
   <td style="text-align:left;"> <span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: burlywood !important;">1.309</span> </td>
   <td style="text-align:left;font-weight: bold;"> <span style="     color: black !important;">0.252</span> </td>
   <td style="text-align:right;font-style: italic;"> 1.425 </td>
   <td style="text-align:right;"> 0.215 </td>
   <td style="text-align:right;"> 0.221 </td>
   <td style="text-align:right;font-style: italic;"> 0.153 </td>
  </tr>
<tr>
<td style="text-align:left;"> q2 </td>
   <td style="text-align:left;"> <span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: lightblue !important;">-0.691</span> </td>
   <td style="text-align:left;"> <span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: burlywood !important;">-0.888</span> </td>
   <td style="text-align:left;font-weight: bold;"> <span style="     color: black !important;">0.197</span> </td>
   <td style="text-align:right;font-style: italic;"> -0.792 </td>
   <td style="text-align:right;"> 0.205 </td>
   <td style="text-align:right;"> 0.198 </td>
   <td style="text-align:right;font-style: italic;"> 0.142 </td>
  </tr>
<tr>
<td style="text-align:left;"> q3 </td>
   <td style="text-align:left;"> <span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: burlywood !important;">0.14</span> </td>
   <td style="text-align:left;"> <span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: lightblue !important;">0.899</span> </td>
   <td style="text-align:left;font-weight: bold;"> <span style="     color: red !important;">0.759</span> </td>
   <td style="text-align:right;font-style: italic;"> 0.492 </td>
   <td style="text-align:right;"> 0.186 </td>
   <td style="text-align:right;"> 0.196 </td>
   <td style="text-align:right;font-style: italic;"> 0.132 </td>
  </tr>
<tr>
<td style="text-align:left;"> q4 </td>
   <td style="text-align:left;"> <span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: lightblue !important;">0.641</span> </td>
   <td style="text-align:left;"> <span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: burlywood !important;">0.628</span> </td>
   <td style="text-align:left;font-weight: bold;"> <span style="     color: black !important;">0.013</span> </td>
   <td style="text-align:right;font-style: italic;"> 0.634 </td>
   <td style="text-align:right;"> 0.184 </td>
   <td style="text-align:right;"> 0.192 </td>
   <td style="text-align:right;font-style: italic;"> 0.131 </td>
  </tr>
<tr>
<td style="text-align:left;"> q5 </td>
   <td style="text-align:left;"> <span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: lightblue !important;">0.345</span> </td>
   <td style="text-align:left;"> <span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: burlywood !important;">0.133</span> </td>
   <td style="text-align:left;font-weight: bold;"> <span style="     color: black !important;">0.212</span> </td>
   <td style="text-align:right;font-style: italic;"> 0.233 </td>
   <td style="text-align:right;"> 0.183 </td>
   <td style="text-align:right;"> 0.181 </td>
   <td style="text-align:right;font-style: italic;"> 0.128 </td>
  </tr>
<tr>
<td style="text-align:left;"> q6 </td>
   <td style="text-align:left;"> <span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: lightblue !important;">-1.285</span> </td>
   <td style="text-align:left;"> <span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: burlywood !important;">-1.345</span> </td>
   <td style="text-align:left;font-weight: bold;"> <span style="     color: black !important;">0.06</span> </td>
   <td style="text-align:right;font-style: italic;"> -1.307 </td>
   <td style="text-align:right;"> 0.244 </td>
   <td style="text-align:right;"> 0.222 </td>
   <td style="text-align:right;font-style: italic;"> 0.164 </td>
  </tr>
<tr>
<td style="text-align:left;"> q7 </td>
   <td style="text-align:left;"> <span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: burlywood !important;">1.411</span> </td>
   <td style="text-align:left;"> <span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: lightblue !important;">1.46</span> </td>
   <td style="text-align:left;font-weight: bold;"> <span style="     color: black !important;">0.049</span> </td>
   <td style="text-align:right;font-style: italic;"> 1.419 </td>
   <td style="text-align:right;"> 0.206 </td>
   <td style="text-align:right;"> 0.223 </td>
   <td style="text-align:right;font-style: italic;"> 0.151 </td>
  </tr>
<tr>
<td style="text-align:left;"> q8 </td>
   <td style="text-align:left;"> <span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: lightblue !important;">-0.87</span> </td>
   <td style="text-align:left;"> <span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: burlywood !important;">-0.891</span> </td>
   <td style="text-align:left;font-weight: bold;"> <span style="     color: black !important;">0.021</span> </td>
   <td style="text-align:right;font-style: italic;"> -0.873 </td>
   <td style="text-align:right;"> 0.219 </td>
   <td style="text-align:right;"> 0.197 </td>
   <td style="text-align:right;font-style: italic;"> 0.146 </td>
  </tr>
<tr>
<td style="text-align:left;"> q9 </td>
   <td style="text-align:left;"> <span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: lightblue !important;">0.546</span> </td>
   <td style="text-align:left;"> <span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: burlywood !important;">0.445</span> </td>
   <td style="text-align:left;font-weight: bold;"> <span style="     color: black !important;">0.101</span> </td>
   <td style="text-align:right;font-style: italic;"> 0.485 </td>
   <td style="text-align:right;"> 0.183 </td>
   <td style="text-align:right;"> 0.185 </td>
   <td style="text-align:right;font-style: italic;"> 0.129 </td>
  </tr>
<tr>
<td style="text-align:left;"> q10 </td>
   <td style="text-align:left;"> <span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: burlywood !important;">0.919</span> </td>
   <td style="text-align:left;"> <span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: lightblue !important;">0.927</span> </td>
   <td style="text-align:left;font-weight: bold;"> <span style="     color: black !important;">0.008</span> </td>
   <td style="text-align:right;font-style: italic;"> 0.916 </td>
   <td style="text-align:right;"> 0.187 </td>
   <td style="text-align:right;"> 0.195 </td>
   <td style="text-align:right;font-style: italic;"> 0.134 </td>
  </tr>
</tbody>
<tfoot>
<tr><td style="padding: 0; " colspan="100%"><span style="font-style: italic;">Note: </span></td></tr>
<tr><td style="padding: 0; " colspan="100%">
<sup></sup> Values highlighted in red are above the chosen cutoff 0.5 logits. Background color brown and blue indicate the lowest and highest values among the DIF groups.</td></tr>
</tfoot>
</table>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/RISEkbmRasch/man/RIdifThreshFigLR.html">RIdifThreshFigLR</a></span><span class="op">(</span><span class="va">d</span>, <span class="va">dif.group</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="dif_magnitude_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="1050"></p>
</figure>
</div>
</div>
</div>
</section><section id="partial-gamma" class="level3" data-number="2.2"><h3 data-number="2.2" class="anchored" data-anchor-id="partial-gamma">
<span class="header-section-number">2.2</span> Partial gamma</h3>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/RISEkbmRasch/man/RIpartgamDIF.html">RIpartgamDIF</a></span><span class="op">(</span><span class="va">d</span>, <span class="va">dif.group</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table data-quarto-disable-processing="true" style="width:65%; font-size: 14px;  font-family: Arial; margin-left: auto; margin-right: auto;" class="table table-striped table-hover lightable-classic">
<thead><tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> Item </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> Partial gamma </th>
   <th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> SE </th>
   <th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> Lower CI </th>
   <th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> Upper CI </th>
   <th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> Adjusted p-value (BH) </th>
  </tr></thead>
<tbody><tr>
<td style="text-align:left;"> q3 </td>
   <td style="text-align:left;"> <span style="     color: red !important;">-0.454</span> </td>
   <td style="text-align:right;"> 0.071 </td>
   <td style="text-align:right;"> -0.594 </td>
   <td style="text-align:right;"> -0.314 </td>
   <td style="text-align:right;"> 0 </td>
  </tr></tbody>
</table>
</div>
</div>
</section><section id="psychotree" class="level3" data-number="2.3"><h3 data-number="2.3" class="anchored" data-anchor-id="psychotree">
<span class="header-section-number">2.3</span> Psychotree</h3>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/RISEkbmRasch/man/RIdifTable.html">RIdifTable</a></span><span class="op">(</span><span class="va">d</span>, <span class="va">dif.group</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="dif_magnitude_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="1050"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<table class="table table-striped" style="font-size: 15px; font-family: Lato">
<thead><tr>
<th style="text-align:right;">
Item
</th>
<th style="text-align:right;">
2
</th>
<th style="text-align:right;">
3
</th>
<th style="text-align:right;">
Mean location
</th>
<th style="text-align:right;">
StDev
</th>
<th style="text-align:right;">
MaxDiff
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:right;">
q1
</td>
<td style="text-align:right;">
1.289
</td>
<td style="text-align:right;">
1.041
</td>
<td style="text-align:right;">
1.165
</td>
<td style="text-align:right;">
0.176
</td>
<td style="text-align:right;">
<span style="color: black">0.248</span>
</td>
</tr>
<tr>
<td style="text-align:right;">
q2
</td>
<td style="text-align:right;">
-0.962
</td>
<td style="text-align:right;">
-1.155
</td>
<td style="text-align:right;">
-1.059
</td>
<td style="text-align:right;">
0.136
</td>
<td style="text-align:right;">
<span style="color: black">0.193</span>
</td>
</tr>
<tr>
<td style="text-align:right;">
q3
</td>
<td style="text-align:right;">
-0.132
</td>
<td style="text-align:right;">
0.631
</td>
<td style="text-align:right;">
0.250
</td>
<td style="text-align:right;">
0.540
</td>
<td style="text-align:right;">
<span style="color: red">0.763</span>
</td>
</tr>
<tr>
<td style="text-align:right;">
q4
</td>
<td style="text-align:right;">
0.369
</td>
<td style="text-align:right;">
0.360
</td>
<td style="text-align:right;">
0.365
</td>
<td style="text-align:right;">
0.006
</td>
<td style="text-align:right;">
<span style="color: black">0.009</span>
</td>
</tr>
<tr>
<td style="text-align:right;">
q5
</td>
<td style="text-align:right;">
0.073
</td>
<td style="text-align:right;">
-0.135
</td>
<td style="text-align:right;">
-0.031
</td>
<td style="text-align:right;">
0.147
</td>
<td style="text-align:right;">
<span style="color: black">0.208</span>
</td>
</tr>
<tr>
<td style="text-align:right;">
q6
</td>
<td style="text-align:right;">
-1.557
</td>
<td style="text-align:right;">
-1.613
</td>
<td style="text-align:right;">
-1.585
</td>
<td style="text-align:right;">
0.039
</td>
<td style="text-align:right;">
<span style="color: black">0.056</span>
</td>
</tr>
<tr>
<td style="text-align:right;">
q7
</td>
<td style="text-align:right;">
1.140
</td>
<td style="text-align:right;">
1.192
</td>
<td style="text-align:right;">
1.166
</td>
<td style="text-align:right;">
0.037
</td>
<td style="text-align:right;">
<span style="color: black">0.053</span>
</td>
</tr>
<tr>
<td style="text-align:right;">
q8
</td>
<td style="text-align:right;">
-1.142
</td>
<td style="text-align:right;">
-1.159
</td>
<td style="text-align:right;">
-1.150
</td>
<td style="text-align:right;">
0.012
</td>
<td style="text-align:right;">
<span style="color: black">0.017</span>
</td>
</tr>
<tr>
<td style="text-align:right;">
q9
</td>
<td style="text-align:right;">
0.274
</td>
<td style="text-align:right;">
0.177
</td>
<td style="text-align:right;">
0.226
</td>
<td style="text-align:right;">
0.068
</td>
<td style="text-align:right;">
<span style="color: black">0.097</span>
</td>
</tr>
<tr>
<td style="text-align:right;">
q10
</td>
<td style="text-align:right;">
0.647
</td>
<td style="text-align:right;">
0.659
</td>
<td style="text-align:right;">
0.653
</td>
<td style="text-align:right;">
0.008
</td>
<td style="text-align:right;">
<span style="color: black">0.012</span>
</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>DIF clearly shown.</p>
</section><section id="item-split" class="level3" data-number="2.4"><h3 data-number="2.4" class="anchored" data-anchor-id="item-split">
<span class="header-section-number">2.4</span> Item split</h3>
<p>Now, we’ll do an item split and compare thetas for both groups with and without split, and also with the DIF item removed.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">thetas_together</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/RISEkbmRasch/man/RIestThetas.html">RIestThetas</a></span><span class="op">(</span><span class="va">d</span><span class="op">)</span></span>
<span></span>
<span><span class="va">thetas_q3_removed</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/RISEkbmRasch/man/RIestThetas.html">RIestThetas</a></span><span class="op">(</span><span class="va">d</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="op">!</span><span class="va">q3</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">d2</span> <span class="op">&lt;-</span> <span class="va">d</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://tibble.tidyverse.org/reference/add_column.html">add_column</a></span><span class="op">(</span>group <span class="op">=</span> <span class="va">dif.group</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>q3a <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/if_else.html">if_else</a></span><span class="op">(</span><span class="va">group</span> <span class="op">==</span> <span class="fl">1</span>, <span class="va">q3</span>, <span class="cn">NA</span><span class="op">)</span>, </span>
<span>         q3b <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/if_else.html">if_else</a></span><span class="op">(</span><span class="va">group</span> <span class="op">==</span> <span class="fl">2</span>, <span class="va">q3</span>, <span class="cn">NA</span><span class="op">)</span></span>
<span>         <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="op">!</span><span class="va">group</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="op">!</span><span class="va">q3</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Let’s look at the data and a targeting plot.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/RISEkbmRasch/man/RItileplot.html">RItileplot</a></span><span class="op">(</span><span class="va">d2</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="dif_magnitude_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="1050"></p>
</figure>
</div>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/RISEkbmRasch/man/RImissing.html">RImissing</a></span><span class="op">(</span><span class="va">d2</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="dif_magnitude_files/figure-html/unnamed-chunk-9-2.png" class="img-fluid figure-img" width="1050"></p>
</figure>
</div>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/RISEkbmRasch/man/RItargeting.html">RItargeting</a></span><span class="op">(</span><span class="va">d2</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="dif_magnitude_files/figure-html/unnamed-chunk-9-3.png" class="img-fluid figure-img" width="1050"></p>
</figure>
</div>
</div>
</div>
<p>Comparing to non-split data.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/RISEkbmRasch/man/RItargeting.html">RItargeting</a></span><span class="op">(</span><span class="va">d</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="dif_magnitude_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="1050"></p>
</figure>
</div>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb14"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">itemlabels</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>itemnr <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">d</span><span class="op">)</span>, item <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/RISEkbmRasch/man/RIitemHierarchy.html">RIitemHierarchy</a></span><span class="op">(</span><span class="va">d</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="dif_magnitude_files/figure-html/unnamed-chunk-10-2.png" class="img-fluid figure-img" width="1050"></p>
</figure>
</div>
</div>
</div>
</section><section id="estimating-thetas" class="level3" data-number="2.5"><h3 data-number="2.5" class="anchored" data-anchor-id="estimating-thetas">
<span class="header-section-number">2.5</span> Estimating thetas</h3>
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb15"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">thetas_separate</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/RISEkbmRasch/man/RIestThetas.html">RIestThetas</a></span><span class="op">(</span><span class="va">d2</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">thetas_separate</span><span class="op">$</span><span class="va">WLE</span>, breaks <span class="op">=</span> <span class="fl">30</span>, col <span class="op">=</span> <span class="st">"lightblue"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">thetas_together</span><span class="op">$</span><span class="va">WLE</span>, breaks <span class="op">=</span> <span class="fl">30</span>, col <span class="op">=</span> <span class="st">"lightpink"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">thetas_q3_removed</span><span class="op">$</span><span class="va">WLE</span>, breaks <span class="op">=</span> <span class="fl">30</span>, , col <span class="op">=</span> <span class="st">"sienna4"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">thetas_separate</span><span class="op">$</span><span class="va">WLE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">thetas_together</span><span class="op">$</span><span class="va">WLE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">thetas_q3_removed</span><span class="op">$</span><span class="va">WLE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell quarto-layout-panel" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="dif_magnitude_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid" width="1050"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="dif_magnitude_files/figure-html/unnamed-chunk-11-2.png" class="img-fluid" width="1050"></p>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="dif_magnitude_files/figure-html/unnamed-chunk-11-3.png" class="img-fluid" width="1050"></p>
</div>
<div class="cell-output cell-output-stdout quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
-4.3090 -1.0323 -0.1378 -0.3004  0.6439  2.2196 </code></pre>
</div>
</div>
<div class="quarto-layout-row">
<div class="cell-output cell-output-stdout quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<pre><code>    Min.  1st Qu.   Median     Mean  3rd Qu.     Max. 
-4.22145 -0.89478  0.06713 -0.03405  0.94001  4.10588 </code></pre>
</div>
<div class="cell-output cell-output-stdout quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<pre><code>    Min.  1st Qu.   Median     Mean  3rd Qu.     Max. 
-4.15902 -0.96844 -0.02300 -0.01072  1.00094  4.06447 </code></pre>
</div>
</div>
</div>
<p>The upper range is rather different for the item split subgroup when using this method, with max score of 2.22, compared to (expected) ~ 4.1. Let’s review the threshold locations.</p>
</section><section id="comparing-item-parameters" class="level3" data-number="2.6"><h3 data-number="2.6" class="anchored" data-anchor-id="comparing-item-parameters">
<span class="header-section-number">2.6</span> Comparing item parameters</h3>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true">Original data</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">Item split</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-3" role="tab" aria-controls="tabset-1-3" aria-selected="false">DIF item removed</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-4" role="tab" aria-controls="tabset-1-4" aria-selected="false">Plot estimation bias</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-5" role="tab" aria-controls="tabset-1-5" aria-selected="false">Summary plot estimation bias</a></li>
</ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb19"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/RISEkbmRasch/man/RIitemparams.html">RIitemparams</a></span><span class="op">(</span><span class="va">d</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table data-quarto-disable-processing="true" style="width:90%; font-size: 15px; width: auto !important;  font-family: Lato; margin-left: auto; margin-right: auto; margin-left: auto; margin-right: auto;border-bottom: 0;" class="table table-striped table-hover lightable-classic table">
<thead><tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">   </th>
   <th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;"> Threshold 1 </th>
   <th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;"> Threshold 2 </th>
   <th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;"> Threshold 3 </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"> Item location </th>
  </tr></thead>
<tbody>
<tr>
<td style="text-align:left;font-weight: bold;"> q1 </td>
   <td style="text-align:right;"> 0.74 </td>
   <td style="text-align:right;"> 1.14 </td>
   <td style="text-align:right;"> 1.61 </td>
   <td style="text-align:left;"> <span style=" font-weight: bold;    text-align: right;">1.16</span> </td>
  </tr>
<tr>
<td style="text-align:left;font-weight: bold;"> q2 </td>
   <td style="text-align:right;"> -1.94 </td>
   <td style="text-align:right;"> -1.12 </td>
   <td style="text-align:right;"> -0.10 </td>
   <td style="text-align:left;"> <span style=" font-weight: bold;    text-align: right;">-1.05</span> </td>
  </tr>
<tr>
<td style="text-align:left;font-weight: bold;"> q3 </td>
   <td style="text-align:right;"> -0.28 </td>
   <td style="text-align:right;"> 0.16 </td>
   <td style="text-align:right;"> 0.80 </td>
   <td style="text-align:left;"> <span style=" font-weight: bold;    text-align: right;">0.23</span> </td>
  </tr>
<tr>
<td style="text-align:left;font-weight: bold;"> q4 </td>
   <td style="text-align:right;"> -0.28 </td>
   <td style="text-align:right;"> 0.13 </td>
   <td style="text-align:right;"> 1.27 </td>
   <td style="text-align:left;"> <span style=" font-weight: bold;    text-align: right;">0.37</span> </td>
  </tr>
<tr>
<td style="text-align:left;font-weight: bold;"> q5 </td>
   <td style="text-align:right;"> -0.89 </td>
   <td style="text-align:right;"> 0.04 </td>
   <td style="text-align:right;"> 0.75 </td>
   <td style="text-align:left;"> <span style=" font-weight: bold;    text-align: right;">-0.03</span> </td>
  </tr>
<tr>
<td style="text-align:left;font-weight: bold;"> q6 </td>
   <td style="text-align:right;"> -2.25 </td>
   <td style="text-align:right;"> -1.67 </td>
   <td style="text-align:right;"> -0.78 </td>
   <td style="text-align:left;"> <span style=" font-weight: bold;    text-align: right;">-1.57</span> </td>
  </tr>
<tr>
<td style="text-align:left;font-weight: bold;"> q7 </td>
   <td style="text-align:right;"> 0.65 </td>
   <td style="text-align:right;"> 1.01 </td>
   <td style="text-align:right;"> 1.80 </td>
   <td style="text-align:left;"> <span style=" font-weight: bold;    text-align: right;">1.16</span> </td>
  </tr>
<tr>
<td style="text-align:left;font-weight: bold;"> q8 </td>
   <td style="text-align:right;"> -1.82 </td>
   <td style="text-align:right;"> -1.39 </td>
   <td style="text-align:right;"> -0.20 </td>
   <td style="text-align:left;"> <span style=" font-weight: bold;    text-align: right;">-1.14</span> </td>
  </tr>
<tr>
<td style="text-align:left;font-weight: bold;"> q9 </td>
   <td style="text-align:right;"> -1.33 </td>
   <td style="text-align:right;"> 0.58 </td>
   <td style="text-align:right;"> 1.42 </td>
   <td style="text-align:left;"> <span style=" font-weight: bold;    text-align: right;">0.22</span> </td>
  </tr>
<tr>
<td style="text-align:left;font-weight: bold;"> q10 </td>
   <td style="text-align:right;"> -0.24 </td>
   <td style="text-align:right;"> 0.62 </td>
   <td style="text-align:right;"> 1.58 </td>
   <td style="text-align:left;"> <span style=" font-weight: bold;    text-align: right;">0.65</span> </td>
  </tr>
</tbody>
<tfoot>
<tr><td style="padding: 0; " colspan="100%"><span style="font-style: italic;">Note: </span></td></tr>
<tr><td style="padding: 0; " colspan="100%">
<sup></sup> Item location is the average of the thresholds for each item.</td></tr>
</tfoot>
</table>
</div>
</div>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb20"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/RISEkbmRasch/man/RIitemparams.html">RIitemparams</a></span><span class="op">(</span><span class="va">d2</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table data-quarto-disable-processing="true" style="width:90%; font-size: 15px; width: auto !important;  font-family: Lato; margin-left: auto; margin-right: auto; margin-left: auto; margin-right: auto;border-bottom: 0;" class="table table-striped table-hover lightable-classic table">
<thead><tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">   </th>
   <th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;"> Threshold 1 </th>
   <th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;"> Threshold 2 </th>
   <th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;"> Threshold 3 </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"> Item location </th>
  </tr></thead>
<tbody>
<tr>
<td style="text-align:left;font-weight: bold;"> q1 </td>
   <td style="text-align:right;"> 0.71 </td>
   <td style="text-align:right;"> 1.12 </td>
   <td style="text-align:right;"> 1.60 </td>
   <td style="text-align:left;"> <span style=" font-weight: bold;    text-align: right;">1.14</span> </td>
  </tr>
<tr>
<td style="text-align:left;font-weight: bold;"> q2 </td>
   <td style="text-align:right;"> -1.97 </td>
   <td style="text-align:right;"> -1.15 </td>
   <td style="text-align:right;"> -0.13 </td>
   <td style="text-align:left;"> <span style=" font-weight: bold;    text-align: right;">-1.08</span> </td>
  </tr>
<tr>
<td style="text-align:left;font-weight: bold;"> q4 </td>
   <td style="text-align:right;"> -0.32 </td>
   <td style="text-align:right;"> 0.10 </td>
   <td style="text-align:right;"> 1.25 </td>
   <td style="text-align:left;"> <span style=" font-weight: bold;    text-align: right;">0.35</span> </td>
  </tr>
<tr>
<td style="text-align:left;font-weight: bold;"> q5 </td>
   <td style="text-align:right;"> -0.92 </td>
   <td style="text-align:right;"> 0.02 </td>
   <td style="text-align:right;"> 0.73 </td>
   <td style="text-align:left;"> <span style=" font-weight: bold;    text-align: right;">-0.06</span> </td>
  </tr>
<tr>
<td style="text-align:left;font-weight: bold;"> q6 </td>
   <td style="text-align:right;"> -2.29 </td>
   <td style="text-align:right;"> -1.70 </td>
   <td style="text-align:right;"> -0.81 </td>
   <td style="text-align:left;"> <span style=" font-weight: bold;    text-align: right;">-1.6</span> </td>
  </tr>
<tr>
<td style="text-align:left;font-weight: bold;"> q7 </td>
   <td style="text-align:right;"> 0.62 </td>
   <td style="text-align:right;"> 0.99 </td>
   <td style="text-align:right;"> 1.80 </td>
   <td style="text-align:left;"> <span style=" font-weight: bold;    text-align: right;">1.14</span> </td>
  </tr>
<tr>
<td style="text-align:left;font-weight: bold;"> q8 </td>
   <td style="text-align:right;"> -1.85 </td>
   <td style="text-align:right;"> -1.42 </td>
   <td style="text-align:right;"> -0.22 </td>
   <td style="text-align:left;"> <span style=" font-weight: bold;    text-align: right;">-1.17</span> </td>
  </tr>
<tr>
<td style="text-align:left;font-weight: bold;"> q9 </td>
   <td style="text-align:right;"> -1.37 </td>
   <td style="text-align:right;"> 0.55 </td>
   <td style="text-align:right;"> 1.41 </td>
   <td style="text-align:left;"> <span style=" font-weight: bold;    text-align: right;">0.2</span> </td>
  </tr>
<tr>
<td style="text-align:left;font-weight: bold;"> q10 </td>
   <td style="text-align:right;"> -0.27 </td>
   <td style="text-align:right;"> 0.59 </td>
   <td style="text-align:right;"> 1.57 </td>
   <td style="text-align:left;"> <span style=" font-weight: bold;    text-align: right;">0.63</span> </td>
  </tr>
<tr>
<td style="text-align:left;font-weight: bold;"> q3a </td>
   <td style="text-align:right;"> -0.88 </td>
   <td style="text-align:right;"> -0.04 </td>
   <td style="text-align:right;"> 0.35 </td>
   <td style="text-align:left;"> <span style=" font-weight: bold;    text-align: right;">-0.19</span> </td>
  </tr>
<tr>
<td style="text-align:left;font-weight: bold;"> q3b </td>
   <td style="text-align:right;"> 0.10 </td>
   <td style="text-align:right;"> 0.36 </td>
   <td style="text-align:right;"> 1.47 </td>
   <td style="text-align:left;"> <span style=" font-weight: bold;    text-align: right;">0.64</span> </td>
  </tr>
</tbody>
<tfoot>
<tr><td style="padding: 0; " colspan="100%"><span style="font-style: italic;">Note: </span></td></tr>
<tr><td style="padding: 0; " colspan="100%">
<sup></sup> Item location is the average of the thresholds for each item.</td></tr>
</tfoot>
</table>
</div>
</div>
</div>
<div id="tabset-1-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-3-tab">
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb21"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/RISEkbmRasch/man/RIitemparams.html">RIitemparams</a></span><span class="op">(</span><span class="va">d</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="op">!</span><span class="va">q3</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table data-quarto-disable-processing="true" style="width:90%; font-size: 15px; width: auto !important;  font-family: Lato; margin-left: auto; margin-right: auto; margin-left: auto; margin-right: auto;border-bottom: 0;" class="table table-striped table-hover lightable-classic table">
<thead><tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">   </th>
   <th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;"> Threshold 1 </th>
   <th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;"> Threshold 2 </th>
   <th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;"> Threshold 3 </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"> Item location </th>
  </tr></thead>
<tbody>
<tr>
<td style="text-align:left;font-weight: bold;"> q1 </td>
   <td style="text-align:right;"> 0.76 </td>
   <td style="text-align:right;"> 1.19 </td>
   <td style="text-align:right;"> 1.64 </td>
   <td style="text-align:left;"> <span style=" font-weight: bold;    text-align: right;">1.19</span> </td>
  </tr>
<tr>
<td style="text-align:left;font-weight: bold;"> q2 </td>
   <td style="text-align:right;"> -1.91 </td>
   <td style="text-align:right;"> -1.11 </td>
   <td style="text-align:right;"> -0.08 </td>
   <td style="text-align:left;"> <span style=" font-weight: bold;    text-align: right;">-1.03</span> </td>
  </tr>
<tr>
<td style="text-align:left;font-weight: bold;"> q4 </td>
   <td style="text-align:right;"> -0.27 </td>
   <td style="text-align:right;"> 0.15 </td>
   <td style="text-align:right;"> 1.31 </td>
   <td style="text-align:left;"> <span style=" font-weight: bold;    text-align: right;">0.4</span> </td>
  </tr>
<tr>
<td style="text-align:left;font-weight: bold;"> q5 </td>
   <td style="text-align:right;"> -0.87 </td>
   <td style="text-align:right;"> 0.06 </td>
   <td style="text-align:right;"> 0.79 </td>
   <td style="text-align:left;"> <span style=" font-weight: bold;    text-align: right;">-0.01</span> </td>
  </tr>
<tr>
<td style="text-align:left;font-weight: bold;"> q6 </td>
   <td style="text-align:right;"> -2.22 </td>
   <td style="text-align:right;"> -1.66 </td>
   <td style="text-align:right;"> -0.76 </td>
   <td style="text-align:left;"> <span style=" font-weight: bold;    text-align: right;">-1.55</span> </td>
  </tr>
<tr>
<td style="text-align:left;font-weight: bold;"> q7 </td>
   <td style="text-align:right;"> 0.67 </td>
   <td style="text-align:right;"> 1.05 </td>
   <td style="text-align:right;"> 1.83 </td>
   <td style="text-align:left;"> <span style=" font-weight: bold;    text-align: right;">1.19</span> </td>
  </tr>
<tr>
<td style="text-align:left;font-weight: bold;"> q8 </td>
   <td style="text-align:right;"> -1.79 </td>
   <td style="text-align:right;"> -1.38 </td>
   <td style="text-align:right;"> -0.17 </td>
   <td style="text-align:left;"> <span style=" font-weight: bold;    text-align: right;">-1.12</span> </td>
  </tr>
<tr>
<td style="text-align:left;font-weight: bold;"> q9 </td>
   <td style="text-align:right;"> -1.32 </td>
   <td style="text-align:right;"> 0.60 </td>
   <td style="text-align:right;"> 1.46 </td>
   <td style="text-align:left;"> <span style=" font-weight: bold;    text-align: right;">0.25</span> </td>
  </tr>
<tr>
<td style="text-align:left;font-weight: bold;"> q10 </td>
   <td style="text-align:right;"> -0.22 </td>
   <td style="text-align:right;"> 0.65 </td>
   <td style="text-align:right;"> 1.62 </td>
   <td style="text-align:left;"> <span style=" font-weight: bold;    text-align: right;">0.68</span> </td>
  </tr>
</tbody>
<tfoot>
<tr><td style="padding: 0; " colspan="100%"><span style="font-style: italic;">Note: </span></td></tr>
<tr><td style="padding: 0; " colspan="100%">
<sup></sup> Item location is the average of the thresholds for each item.</td></tr>
</tfoot>
</table>
</div>
</div>
</div>
<div id="tabset-1-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-4-tab">
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb22"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">dp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/RISEkbmRasch/man/RIitemparams.html">RIitemparams</a></span><span class="op">(</span><span class="va">d</span>, output <span class="op">=</span> <span class="st">"dataframe"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="op">!</span><span class="va">Location</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rlang.r-lib.org/reference/set_names.html">set_names</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"orig_"</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html">rownames_to_column</a></span><span class="op">(</span><span class="st">"item"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html">str_detect</a></span><span class="op">(</span><span class="va">item</span>,<span class="st">"q3"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">dp2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/RISEkbmRasch/man/RIitemparams.html">RIitemparams</a></span><span class="op">(</span><span class="va">d2</span>, output <span class="op">=</span> <span class="st">"dataframe"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="op">!</span><span class="va">Location</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rlang.r-lib.org/reference/set_names.html">set_names</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"split_"</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html">rownames_to_column</a></span><span class="op">(</span><span class="st">"item"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html">str_detect</a></span><span class="op">(</span><span class="va">item</span>,<span class="st">"q3"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">dp3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/RISEkbmRasch/man/RIitemparams.html">RIitemparams</a></span><span class="op">(</span><span class="va">d</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="op">!</span><span class="va">q3</span><span class="op">)</span>, output <span class="op">=</span> <span class="st">"dataframe"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="op">!</span><span class="va">Location</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rlang.r-lib.org/reference/set_names.html">set_names</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"q3rem_"</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span><span class="op">)</span>  <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html">rownames_to_column</a></span><span class="op">(</span><span class="st">"item"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html">str_detect</a></span><span class="op">(</span><span class="va">item</span>,<span class="st">"q3"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">d_params</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">dp</span>,<span class="va">dp2</span><span class="op">[</span>,<span class="op">-</span><span class="fl">1</span><span class="op">]</span>,<span class="va">dp3</span><span class="op">[</span>,<span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span> <span class="co"># bind columns, keeping one "item" column</span></span>
<span></span>
<span><span class="va">dpin</span> <span class="op">&lt;-</span> <span class="va">inputParams1c</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rlang.r-lib.org/reference/set_names.html">set_names</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"input_"</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html">rownames_to_column</a></span><span class="op">(</span><span class="st">"item"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html">str_detect</a></span><span class="op">(</span><span class="va">item</span>,<span class="st">"q3"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">dpin_long</span> <span class="op">&lt;-</span> <span class="va">dpin</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span><span class="op">!</span><span class="va">item</span>,</span>
<span>               names_sep <span class="op">=</span> <span class="st">"_"</span>,</span>
<span>               names_to <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"source"</span>,<span class="st">"threshold"</span><span class="op">)</span>,</span>
<span>               values_to <span class="op">=</span> <span class="st">"input"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb23"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">d_params</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span><span class="op">!</span><span class="va">item</span>, </span>
<span>               names_sep <span class="op">=</span> <span class="st">"_"</span>,</span>
<span>               names_to <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"source"</span>,<span class="st">"threshold"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">left_join</a></span><span class="op">(</span><span class="va">dpin_long</span><span class="op">[</span>,<span class="op">-</span><span class="fl">2</span><span class="op">]</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"item"</span>,<span class="st">"threshold"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">source</span>,<span class="va">item</span>,<span class="va">threshold</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span>abs_diff <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="va">input</span> <span class="op">-</span> <span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">threshold</span>, y <span class="op">=</span> <span class="va">abs_diff</span>, color <span class="op">=</span> <span class="va">source</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">2</span>, alpha <span class="op">=</span> <span class="fl">0.85</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>group <span class="op">=</span> <span class="va">source</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="op">~</span> <span class="va">item</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Absolute bias (logits)"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="dif_magnitude_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid figure-img" width="1050"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-1-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-5-tab">
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb24"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">itemlocs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/RISEkbmRasch/man/RIitemparams.html">RIitemparams</a></span><span class="op">(</span><span class="va">d</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="op">!</span><span class="va">q3</span><span class="op">)</span>, output <span class="op">=</span> <span class="st">"dataframe"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html">pull</a></span><span class="op">(</span><span class="va">Location</span><span class="op">)</span></span>
<span></span>
<span><span class="va">item_order</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sort.html">sort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">itemlocs</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">d_params</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span><span class="op">!</span><span class="va">item</span>, </span>
<span>               names_sep <span class="op">=</span> <span class="st">"_"</span>,</span>
<span>               names_to <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"source"</span>,<span class="st">"threshold"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">left_join</a></span><span class="op">(</span><span class="va">dpin_long</span><span class="op">[</span>,<span class="op">-</span><span class="fl">2</span><span class="op">]</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"item"</span>,<span class="st">"threshold"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">source</span>,<span class="va">item</span>,<span class="va">threshold</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span>abs_diff <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="va">input</span> <span class="op">-</span> <span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">ungroup</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">source</span>,<span class="va">item</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span>sum_diff <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">abs_diff</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">ungroup</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html">pivot_wider</a></span><span class="op">(</span>values_from <span class="op">=</span> <span class="st">"sum_diff"</span>,</span>
<span>              names_from <span class="op">=</span> <span class="st">"source"</span>,</span>
<span>              id_cols <span class="op">=</span> <span class="st">"item"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span><span class="op">!</span><span class="va">item</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>item <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">item</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">itemlocs</span><span class="op">)</span>, </span>
<span>                        labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">itemlocs</span><span class="op">)</span>,<span class="st">"_"</span>,<span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">itemlocs</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">item</span>, </span>
<span>             y <span class="op">=</span> <span class="va">value</span>, </span>
<span>             color <span class="op">=</span> <span class="va">name</span><span class="op">)</span></span>
<span>         <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Total estimation bias for each item (all thresholds) and item set"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Absolute bias (logits)"</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"Item (and average location)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="cn">NA</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="dif_magnitude_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid figure-img" width="1050"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
<section id="mirt-comparison" class="level4" data-number="2.6.1"><h4 data-number="2.6.1" class="anchored" data-anchor-id="mirt-comparison">
<span class="header-section-number">2.6.1</span> <code>mirt</code> comparison</h4>
<p>Perhaps the <code>mirt</code> package could be more accurate in item threshold estimation when we have item split?</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb25"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">mirt_out</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/mirt/man/mirt.html">mirt</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">d</span>, model <span class="op">=</span> <span class="fl">1</span>, itemtype <span class="op">=</span> <span class="st">"Rasch"</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">mirt_params</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">mirt_out</span>, simplify <span class="op">=</span> <span class="cn">TRUE</span>, IRTpars <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">$</span><span class="va">items</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="op">!</span><span class="va">a</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rlang.r-lib.org/reference/set_names.html">set_names</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"orig_"</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>   </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">dpm</span> <span class="op">&lt;-</span> <span class="va">mirt_params</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">mirt_params</span><span class="op">)</span></span>
<span></span>
<span><span class="va">dpm</span> <span class="op">&lt;-</span> <span class="va">dpm</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html">rownames_to_column</a></span><span class="op">(</span><span class="st">"item"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html">str_detect</a></span><span class="op">(</span><span class="va">item</span>,<span class="st">"q3"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">mirt_out</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/mirt/man/mirt.html">mirt</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">d2</span>, model <span class="op">=</span> <span class="fl">1</span>, itemtype <span class="op">=</span> <span class="st">"Rasch"</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">mirt_params</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">mirt_out</span>, simplify <span class="op">=</span> <span class="cn">TRUE</span>, IRTpars <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">$</span><span class="va">items</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="op">!</span><span class="va">a</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rlang.r-lib.org/reference/set_names.html">set_names</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"split_"</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">dpm2</span> <span class="op">&lt;-</span> <span class="va">mirt_params</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">mirt_params</span><span class="op">)</span></span>
<span></span>
<span><span class="va">dpm2</span> <span class="op">&lt;-</span> <span class="va">dpm2</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html">rownames_to_column</a></span><span class="op">(</span><span class="st">"item"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html">str_detect</a></span><span class="op">(</span><span class="va">item</span>,<span class="st">"q3"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">mirt_out</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/mirt/man/mirt.html">mirt</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">d</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="op">!</span><span class="va">q3</span><span class="op">)</span>, model <span class="op">=</span> <span class="fl">1</span>, itemtype <span class="op">=</span> <span class="st">"Rasch"</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">mirt_params</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">mirt_out</span>, simplify <span class="op">=</span> <span class="cn">TRUE</span>, IRTpars <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">$</span><span class="va">items</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="op">!</span><span class="va">a</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rlang.r-lib.org/reference/set_names.html">set_names</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"q3rem_"</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">dpm3</span> <span class="op">&lt;-</span> <span class="va">mirt_params</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">mirt_params</span><span class="op">)</span></span>
<span></span>
<span><span class="va">dpm3</span> <span class="op">&lt;-</span> <span class="va">dpm3</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html">rownames_to_column</a></span><span class="op">(</span><span class="st">"item"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html">str_detect</a></span><span class="op">(</span><span class="va">item</span>,<span class="st">"q3"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">d_params2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">dpm</span>,<span class="va">dpm2</span><span class="op">[</span>,<span class="op">-</span><span class="fl">1</span><span class="op">]</span>,<span class="va">dpm3</span><span class="op">[</span>,<span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span> <span class="co"># bind columns, keeping one "item" column</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true">Plot estimation bias</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false">Summary plot estimation bias</a></li>
</ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb26"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">d_params2</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span><span class="op">!</span><span class="va">item</span>, </span>
<span>               names_sep <span class="op">=</span> <span class="st">"_"</span>,</span>
<span>               names_to <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"source"</span>,<span class="st">"threshold"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">left_join</a></span><span class="op">(</span><span class="va">dpin_long</span><span class="op">[</span>,<span class="op">-</span><span class="fl">2</span><span class="op">]</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"item"</span>,<span class="st">"threshold"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">source</span>,<span class="va">item</span>,<span class="va">threshold</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span>abs_diff <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="va">input</span> <span class="op">-</span> <span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">threshold</span>, y <span class="op">=</span> <span class="va">abs_diff</span>, color <span class="op">=</span> <span class="va">source</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.85</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="op">~</span> <span class="va">item</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="dif_magnitude_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid figure-img" width="1050"></p>
</figure>
</div>
</div>
</div>
<p>Seems indentical to eRm estimates.</p>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb27"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">d_params2</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span><span class="op">!</span><span class="va">item</span>, </span>
<span>               names_sep <span class="op">=</span> <span class="st">"_"</span>,</span>
<span>               names_to <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"source"</span>,<span class="st">"threshold"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">left_join</a></span><span class="op">(</span><span class="va">dpin_long</span><span class="op">[</span>,<span class="op">-</span><span class="fl">2</span><span class="op">]</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"item"</span>,<span class="st">"threshold"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">source</span>,<span class="va">item</span>,<span class="va">threshold</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span>abs_diff <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="va">input</span> <span class="op">-</span> <span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">ungroup</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">source</span>,<span class="va">item</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span>sum_diff <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">abs_diff</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">ungroup</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html">pivot_wider</a></span><span class="op">(</span>values_from <span class="op">=</span> <span class="st">"sum_diff"</span>,</span>
<span>              names_from <span class="op">=</span> <span class="st">"source"</span>,</span>
<span>              id_cols <span class="op">=</span> <span class="st">"item"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span><span class="op">!</span><span class="va">item</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>item <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">item</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">itemlocs</span><span class="op">)</span>, </span>
<span>                        labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">itemlocs</span><span class="op">)</span>,<span class="st">"_"</span>,<span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">itemlocs</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">item</span>, </span>
<span>             y <span class="op">=</span> <span class="va">value</span>, </span>
<span>             color <span class="op">=</span> <span class="va">name</span><span class="op">)</span></span>
<span>         <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"mirt: Total estimation bias for each item and item set"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="dif_magnitude_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid figure-img" width="1050"></p>
</figure>
</div>
</div>
</div>
<p>No difference here either.</p>
</div>
</div>
</div>
</section></section><section id="theta-estimation-investigated" class="level3" data-number="2.7"><h3 data-number="2.7" class="anchored" data-anchor-id="theta-estimation-investigated">
<span class="header-section-number">2.7</span> Theta estimation investigated</h3>
<p>The method for estimating item parameters and thetas used in the function <code><a href="https://rdrr.io/pkg/RISEkbmRasch/man/RIestThetas.html">RIestThetas()</a></code> may be at fault for the odd results in thetas estimated by the item set with item split? We can separate the two steps, and use a separate function for theta estimation with manual input of item parameters.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb28"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">itemps</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/RISEkbmRasch/man/RIitemparams.html">RIitemparams</a></span><span class="op">(</span><span class="va">d2</span>, output <span class="op">=</span> <span class="st">"dataframe"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="op">!</span><span class="va">Location</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">thetas_separate_catR</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/RISEkbmRasch/man/RIestThetasOLD.html">RIestThetasOLD</a></span><span class="op">(</span><span class="va">d2</span>, itemParams <span class="op">=</span> <span class="va">itemps</span>, theta_range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">8</span>,<span class="fl">8</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">c</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>together_RIestThetas <span class="op">=</span> <span class="va">thetas_together</span><span class="op">$</span><span class="va">WLE</span>,</span>
<span>           together_q3_rem <span class="op">=</span> <span class="va">thetas_q3_removed</span><span class="op">$</span><span class="va">WLE</span>,</span>
<span>           separate_catR <span class="op">=</span> <span class="va">thetas_separate_catR</span>,</span>
<span>           separate_RIestThetas <span class="op">=</span> <span class="va">thetas_separate</span><span class="op">$</span><span class="va">WLE</span>,</span>
<span>           input_thetas <span class="op">=</span> <span class="va">input_thetas</span><span class="op">)</span></span>
<span></span>
<span><span class="va">c</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html">everything</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>               names_to <span class="op">=</span> <span class="st">"method"</span>,</span>
<span>               values_to <span class="op">=</span> <span class="st">"theta"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">theta</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span>bins <span class="op">=</span> <span class="fl">50</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">method</span>, axes <span class="op">=</span> <span class="st">"all_x"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">5</span>,<span class="fl">5</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="dif_magnitude_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid figure-img" width="1050"></p>
</figure>
</div>
</div>
</div>
<p>Looks like the two step approach worked a lot better. Since the item parameter estimation is identical (both are using <code><a href="https://rdrr.io/pkg/eRm/man/PCM.html">eRm::PCM()</a></code>), the reason should be the difference in theta estimation. The two-step approach uses <code><a href="https://rdrr.io/pkg/catR/man/thetaEst.html">catR::thetaEst()</a></code> for theta estimation, which is probably handling missing data better than <code><a href="https://rdrr.io/pkg/iarm/man/person_estimates.html">iarm::person_estimates()</a></code>. Note: both approaches use the Weighted Likelihood Estimation to minimize bias (Warm, 1989).</p>
</section></section><section id="results" class="level2" data-number="3"><h2 data-number="3" class="anchored" data-anchor-id="results">
<span class="header-section-number">3</span> Results</h2>
<section id="summarised" class="level3" data-number="3.1"><h3 data-number="3.1" class="anchored" data-anchor-id="summarised">
<span class="header-section-number">3.1</span> Summarised</h3>
<p>First, absolute differences in estimated thetas compared to input thetas.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb29"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">c_diff</span> <span class="op">&lt;-</span> <span class="va">c</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>with_q3 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="va">together_RIestThetas</span> <span class="op">-</span> <span class="va">input_thetas</span><span class="op">)</span>,</span>
<span>         q3_removed <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="va">together_q3_rem</span> <span class="op">-</span> <span class="va">input_thetas</span><span class="op">)</span>,</span>
<span>         q3_split <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="va">separate_catR</span> <span class="op">-</span> <span class="va">input_thetas</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">c</span><span class="op">)</span><span class="op">)</span></span>
<span>  </span>
<span><span class="va">c_diff</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html">everything</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span>bins <span class="op">=</span> <span class="fl">50</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="op">~</span> <span class="va">name</span>, ncol <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Absolute difference in logits"</span>,</span>
<span>       title <span class="op">=</span> <span class="st">"Comparing input thetas to estimated"</span>,</span>
<span>       subtitle <span class="op">=</span> <span class="st">"Distribution of bias"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="dif_magnitude_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid figure-img" width="1050"></p>
</figure>
</div>
</div>
</div>
<p>No huge differences between these histograms.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb30"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">c_diff_descr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/summarytools/man/descr.html">descr</a></span><span class="op">(</span><span class="va">c_diff</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html">rownames_to_column</a></span><span class="op">(</span><span class="st">"Parameter"</span><span class="op">)</span> </span>
<span></span>
<span><span class="va">c_diff_descr</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">9</span>,<span class="op">]</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span><span class="op">!</span><span class="va">Parameter</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Parameter</span>, y <span class="op">=</span> <span class="va">value</span>, color <span class="op">=</span> <span class="va">name</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.85</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html">scale_color_viridis_d</a></span><span class="op">(</span><span class="st">'Item set'</span>, end <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>y <span class="op">=</span> <span class="st">"Logits"</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"Descriptive metric"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="dif_magnitude_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid figure-img" width="1050"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb31"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">c_diff_descr</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">9</span>,<span class="op">]</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate_all.html">mutate_if</a></span><span class="op">(</span><span class="va">is.numeric</span>, <span class="va">round</span>, <span class="fl">3</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/RISEkbmRasch/man/kbl_rise.html">kbl_rise</a></span><span class="op">(</span>tbl_width <span class="op">=</span> <span class="fl">50</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table data-quarto-disable-processing="true" style="width:50%; font-size: 14px;  font-family: Arial; margin-left: auto; margin-right: auto;" class="table table-striped table-hover lightable-classic">
<thead><tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> Parameter </th>
   <th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> q3_removed </th>
   <th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> q3_split </th>
   <th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> with_q3 </th>
  </tr></thead>
<tbody>
<tr>
<td style="text-align:left;"> Mean </td>
   <td style="text-align:right;"> 0.378 </td>
   <td style="text-align:right;"> 0.354 </td>
   <td style="text-align:right;"> 0.358 </td>
  </tr>
<tr>
<td style="text-align:left;"> Std.Dev </td>
   <td style="text-align:right;"> 0.288 </td>
   <td style="text-align:right;"> 0.275 </td>
   <td style="text-align:right;"> 0.278 </td>
  </tr>
<tr>
<td style="text-align:left;"> Min </td>
   <td style="text-align:right;"> 0.000 </td>
   <td style="text-align:right;"> 0.001 </td>
   <td style="text-align:right;"> 0.000 </td>
  </tr>
<tr>
<td style="text-align:left;"> Q1 </td>
   <td style="text-align:right;"> 0.159 </td>
   <td style="text-align:right;"> 0.125 </td>
   <td style="text-align:right;"> 0.136 </td>
  </tr>
<tr>
<td style="text-align:left;"> Median </td>
   <td style="text-align:right;"> 0.316 </td>
   <td style="text-align:right;"> 0.292 </td>
   <td style="text-align:right;"> 0.302 </td>
  </tr>
<tr>
<td style="text-align:left;"> Q3 </td>
   <td style="text-align:right;"> 0.546 </td>
   <td style="text-align:right;"> 0.525 </td>
   <td style="text-align:right;"> 0.518 </td>
  </tr>
<tr>
<td style="text-align:left;"> Max </td>
   <td style="text-align:right;"> 1.729 </td>
   <td style="text-align:right;"> 1.732 </td>
   <td style="text-align:right;"> 1.770 </td>
  </tr>
<tr>
<td style="text-align:left;"> MAD </td>
   <td style="text-align:right;"> 0.283 </td>
   <td style="text-align:right;"> 0.272 </td>
   <td style="text-align:right;"> 0.278 </td>
  </tr>
<tr>
<td style="text-align:left;"> IQR </td>
   <td style="text-align:right;"> 0.385 </td>
   <td style="text-align:right;"> 0.400 </td>
   <td style="text-align:right;"> 0.381 </td>
  </tr>
</tbody>
</table>
</div>
</div>
<p>Still not large differences anywhere.</p>
<p>We should look at the particular region where the DIF item is located, since it should have the most impact there.</p>
</section><section id="across-the-latent-continuum" class="level3" data-number="3.2"><h3 data-number="3.2" class="anchored" data-anchor-id="across-the-latent-continuum">
<span class="header-section-number">3.2</span> Across the latent continuum</h3>
<p>First, the test information function (TIF) curve could be of interest to understand what to expect in terms of estimation bias due to reliability limitations. Even more interesting is the table showing range of SEM.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-3-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-1" role="tab" aria-controls="tabset-3-1" aria-selected="true">TIF original data</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-2" role="tab" aria-controls="tabset-3-2" aria-selected="false">TIF without q3</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-3" role="tab" aria-controls="tabset-3-3" aria-selected="false">SEM without q3</a></li>
</ul>
<div class="tab-content">
<div id="tabset-3-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-3-1-tab">
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb32"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/RISEkbmRasch/man/RItif.html">RItif</a></span><span class="op">(</span><span class="va">d</span>, samplePSI <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="dif_magnitude_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid figure-img" width="1350"></p>
</figure>
</div>
</div>
</div>
<section id="sem-original-data" class="level3" data-number="3.3"><h3 data-number="3.3" class="anchored" data-anchor-id="sem-original-data">
<span class="header-section-number">3.3</span> SEM original data</h3>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb33"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/RISEkbmRasch/man/RIscoreSE.html">RIscoreSE</a></span><span class="op">(</span><span class="va">d</span>, output <span class="op">=</span> <span class="st">"table"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table data-quarto-disable-processing="true" style="width:65%; font-size: 14px;  font-family: Arial; margin-left: auto; margin-right: auto;" class="table table-striped table-hover lightable-classic">
<thead><tr>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> Ordinal sum score </th>
   <th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> Logit score </th>
   <th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> Logit std.error </th>
  </tr></thead>
<tbody>
<tr>
<td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> -4.221 </td>
   <td style="text-align:right;"> 0.619 </td>
  </tr>
<tr>
<td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> -3.131 </td>
   <td style="text-align:right;"> 0.726 </td>
  </tr>
<tr>
<td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> -2.608 </td>
   <td style="text-align:right;"> 0.675 </td>
  </tr>
<tr>
<td style="text-align:right;"> 3 </td>
   <td style="text-align:right;"> -2.245 </td>
   <td style="text-align:right;"> 0.608 </td>
  </tr>
<tr>
<td style="text-align:right;"> 4 </td>
   <td style="text-align:right;"> -1.955 </td>
   <td style="text-align:right;"> 0.552 </td>
  </tr>
<tr>
<td style="text-align:right;"> 5 </td>
   <td style="text-align:right;"> -1.706 </td>
   <td style="text-align:right;"> 0.510 </td>
  </tr>
<tr>
<td style="text-align:right;"> 6 </td>
   <td style="text-align:right;"> -1.482 </td>
   <td style="text-align:right;"> 0.479 </td>
  </tr>
<tr>
<td style="text-align:right;"> 7 </td>
   <td style="text-align:right;"> -1.274 </td>
   <td style="text-align:right;"> 0.457 </td>
  </tr>
<tr>
<td style="text-align:right;"> 8 </td>
   <td style="text-align:right;"> -1.080 </td>
   <td style="text-align:right;"> 0.441 </td>
  </tr>
<tr>
<td style="text-align:right;"> 9 </td>
   <td style="text-align:right;"> -0.895 </td>
   <td style="text-align:right;"> 0.428 </td>
  </tr>
<tr>
<td style="text-align:right;"> 10 </td>
   <td style="text-align:right;"> -0.718 </td>
   <td style="text-align:right;"> 0.418 </td>
  </tr>
<tr>
<td style="text-align:right;"> 11 </td>
   <td style="text-align:right;"> -0.550 </td>
   <td style="text-align:right;"> 0.409 </td>
  </tr>
<tr>
<td style="text-align:right;"> 12 </td>
   <td style="text-align:right;"> -0.388 </td>
   <td style="text-align:right;"> 0.401 </td>
  </tr>
<tr>
<td style="text-align:right;"> 13 </td>
   <td style="text-align:right;"> -0.232 </td>
   <td style="text-align:right;"> 0.395 </td>
  </tr>
<tr>
<td style="text-align:right;"> 14 </td>
   <td style="text-align:right;"> -0.080 </td>
   <td style="text-align:right;"> 0.391 </td>
  </tr>
<tr>
<td style="text-align:right;"> 15 </td>
   <td style="text-align:right;"> 0.067 </td>
   <td style="text-align:right;"> 0.387 </td>
  </tr>
<tr>
<td style="text-align:right;"> 16 </td>
   <td style="text-align:right;"> 0.212 </td>
   <td style="text-align:right;"> 0.385 </td>
  </tr>
<tr>
<td style="text-align:right;"> 17 </td>
   <td style="text-align:right;"> 0.356 </td>
   <td style="text-align:right;"> 0.384 </td>
  </tr>
<tr>
<td style="text-align:right;"> 18 </td>
   <td style="text-align:right;"> 0.499 </td>
   <td style="text-align:right;"> 0.385 </td>
  </tr>
<tr>
<td style="text-align:right;"> 19 </td>
   <td style="text-align:right;"> 0.643 </td>
   <td style="text-align:right;"> 0.388 </td>
  </tr>
<tr>
<td style="text-align:right;"> 20 </td>
   <td style="text-align:right;"> 0.790 </td>
   <td style="text-align:right;"> 0.393 </td>
  </tr>
<tr>
<td style="text-align:right;"> 21 </td>
   <td style="text-align:right;"> 0.940 </td>
   <td style="text-align:right;"> 0.402 </td>
  </tr>
<tr>
<td style="text-align:right;"> 22 </td>
   <td style="text-align:right;"> 1.096 </td>
   <td style="text-align:right;"> 0.413 </td>
  </tr>
<tr>
<td style="text-align:right;"> 23 </td>
   <td style="text-align:right;"> 1.261 </td>
   <td style="text-align:right;"> 0.430 </td>
  </tr>
<tr>
<td style="text-align:right;"> 24 </td>
   <td style="text-align:right;"> 1.438 </td>
   <td style="text-align:right;"> 0.453 </td>
  </tr>
<tr>
<td style="text-align:right;"> 25 </td>
   <td style="text-align:right;"> 1.634 </td>
   <td style="text-align:right;"> 0.486 </td>
  </tr>
<tr>
<td style="text-align:right;"> 26 </td>
   <td style="text-align:right;"> 1.858 </td>
   <td style="text-align:right;"> 0.531 </td>
  </tr>
<tr>
<td style="text-align:right;"> 27 </td>
   <td style="text-align:right;"> 2.128 </td>
   <td style="text-align:right;"> 0.591 </td>
  </tr>
<tr>
<td style="text-align:right;"> 28 </td>
   <td style="text-align:right;"> 2.478 </td>
   <td style="text-align:right;"> 0.665 </td>
  </tr>
<tr>
<td style="text-align:right;"> 29 </td>
   <td style="text-align:right;"> 2.999 </td>
   <td style="text-align:right;"> 0.725 </td>
  </tr>
<tr>
<td style="text-align:right;"> 30 </td>
   <td style="text-align:right;"> 4.106 </td>
   <td style="text-align:right;"> 0.624 </td>
  </tr>
</tbody>
</table>
</div>
</div>
</section>
</div>
<div id="tabset-3-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-2-tab">
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb34"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/RISEkbmRasch/man/RItif.html">RItif</a></span><span class="op">(</span><span class="va">d</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="op">!</span><span class="va">q3</span><span class="op">)</span>, samplePSI <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="dif_magnitude_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid figure-img" width="1350"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-3-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-3-tab">
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb35"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/RISEkbmRasch/man/RIscoreSE.html">RIscoreSE</a></span><span class="op">(</span><span class="va">d</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="op">!</span><span class="va">q3</span><span class="op">)</span>, output <span class="op">=</span> <span class="st">"table"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table data-quarto-disable-processing="true" style="width:65%; font-size: 14px;  font-family: Arial; margin-left: auto; margin-right: auto;" class="table table-striped table-hover lightable-classic">
<thead><tr>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> Ordinal sum score </th>
   <th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> Logit score </th>
   <th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> Logit std.error </th>
  </tr></thead>
<tbody>
<tr>
<td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> -4.159 </td>
   <td style="text-align:right;"> 0.618 </td>
  </tr>
<tr>
<td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> -3.070 </td>
   <td style="text-align:right;"> 0.727 </td>
  </tr>
<tr>
<td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> -2.546 </td>
   <td style="text-align:right;"> 0.678 </td>
  </tr>
<tr>
<td style="text-align:right;"> 3 </td>
   <td style="text-align:right;"> -2.180 </td>
   <td style="text-align:right;"> 0.613 </td>
  </tr>
<tr>
<td style="text-align:right;"> 4 </td>
   <td style="text-align:right;"> -1.885 </td>
   <td style="text-align:right;"> 0.558 </td>
  </tr>
<tr>
<td style="text-align:right;"> 5 </td>
   <td style="text-align:right;"> -1.629 </td>
   <td style="text-align:right;"> 0.518 </td>
  </tr>
<tr>
<td style="text-align:right;"> 6 </td>
   <td style="text-align:right;"> -1.396 </td>
   <td style="text-align:right;"> 0.490 </td>
  </tr>
<tr>
<td style="text-align:right;"> 7 </td>
   <td style="text-align:right;"> -1.177 </td>
   <td style="text-align:right;"> 0.471 </td>
  </tr>
<tr>
<td style="text-align:right;"> 8 </td>
   <td style="text-align:right;"> -0.968 </td>
   <td style="text-align:right;"> 0.457 </td>
  </tr>
<tr>
<td style="text-align:right;"> 9 </td>
   <td style="text-align:right;"> -0.767 </td>
   <td style="text-align:right;"> 0.447 </td>
  </tr>
<tr>
<td style="text-align:right;"> 10 </td>
   <td style="text-align:right;"> -0.573 </td>
   <td style="text-align:right;"> 0.439 </td>
  </tr>
<tr>
<td style="text-align:right;"> 11 </td>
   <td style="text-align:right;"> -0.384 </td>
   <td style="text-align:right;"> 0.432 </td>
  </tr>
<tr>
<td style="text-align:right;"> 12 </td>
   <td style="text-align:right;"> -0.201 </td>
   <td style="text-align:right;"> 0.427 </td>
  </tr>
<tr>
<td style="text-align:right;"> 13 </td>
   <td style="text-align:right;"> -0.023 </td>
   <td style="text-align:right;"> 0.422 </td>
  </tr>
<tr>
<td style="text-align:right;"> 14 </td>
   <td style="text-align:right;"> 0.151 </td>
   <td style="text-align:right;"> 0.419 </td>
  </tr>
<tr>
<td style="text-align:right;"> 15 </td>
   <td style="text-align:right;"> 0.322 </td>
   <td style="text-align:right;"> 0.416 </td>
  </tr>
<tr>
<td style="text-align:right;"> 16 </td>
   <td style="text-align:right;"> 0.491 </td>
   <td style="text-align:right;"> 0.416 </td>
  </tr>
<tr>
<td style="text-align:right;"> 17 </td>
   <td style="text-align:right;"> 0.659 </td>
   <td style="text-align:right;"> 0.418 </td>
  </tr>
<tr>
<td style="text-align:right;"> 18 </td>
   <td style="text-align:right;"> 0.828 </td>
   <td style="text-align:right;"> 0.423 </td>
  </tr>
<tr>
<td style="text-align:right;"> 19 </td>
   <td style="text-align:right;"> 1.001 </td>
   <td style="text-align:right;"> 0.432 </td>
  </tr>
<tr>
<td style="text-align:right;"> 20 </td>
   <td style="text-align:right;"> 1.179 </td>
   <td style="text-align:right;"> 0.445 </td>
  </tr>
<tr>
<td style="text-align:right;"> 21 </td>
   <td style="text-align:right;"> 1.368 </td>
   <td style="text-align:right;"> 0.466 </td>
  </tr>
<tr>
<td style="text-align:right;"> 22 </td>
   <td style="text-align:right;"> 1.573 </td>
   <td style="text-align:right;"> 0.496 </td>
  </tr>
<tr>
<td style="text-align:right;"> 23 </td>
   <td style="text-align:right;"> 1.805 </td>
   <td style="text-align:right;"> 0.539 </td>
  </tr>
<tr>
<td style="text-align:right;"> 24 </td>
   <td style="text-align:right;"> 2.079 </td>
   <td style="text-align:right;"> 0.597 </td>
  </tr>
<tr>
<td style="text-align:right;"> 25 </td>
   <td style="text-align:right;"> 2.433 </td>
   <td style="text-align:right;"> 0.669 </td>
  </tr>
<tr>
<td style="text-align:right;"> 26 </td>
   <td style="text-align:right;"> 2.956 </td>
   <td style="text-align:right;"> 0.727 </td>
  </tr>
<tr>
<td style="text-align:right;"> 27 </td>
   <td style="text-align:right;"> 4.064 </td>
   <td style="text-align:right;"> 0.625 </td>
  </tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
<p>The lowest SEM with q3 is 0.384, at logit score 0.356.</p>
<p>Lowest SEM without q3 is 0.416, at logit score 0.322 to 0.491, which makes a difference in minimal SEM of about 0.032 compared to including the DIF item. 0.032 * 1.96 = 0.064 for a 95% CI.</p>
<section id="theta-estimation-bias" class="level4" data-number="3.3.1"><h4 data-number="3.3.1" class="anchored" data-anchor-id="theta-estimation-bias">
<span class="header-section-number">3.3.1</span> Theta estimation bias</h4>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb36"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">c_diff</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://tibble.tidyverse.org/reference/add_column.html">add_column</a></span><span class="op">(</span>Theta <span class="op">=</span> <span class="va">input_thetas</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span><span class="op">!</span><span class="va">Theta</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Theta</span>, y <span class="op">=</span> <span class="va">value</span>, color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">name</span><span class="op">)</span>, fill <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">name</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.85</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"loess"</span>,</span>
<span>              <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>linetype <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">name</span><span class="op">)</span><span class="op">)</span>, alpha <span class="op">=</span> <span class="fl">0.15</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ewenme.github.io/ghibli/reference/ggplot2-scales-discrete.html">scale_color_ghibli_d</a></span><span class="op">(</span><span class="st">"MononokeMedium"</span>, direction <span class="op">=</span> <span class="op">-</span><span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ewenme.github.io/ghibli/reference/ggplot2-scales-discrete.html">scale_fill_ghibli_d</a></span><span class="op">(</span><span class="st">"MononokeMedium"</span>, direction <span class="op">=</span> <span class="op">-</span><span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"Item set"</span>,</span>
<span>       title <span class="op">=</span> <span class="st">"Theta estimation bias"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Absolute difference in logits"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html">guides</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"none"</span>, linetype <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">5</span>,<span class="fl">5</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="cn">NA</span><span class="op">)</span>, breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">2</span>,<span class="fl">0.1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">name</span>, ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/RISEkbmRasch/man/theme_rise.html">theme_rise</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="dif_magnitude_files/figure-html/unnamed-chunk-29-1.png" class="img-fluid figure-img" width="1050"></p>
</figure>
</div>
</div>
</div>
<p>Without points for a cleaner view.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb37"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">c_diff</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://tibble.tidyverse.org/reference/add_column.html">add_column</a></span><span class="op">(</span>Theta <span class="op">=</span> <span class="va">input_thetas</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span><span class="op">!</span><span class="va">Theta</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Theta</span>, y <span class="op">=</span> <span class="va">value</span>, color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">name</span><span class="op">)</span>, fill <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">name</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co">#geom_point(alpha = 0.85) +</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"loess"</span>,</span>
<span>              <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>linetype <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">name</span><span class="op">)</span><span class="op">)</span>, alpha <span class="op">=</span> <span class="fl">0.15</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ewenme.github.io/ghibli/reference/ggplot2-scales-discrete.html">scale_color_ghibli_d</a></span><span class="op">(</span><span class="st">"MononokeMedium"</span>, direction <span class="op">=</span> <span class="op">-</span><span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ewenme.github.io/ghibli/reference/ggplot2-scales-discrete.html">scale_fill_ghibli_d</a></span><span class="op">(</span><span class="st">"MononokeMedium"</span>, direction <span class="op">=</span> <span class="op">-</span><span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"Item set"</span>,</span>
<span>       title <span class="op">=</span> <span class="st">"Theta estimation bias"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Absolute difference (logits)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html">guides</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"none"</span>, linetype <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">5</span>,<span class="fl">5</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="cn">NA</span><span class="op">)</span>, breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1.2</span>,<span class="fl">0.1</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="dif_magnitude_files/figure-html/unnamed-chunk-30-1.png" class="img-fluid figure-img" width="1050"></p>
</figure>
</div>
</div>
</div>
<p>Item split slightly reduces bias compared to keeping the DIF item (3), while removing item 3 increases bias from -1.5 to +1.5</p>
</section></section><section id="statistical-analysis" class="level3" data-number="3.4"><h3 data-number="3.4" class="anchored" data-anchor-id="statistical-analysis">
<span class="header-section-number">3.4</span> Statistical analysis</h3>
<p>Comparing differences in theta estimation to input thetas.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb38"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://broom.tidymodels.org/">broom</a></span><span class="op">)</span></span>
<span><span class="va">lm_all</span> <span class="op">&lt;-</span> <span class="va">c</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">together_RIestThetas</span>,<span class="va">input_thetas</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html">everything</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">value</span> <span class="op">~</span> <span class="va">name</span>, data <span class="op">=</span> <span class="va">.</span><span class="op">)</span></span>
<span></span>
<span><span class="va">lm_q3rem</span> <span class="op">&lt;-</span> <span class="va">c</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">together_q3_rem</span>,<span class="va">input_thetas</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html">everything</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">value</span> <span class="op">~</span> <span class="va">name</span>, data <span class="op">=</span> <span class="va">.</span><span class="op">)</span></span>
<span></span>
<span><span class="va">lm_q3split</span> <span class="op">&lt;-</span> <span class="va">c</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">separate_catR</span>,<span class="va">input_thetas</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html">everything</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">value</span> <span class="op">~</span> <span class="va">name</span>, data <span class="op">=</span> <span class="va">.</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op">(</span><span class="va">lm_all</span>,<span class="va">lm_q3rem</span>,<span class="va">lm_q3split</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Model 1: value ~ name
Model 2: value ~ name
Model 3: value ~ name
  Res.Df    RSS Df Sum of Sq F Pr(&gt;F)
1   1198 2552.6                      
2   1198 2560.5  0   -7.8668         
3   1198 2570.7  0  -10.2168         </code></pre>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb40"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html">bind_rows</a></span><span class="op">(</span><span class="fu"><a href="https://generics.r-lib.org/reference/glance.html">glance</a></span><span class="op">(</span><span class="va">lm_all</span><span class="op">)</span>,</span>
<span>          <span class="fu"><a href="https://generics.r-lib.org/reference/glance.html">glance</a></span><span class="op">(</span><span class="va">lm_q3rem</span><span class="op">)</span>,</span>
<span>          <span class="fu"><a href="https://generics.r-lib.org/reference/glance.html">glance</a></span><span class="op">(</span><span class="va">lm_q3split</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://tibble.tidyverse.org/reference/add_column.html">add_column</a></span><span class="op">(</span>Model <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"All items"</span>,<span class="st">"Q3 removed"</span>,<span class="st">"Q3 split"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">Model</span>,<span class="va">statistic</span>,<span class="va">p.value</span>,<span class="va">logLik</span>,<span class="va">AIC</span>,<span class="va">BIC</span>,<span class="va">deviance</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 7
  Model      statistic p.value logLik   AIC   BIC deviance
  &lt;chr&gt;          &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;
1 All items     0.0314   0.859 -2156. 4317. 4332.    2553.
2 Q3 removed    0.206    0.650 -2157. 4321. 4336.    2560.
3 Q3 split      0.0134   0.908 -2160. 4326. 4341.    2571.</code></pre>
</div>
</div>
<p>Same analysis, but limited to the theta range from -1.5 to +1.5 logits, where differences seem the biggest.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb42"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">lm_all</span> <span class="op">&lt;-</span> <span class="va">c</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">together_RIestThetas</span>,<span class="va">input_thetas</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">input_thetas</span> <span class="op">&gt;</span> <span class="op">-</span><span class="fl">1.5</span> <span class="op">&amp;</span> <span class="va">input_thetas</span> <span class="op">&lt;</span> <span class="fl">1.5</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html">everything</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">value</span> <span class="op">~</span> <span class="va">name</span>, data <span class="op">=</span> <span class="va">.</span><span class="op">)</span></span>
<span></span>
<span><span class="va">lm_q3rem</span> <span class="op">&lt;-</span> <span class="va">c</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">together_q3_rem</span>,<span class="va">input_thetas</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">input_thetas</span> <span class="op">&gt;</span> <span class="op">-</span><span class="fl">1.5</span> <span class="op">&amp;</span> <span class="va">input_thetas</span> <span class="op">&lt;</span> <span class="fl">1.5</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html">everything</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">value</span> <span class="op">~</span> <span class="va">name</span>, data <span class="op">=</span> <span class="va">.</span><span class="op">)</span></span>
<span></span>
<span><span class="va">lm_q3split</span> <span class="op">&lt;-</span> <span class="va">c</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">separate_catR</span>,<span class="va">input_thetas</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">input_thetas</span> <span class="op">&gt;</span> <span class="op">-</span><span class="fl">1.5</span> <span class="op">&amp;</span> <span class="va">input_thetas</span> <span class="op">&lt;</span> <span class="fl">1.5</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html">everything</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">value</span> <span class="op">~</span> <span class="va">name</span>, data <span class="op">=</span> <span class="va">.</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op">(</span><span class="va">lm_all</span>,<span class="va">lm_q3rem</span>,<span class="va">lm_q3split</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Model 1: value ~ name
Model 2: value ~ name
Model 3: value ~ name
  Res.Df    RSS Df Sum of Sq F Pr(&gt;F)
1    848 606.93                      
2    848 623.18  0   -16.245         
3    848 609.47  0    13.708         </code></pre>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb44"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html">bind_rows</a></span><span class="op">(</span><span class="fu"><a href="https://generics.r-lib.org/reference/glance.html">glance</a></span><span class="op">(</span><span class="va">lm_all</span><span class="op">)</span>,</span>
<span>          <span class="fu"><a href="https://generics.r-lib.org/reference/glance.html">glance</a></span><span class="op">(</span><span class="va">lm_q3rem</span><span class="op">)</span>,</span>
<span>          <span class="fu"><a href="https://generics.r-lib.org/reference/glance.html">glance</a></span><span class="op">(</span><span class="va">lm_q3split</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://tibble.tidyverse.org/reference/add_column.html">add_column</a></span><span class="op">(</span>Model <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"All items"</span>,<span class="st">"Q3 removed"</span>,<span class="st">"Q3 split"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">Model</span>,<span class="va">statistic</span>,<span class="va">p.value</span>,<span class="va">logLik</span>,<span class="va">AIC</span>,<span class="va">BIC</span>,<span class="va">deviance</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 7
  Model      statistic p.value logLik   AIC   BIC deviance
  &lt;chr&gt;          &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;
1 All items    0.309     0.578 -1063. 2132. 2146.     607.
2 Q3 removed   1.02      0.314 -1074. 2154. 2169.     623.
3 Q3 split     0.00962   0.922 -1065. 2135. 2150.     609.</code></pre>
</div>
</div>
</section></section><section id="session-info" class="level2" data-number="4"><h2 data-number="4" class="anchored" data-anchor-id="session-info">
<span class="header-section-number">4</span> Session info</h2>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb46"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>R version 4.4.1 (2024-06-14)
Platform: aarch64-apple-darwin20
Running under: macOS Sonoma 14.6.1

Matrix products: default
BLAS:   /Library/Frameworks/R.framework/Versions/4.4-arm64/Resources/lib/libRblas.0.dylib 
LAPACK: /Library/Frameworks/R.framework/Versions/4.4-arm64/Resources/lib/libRlapack.dylib;  LAPACK version 3.12.0

locale:
[1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8

time zone: Europe/Stockholm
tzcode source: internal

attached base packages:
[1] grid      stats4    stats     graphics  grDevices utils     datasets 
[8] methods   base     

other attached packages:
 [1] broom_1.0.7          ghibli_0.3.4         summarytools_1.0.1  
 [4] RISEkbmRasch_0.2.4.6 janitor_2.2.0        hexbin_1.28.4       
 [7] catR_3.17            glue_1.7.0           ggrepel_0.9.6       
[10] patchwork_1.3.0      reshape_0.8.9        matrixStats_1.4.1   
[13] psychotree_0.16-1    psychotools_0.7-4    partykit_1.2-22     
[16] mvtnorm_1.3-1        libcoin_1.0-10       psych_2.4.6.26      
[19] mirt_1.42            lattice_0.22-6       kableExtra_1.4.0    
[22] formattable_0.2.1    iarm_0.4.3           eRm_1.0-6           
[25] lubridate_1.9.3      forcats_1.0.0        stringr_1.5.1       
[28] dplyr_1.1.4          purrr_1.0.2          readr_2.1.5         
[31] tidyr_1.3.1          tibble_3.2.1         ggplot2_3.5.1       
[34] tidyverse_2.0.0     

loaded via a namespace (and not attached):
  [1] vcd_1.4-12           rstudioapi_0.16.0    audio_0.1-11        
  [4] jsonlite_1.8.9       magrittr_2.0.3       magick_2.8.5        
  [7] farver_2.1.2         rmarkdown_2.28       vctrs_0.6.5         
 [10] base64enc_0.1-3      htmltools_0.5.8.1    curl_5.2.3          
 [13] cellranger_1.1.0     Formula_1.2-5        dcurver_0.9.2       
 [16] parallelly_1.38.0    htmlwidgets_1.6.4    plyr_1.8.9          
 [19] testthat_3.2.1.1     zoo_1.8-12           lifecycle_1.0.4     
 [22] pkgconfig_2.0.3      Matrix_1.7-0         R6_2.5.1            
 [25] fastmap_1.2.0        snakecase_0.11.1     future_1.34.0       
 [28] digest_0.6.37        colorspace_2.1-1     rprojroot_2.0.4     
 [31] prismatic_1.1.2      Hmisc_5.1-3          vegan_2.6-8         
 [34] progressr_0.14.0     fansi_1.0.6          timechange_0.3.0    
 [37] mgcv_1.9-1           compiler_4.4.1       here_1.0.1          
 [40] vcdExtra_0.8-5       pander_0.6.5         withr_3.0.1         
 [43] htmlTable_2.4.3      backports_1.5.0      relimp_1.0-5        
 [46] R.utils_2.12.3       MASS_7.3-61          sessioninfo_1.2.2   
 [49] GPArotation_2024.3-1 permute_0.9-7        tools_4.4.1         
 [52] foreign_0.8-87       lmtest_0.9-40        future.apply_1.11.2 
 [55] nnet_7.3-19          R.oo_1.26.0          nlme_3.1-165        
 [58] inum_1.0-5           checkmate_2.3.2      reshape2_1.4.4      
 [61] cluster_2.1.6        generics_0.1.3       snow_0.4-4          
 [64] gtable_0.3.5         RPushbullet_0.3.4    tzdb_0.4.0          
 [67] R.methodsS3_1.8.2    ca_0.71.1            data.table_1.16.0   
 [70] hms_1.1.3            xml2_1.3.6           Deriv_4.1.3         
 [73] utf8_1.2.4           pillar_1.9.0         splines_4.4.1       
 [76] pryr_0.1.6           survival_3.7-0       tidyselect_1.2.1    
 [79] pbapply_1.7-2        knitr_1.48           gridExtra_2.3       
 [82] svglite_2.1.3        xfun_0.46            gnm_1.1-5           
 [85] rapportools_1.1      brio_1.1.5           stringi_1.8.4       
 [88] yaml_2.3.10          evaluate_0.24.0      codetools_0.2-20    
 [91] beepr_2.0            tcltk_4.4.1          cli_3.6.3           
 [94] rpart_4.1.23         qvcalc_1.0.3         systemfonts_1.1.0   
 [97] munsell_0.5.1        Rcpp_1.0.13          readxl_1.4.3        
[100] globals_0.16.3       parallel_4.4.1       listenv_0.9.1       
[103] viridisLite_0.4.2    SimDesign_2.17.1     scales_1.3.0        
[106] rlang_1.1.4          mnormt_2.1.1        </code></pre>
</div>
</div>


<!-- -->

</section><div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-reuse"><h2 class="anchored quarto-appendix-heading">Reuse</h2><div class="quarto-appendix-contents"><div><a rel="license" href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a></div></div></section><section class="quarto-appendix-contents" id="quarto-citation"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@online{johansson2024,
  author = {Johansson, Magnus},
  title = {Rasch {DIF} Magnitude \&amp; Item Split},
  date = {2024-10-25},
  url = {https://pgmj.github.io/dif_magnitude.html},
  langid = {en}
}
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-johansson2024" class="csl-entry quarto-appendix-citeas" role="listitem">
Johansson, M. (2024, October 25). <em>Rasch DIF magnitude &amp; item
split</em>. <a href="https://pgmj.github.io/dif_magnitude.html">https://pgmj.github.io/dif_magnitude.html</a>
</div></div></section></div></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/pgmj\.github\.io");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><script src="https://giscus.app/client.js" data-repo="pgmj/pgmj.github.io" data-repo-id="R_kgDOGtKrEA" data-category="General" data-category-id="DIC_kwDOGtKrEM4CdX5K" data-mapping="title" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="top" data-theme="light" data-lang="en" crossorigin="anonymous" async="">
</script><input type="hidden" id="giscus-base-theme" value="light"><input type="hidden" id="giscus-alt-theme" value="dark"><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb48" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Rasch DIF magnitude &amp; item split"</span></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a><span class="an">subtitle:</span><span class="co"> "Brief exploration of Differential Item Functioning in R"</span></span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span><span class="co"> </span></span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a><span class="co">  name: Magnus Johansson</span></span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a><span class="co">  affiliation: RISE Research Institutes of Sweden</span></span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a><span class="co">  affiliation-url: https://www.ri.se/en/shic</span></span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a><span class="co">  orcid: 0000-0003-1669-592X</span></span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a><span class="an">date:</span><span class="co"> last-modified</span></span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a><span class="an">citation:</span></span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a><span class="co">  type: 'webpage'</span></span>
<span id="cb48-12"><a href="#cb48-12" aria-hidden="true" tabindex="-1"></a><span class="an">csl:</span><span class="co"> apa.csl</span></span>
<span id="cb48-13"><a href="#cb48-13" aria-hidden="true" tabindex="-1"></a><span class="an">execute:</span><span class="co"> </span></span>
<span id="cb48-14"><a href="#cb48-14" aria-hidden="true" tabindex="-1"></a><span class="co">  cache: true</span></span>
<span id="cb48-15"><a href="#cb48-15" aria-hidden="true" tabindex="-1"></a><span class="co">  warning: false</span></span>
<span id="cb48-16"><a href="#cb48-16" aria-hidden="true" tabindex="-1"></a><span class="co">  message: false</span></span>
<span id="cb48-17"><a href="#cb48-17" aria-hidden="true" tabindex="-1"></a><span class="an">editor:</span><span class="co"> </span></span>
<span id="cb48-18"><a href="#cb48-18" aria-hidden="true" tabindex="-1"></a><span class="co">  markdown: </span></span>
<span id="cb48-19"><a href="#cb48-19" aria-hidden="true" tabindex="-1"></a><span class="co">    wrap: 72</span></span>
<span id="cb48-20"><a href="#cb48-20" aria-hidden="true" tabindex="-1"></a><span class="an">editor_options:</span><span class="co"> </span></span>
<span id="cb48-21"><a href="#cb48-21" aria-hidden="true" tabindex="-1"></a><span class="co">  chunk_output_type: console</span></span>
<span id="cb48-22"><a href="#cb48-22" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb48-23"><a href="#cb48-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-24"><a href="#cb48-24" aria-hidden="true" tabindex="-1"></a><span class="fu">## Background</span></span>
<span id="cb48-25"><a href="#cb48-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-26"><a href="#cb48-26" aria-hidden="true" tabindex="-1"></a>Out of interest of better understanding som aspects of differential item functioning (DIF, a form of invariance test):</span>
<span id="cb48-27"><a href="#cb48-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-28"><a href="#cb48-28" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>how much does DIF affect estimated thetas (factor scores)?</span>
<span id="cb48-29"><a href="#cb48-29" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>how to do item-split in R (creating separate items for subgroups from one item with problematic DIF)</span>
<span id="cb48-30"><a href="#cb48-30" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>how an item-split compares to removing the item (and keeping the DIF item) in terms of absolute differences in estimated thetas</span>
<span id="cb48-31"><a href="#cb48-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-32"><a href="#cb48-32" aria-hidden="true" tabindex="-1"></a>We'll use simulated data in order to have knowledge of the thetas used to generate response data ("input thetas" in the text below), and make objective comparisons using the different estimated thetas.</span>
<span id="cb48-33"><a href="#cb48-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-34"><a href="#cb48-34" aria-hidden="true" tabindex="-1"></a>Ideally, this would be a simulation study where we create lots of datasets with a systematic variation in some parameters to investigate effects. But maybe this is a first step towards that.</span>
<span id="cb48-35"><a href="#cb48-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-36"><a href="#cb48-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-39"><a href="#cb48-39" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb48-40"><a href="#cb48-40" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb48-41"><a href="#cb48-41" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb48-42"><a href="#cb48-42" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(eRm)</span>
<span id="cb48-43"><a href="#cb48-43" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(iarm)</span>
<span id="cb48-44"><a href="#cb48-44" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RISEkbmRasch) <span class="co"># devtools::install_github("pgmj/RISEkbmRasch", dependencies = TRUE)</span></span>
<span id="cb48-45"><a href="#cb48-45" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(summarytools)</span>
<span id="cb48-46"><a href="#cb48-46" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ghibli)</span>
<span id="cb48-47"><a href="#cb48-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-48"><a href="#cb48-48" aria-hidden="true" tabindex="-1"></a><span class="do">### some commands exist in multiple packages, here we define preferred ones that are frequently used</span></span>
<span id="cb48-49"><a href="#cb48-49" aria-hidden="true" tabindex="-1"></a>select <span class="ot">&lt;-</span> dplyr<span class="sc">::</span>select</span>
<span id="cb48-50"><a href="#cb48-50" aria-hidden="true" tabindex="-1"></a>count <span class="ot">&lt;-</span> dplyr<span class="sc">::</span>count</span>
<span id="cb48-51"><a href="#cb48-51" aria-hidden="true" tabindex="-1"></a>recode <span class="ot">&lt;-</span> car<span class="sc">::</span>recode</span>
<span id="cb48-52"><a href="#cb48-52" aria-hidden="true" tabindex="-1"></a>rename <span class="ot">&lt;-</span> dplyr<span class="sc">::</span>rename</span>
<span id="cb48-53"><a href="#cb48-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-54"><a href="#cb48-54" aria-hidden="true" tabindex="-1"></a>theme_rise <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">fontfamily =</span> <span class="st">"Lato"</span>, <span class="at">axissize =</span> <span class="dv">13</span>, <span class="at">titlesize =</span> <span class="dv">15</span>,</span>
<span id="cb48-55"><a href="#cb48-55" aria-hidden="true" tabindex="-1"></a>                       <span class="at">margins =</span> <span class="dv">12</span>, <span class="at">axisface =</span> <span class="st">"plain"</span>, <span class="at">panelDist =</span> <span class="fl">0.6</span>, ...) {</span>
<span id="cb48-56"><a href="#cb48-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb48-57"><a href="#cb48-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb48-58"><a href="#cb48-58" aria-hidden="true" tabindex="-1"></a>    <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">family =</span> fontfamily),</span>
<span id="cb48-59"><a href="#cb48-59" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(</span>
<span id="cb48-60"><a href="#cb48-60" aria-hidden="true" tabindex="-1"></a>      <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> margins),</span>
<span id="cb48-61"><a href="#cb48-61" aria-hidden="true" tabindex="-1"></a>      <span class="at">size =</span> axissize</span>
<span id="cb48-62"><a href="#cb48-62" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb48-63"><a href="#cb48-63" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(</span>
<span id="cb48-64"><a href="#cb48-64" aria-hidden="true" tabindex="-1"></a>      <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">r =</span> margins),</span>
<span id="cb48-65"><a href="#cb48-65" aria-hidden="true" tabindex="-1"></a>      <span class="at">size =</span> axissize</span>
<span id="cb48-66"><a href="#cb48-66" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb48-67"><a href="#cb48-67" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(</span>
<span id="cb48-68"><a href="#cb48-68" aria-hidden="true" tabindex="-1"></a>      <span class="at">face =</span> <span class="st">"bold"</span>,</span>
<span id="cb48-69"><a href="#cb48-69" aria-hidden="true" tabindex="-1"></a>      <span class="at">size =</span> titlesize</span>
<span id="cb48-70"><a href="#cb48-70" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb48-71"><a href="#cb48-71" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(</span>
<span id="cb48-72"><a href="#cb48-72" aria-hidden="true" tabindex="-1"></a>      <span class="at">face =</span> axisface</span>
<span id="cb48-73"><a href="#cb48-73" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb48-74"><a href="#cb48-74" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.caption =</span> <span class="fu">element_text</span>(</span>
<span id="cb48-75"><a href="#cb48-75" aria-hidden="true" tabindex="-1"></a>      <span class="at">face =</span> <span class="st">"italic"</span></span>
<span id="cb48-76"><a href="#cb48-76" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb48-77"><a href="#cb48-77" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">family =</span> fontfamily),</span>
<span id="cb48-78"><a href="#cb48-78" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">color =</span> <span class="st">"lightgrey"</span>),</span>
<span id="cb48-79"><a href="#cb48-79" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.background =</span> <span class="fu">element_rect</span>(<span class="at">color =</span> <span class="st">"lightgrey"</span>),</span>
<span id="cb48-80"><a href="#cb48-80" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.spacing =</span> <span class="fu">unit</span>(panelDist, <span class="st">"cm"</span>, <span class="at">data =</span> <span class="cn">NULL</span>),</span>
<span id="cb48-81"><a href="#cb48-81" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.border =</span> <span class="fu">element_rect</span>(<span class="at">color =</span> <span class="st">"grey"</span>, <span class="at">fill =</span> <span class="cn">NA</span>),</span>
<span id="cb48-82"><a href="#cb48-82" aria-hidden="true" tabindex="-1"></a>    ...</span>
<span id="cb48-83"><a href="#cb48-83" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb48-84"><a href="#cb48-84" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb48-85"><a href="#cb48-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-86"><a href="#cb48-86" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_set</span>(<span class="fu">theme_rise</span>())</span>
<span id="cb48-87"><a href="#cb48-87" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb48-88"><a href="#cb48-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-89"><a href="#cb48-89" aria-hidden="true" tabindex="-1"></a><span class="fu">### Simulate response data</span></span>
<span id="cb48-90"><a href="#cb48-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-91"><a href="#cb48-91" aria-hidden="true" tabindex="-1"></a>First define input parameters for items.</span>
<span id="cb48-92"><a href="#cb48-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-95"><a href="#cb48-95" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb48-96"><a href="#cb48-96" aria-hidden="true" tabindex="-1"></a><span class="co"># make a tibble/dataframe also, for possible later use</span></span>
<span id="cb48-97"><a href="#cb48-97" aria-hidden="true" tabindex="-1"></a>inputParams1 <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb48-98"><a href="#cb48-98" aria-hidden="true" tabindex="-1"></a>  <span class="at">q1  =</span> <span class="fu">c</span>(<span class="fl">1.2</span>, <span class="fl">1.8</span>, <span class="fl">2.4</span>),</span>
<span id="cb48-99"><a href="#cb48-99" aria-hidden="true" tabindex="-1"></a>  <span class="at">q2  =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">1.3</span>, <span class="sc">-</span><span class="fl">0.5</span>, <span class="fl">0.5</span>),</span>
<span id="cb48-100"><a href="#cb48-100" aria-hidden="true" tabindex="-1"></a>  <span class="at">q3a =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.3</span>, <span class="fl">0.3</span>, <span class="fl">1.2</span>), <span class="co"># this is the DIF item</span></span>
<span id="cb48-101"><a href="#cb48-101" aria-hidden="true" tabindex="-1"></a>  <span class="at">q3b =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.3</span><span class="sc">+</span><span class="dv">1</span>, <span class="fl">0.3</span><span class="sc">+</span><span class="dv">1</span>, <span class="fl">1.2</span><span class="sc">+</span><span class="dv">1</span>), <span class="co"># this is the DIF item</span></span>
<span id="cb48-102"><a href="#cb48-102" aria-hidden="true" tabindex="-1"></a>  <span class="at">q4  =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.6</span>, <span class="fl">1.6</span>),</span>
<span id="cb48-103"><a href="#cb48-103" aria-hidden="true" tabindex="-1"></a>  <span class="at">q5  =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.3</span>, <span class="fl">0.7</span>, <span class="fl">1.5</span>),</span>
<span id="cb48-104"><a href="#cb48-104" aria-hidden="true" tabindex="-1"></a>  <span class="at">q6  =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">1.6</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="sc">-</span><span class="fl">0.3</span>),</span>
<span id="cb48-105"><a href="#cb48-105" aria-hidden="true" tabindex="-1"></a>  <span class="at">q7  =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">1.8</span>, <span class="fl">2.5</span>),</span>
<span id="cb48-106"><a href="#cb48-106" aria-hidden="true" tabindex="-1"></a>  <span class="at">q8  =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">1.3</span>, <span class="sc">-</span><span class="fl">0.7</span>, <span class="fl">0.4</span>),</span>
<span id="cb48-107"><a href="#cb48-107" aria-hidden="true" tabindex="-1"></a>  <span class="at">q9  =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.8</span>, <span class="fl">1.4</span>, <span class="fl">1.9</span>),</span>
<span id="cb48-108"><a href="#cb48-108" aria-hidden="true" tabindex="-1"></a>  <span class="at">q10 =</span> <span class="fu">c</span>(<span class="fl">0.25</span>, <span class="fl">1.25</span>, <span class="fl">2.15</span>)</span>
<span id="cb48-109"><a href="#cb48-109" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb48-110"><a href="#cb48-110" aria-hidden="true" tabindex="-1"></a>  <span class="fu">t</span>() <span class="sc">%&gt;%</span></span>
<span id="cb48-111"><a href="#cb48-111" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.matrix</span>()</span>
<span id="cb48-112"><a href="#cb48-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-113"><a href="#cb48-113" aria-hidden="true" tabindex="-1"></a><span class="co"># center to 0</span></span>
<span id="cb48-114"><a href="#cb48-114" aria-hidden="true" tabindex="-1"></a>inputParams1c <span class="ot">&lt;-</span> inputParams1 <span class="sc">-</span> <span class="fu">mean</span>(inputParams1)</span>
<span id="cb48-115"><a href="#cb48-115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-116"><a href="#cb48-116" aria-hidden="true" tabindex="-1"></a><span class="co"># item list for simulation for group 1</span></span>
<span id="cb48-117"><a href="#cb48-117" aria-hidden="true" tabindex="-1"></a>tlist1 <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb48-118"><a href="#cb48-118" aria-hidden="true" tabindex="-1"></a>  <span class="at">q1 =</span>  <span class="fu">list</span>(inputParams1c[<span class="dv">1</span>,]),</span>
<span id="cb48-119"><a href="#cb48-119" aria-hidden="true" tabindex="-1"></a>  <span class="at">q2 =</span>  <span class="fu">list</span>(inputParams1c[<span class="dv">2</span>,]),</span>
<span id="cb48-120"><a href="#cb48-120" aria-hidden="true" tabindex="-1"></a>  <span class="at">q3 =</span>  <span class="fu">list</span>(inputParams1c[<span class="dv">3</span>,]), <span class="co"># this is the DIF item</span></span>
<span id="cb48-121"><a href="#cb48-121" aria-hidden="true" tabindex="-1"></a>  <span class="at">q4 =</span>  <span class="fu">list</span>(inputParams1c[<span class="dv">5</span>,]),</span>
<span id="cb48-122"><a href="#cb48-122" aria-hidden="true" tabindex="-1"></a>  <span class="at">q5 =</span>  <span class="fu">list</span>(inputParams1c[<span class="dv">6</span>,]),</span>
<span id="cb48-123"><a href="#cb48-123" aria-hidden="true" tabindex="-1"></a>  <span class="at">q6 =</span>  <span class="fu">list</span>(inputParams1c[<span class="dv">7</span>,]),</span>
<span id="cb48-124"><a href="#cb48-124" aria-hidden="true" tabindex="-1"></a>  <span class="at">q7 =</span>  <span class="fu">list</span>(inputParams1c[<span class="dv">8</span>,]),</span>
<span id="cb48-125"><a href="#cb48-125" aria-hidden="true" tabindex="-1"></a>  <span class="at">q8 =</span>  <span class="fu">list</span>(inputParams1c[<span class="dv">9</span>,]),</span>
<span id="cb48-126"><a href="#cb48-126" aria-hidden="true" tabindex="-1"></a>  <span class="at">q9 =</span>  <span class="fu">list</span>(inputParams1c[<span class="dv">10</span>,]),</span>
<span id="cb48-127"><a href="#cb48-127" aria-hidden="true" tabindex="-1"></a>  <span class="at">q10 =</span> <span class="fu">list</span>(inputParams1c[<span class="dv">11</span>,])</span>
<span id="cb48-128"><a href="#cb48-128" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb48-129"><a href="#cb48-129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-130"><a href="#cb48-130" aria-hidden="true" tabindex="-1"></a><span class="co"># item list for simulation for group 2</span></span>
<span id="cb48-131"><a href="#cb48-131" aria-hidden="true" tabindex="-1"></a>tlist2 <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb48-132"><a href="#cb48-132" aria-hidden="true" tabindex="-1"></a>  <span class="at">q1 =</span>  <span class="fu">list</span>(inputParams1c[<span class="dv">1</span>,]),</span>
<span id="cb48-133"><a href="#cb48-133" aria-hidden="true" tabindex="-1"></a>  <span class="at">q2 =</span>  <span class="fu">list</span>(inputParams1c[<span class="dv">2</span>,]),</span>
<span id="cb48-134"><a href="#cb48-134" aria-hidden="true" tabindex="-1"></a>  <span class="at">q3 =</span>  <span class="fu">list</span>(inputParams1c[<span class="dv">4</span>,]), <span class="co"># this is the DIF item</span></span>
<span id="cb48-135"><a href="#cb48-135" aria-hidden="true" tabindex="-1"></a>  <span class="at">q4 =</span>  <span class="fu">list</span>(inputParams1c[<span class="dv">5</span>,]),</span>
<span id="cb48-136"><a href="#cb48-136" aria-hidden="true" tabindex="-1"></a>  <span class="at">q5 =</span>  <span class="fu">list</span>(inputParams1c[<span class="dv">6</span>,]),</span>
<span id="cb48-137"><a href="#cb48-137" aria-hidden="true" tabindex="-1"></a>  <span class="at">q6 =</span>  <span class="fu">list</span>(inputParams1c[<span class="dv">7</span>,]),</span>
<span id="cb48-138"><a href="#cb48-138" aria-hidden="true" tabindex="-1"></a>  <span class="at">q7 =</span>  <span class="fu">list</span>(inputParams1c[<span class="dv">8</span>,]),</span>
<span id="cb48-139"><a href="#cb48-139" aria-hidden="true" tabindex="-1"></a>  <span class="at">q8 =</span>  <span class="fu">list</span>(inputParams1c[<span class="dv">9</span>,]),</span>
<span id="cb48-140"><a href="#cb48-140" aria-hidden="true" tabindex="-1"></a>  <span class="at">q9 =</span>  <span class="fu">list</span>(inputParams1c[<span class="dv">10</span>,]),</span>
<span id="cb48-141"><a href="#cb48-141" aria-hidden="true" tabindex="-1"></a>  <span class="at">q10 =</span> <span class="fu">list</span>(inputParams1c[<span class="dv">11</span>,])</span>
<span id="cb48-142"><a href="#cb48-142" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb48-143"><a href="#cb48-143" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb48-144"><a href="#cb48-144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-145"><a href="#cb48-145" aria-hidden="true" tabindex="-1"></a>Then generate random thetas that we save to file to be able to reproduce the analysis.</span>
<span id="cb48-146"><a href="#cb48-146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-149"><a href="#cb48-149" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb48-150"><a href="#cb48-150" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb48-151"><a href="#cb48-151" aria-hidden="true" tabindex="-1"></a><span class="co"># simulate thetas</span></span>
<span id="cb48-152"><a href="#cb48-152" aria-hidden="true" tabindex="-1"></a>thetas1 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">300</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="fl">1.5</span>)</span>
<span id="cb48-153"><a href="#cb48-153" aria-hidden="true" tabindex="-1"></a>thetas2 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">300</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="fl">1.5</span>)</span>
<span id="cb48-154"><a href="#cb48-154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-155"><a href="#cb48-155" aria-hidden="true" tabindex="-1"></a>input_thetas <span class="ot">&lt;-</span> <span class="fu">c</span>(thetas1,thetas2)</span>
<span id="cb48-156"><a href="#cb48-156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-157"><a href="#cb48-157" aria-hidden="true" tabindex="-1"></a><span class="co"># simulate response data based on the above defined item thresholds</span></span>
<span id="cb48-158"><a href="#cb48-158" aria-hidden="true" tabindex="-1"></a>td1 <span class="ot">&lt;-</span> <span class="fu">SimPartialScore</span>(</span>
<span id="cb48-159"><a href="#cb48-159" aria-hidden="true" tabindex="-1"></a>  <span class="at">deltaslist =</span> tlist1,</span>
<span id="cb48-160"><a href="#cb48-160" aria-hidden="true" tabindex="-1"></a>  <span class="at">thetavec =</span> thetas1</span>
<span id="cb48-161"><a href="#cb48-161" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb48-162"><a href="#cb48-162" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>()</span>
<span id="cb48-163"><a href="#cb48-163" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-164"><a href="#cb48-164" aria-hidden="true" tabindex="-1"></a>td2 <span class="ot">&lt;-</span> <span class="fu">SimPartialScore</span>(</span>
<span id="cb48-165"><a href="#cb48-165" aria-hidden="true" tabindex="-1"></a>  <span class="at">deltaslist =</span> tlist2,</span>
<span id="cb48-166"><a href="#cb48-166" aria-hidden="true" tabindex="-1"></a>  <span class="at">thetavec =</span> thetas2</span>
<span id="cb48-167"><a href="#cb48-167" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb48-168"><a href="#cb48-168" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>()</span>
<span id="cb48-169"><a href="#cb48-169" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-170"><a href="#cb48-170" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">rbind</span>(td1,td2) <span class="sc">%&gt;%</span> </span>
<span id="cb48-171"><a href="#cb48-171" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_column</span>(<span class="at">group =</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="at">each =</span> <span class="dv">300</span>))</span>
<span id="cb48-172"><a href="#cb48-172" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-173"><a href="#cb48-173" aria-hidden="true" tabindex="-1"></a>dif.group <span class="ot">&lt;-</span> <span class="fu">factor</span>(d<span class="sc">$</span>group)</span>
<span id="cb48-174"><a href="#cb48-174" aria-hidden="true" tabindex="-1"></a>d<span class="sc">$</span>group <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb48-175"><a href="#cb48-175" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-176"><a href="#cb48-176" aria-hidden="true" tabindex="-1"></a>all_data <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">simResponses =</span> d,</span>
<span id="cb48-177"><a href="#cb48-177" aria-hidden="true" tabindex="-1"></a>                 <span class="at">dif_group =</span> dif.group,</span>
<span id="cb48-178"><a href="#cb48-178" aria-hidden="true" tabindex="-1"></a>                 <span class="at">input_thetas =</span> input_thetas)</span>
<span id="cb48-179"><a href="#cb48-179" aria-hidden="true" tabindex="-1"></a><span class="co"># save simulated data for reproducibility</span></span>
<span id="cb48-180"><a href="#cb48-180" aria-hidden="true" tabindex="-1"></a><span class="co">#saveRDS(all_data,"dif_magnitude_1_0.Rdata")</span></span>
<span id="cb48-181"><a href="#cb48-181" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb48-182"><a href="#cb48-182" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-185"><a href="#cb48-185" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb48-186"><a href="#cb48-186" aria-hidden="true" tabindex="-1"></a><span class="co"># read simulated data for reprodubility</span></span>
<span id="cb48-187"><a href="#cb48-187" aria-hidden="true" tabindex="-1"></a>all_data <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"dif_magnitude_1_0.Rdata"</span>)</span>
<span id="cb48-188"><a href="#cb48-188" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-189"><a href="#cb48-189" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> all_data<span class="sc">$</span>simResponses</span>
<span id="cb48-190"><a href="#cb48-190" aria-hidden="true" tabindex="-1"></a>dif.group <span class="ot">&lt;-</span> all_data<span class="sc">$</span>dif_group</span>
<span id="cb48-191"><a href="#cb48-191" aria-hidden="true" tabindex="-1"></a>input_thetas <span class="ot">&lt;-</span> all_data<span class="sc">$</span>input_thetas</span>
<span id="cb48-192"><a href="#cb48-192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-193"><a href="#cb48-193" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb48-194"><a href="#cb48-194" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-195"><a href="#cb48-195" aria-hidden="true" tabindex="-1"></a>We now have 10 items with 4 categories each. There are 600 respondents in all, with 300 showing differential item functioning for one item (item q3). DIF is induced at +1 logit uniform difference in location (all thresholds for item q3 are +1 logits).</span>
<span id="cb48-196"><a href="#cb48-196" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-197"><a href="#cb48-197" aria-hidden="true" tabindex="-1"></a><span class="fu">## DIF assessment</span></span>
<span id="cb48-198"><a href="#cb48-198" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-199"><a href="#cb48-199" aria-hidden="true" tabindex="-1"></a>Let's test for DIF with some different methods.</span>
<span id="cb48-200"><a href="#cb48-200" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-201"><a href="#cb48-201" aria-hidden="true" tabindex="-1"></a><span class="fu">### LR-test</span></span>
<span id="cb48-204"><a href="#cb48-204" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb48-205"><a href="#cb48-205" aria-hidden="true" tabindex="-1"></a><span class="fu">RIdifTableLR</span>(d, dif.group)</span>
<span id="cb48-206"><a href="#cb48-206" aria-hidden="true" tabindex="-1"></a><span class="fu">RIdifThreshFigLR</span>(d, dif.group)</span>
<span id="cb48-207"><a href="#cb48-207" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb48-208"><a href="#cb48-208" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-209"><a href="#cb48-209" aria-hidden="true" tabindex="-1"></a><span class="fu">### Partial gamma</span></span>
<span id="cb48-212"><a href="#cb48-212" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb48-213"><a href="#cb48-213" aria-hidden="true" tabindex="-1"></a><span class="fu">RIpartgamDIF</span>(d, dif.group)</span>
<span id="cb48-214"><a href="#cb48-214" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb48-215"><a href="#cb48-215" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-216"><a href="#cb48-216" aria-hidden="true" tabindex="-1"></a><span class="fu">### Psychotree</span></span>
<span id="cb48-219"><a href="#cb48-219" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb48-220"><a href="#cb48-220" aria-hidden="true" tabindex="-1"></a><span class="fu">RIdifTable</span>(d, dif.group)</span>
<span id="cb48-221"><a href="#cb48-221" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb48-222"><a href="#cb48-222" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-223"><a href="#cb48-223" aria-hidden="true" tabindex="-1"></a>DIF clearly shown.</span>
<span id="cb48-224"><a href="#cb48-224" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-225"><a href="#cb48-225" aria-hidden="true" tabindex="-1"></a><span class="fu">### Item split</span></span>
<span id="cb48-226"><a href="#cb48-226" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-227"><a href="#cb48-227" aria-hidden="true" tabindex="-1"></a>Now, we'll do an item split and compare thetas for both groups with and without split, and also with the DIF item removed.</span>
<span id="cb48-228"><a href="#cb48-228" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-229"><a href="#cb48-229" aria-hidden="true" tabindex="-1"></a><span class="in">``` {r}</span></span>
<span id="cb48-230"><a href="#cb48-230" aria-hidden="true" tabindex="-1"></a><span class="in">thetas_together &lt;- RIestThetas(d)</span></span>
<span id="cb48-231"><a href="#cb48-231" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-232"><a href="#cb48-232" aria-hidden="true" tabindex="-1"></a><span class="in">thetas_q3_removed &lt;- RIestThetas(d %&gt;% select(!q3))</span></span>
<span id="cb48-233"><a href="#cb48-233" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-234"><a href="#cb48-234" aria-hidden="true" tabindex="-1"></a><span class="in">d2 &lt;- d %&gt;% </span></span>
<span id="cb48-235"><a href="#cb48-235" aria-hidden="true" tabindex="-1"></a><span class="in">  add_column(group = dif.group) %&gt;% </span></span>
<span id="cb48-236"><a href="#cb48-236" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(q3a = if_else(group == 1, q3, NA), </span></span>
<span id="cb48-237"><a href="#cb48-237" aria-hidden="true" tabindex="-1"></a><span class="in">         q3b = if_else(group == 2, q3, NA)</span></span>
<span id="cb48-238"><a href="#cb48-238" aria-hidden="true" tabindex="-1"></a><span class="in">         ) %&gt;% </span></span>
<span id="cb48-239"><a href="#cb48-239" aria-hidden="true" tabindex="-1"></a><span class="in">  select(!group) %&gt;%</span></span>
<span id="cb48-240"><a href="#cb48-240" aria-hidden="true" tabindex="-1"></a><span class="in">  select(!q3)</span></span>
<span id="cb48-241"><a href="#cb48-241" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb48-242"><a href="#cb48-242" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-243"><a href="#cb48-243" aria-hidden="true" tabindex="-1"></a>Let's look at the data and a targeting plot.</span>
<span id="cb48-244"><a href="#cb48-244" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-245"><a href="#cb48-245" aria-hidden="true" tabindex="-1"></a><span class="in">``` {r}</span></span>
<span id="cb48-246"><a href="#cb48-246" aria-hidden="true" tabindex="-1"></a><span class="in">RItileplot(d2)</span></span>
<span id="cb48-247"><a href="#cb48-247" aria-hidden="true" tabindex="-1"></a><span class="in">RImissing(d2)</span></span>
<span id="cb48-248"><a href="#cb48-248" aria-hidden="true" tabindex="-1"></a><span class="in">RItargeting(d2)</span></span>
<span id="cb48-249"><a href="#cb48-249" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb48-250"><a href="#cb48-250" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-251"><a href="#cb48-251" aria-hidden="true" tabindex="-1"></a>Comparing to non-split data.</span>
<span id="cb48-252"><a href="#cb48-252" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-255"><a href="#cb48-255" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb48-256"><a href="#cb48-256" aria-hidden="true" tabindex="-1"></a><span class="fu">RItargeting</span>(d)</span>
<span id="cb48-257"><a href="#cb48-257" aria-hidden="true" tabindex="-1"></a>itemlabels <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">itemnr =</span> <span class="fu">names</span>(d), <span class="at">item =</span> <span class="st">""</span>)</span>
<span id="cb48-258"><a href="#cb48-258" aria-hidden="true" tabindex="-1"></a><span class="fu">RIitemHierarchy</span>(d)</span>
<span id="cb48-259"><a href="#cb48-259" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb48-260"><a href="#cb48-260" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-261"><a href="#cb48-261" aria-hidden="true" tabindex="-1"></a><span class="fu">### Estimating thetas</span></span>
<span id="cb48-262"><a href="#cb48-262" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-265"><a href="#cb48-265" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb48-266"><a href="#cb48-266" aria-hidden="true" tabindex="-1"></a><span class="co">#| layout-ncol: 2</span></span>
<span id="cb48-267"><a href="#cb48-267" aria-hidden="true" tabindex="-1"></a>thetas_separate <span class="ot">&lt;-</span> <span class="fu">RIestThetas</span>(d2)</span>
<span id="cb48-268"><a href="#cb48-268" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-269"><a href="#cb48-269" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(thetas_separate<span class="sc">$</span>WLE, <span class="at">breaks =</span> <span class="dv">30</span>, <span class="at">col =</span> <span class="st">"lightblue"</span>)</span>
<span id="cb48-270"><a href="#cb48-270" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(thetas_together<span class="sc">$</span>WLE, <span class="at">breaks =</span> <span class="dv">30</span>, <span class="at">col =</span> <span class="st">"lightpink"</span>)</span>
<span id="cb48-271"><a href="#cb48-271" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(thetas_q3_removed<span class="sc">$</span>WLE, <span class="at">breaks =</span> <span class="dv">30</span>, , <span class="at">col =</span> <span class="st">"sienna4"</span>)</span>
<span id="cb48-272"><a href="#cb48-272" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-273"><a href="#cb48-273" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(thetas_separate<span class="sc">$</span>WLE)</span>
<span id="cb48-274"><a href="#cb48-274" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(thetas_together<span class="sc">$</span>WLE)</span>
<span id="cb48-275"><a href="#cb48-275" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(thetas_q3_removed<span class="sc">$</span>WLE)</span>
<span id="cb48-276"><a href="#cb48-276" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb48-277"><a href="#cb48-277" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-278"><a href="#cb48-278" aria-hidden="true" tabindex="-1"></a>The upper range is rather different for the item split subgroup when using this method, with max score of 2.22, compared to (expected) ~ 4.1. Let's review the threshold locations.</span>
<span id="cb48-279"><a href="#cb48-279" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-280"><a href="#cb48-280" aria-hidden="true" tabindex="-1"></a><span class="fu">### Comparing item parameters</span></span>
<span id="cb48-281"><a href="#cb48-281" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-282"><a href="#cb48-282" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb48-283"><a href="#cb48-283" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Original data</span></span>
<span id="cb48-286"><a href="#cb48-286" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb48-287"><a href="#cb48-287" aria-hidden="true" tabindex="-1"></a><span class="fu">RIitemparams</span>(d)</span>
<span id="cb48-288"><a href="#cb48-288" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb48-289"><a href="#cb48-289" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-290"><a href="#cb48-290" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Item split</span></span>
<span id="cb48-293"><a href="#cb48-293" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb48-294"><a href="#cb48-294" aria-hidden="true" tabindex="-1"></a><span class="fu">RIitemparams</span>(d2)</span>
<span id="cb48-295"><a href="#cb48-295" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb48-296"><a href="#cb48-296" aria-hidden="true" tabindex="-1"></a><span class="fu">#### DIF item removed</span></span>
<span id="cb48-299"><a href="#cb48-299" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb48-300"><a href="#cb48-300" aria-hidden="true" tabindex="-1"></a><span class="fu">RIitemparams</span>(d <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">!</span>q3))</span>
<span id="cb48-301"><a href="#cb48-301" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb48-302"><a href="#cb48-302" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-303"><a href="#cb48-303" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Plot estimation bias</span></span>
<span id="cb48-306"><a href="#cb48-306" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb48-307"><a href="#cb48-307" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb48-308"><a href="#cb48-308" aria-hidden="true" tabindex="-1"></a>dp <span class="ot">&lt;-</span> <span class="fu">RIitemparams</span>(d, <span class="at">output =</span> <span class="st">"dataframe"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb48-309"><a href="#cb48-309" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">!</span>Location) <span class="sc">%&gt;%</span> </span>
<span id="cb48-310"><a href="#cb48-310" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_names</span>(<span class="fu">paste0</span>(<span class="st">"orig_"</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb48-311"><a href="#cb48-311" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>(<span class="st">"item"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb48-312"><a href="#cb48-312" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(item,<span class="st">"q3"</span>))</span>
<span id="cb48-313"><a href="#cb48-313" aria-hidden="true" tabindex="-1"></a>dp2 <span class="ot">&lt;-</span> <span class="fu">RIitemparams</span>(d2, <span class="at">output =</span> <span class="st">"dataframe"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb48-314"><a href="#cb48-314" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">!</span>Location) <span class="sc">%&gt;%</span> </span>
<span id="cb48-315"><a href="#cb48-315" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_names</span>(<span class="fu">paste0</span>(<span class="st">"split_"</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb48-316"><a href="#cb48-316" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>(<span class="st">"item"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb48-317"><a href="#cb48-317" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(item,<span class="st">"q3"</span>))</span>
<span id="cb48-318"><a href="#cb48-318" aria-hidden="true" tabindex="-1"></a>dp3 <span class="ot">&lt;-</span> <span class="fu">RIitemparams</span>(d <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">!</span>q3), <span class="at">output =</span> <span class="st">"dataframe"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb48-319"><a href="#cb48-319" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">!</span>Location) <span class="sc">%&gt;%</span> </span>
<span id="cb48-320"><a href="#cb48-320" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_names</span>(<span class="fu">paste0</span>(<span class="st">"q3rem_"</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>))  <span class="sc">%&gt;%</span> </span>
<span id="cb48-321"><a href="#cb48-321" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>(<span class="st">"item"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb48-322"><a href="#cb48-322" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(item,<span class="st">"q3"</span>))</span>
<span id="cb48-323"><a href="#cb48-323" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-324"><a href="#cb48-324" aria-hidden="true" tabindex="-1"></a>d_params <span class="ot">&lt;-</span> <span class="fu">cbind</span>(dp,dp2[,<span class="sc">-</span><span class="dv">1</span>],dp3[,<span class="sc">-</span><span class="dv">1</span>]) <span class="co"># bind columns, keeping one "item" column</span></span>
<span id="cb48-325"><a href="#cb48-325" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-326"><a href="#cb48-326" aria-hidden="true" tabindex="-1"></a>dpin <span class="ot">&lt;-</span> inputParams1c <span class="sc">%&gt;%</span> </span>
<span id="cb48-327"><a href="#cb48-327" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb48-328"><a href="#cb48-328" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_names</span>(<span class="fu">paste0</span>(<span class="st">"input_"</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb48-329"><a href="#cb48-329" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>(<span class="st">"item"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb48-330"><a href="#cb48-330" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(item,<span class="st">"q3"</span>))</span>
<span id="cb48-331"><a href="#cb48-331" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-332"><a href="#cb48-332" aria-hidden="true" tabindex="-1"></a>dpin_long <span class="ot">&lt;-</span> dpin <span class="sc">%&gt;%</span> </span>
<span id="cb48-333"><a href="#cb48-333" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">!</span>item,</span>
<span id="cb48-334"><a href="#cb48-334" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_sep =</span> <span class="st">"_"</span>,</span>
<span id="cb48-335"><a href="#cb48-335" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="fu">c</span>(<span class="st">"source"</span>,<span class="st">"threshold"</span>),</span>
<span id="cb48-336"><a href="#cb48-336" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">"input"</span>)</span>
<span id="cb48-337"><a href="#cb48-337" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb48-338"><a href="#cb48-338" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-339"><a href="#cb48-339" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-342"><a href="#cb48-342" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb48-343"><a href="#cb48-343" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb48-344"><a href="#cb48-344" aria-hidden="true" tabindex="-1"></a>d_params <span class="sc">%&gt;%</span> </span>
<span id="cb48-345"><a href="#cb48-345" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">!</span>item, </span>
<span id="cb48-346"><a href="#cb48-346" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_sep =</span> <span class="st">"_"</span>,</span>
<span id="cb48-347"><a href="#cb48-347" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="fu">c</span>(<span class="st">"source"</span>,<span class="st">"threshold"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb48-348"><a href="#cb48-348" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(dpin_long[,<span class="sc">-</span><span class="dv">2</span>], <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"item"</span>,<span class="st">"threshold"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb48-349"><a href="#cb48-349" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(source,item,threshold) <span class="sc">%&gt;%</span> </span>
<span id="cb48-350"><a href="#cb48-350" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">abs_diff =</span> <span class="fu">abs</span>(input <span class="sc">-</span> value)) <span class="sc">%&gt;%</span> </span>
<span id="cb48-351"><a href="#cb48-351" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb48-352"><a href="#cb48-352" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> threshold, <span class="at">y =</span> abs_diff, <span class="at">color =</span> source)) <span class="sc">+</span></span>
<span id="cb48-353"><a href="#cb48-353" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>, <span class="at">alpha =</span> <span class="fl">0.85</span>) <span class="sc">+</span></span>
<span id="cb48-354"><a href="#cb48-354" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> source)) <span class="sc">+</span></span>
<span id="cb48-355"><a href="#cb48-355" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> item) <span class="sc">+</span></span>
<span id="cb48-356"><a href="#cb48-356" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Absolute bias (logits)"</span>)</span>
<span id="cb48-357"><a href="#cb48-357" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb48-358"><a href="#cb48-358" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb48-359"><a href="#cb48-359" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Summary plot estimation bias</span></span>
<span id="cb48-362"><a href="#cb48-362" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb48-363"><a href="#cb48-363" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb48-364"><a href="#cb48-364" aria-hidden="true" tabindex="-1"></a>itemlocs <span class="ot">&lt;-</span> <span class="fu">RIitemparams</span>(d <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">!</span>q3), <span class="at">output =</span> <span class="st">"dataframe"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb48-365"><a href="#cb48-365" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(Location)</span>
<span id="cb48-366"><a href="#cb48-366" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-367"><a href="#cb48-367" aria-hidden="true" tabindex="-1"></a>item_order <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">as.numeric</span>(itemlocs))</span>
<span id="cb48-368"><a href="#cb48-368" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-369"><a href="#cb48-369" aria-hidden="true" tabindex="-1"></a>d_params <span class="sc">%&gt;%</span> </span>
<span id="cb48-370"><a href="#cb48-370" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">!</span>item, </span>
<span id="cb48-371"><a href="#cb48-371" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_sep =</span> <span class="st">"_"</span>,</span>
<span id="cb48-372"><a href="#cb48-372" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="fu">c</span>(<span class="st">"source"</span>,<span class="st">"threshold"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb48-373"><a href="#cb48-373" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(dpin_long[,<span class="sc">-</span><span class="dv">2</span>], <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"item"</span>,<span class="st">"threshold"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb48-374"><a href="#cb48-374" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(source,item,threshold) <span class="sc">%&gt;%</span> </span>
<span id="cb48-375"><a href="#cb48-375" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">abs_diff =</span> <span class="fu">abs</span>(input <span class="sc">-</span> value)) <span class="sc">%&gt;%</span> </span>
<span id="cb48-376"><a href="#cb48-376" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb48-377"><a href="#cb48-377" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(source,item) <span class="sc">%&gt;%</span> </span>
<span id="cb48-378"><a href="#cb48-378" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">sum_diff =</span> <span class="fu">sum</span>(abs_diff)) <span class="sc">%&gt;%</span> </span>
<span id="cb48-379"><a href="#cb48-379" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb48-380"><a href="#cb48-380" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">values_from =</span> <span class="st">"sum_diff"</span>,</span>
<span id="cb48-381"><a href="#cb48-381" aria-hidden="true" tabindex="-1"></a>              <span class="at">names_from =</span> <span class="st">"source"</span>,</span>
<span id="cb48-382"><a href="#cb48-382" aria-hidden="true" tabindex="-1"></a>              <span class="at">id_cols =</span> <span class="st">"item"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb48-383"><a href="#cb48-383" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">!</span>item) <span class="sc">%&gt;%</span> </span>
<span id="cb48-384"><a href="#cb48-384" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">item =</span> <span class="fu">factor</span>(item, <span class="at">levels =</span> <span class="fu">names</span>(itemlocs), </span>
<span id="cb48-385"><a href="#cb48-385" aria-hidden="true" tabindex="-1"></a>                        <span class="at">labels =</span> <span class="fu">paste0</span>(<span class="fu">names</span>(itemlocs),<span class="st">"_"</span>,<span class="fu">as.numeric</span>(itemlocs)))) <span class="sc">%&gt;%</span> </span>
<span id="cb48-386"><a href="#cb48-386" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> item, </span>
<span id="cb48-387"><a href="#cb48-387" aria-hidden="true" tabindex="-1"></a>             <span class="at">y =</span> value, </span>
<span id="cb48-388"><a href="#cb48-388" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> name)</span>
<span id="cb48-389"><a href="#cb48-389" aria-hidden="true" tabindex="-1"></a>         ) <span class="sc">+</span></span>
<span id="cb48-390"><a href="#cb48-390" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb48-391"><a href="#cb48-391" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Total estimation bias for each item (all thresholds) and item set"</span>,</span>
<span id="cb48-392"><a href="#cb48-392" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Absolute bias (logits)"</span>,</span>
<span id="cb48-393"><a href="#cb48-393" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Item (and average location)"</span>) <span class="sc">+</span></span>
<span id="cb48-394"><a href="#cb48-394" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="cn">NA</span>))</span>
<span id="cb48-395"><a href="#cb48-395" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb48-396"><a href="#cb48-396" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb48-397"><a href="#cb48-397" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-398"><a href="#cb48-398" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-399"><a href="#cb48-399" aria-hidden="true" tabindex="-1"></a><span class="fu">#### `mirt` comparison</span></span>
<span id="cb48-400"><a href="#cb48-400" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-401"><a href="#cb48-401" aria-hidden="true" tabindex="-1"></a>Perhaps the <span class="in">`mirt`</span> package could be more accurate in item threshold estimation when we have item split?</span>
<span id="cb48-402"><a href="#cb48-402" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-405"><a href="#cb48-405" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb48-406"><a href="#cb48-406" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb48-407"><a href="#cb48-407" aria-hidden="true" tabindex="-1"></a>mirt_out <span class="ot">&lt;-</span> <span class="fu">mirt</span>(<span class="at">data =</span> d, <span class="at">model =</span> <span class="dv">1</span>, <span class="at">itemtype =</span> <span class="st">"Rasch"</span>, <span class="at">verbose =</span> <span class="cn">FALSE</span>)</span>
<span id="cb48-408"><a href="#cb48-408" aria-hidden="true" tabindex="-1"></a>mirt_params <span class="ot">&lt;-</span> <span class="fu">coef</span>(mirt_out, <span class="at">simplify =</span> <span class="cn">TRUE</span>, <span class="at">IRTpars =</span> <span class="cn">TRUE</span>)<span class="sc">$</span>items <span class="sc">%&gt;%</span></span>
<span id="cb48-409"><a href="#cb48-409" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb48-410"><a href="#cb48-410" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">!</span>a) <span class="sc">%&gt;%</span></span>
<span id="cb48-411"><a href="#cb48-411" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_names</span>(<span class="fu">paste0</span>(<span class="st">"orig_"</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>)) <span class="sc">%&gt;%</span>   </span>
<span id="cb48-412"><a href="#cb48-412" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.matrix</span>()</span>
<span id="cb48-413"><a href="#cb48-413" aria-hidden="true" tabindex="-1"></a>dpm <span class="ot">&lt;-</span> mirt_params <span class="sc">-</span> <span class="fu">mean</span>(mirt_params)</span>
<span id="cb48-414"><a href="#cb48-414" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-415"><a href="#cb48-415" aria-hidden="true" tabindex="-1"></a>dpm <span class="ot">&lt;-</span> dpm <span class="sc">%&gt;%</span> </span>
<span id="cb48-416"><a href="#cb48-416" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb48-417"><a href="#cb48-417" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>(<span class="st">"item"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb48-418"><a href="#cb48-418" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(item,<span class="st">"q3"</span>))</span>
<span id="cb48-419"><a href="#cb48-419" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-420"><a href="#cb48-420" aria-hidden="true" tabindex="-1"></a>mirt_out <span class="ot">&lt;-</span> <span class="fu">mirt</span>(<span class="at">data =</span> d2, <span class="at">model =</span> <span class="dv">1</span>, <span class="at">itemtype =</span> <span class="st">"Rasch"</span>, <span class="at">verbose =</span> <span class="cn">FALSE</span>)</span>
<span id="cb48-421"><a href="#cb48-421" aria-hidden="true" tabindex="-1"></a>mirt_params <span class="ot">&lt;-</span> <span class="fu">coef</span>(mirt_out, <span class="at">simplify =</span> <span class="cn">TRUE</span>, <span class="at">IRTpars =</span> <span class="cn">TRUE</span>)<span class="sc">$</span>items <span class="sc">%&gt;%</span></span>
<span id="cb48-422"><a href="#cb48-422" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb48-423"><a href="#cb48-423" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">!</span>a) <span class="sc">%&gt;%</span></span>
<span id="cb48-424"><a href="#cb48-424" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_names</span>(<span class="fu">paste0</span>(<span class="st">"split_"</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb48-425"><a href="#cb48-425" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.matrix</span>()</span>
<span id="cb48-426"><a href="#cb48-426" aria-hidden="true" tabindex="-1"></a>dpm2 <span class="ot">&lt;-</span> mirt_params <span class="sc">-</span> <span class="fu">mean</span>(mirt_params)</span>
<span id="cb48-427"><a href="#cb48-427" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-428"><a href="#cb48-428" aria-hidden="true" tabindex="-1"></a>dpm2 <span class="ot">&lt;-</span> dpm2 <span class="sc">%&gt;%</span> </span>
<span id="cb48-429"><a href="#cb48-429" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb48-430"><a href="#cb48-430" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>(<span class="st">"item"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb48-431"><a href="#cb48-431" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(item,<span class="st">"q3"</span>))</span>
<span id="cb48-432"><a href="#cb48-432" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-433"><a href="#cb48-433" aria-hidden="true" tabindex="-1"></a>mirt_out <span class="ot">&lt;-</span> <span class="fu">mirt</span>(<span class="at">data =</span> d <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">!</span>q3), <span class="at">model =</span> <span class="dv">1</span>, <span class="at">itemtype =</span> <span class="st">"Rasch"</span>, <span class="at">verbose =</span> <span class="cn">FALSE</span>)</span>
<span id="cb48-434"><a href="#cb48-434" aria-hidden="true" tabindex="-1"></a>mirt_params <span class="ot">&lt;-</span> <span class="fu">coef</span>(mirt_out, <span class="at">simplify =</span> <span class="cn">TRUE</span>, <span class="at">IRTpars =</span> <span class="cn">TRUE</span>)<span class="sc">$</span>items <span class="sc">%&gt;%</span></span>
<span id="cb48-435"><a href="#cb48-435" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb48-436"><a href="#cb48-436" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">!</span>a) <span class="sc">%&gt;%</span></span>
<span id="cb48-437"><a href="#cb48-437" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_names</span>(<span class="fu">paste0</span>(<span class="st">"q3rem_"</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb48-438"><a href="#cb48-438" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.matrix</span>()</span>
<span id="cb48-439"><a href="#cb48-439" aria-hidden="true" tabindex="-1"></a>dpm3 <span class="ot">&lt;-</span> mirt_params <span class="sc">-</span> <span class="fu">mean</span>(mirt_params)</span>
<span id="cb48-440"><a href="#cb48-440" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-441"><a href="#cb48-441" aria-hidden="true" tabindex="-1"></a>dpm3 <span class="ot">&lt;-</span> dpm3 <span class="sc">%&gt;%</span> </span>
<span id="cb48-442"><a href="#cb48-442" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb48-443"><a href="#cb48-443" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>(<span class="st">"item"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb48-444"><a href="#cb48-444" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(item,<span class="st">"q3"</span>))</span>
<span id="cb48-445"><a href="#cb48-445" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-446"><a href="#cb48-446" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-447"><a href="#cb48-447" aria-hidden="true" tabindex="-1"></a>d_params2 <span class="ot">&lt;-</span> <span class="fu">cbind</span>(dpm,dpm2[,<span class="sc">-</span><span class="dv">1</span>],dpm3[,<span class="sc">-</span><span class="dv">1</span>]) <span class="co"># bind columns, keeping one "item" column</span></span>
<span id="cb48-448"><a href="#cb48-448" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb48-449"><a href="#cb48-449" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb48-450"><a href="#cb48-450" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Plot estimation bias</span></span>
<span id="cb48-453"><a href="#cb48-453" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb48-454"><a href="#cb48-454" aria-hidden="true" tabindex="-1"></a>d_params2 <span class="sc">%&gt;%</span> </span>
<span id="cb48-455"><a href="#cb48-455" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">!</span>item, </span>
<span id="cb48-456"><a href="#cb48-456" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_sep =</span> <span class="st">"_"</span>,</span>
<span id="cb48-457"><a href="#cb48-457" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="fu">c</span>(<span class="st">"source"</span>,<span class="st">"threshold"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb48-458"><a href="#cb48-458" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(dpin_long[,<span class="sc">-</span><span class="dv">2</span>], <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"item"</span>,<span class="st">"threshold"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb48-459"><a href="#cb48-459" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(source,item,threshold) <span class="sc">%&gt;%</span> </span>
<span id="cb48-460"><a href="#cb48-460" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">abs_diff =</span> <span class="fu">abs</span>(input <span class="sc">-</span> value)) <span class="sc">%&gt;%</span> </span>
<span id="cb48-461"><a href="#cb48-461" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb48-462"><a href="#cb48-462" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> threshold, <span class="at">y =</span> abs_diff, <span class="at">color =</span> source)) <span class="sc">+</span></span>
<span id="cb48-463"><a href="#cb48-463" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.85</span>) <span class="sc">+</span></span>
<span id="cb48-464"><a href="#cb48-464" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> item)</span>
<span id="cb48-465"><a href="#cb48-465" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb48-466"><a href="#cb48-466" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb48-467"><a href="#cb48-467" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-468"><a href="#cb48-468" aria-hidden="true" tabindex="-1"></a>Seems indentical to eRm estimates.</span>
<span id="cb48-469"><a href="#cb48-469" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-470"><a href="#cb48-470" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Summary plot estimation bias</span></span>
<span id="cb48-473"><a href="#cb48-473" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb48-474"><a href="#cb48-474" aria-hidden="true" tabindex="-1"></a>d_params2 <span class="sc">%&gt;%</span> </span>
<span id="cb48-475"><a href="#cb48-475" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">!</span>item, </span>
<span id="cb48-476"><a href="#cb48-476" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_sep =</span> <span class="st">"_"</span>,</span>
<span id="cb48-477"><a href="#cb48-477" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="fu">c</span>(<span class="st">"source"</span>,<span class="st">"threshold"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb48-478"><a href="#cb48-478" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(dpin_long[,<span class="sc">-</span><span class="dv">2</span>], <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"item"</span>,<span class="st">"threshold"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb48-479"><a href="#cb48-479" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(source,item,threshold) <span class="sc">%&gt;%</span> </span>
<span id="cb48-480"><a href="#cb48-480" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">abs_diff =</span> <span class="fu">abs</span>(input <span class="sc">-</span> value)) <span class="sc">%&gt;%</span> </span>
<span id="cb48-481"><a href="#cb48-481" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb48-482"><a href="#cb48-482" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(source,item) <span class="sc">%&gt;%</span> </span>
<span id="cb48-483"><a href="#cb48-483" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">sum_diff =</span> <span class="fu">sum</span>(abs_diff)) <span class="sc">%&gt;%</span> </span>
<span id="cb48-484"><a href="#cb48-484" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb48-485"><a href="#cb48-485" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">values_from =</span> <span class="st">"sum_diff"</span>,</span>
<span id="cb48-486"><a href="#cb48-486" aria-hidden="true" tabindex="-1"></a>              <span class="at">names_from =</span> <span class="st">"source"</span>,</span>
<span id="cb48-487"><a href="#cb48-487" aria-hidden="true" tabindex="-1"></a>              <span class="at">id_cols =</span> <span class="st">"item"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb48-488"><a href="#cb48-488" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">!</span>item) <span class="sc">%&gt;%</span> </span>
<span id="cb48-489"><a href="#cb48-489" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">item =</span> <span class="fu">factor</span>(item, <span class="at">levels =</span> <span class="fu">names</span>(itemlocs), </span>
<span id="cb48-490"><a href="#cb48-490" aria-hidden="true" tabindex="-1"></a>                        <span class="at">labels =</span> <span class="fu">paste0</span>(<span class="fu">names</span>(itemlocs),<span class="st">"_"</span>,<span class="fu">as.numeric</span>(itemlocs)))) <span class="sc">%&gt;%</span> </span>
<span id="cb48-491"><a href="#cb48-491" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> item, </span>
<span id="cb48-492"><a href="#cb48-492" aria-hidden="true" tabindex="-1"></a>             <span class="at">y =</span> value, </span>
<span id="cb48-493"><a href="#cb48-493" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> name)</span>
<span id="cb48-494"><a href="#cb48-494" aria-hidden="true" tabindex="-1"></a>         ) <span class="sc">+</span></span>
<span id="cb48-495"><a href="#cb48-495" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb48-496"><a href="#cb48-496" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"mirt: Total estimation bias for each item and item set"</span>)</span>
<span id="cb48-497"><a href="#cb48-497" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb48-498"><a href="#cb48-498" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-499"><a href="#cb48-499" aria-hidden="true" tabindex="-1"></a>No difference here either.</span>
<span id="cb48-500"><a href="#cb48-500" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb48-501"><a href="#cb48-501" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-502"><a href="#cb48-502" aria-hidden="true" tabindex="-1"></a><span class="fu">### Theta estimation investigated</span></span>
<span id="cb48-503"><a href="#cb48-503" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-504"><a href="#cb48-504" aria-hidden="true" tabindex="-1"></a>The method for estimating item parameters and thetas used in the function <span class="in">`RIestThetas()`</span> may be at fault for the odd results in thetas estimated by the item set with item split? We can separate the two steps, and use a separate function for theta estimation with manual input of item parameters.</span>
<span id="cb48-505"><a href="#cb48-505" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-508"><a href="#cb48-508" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb48-509"><a href="#cb48-509" aria-hidden="true" tabindex="-1"></a>itemps <span class="ot">&lt;-</span> <span class="fu">RIitemparams</span>(d2, <span class="at">output =</span> <span class="st">"dataframe"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb48-510"><a href="#cb48-510" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">!</span>Location) <span class="sc">%&gt;%</span> </span>
<span id="cb48-511"><a href="#cb48-511" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.matrix</span>()</span>
<span id="cb48-512"><a href="#cb48-512" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-513"><a href="#cb48-513" aria-hidden="true" tabindex="-1"></a>thetas_separate_catR <span class="ot">&lt;-</span> <span class="fu">RIestThetasOLD</span>(d2, <span class="at">itemParams =</span> itemps, <span class="at">theta_range =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">8</span>,<span class="dv">8</span>))</span>
<span id="cb48-514"><a href="#cb48-514" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-515"><a href="#cb48-515" aria-hidden="true" tabindex="-1"></a>c <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">together_RIestThetas =</span> thetas_together<span class="sc">$</span>WLE,</span>
<span id="cb48-516"><a href="#cb48-516" aria-hidden="true" tabindex="-1"></a>           <span class="at">together_q3_rem =</span> thetas_q3_removed<span class="sc">$</span>WLE,</span>
<span id="cb48-517"><a href="#cb48-517" aria-hidden="true" tabindex="-1"></a>           <span class="at">separate_catR =</span> thetas_separate_catR,</span>
<span id="cb48-518"><a href="#cb48-518" aria-hidden="true" tabindex="-1"></a>           <span class="at">separate_RIestThetas =</span> thetas_separate<span class="sc">$</span>WLE,</span>
<span id="cb48-519"><a href="#cb48-519" aria-hidden="true" tabindex="-1"></a>           <span class="at">input_thetas =</span> input_thetas)</span>
<span id="cb48-520"><a href="#cb48-520" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-521"><a href="#cb48-521" aria-hidden="true" tabindex="-1"></a>c <span class="sc">%&gt;%</span> </span>
<span id="cb48-522"><a href="#cb48-522" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">everything</span>(),</span>
<span id="cb48-523"><a href="#cb48-523" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">"method"</span>,</span>
<span id="cb48-524"><a href="#cb48-524" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">"theta"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb48-525"><a href="#cb48-525" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> theta)) <span class="sc">+</span></span>
<span id="cb48-526"><a href="#cb48-526" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">50</span>) <span class="sc">+</span></span>
<span id="cb48-527"><a href="#cb48-527" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>method, <span class="at">axes =</span> <span class="st">"all_x"</span>) <span class="sc">+</span></span>
<span id="cb48-528"><a href="#cb48-528" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">1</span>))</span>
<span id="cb48-529"><a href="#cb48-529" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb48-530"><a href="#cb48-530" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-531"><a href="#cb48-531" aria-hidden="true" tabindex="-1"></a>Looks like the two step approach worked a lot better. Since the item parameter estimation is identical (both are using <span class="in">`eRm::PCM()`</span>), the reason should be the difference in theta estimation. The two-step approach uses <span class="in">`catR::thetaEst()`</span> for theta estimation, which is probably handling missing data better than <span class="in">`iarm::person_estimates()`</span>. Note: both approaches use the Weighted Likelihood Estimation to minimize bias (Warm, 1989).</span>
<span id="cb48-532"><a href="#cb48-532" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-533"><a href="#cb48-533" aria-hidden="true" tabindex="-1"></a><span class="fu">## Results </span></span>
<span id="cb48-534"><a href="#cb48-534" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-535"><a href="#cb48-535" aria-hidden="true" tabindex="-1"></a><span class="fu">### Summarised</span></span>
<span id="cb48-536"><a href="#cb48-536" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-537"><a href="#cb48-537" aria-hidden="true" tabindex="-1"></a>First, absolute differences in estimated thetas compared to input thetas.</span>
<span id="cb48-538"><a href="#cb48-538" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-541"><a href="#cb48-541" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb48-542"><a href="#cb48-542" aria-hidden="true" tabindex="-1"></a>c_diff <span class="ot">&lt;-</span> c <span class="sc">%&gt;%</span> </span>
<span id="cb48-543"><a href="#cb48-543" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">with_q3 =</span> <span class="fu">abs</span>(together_RIestThetas <span class="sc">-</span> input_thetas),</span>
<span id="cb48-544"><a href="#cb48-544" aria-hidden="true" tabindex="-1"></a>         <span class="at">q3_removed =</span> <span class="fu">abs</span>(together_q3_rem <span class="sc">-</span> input_thetas),</span>
<span id="cb48-545"><a href="#cb48-545" aria-hidden="true" tabindex="-1"></a>         <span class="at">q3_split =</span> <span class="fu">abs</span>(separate_catR <span class="sc">-</span> input_thetas)) <span class="sc">%&gt;%</span> </span>
<span id="cb48-546"><a href="#cb48-546" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">!</span><span class="fu">names</span>(c))</span>
<span id="cb48-547"><a href="#cb48-547" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb48-548"><a href="#cb48-548" aria-hidden="true" tabindex="-1"></a>c_diff <span class="sc">%&gt;%</span> </span>
<span id="cb48-549"><a href="#cb48-549" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">everything</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb48-550"><a href="#cb48-550" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> value)) <span class="sc">+</span></span>
<span id="cb48-551"><a href="#cb48-551" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">50</span>) <span class="sc">+</span></span>
<span id="cb48-552"><a href="#cb48-552" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> name, <span class="at">ncol =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb48-553"><a href="#cb48-553" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Absolute difference in logits"</span>,</span>
<span id="cb48-554"><a href="#cb48-554" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Comparing input thetas to estimated"</span>,</span>
<span id="cb48-555"><a href="#cb48-555" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Distribution of bias"</span>)</span>
<span id="cb48-556"><a href="#cb48-556" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-557"><a href="#cb48-557" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb48-558"><a href="#cb48-558" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-559"><a href="#cb48-559" aria-hidden="true" tabindex="-1"></a>No huge differences between these histograms.</span>
<span id="cb48-560"><a href="#cb48-560" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-563"><a href="#cb48-563" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb48-564"><a href="#cb48-564" aria-hidden="true" tabindex="-1"></a>c_diff_descr <span class="ot">&lt;-</span> <span class="fu">descr</span>(c_diff) <span class="sc">%&gt;%</span> </span>
<span id="cb48-565"><a href="#cb48-565" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb48-566"><a href="#cb48-566" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>(<span class="st">"Parameter"</span>) </span>
<span id="cb48-567"><a href="#cb48-567" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-568"><a href="#cb48-568" aria-hidden="true" tabindex="-1"></a>c_diff_descr[<span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>,] <span class="sc">%&gt;%</span> </span>
<span id="cb48-569"><a href="#cb48-569" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">!</span>Parameter) <span class="sc">%&gt;%</span> </span>
<span id="cb48-570"><a href="#cb48-570" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb48-571"><a href="#cb48-571" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Parameter, <span class="at">y =</span> value, <span class="at">color =</span> name)) <span class="sc">+</span></span>
<span id="cb48-572"><a href="#cb48-572" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.85</span>) <span class="sc">+</span></span>
<span id="cb48-573"><a href="#cb48-573" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_d</span>(<span class="st">'Item set'</span>, <span class="at">end =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb48-574"><a href="#cb48-574" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Logits"</span>,</span>
<span id="cb48-575"><a href="#cb48-575" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Descriptive metric"</span>)</span>
<span id="cb48-576"><a href="#cb48-576" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb48-577"><a href="#cb48-577" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-580"><a href="#cb48-580" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb48-581"><a href="#cb48-581" aria-hidden="true" tabindex="-1"></a>c_diff_descr[<span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>,] <span class="sc">%&gt;%</span> </span>
<span id="cb48-582"><a href="#cb48-582" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.numeric, round, <span class="dv">3</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb48-583"><a href="#cb48-583" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl_rise</span>(<span class="at">tbl_width =</span> <span class="dv">50</span>)</span>
<span id="cb48-584"><a href="#cb48-584" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb48-585"><a href="#cb48-585" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-586"><a href="#cb48-586" aria-hidden="true" tabindex="-1"></a>Still not large differences anywhere.</span>
<span id="cb48-587"><a href="#cb48-587" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-588"><a href="#cb48-588" aria-hidden="true" tabindex="-1"></a>We should look at the particular region where the DIF item is located, since it should have the most impact there.</span>
<span id="cb48-589"><a href="#cb48-589" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-590"><a href="#cb48-590" aria-hidden="true" tabindex="-1"></a><span class="fu">### Across the latent continuum</span></span>
<span id="cb48-591"><a href="#cb48-591" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-592"><a href="#cb48-592" aria-hidden="true" tabindex="-1"></a>First, the test information function (TIF) curve could be of interest to understand what to expect in terms of estimation bias due to reliability limitations. Even more interesting is the table showing range of SEM.</span>
<span id="cb48-593"><a href="#cb48-593" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-594"><a href="#cb48-594" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb48-595"><a href="#cb48-595" aria-hidden="true" tabindex="-1"></a><span class="fu">#### TIF original data</span></span>
<span id="cb48-596"><a href="#cb48-596" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-599"><a href="#cb48-599" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb48-600"><a href="#cb48-600" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 9</span></span>
<span id="cb48-601"><a href="#cb48-601" aria-hidden="true" tabindex="-1"></a><span class="fu">RItif</span>(d, <span class="at">samplePSI =</span> <span class="cn">TRUE</span>)</span>
<span id="cb48-602"><a href="#cb48-602" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb48-603"><a href="#cb48-603" aria-hidden="true" tabindex="-1"></a><span class="fu">### SEM original data</span></span>
<span id="cb48-606"><a href="#cb48-606" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb48-607"><a href="#cb48-607" aria-hidden="true" tabindex="-1"></a><span class="fu">RIscoreSE</span>(d, <span class="at">output =</span> <span class="st">"table"</span>)</span>
<span id="cb48-608"><a href="#cb48-608" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb48-609"><a href="#cb48-609" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-610"><a href="#cb48-610" aria-hidden="true" tabindex="-1"></a><span class="fu">#### TIF without q3</span></span>
<span id="cb48-611"><a href="#cb48-611" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-614"><a href="#cb48-614" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb48-615"><a href="#cb48-615" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 9</span></span>
<span id="cb48-616"><a href="#cb48-616" aria-hidden="true" tabindex="-1"></a><span class="fu">RItif</span>(d <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">!</span>q3), <span class="at">samplePSI =</span> <span class="cn">TRUE</span>)</span>
<span id="cb48-617"><a href="#cb48-617" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb48-618"><a href="#cb48-618" aria-hidden="true" tabindex="-1"></a><span class="fu">#### SEM without q3</span></span>
<span id="cb48-621"><a href="#cb48-621" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb48-622"><a href="#cb48-622" aria-hidden="true" tabindex="-1"></a><span class="fu">RIscoreSE</span>(d <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">!</span>q3), <span class="at">output =</span> <span class="st">"table"</span>)</span>
<span id="cb48-623"><a href="#cb48-623" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb48-624"><a href="#cb48-624" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb48-625"><a href="#cb48-625" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-626"><a href="#cb48-626" aria-hidden="true" tabindex="-1"></a>The lowest SEM with q3 is 0.384, at logit score 0.356. </span>
<span id="cb48-627"><a href="#cb48-627" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-628"><a href="#cb48-628" aria-hidden="true" tabindex="-1"></a>Lowest SEM without q3 is 0.416, at logit score 0.322 to 0.491, which makes a difference in minimal SEM of about 0.032 compared to including the DIF item. 0.032 * 1.96 = 0.064 for a 95% CI.</span>
<span id="cb48-629"><a href="#cb48-629" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-630"><a href="#cb48-630" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Theta estimation bias</span></span>
<span id="cb48-631"><a href="#cb48-631" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-634"><a href="#cb48-634" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb48-635"><a href="#cb48-635" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb48-636"><a href="#cb48-636" aria-hidden="true" tabindex="-1"></a>c_diff <span class="sc">%&gt;%</span> </span>
<span id="cb48-637"><a href="#cb48-637" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_column</span>(<span class="at">Theta =</span> input_thetas) <span class="sc">%&gt;%</span> </span>
<span id="cb48-638"><a href="#cb48-638" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">!</span>Theta) <span class="sc">%&gt;%</span> </span>
<span id="cb48-639"><a href="#cb48-639" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb48-640"><a href="#cb48-640" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Theta, <span class="at">y =</span> value, <span class="at">color =</span> <span class="fu">factor</span>(name), <span class="at">fill =</span> <span class="fu">factor</span>(name))) <span class="sc">+</span></span>
<span id="cb48-641"><a href="#cb48-641" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.85</span>) <span class="sc">+</span></span>
<span id="cb48-642"><a href="#cb48-642" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"loess"</span>,</span>
<span id="cb48-643"><a href="#cb48-643" aria-hidden="true" tabindex="-1"></a>              <span class="fu">aes</span>(<span class="at">linetype =</span> <span class="fu">factor</span>(name)), <span class="at">alpha =</span> <span class="fl">0.15</span>) <span class="sc">+</span></span>
<span id="cb48-644"><a href="#cb48-644" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_ghibli_d</span>(<span class="st">"MononokeMedium"</span>, <span class="at">direction =</span> <span class="sc">-</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb48-645"><a href="#cb48-645" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_ghibli_d</span>(<span class="st">"MononokeMedium"</span>, <span class="at">direction =</span> <span class="sc">-</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb48-646"><a href="#cb48-646" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">color =</span> <span class="st">"Item set"</span>,</span>
<span id="cb48-647"><a href="#cb48-647" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Theta estimation bias"</span>,</span>
<span id="cb48-648"><a href="#cb48-648" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Absolute difference in logits"</span>) <span class="sc">+</span></span>
<span id="cb48-649"><a href="#cb48-649" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="st">"none"</span>, <span class="at">linetype =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb48-650"><a href="#cb48-650" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb48-651"><a href="#cb48-651" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="cn">NA</span>), <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">2</span>,<span class="fl">0.1</span>)) <span class="sc">+</span></span>
<span id="cb48-652"><a href="#cb48-652" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>name, <span class="at">ncol =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb48-653"><a href="#cb48-653" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_rise</span>()</span>
<span id="cb48-654"><a href="#cb48-654" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb48-655"><a href="#cb48-655" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-656"><a href="#cb48-656" aria-hidden="true" tabindex="-1"></a>Without points for a cleaner view.</span>
<span id="cb48-657"><a href="#cb48-657" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-660"><a href="#cb48-660" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb48-661"><a href="#cb48-661" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb48-662"><a href="#cb48-662" aria-hidden="true" tabindex="-1"></a>c_diff <span class="sc">%&gt;%</span> </span>
<span id="cb48-663"><a href="#cb48-663" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_column</span>(<span class="at">Theta =</span> input_thetas) <span class="sc">%&gt;%</span> </span>
<span id="cb48-664"><a href="#cb48-664" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">!</span>Theta) <span class="sc">%&gt;%</span> </span>
<span id="cb48-665"><a href="#cb48-665" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb48-666"><a href="#cb48-666" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Theta, <span class="at">y =</span> value, <span class="at">color =</span> <span class="fu">factor</span>(name), <span class="at">fill =</span> <span class="fu">factor</span>(name))) <span class="sc">+</span></span>
<span id="cb48-667"><a href="#cb48-667" aria-hidden="true" tabindex="-1"></a>  <span class="co">#geom_point(alpha = 0.85) +</span></span>
<span id="cb48-668"><a href="#cb48-668" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"loess"</span>,</span>
<span id="cb48-669"><a href="#cb48-669" aria-hidden="true" tabindex="-1"></a>              <span class="fu">aes</span>(<span class="at">linetype =</span> <span class="fu">factor</span>(name)), <span class="at">alpha =</span> <span class="fl">0.15</span>) <span class="sc">+</span></span>
<span id="cb48-670"><a href="#cb48-670" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_ghibli_d</span>(<span class="st">"MononokeMedium"</span>, <span class="at">direction =</span> <span class="sc">-</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb48-671"><a href="#cb48-671" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_ghibli_d</span>(<span class="st">"MononokeMedium"</span>, <span class="at">direction =</span> <span class="sc">-</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb48-672"><a href="#cb48-672" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">color =</span> <span class="st">"Item set"</span>,</span>
<span id="cb48-673"><a href="#cb48-673" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Theta estimation bias"</span>,</span>
<span id="cb48-674"><a href="#cb48-674" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Absolute difference (logits)"</span>) <span class="sc">+</span></span>
<span id="cb48-675"><a href="#cb48-675" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="st">"none"</span>, <span class="at">linetype =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb48-676"><a href="#cb48-676" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb48-677"><a href="#cb48-677" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="cn">NA</span>), <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="fl">1.2</span>,<span class="fl">0.1</span>))</span>
<span id="cb48-678"><a href="#cb48-678" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb48-679"><a href="#cb48-679" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-680"><a href="#cb48-680" aria-hidden="true" tabindex="-1"></a>Item split slightly reduces bias compared to keeping the DIF item (3), while removing item 3 increases bias from -1.5 to +1.5</span>
<span id="cb48-681"><a href="#cb48-681" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-682"><a href="#cb48-682" aria-hidden="true" tabindex="-1"></a><span class="fu">### Statistical analysis</span></span>
<span id="cb48-683"><a href="#cb48-683" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-684"><a href="#cb48-684" aria-hidden="true" tabindex="-1"></a>Comparing differences in theta estimation to input thetas.</span>
<span id="cb48-685"><a href="#cb48-685" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-688"><a href="#cb48-688" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb48-689"><a href="#cb48-689" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb48-690"><a href="#cb48-690" aria-hidden="true" tabindex="-1"></a>lm_all <span class="ot">&lt;-</span> c <span class="sc">%&gt;%</span> </span>
<span id="cb48-691"><a href="#cb48-691" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">c</span>(together_RIestThetas,input_thetas)) <span class="sc">%&gt;%</span></span>
<span id="cb48-692"><a href="#cb48-692" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">everything</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb48-693"><a href="#cb48-693" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lm</span>(value <span class="sc">~</span> name, <span class="at">data =</span> .)</span>
<span id="cb48-694"><a href="#cb48-694" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-695"><a href="#cb48-695" aria-hidden="true" tabindex="-1"></a>lm_q3rem <span class="ot">&lt;-</span> c <span class="sc">%&gt;%</span> </span>
<span id="cb48-696"><a href="#cb48-696" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">c</span>(together_q3_rem,input_thetas)) <span class="sc">%&gt;%</span></span>
<span id="cb48-697"><a href="#cb48-697" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">everything</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb48-698"><a href="#cb48-698" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lm</span>(value <span class="sc">~</span> name, <span class="at">data =</span> .)</span>
<span id="cb48-699"><a href="#cb48-699" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-700"><a href="#cb48-700" aria-hidden="true" tabindex="-1"></a>lm_q3split <span class="ot">&lt;-</span> c <span class="sc">%&gt;%</span> </span>
<span id="cb48-701"><a href="#cb48-701" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">c</span>(separate_catR,input_thetas)) <span class="sc">%&gt;%</span></span>
<span id="cb48-702"><a href="#cb48-702" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">everything</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb48-703"><a href="#cb48-703" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lm</span>(value <span class="sc">~</span> name, <span class="at">data =</span> .)</span>
<span id="cb48-704"><a href="#cb48-704" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-705"><a href="#cb48-705" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(lm_all,lm_q3rem,lm_q3split)</span>
<span id="cb48-706"><a href="#cb48-706" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-707"><a href="#cb48-707" aria-hidden="true" tabindex="-1"></a><span class="fu">bind_rows</span>(<span class="fu">glance</span>(lm_all),</span>
<span id="cb48-708"><a href="#cb48-708" aria-hidden="true" tabindex="-1"></a>          <span class="fu">glance</span>(lm_q3rem),</span>
<span id="cb48-709"><a href="#cb48-709" aria-hidden="true" tabindex="-1"></a>          <span class="fu">glance</span>(lm_q3split)) <span class="sc">%&gt;%</span> </span>
<span id="cb48-710"><a href="#cb48-710" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_column</span>(<span class="at">Model =</span> <span class="fu">c</span>(<span class="st">"All items"</span>,<span class="st">"Q3 removed"</span>,<span class="st">"Q3 split"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb48-711"><a href="#cb48-711" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Model,statistic,p.value,logLik,AIC,BIC,deviance)</span>
<span id="cb48-712"><a href="#cb48-712" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-713"><a href="#cb48-713" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb48-714"><a href="#cb48-714" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-715"><a href="#cb48-715" aria-hidden="true" tabindex="-1"></a>Same analysis, but limited to the theta range from -1.5 to +1.5 logits, where differences seem the biggest.</span>
<span id="cb48-716"><a href="#cb48-716" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-719"><a href="#cb48-719" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb48-720"><a href="#cb48-720" aria-hidden="true" tabindex="-1"></a>lm_all <span class="ot">&lt;-</span> c <span class="sc">%&gt;%</span> </span>
<span id="cb48-721"><a href="#cb48-721" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">c</span>(together_RIestThetas,input_thetas)) <span class="sc">%&gt;%</span></span>
<span id="cb48-722"><a href="#cb48-722" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(input_thetas <span class="sc">&gt;</span> <span class="sc">-</span><span class="fl">1.5</span> <span class="sc">&amp;</span> input_thetas <span class="sc">&lt;</span> <span class="fl">1.5</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb48-723"><a href="#cb48-723" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">everything</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb48-724"><a href="#cb48-724" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lm</span>(value <span class="sc">~</span> name, <span class="at">data =</span> .)</span>
<span id="cb48-725"><a href="#cb48-725" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-726"><a href="#cb48-726" aria-hidden="true" tabindex="-1"></a>lm_q3rem <span class="ot">&lt;-</span> c <span class="sc">%&gt;%</span> </span>
<span id="cb48-727"><a href="#cb48-727" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">c</span>(together_q3_rem,input_thetas)) <span class="sc">%&gt;%</span></span>
<span id="cb48-728"><a href="#cb48-728" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(input_thetas <span class="sc">&gt;</span> <span class="sc">-</span><span class="fl">1.5</span> <span class="sc">&amp;</span> input_thetas <span class="sc">&lt;</span> <span class="fl">1.5</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb48-729"><a href="#cb48-729" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">everything</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb48-730"><a href="#cb48-730" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lm</span>(value <span class="sc">~</span> name, <span class="at">data =</span> .)</span>
<span id="cb48-731"><a href="#cb48-731" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-732"><a href="#cb48-732" aria-hidden="true" tabindex="-1"></a>lm_q3split <span class="ot">&lt;-</span> c <span class="sc">%&gt;%</span> </span>
<span id="cb48-733"><a href="#cb48-733" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">c</span>(separate_catR,input_thetas)) <span class="sc">%&gt;%</span></span>
<span id="cb48-734"><a href="#cb48-734" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(input_thetas <span class="sc">&gt;</span> <span class="sc">-</span><span class="fl">1.5</span> <span class="sc">&amp;</span> input_thetas <span class="sc">&lt;</span> <span class="fl">1.5</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb48-735"><a href="#cb48-735" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">everything</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb48-736"><a href="#cb48-736" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lm</span>(value <span class="sc">~</span> name, <span class="at">data =</span> .)</span>
<span id="cb48-737"><a href="#cb48-737" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-738"><a href="#cb48-738" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(lm_all,lm_q3rem,lm_q3split)</span>
<span id="cb48-739"><a href="#cb48-739" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-740"><a href="#cb48-740" aria-hidden="true" tabindex="-1"></a><span class="fu">bind_rows</span>(<span class="fu">glance</span>(lm_all),</span>
<span id="cb48-741"><a href="#cb48-741" aria-hidden="true" tabindex="-1"></a>          <span class="fu">glance</span>(lm_q3rem),</span>
<span id="cb48-742"><a href="#cb48-742" aria-hidden="true" tabindex="-1"></a>          <span class="fu">glance</span>(lm_q3split)) <span class="sc">%&gt;%</span> </span>
<span id="cb48-743"><a href="#cb48-743" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_column</span>(<span class="at">Model =</span> <span class="fu">c</span>(<span class="st">"All items"</span>,<span class="st">"Q3 removed"</span>,<span class="st">"Q3 split"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb48-744"><a href="#cb48-744" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Model,statistic,p.value,logLik,AIC,BIC,deviance)</span>
<span id="cb48-745"><a href="#cb48-745" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-746"><a href="#cb48-746" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb48-747"><a href="#cb48-747" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-748"><a href="#cb48-748" aria-hidden="true" tabindex="-1"></a><span class="fu">## Session info</span></span>
<span id="cb48-749"><a href="#cb48-749" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-752"><a href="#cb48-752" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb48-753"><a href="#cb48-753" aria-hidden="true" tabindex="-1"></a><span class="fu">sessionInfo</span>()</span>
<span id="cb48-754"><a href="#cb48-754" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
</code><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->



</body></html>