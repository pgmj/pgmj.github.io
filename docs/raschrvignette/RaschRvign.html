<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.32">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="author" content="Magnus Johansson">
<meta name="dcterms.date" content="2025-11-06">
<title>easyRasch vignette – R, Rasch, etc</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>

<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-37eea08aefeeee20ff55810ff984fec1.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-1cc9f29c2bb10fdb34aaf7634f70a249.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><script src="../site_libs/kePrint-0.0.1/kePrint.js"></script><link href="../site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<link rel="stylesheet" href="../styles.css">
<meta property="og:title" content="easyRasch vignette – R, Rasch, etc">
<meta property="og:description" content="R package for Rasch analysis">
<meta property="og:image" content="https://pgmj.github.io/RaschRvign_files/figure-html/unnamed-chunk-34-1.png">
<meta property="og:site_name" content="R, Rasch, etc">
<meta name="twitter:title" content="easyRasch vignette – R, Rasch, etc">
<meta name="twitter:description" content="R package for Rasch analysis">
<meta name="twitter:image" content="https://pgmj.github.io/raschrvignette/data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg==">
<meta name="twitter:card" content="summary_large_image">
<meta name="citation_title" content="easyRasch vignette">
<meta name="citation_author" content="Magnus Johansson">
<meta name="citation_publication_date" content="2025-11-06">
<meta name="citation_cover_date" content="2025-11-06">
<meta name="citation_year" content="2025">
<meta name="citation_online_date" content="2025-11-06">
<meta name="citation_language" content="en">
<meta name="citation_reference" content="citation_title=Rasch models in health;,citation_abstract=&amp;amp;amp;quot;The family of statistical models known as Rasch models started with a simple model for responses to questions in educational tests presented together with a number of related models that the Danish mathematician Georg Rasch referred to as models for measurement. Since the beginning of the 1950s the use of Rasch models has grown and spread from education to the measurement of health status. This book contains a comprehensive overview of the statistical theory of Rasch models.&amp;quot;–Back cover;,citation_editor=Karl Bang Christensen;,citation_editor=Svend Kreiner;,citation_editor=Mounir Mesbah;,citation_publication_date=2013;,citation_cover_date=2013;,citation_year=2013;,citation_isbn=978-1-84821-222-0;,citation_series_title=Applied mathematics series;">
<meta name="citation_reference" content="citation_title=Validity and objectivity: Reflections on the role and nature of Rasch models;,citation_abstract=This paper discusses a number of methodological issues related to item analysis by Rasch models including the relationships between objectivity as defined by Rasch and the different ways construct validity is defined in psychometrics. To reconcile the different definitions of validity, the IRT models have to be extended to include exogenous variables in addition to items. One such family of extended models referred to as graphical IRT models is described. Graphical Rasch models are special cases of a graphical IRT model characterized by both objectivity and construct validity. Finally, a family of models called graphical loglinear Rasch models is described. Measurement by items from such models is neither valid nor objective according to formal psychometric definitions. The paper argues, however, that measurement is essentially valid and objective and that it is preferable to retain all items to preserve reliability rather than eliminate items to obtain measurements satisfying all the requirements of validity and objectivity.;,citation_author=Svend Kreiner;,citation_publication_date=2007-01;,citation_cover_date=2007-01;,citation_year=2007;,citation_fulltext_html_url=https://doi.org/10.1027/1901-2276.59.3.268;,citation_issue=3;,citation_doi=10.1027/1901-2276.59.3.268;,citation_issn=1901-2276;,citation_volume=59;,citation_journal_title=Nordic Psychology;">
<meta name="citation_reference" content="citation_title=A Comprehensive Simulation Study of Estimation Methods for the Rasch Model;,citation_abstract=The Rasch model is one of the most prominent item response models. In this article, different item parameter estimation methods for the Rasch model are systematically compared through a comprehensive simulation study: Different alternatives of joint maximum likelihood (JML) estimation, different alternatives of marginal maximum likelihood (MML) estimation, conditional maximum likelihood (CML) estimation, and several limited information methods (LIM). The type of ability distribution (i.e., nonnormality), the number of items, sample size, and the distribution of item difficulties were systematically varied. Across different simulation conditions, MML methods with flexible distributional specifications can be at least as efficient as CML. Moreover, in many situations (i.e., for long tests), penalized JML and JML with ε adjustment resulted in very efficient estimates and might be considered alternatives to JML implementations currently used in statistical software. Moreover, minimum chi-square (MINCHI) estimation was the best-performing LIM method. These findings demonstrate that JML estimation and LIM can still prove helpful in applied research.;,citation_author=Alexander Robitzsch;,citation_publication_date=2021-12;,citation_cover_date=2021-12;,citation_year=2021;,citation_fulltext_html_url=https://www.mdpi.com/2571-905X/4/4/48;,citation_issue=4;,citation_doi=10.3390/stats4040048;,citation_issn=2571-905X;,citation_volume=4;,citation_journal_title=Stats;">
<meta name="citation_reference" content="citation_title=It Might Not Make a Big DIF: Improved Differential Test Functioning Statistics That Account for Sampling Variability;,citation_abstract=Differential test functioning, or DTF, occurs when one or more items in a test demonstrate differential item functioning (DIF) and the aggregate of these effects are witnessed at the test level. In many applications, DTF can be more important than DIF when the overall effects of DIF at the test level can be quantified. However, optimal statistical methodology for detecting and understanding DTF has not been developed. This article proposes improved DTF statistics that properly account for sampling variability in item parameter estimates while avoiding the necessity of predicting provisional latent trait estimates to create two-step approximations. The properties of the DTF statistics were examined with two Monte Carlo simulation studies using dichotomous and polytomous IRT models. The simulation results revealed that the improved DTF statistics obtained optimal and consistent statistical properties, such as obtaining consistent Type I error rates. Next, an empirical analysis demonstrated the application of the proposed methodology. Applied settings where the DTF statistics can be beneficial are suggested and future DTF research areas are proposed.;,citation_author=R. Philip Chalmers;,citation_author=Alyssa Counsell;,citation_author=David B. Flora;,citation_publication_date=2016-02;,citation_cover_date=2016-02;,citation_year=2016;,citation_fulltext_html_url=https://doi.org/10.1177/0013164415584576;,citation_issue=1;,citation_doi=10.1177/0013164415584576;,citation_issn=0013-1644;,citation_volume=76;,citation_journal_title=Educational and Psychological Measurement;">
<meta name="citation_reference" content="citation_title=A Review of Some of the History of Factorial Invariance and Differential Item Functioning;,citation_abstract=The concept of factorial invariance has evolved since it originated in the 1930s as a criterion for the usefulness of the multiple factor model; it has become a form of analysis supporting the validity of inferences about group differences on underlying latent variables. The analysis of differential item functioning (DIF) arose in the literature of item response theory (IRT), where its original purpose was the detection and removal of test items that are differentially difficult for, or biased against, one subpopulation or another. The two traditions merge at the level of the underlying latent variable model, but their separate origins and different purposes have led them to differ in details of terminology and procedure. This review traces some aspects of the histories of the two traditions, ultimately drawing some conclusions about how analysts may draw on elements of both, and how the nature of the research question determines the procedures used. Whether statistical tests are grouped by parameter (as in studies of factorial invariance) or across parameters by variable (as in DIF analysis) depends on the context and is independent of the model, as are subtle aspects of the order of the tests. In any case in which DIF or partial invariance is a possibility, the invariant parameters, or anchor items in DIF analysis, are best selected in an interplay between the statistics and judgment about what is being measured.;,citation_author=David Thissen;,citation_publication_date=2025-03;,citation_cover_date=2025-03;,citation_year=2025;,citation_fulltext_html_url=https://doi.org/10.1080/00273171.2024.2396148;,citation_issue=2;,citation_doi=10.1080/00273171.2024.2396148;,citation_issn=0027-3171;,citation_pmid=39264323;,citation_volume=60;,citation_journal_title=Multivariate Behavioral Research;">
<meta name="citation_reference" content="citation_title=On Specific Objectivity and Measurement by Rasch Models: A Statistical Viewpoint;,citation_abstract=Rasch’s original definition of specific objectivity insisted that measurement by items of educational tests had to be provided by estimates of person parameters of a measurement model that did not involve estimates of item parameters. It was never stated clearly, but there is no doubt that Rasch was thinking about conditional maximum likelihood (CML) estimates similar to the well-known CML estimates of item parameters. However, for technical reasons, there are only few examples of attempts to implement the CML estimates of person parameters in software applications for item analysis by Rasch models. Nevertheless, today CML estimation of person parameters in Rasch models is possible. And since the exact distribution of estimates of person parameters in Rasch models is known, it is possible to compare the performance of the specific objective CML estimates of person parameters to the performances of the other estimates of the person parameters. This paper provides one example of such an exercise. It compares five different estimators of the person parameters of a Rasch model with forty dichotomous items for a Danish cognitive test. In this paper, the point of view on the measurement quality is purely statistical. The superior measure of the latent trait has to have ignorable bias and as little standard error of measurement as possible. In this example, it turns out that the specific objective CML estimate is not the superior estimate. This motivates a slightly weaker notion of essential specific objectivity than many other estimates of person parameters in Rasch models live up to.;,citation_author=Svend Kreiner;,citation_publication_date=2025;,citation_cover_date=2025;,citation_year=2025;,citation_fulltext_html_url=https://dx.doi.org/10.61186/emp.2025.7;,citation_doi=10.61186/emp.2025.7;,citation_volume=3;,citation_journal_title=Educational Methods &amp;amp;amp; Psychometrics;">
<meta name="citation_reference" content="citation_title=Thanks coefficient alpha, we’ll take it from here.;,citation_abstract=Empirical studies in psychology commonly report Cronbach’s alpha as a measure of internal consistency reliability despite the fact that many methodological studies have shown that Cronbach’s alpha is riddled with problems stemming from unrealistic assumptions. In many circumstances, violating these assumptions yields estimates of reliability that are too small, making measures look less reliable than they actually are. Although methodological critiques of Cronbach’s alpha are being cited with increasing frequency in empirical studies, in this tutorial we discuss how the trend is not necessarily improving methodology used in the literature. That is, many studies continue to use Cronbach’s alpha without regard for its assumptions or merely cite methodological articles advising against its use to rationalize unfavorable Cronbach’s alpha estimates. This tutorial first provides evidence that recommendations against Cronbach’s alpha have not appreciably changed how empirical studies report reliability. Then, we summarize the drawbacks of Cronbach’s alpha conceptually without relying on mathematical or simulation-based arguments so that these arguments are accessible to a broad audience. We continue by discussing several alternative measures that make less rigid assumptions which provide justifiably higher estimates of reliability compared to Cronbach’s alpha. We conclude with empirical examples to illustrate advantages of alternative measures of reliability including omega total, Revelle’s omega total, the greatest lower bound, and Coefficient H. A detailed software appendix is also provided to help researchers implement alternative methods.;,citation_author=Daniel McNeish;,citation_publication_date=2018-09;,citation_cover_date=2018-09;,citation_year=2018;,citation_fulltext_html_url=http://doi.apa.org/getdoi.cfm?doi=10.1037/met0000144;,citation_issue=3;,citation_doi=10.1037/met0000144;,citation_issn=1939-1463, 1082-989X;,citation_volume=23;,citation_journal_title=Psychological Methods;">
<meta name="citation_reference" content="citation_title=On the Use, the Misuse, and the Very Limited Usefulness of&nbsp;Cronbach’s Alpha;,citation_abstract=This discussion paper argues that both the use of Cronbach’s alpha as a reliability estimate and as a measure of internal consistency suffer from major problems. First, alpha always has a value, which cannot be equal to the test score’s reliability given the interitem covariance matrix and the usual assumptions about measurement error. Second, in practice, alpha is used more often as a measure of the test’s internal consistency than as an estimate of reliability. However, it can be shown easily that alpha is unrelated to the internal structure of the test. It is further discussed that statistics based on a single test administration do not convey much information about the accuracy of individuals’ test performance. The paper ends with a list of conclusions about the usefulness of alpha.;,citation_author=Klaas Sijtsma;,citation_publication_date=2008-12;,citation_cover_date=2008-12;,citation_year=2008;,citation_fulltext_html_url=https://doi.org/10.1007/s11336-008-9101-0;,citation_issue=1;,citation_doi=10.1007/s11336-008-9101-0;,citation_issn=1860-0980;,citation_volume=74;,citation_journal_title=Psychometrika;">
<meta name="citation_reference" content="citation_title=The role of plausible values in large-scale surveys;,citation_abstract=In large-scale assessment programs such as NAEP, TIMSS and PISA, students’ achievement data sets provided for secondary analysts contain so-called plausible values. Plausible values are multiple imputations of the unobservable latent achievement for each student. In this article it has been shown how plausible values are used to: (1) address concerns with bias in the estimation of certain population parameters when point estimates of latent achievement are used to estimate those population parameters; (2) allow secondary data analysts to employ standard techniques and tools (e.g., SPSS, SAS procedures) to analyse achievement data that contains substantial measurement error components; and (3) facilitate the conlputation or&amp;amp;amp;quot; standard errors of estimates when the sample design is complex. The advantages of plausible values have been illustrated by comparing the use of maximum likelihood estimates and plausible values (PV) for estimating a range of population statistics.;,citation_author=Margaret Wu;,citation_publication_date=2005-01;,citation_cover_date=2005-01;,citation_year=2005;,citation_fulltext_html_url=https://linkinghub.elsevier.com/retrieve/pii/S0191491X05000209;,citation_issue=2-3;,citation_doi=10.1016/j.stueduc.2005.05.005;,citation_issn=0191491X;,citation_volume=31;,citation_journal_title=Studies in Educational Evaluation;">
<meta name="citation_reference" content="citation_title=Randomization-Based Inference about Latent Variables from Complex Samples;,citation_abstract=Standard procedures for drawing inferences from complex samples do not apply when the variable of interest θ cannot be observed directly, but must be inferred from the values of secondary random variables that depend on θ stochastically. Examples are proficiency variables in item response models and class memberships in latent class models. Rubin’s “multiple imputation” techniques yield approximations of sample statistics that would have been obtained, had θ been observable, and associated variance estimates that account for uncertainty due to both the sampling of respondents and the latent nature of θ. The approach is illustrated with data from the National Assessment for Educational Progress.;,citation_author=Robert J. Mislevy;,citation_publication_date=1991-06;,citation_cover_date=1991-06;,citation_year=1991;,citation_fulltext_html_url=https://www.cambridge.org/core/journals/psychometrika/article/abs/randomizationbased-inference-about-latent-variables-from-complex-samples/E981F9B78896C2D3567863944CCA8D83;,citation_issue=2;,citation_doi=10.1007/BF02294457;,citation_issn=0033-3123, 1860-0980;,citation_volume=56;,citation_journal_title=Psychometrika;">
<meta name="citation_reference" content="citation_title=Reliability representativeness: How well does coefficient alpha summarize reliability across the score distribution?;,citation_abstract=Scale scores in psychology studies are commonly accompanied by a reliability coefficient like alpha. Coefficient alpha is an index that summarizes reliability across the entire score distribution, implying equal precision for all scores. However, an underappreciated fact is that reliability can be conditional such that scores in certain parts of the score distribution may be more reliable than others. This conditional perspective of reliability is common in item response theory (IRT), but psychologists are generally not well versed in IRT. Correspondingly, the representativeness of a single summary index like alpha across the entire score distribution can be unclear but is rarely considered. If conditional reliability is fairly homogeneous across the score distribution, coefficient alpha may be sufficiently representative and a useful summary. But, if conditional reliability is heterogeneous across the score distribution, alpha may be unrepresentative and may not align with the reliability of a typical score in the data or with a particularly important score like a cut point where decisions are made. This paper proposes a method, R package, and Shiny application to quantify the potential differences between coefficient alpha and conditional reliability across the score distribution. The goal is to facilitate comparisons between conditional reliability and reliability summary indices so that psychologists can contextualize the reliability of their scores more clearly and comprehensively.;,citation_author=Daniel McNeish;,citation_author=Denis Dumas;,citation_publication_date=2025-02;,citation_cover_date=2025-02;,citation_year=2025;,citation_fulltext_html_url=https://doi.org/10.3758/s13428-025-02611-8;,citation_issue=3;,citation_doi=10.3758/s13428-025-02611-8;,citation_issn=1554-3528;,citation_volume=57;,citation_journal_title=Behavior Research Methods;">
<meta name="citation_reference" content="citation_title=A general method for estimating reliability using Bayesian Measurement Uncertainty;,citation_abstract=Unreliable measurement can lead to lower statistical power, attenuated effect sizes and residual confounding. However, estimating reliability can be challenging for complex cognitive and behavioural assessments without test-retest data. Most statistical methods for assessing reliability with a single test administration are designed for fixed-item questionnaires. We introduce a novel Bayesian procedure called relative measurement uncertainty (RMU) for estimating reliability that can be broadly applied, including to many widely used computational models. Our approach draws pairs of samples from each subject’s posterior and calculates the correlation between draws. We demonstrate analytically and via simulation that this method provides accurate reliability estimates and well-calibrated credible intervals across linear factor, signal detection and reinforcement learning models. Simulations found that RMU was more accurate (lower root mean square error) than existing measures (coefficient alpha, coefficient H, split-half), but more importantly, it can be applied across a wide range of computational models. RMU offers a general method for estimating reliability, leveraging the modelling flexibility of Bayesian statistical methods.;,citation_author=Giacomo Bignardi;,citation_author=Rogier Kievit;,citation_author=Paul-Christian Bürkner;,citation_publication_date=2025-09;,citation_cover_date=2025-09;,citation_year=2025;,citation_fulltext_html_url=https://osf.io/h54k8_v1;,citation_doi=10.31234/osf.io/h54k8_v1;,citation_publisher=OSF;">
<meta name="citation_reference" content="citation_title=Reliability measures in item response theory: Manifest versus latent correlation functions;,citation_abstract=For item response theory (IRT) models, which belong to the class of generalized linear or non-linear mixed models, reliability at the scale of observed scores (i.e., manifest correlation) is more difficult to calculate than latent correlation based reliability, but usually of greater scientific interest. This is not least because it cannot be calculated explicitly when the logit link is used in conjunction with normal random effects. As such, approximations such as Fisher’s information coefficient, Cronbach’s α, or the latent correlation are calculated, allegedly because it is easy to do so. Cronbach’s α has well-known and serious drawbacks, Fisher’s information is not meaningful under certain circumstances, and there is an important but often overlooked difference between latent and manifest correlations. Here, manifest correlation refers to correlation between observed scores, while latent correlation refers to correlation between scores at the latent (e.g., logit or probit) scale. Thus, using one in place of the other can lead to erroneous conclusions. Taylor series based reliability measures, which are based on manifest correlation functions, are derived and a careful comparison of reliability measures based on latent correlations, Fisher’s information, and exact reliability is carried out. The latent correlations are virtually always considerably higher than their manifest counterparts, Fisher’s information measure shows no coherent behaviour (it is even negative in some cases), while the newly introduced Taylor series based approximations reflect the exact reliability very closely. Comparisons among the various types of correlations, for various IRT models, are made using algebraic expressions, Monte Carlo simulations, and data analysis. Given the light computational burden and the performance of Taylor series based reliability measures, their use is recommended.;,citation_author=Elasma Milanzi;,citation_author=Geert Molenberghs;,citation_author=Ariel Alonso;,citation_author=Geert Verbeke;,citation_author=Paul De Boeck;,citation_publication_date=2015;,citation_cover_date=2015;,citation_year=2015;,citation_fulltext_html_url=https://onlinelibrary.wiley.com/doi/abs/10.1111/bmsp.12033;,citation_issue=1;,citation_doi=10.1111/bmsp.12033;,citation_issn=2044-8317;,citation_volume=68;,citation_journal_title=British Journal of Mathematical and Statistical Psychology;">
<meta name="citation_reference" content="citation_title=Local Dependence Indexes for Item Pairs Using Item Response Theory;,citation_abstract=Four statistics are proposed for the detection of local dependence (LD) among items analyzed using item response theory. Among them, the X$^{\textrm{2}}$ and G$^{\textrm{2}}$ LD indexes are of special interest. Simulated data are used to study the distribution and sensitivity of these statistics under the null condition, as well as under conditions in which LD is introduced. The results show that under the null condition of local independence, both the X$^{\textrm{2}}$ and G$^{\textrm{2}}$ LD indexes have distributions very similar to the ? $^{\textrm{2}}$ distribution with 1 degree of freedom. Under the locally dependent conditions, both indexes appear to be sensitive in detecting LD or multidimensionality among items. When compared to Q$_{\textrm{3}}$, another statistic often used to detect LD, these new statistics are somewhat less powerful for underlying LD, equally powerful for surface LD, and better behaved in the null case.;,citation_author=Wen-Hung Chen;,citation_author=David Thissen;,citation_publication_date=1997;,citation_cover_date=1997;,citation_year=1997;,citation_fulltext_html_url=https://www.jstor.org/stable/1165285;,citation_issue=3;,citation_doi=10.2307/1165285;,citation_issn=1076-9986;,citation_volume=22;,citation_journal_title=Journal of Educational and Behavioral Statistics;">
<meta name="citation_reference" content="citation_title=A diagnostic procedure to detect departures from local independence in item response theory models;,citation_abstract=Item response theory (IRT) is a widely used measurement model. When considering its use in education, health outcomes, and psychology, it is likely to be one of the most impactful psychometric models in existence. IRT has many advantages over classical test theory-based measurement models. For these advantages to hold in practice, strong assumptions must be satisfied. One of these assumptions, local independence, is the focus of the work described here. Local independence is the assumption that, conditional on the latent variable(s), item responses are unrelated to one another (i.e., independent). Stated another way, local independence implies that the only thing causing items to covary is the modeled latent variable(s). Violations of this assumption, quite aptly titled local dependence, can have serious consequences for the estimated parameters. A new diagnostic is proposed, based on parameter stability in an item-level jackknife resampling procedure. We review the ideas underlying the new diagnostic and how it is computed before covering some simulated and real examples demonstrating its effectiveness. (PsycInfo Database Record (c) 2020 APA, all rights reserved);,citation_author=Michael C. Edwards;,citation_author=Carrie R. Houts;,citation_author=Li Cai;,citation_publication_date=2018;,citation_cover_date=2018;,citation_year=2018;,citation_issue=1;,citation_doi=10.1037/met0000121;,citation_issn=1939-1463;,citation_volume=23;,citation_journal_title=Psychological Methods;">
<meta name="citation_reference" content="citation_title=Detecting Item Misfit in Rasch Models;,citation_author=Magnus Johansson;,citation_publication_date=2025;,citation_cover_date=2025;,citation_year=2025;,citation_fulltext_html_url=https://pgmj.github.io/rasch_itemfit/;,citation_issue=18;,citation_doi=10.61186/emp.2025.5;,citation_volume=3;,citation_journal_title=Educational Methods &amp;amp;amp; Psychometrics;">
<meta name="citation_reference" content="citation_title=A goodness of fit test for the rasch model;,citation_abstract=The Rasch model is an item analysis model with logistic item characteristic curves of equal slope,i.e. with constant item discriminating powers. The proposed goodness of fit test is based on a comparison between difficulties estimated from different scoregroups and over-all estimates.;,citation_author=Erling B. Andersen;,citation_publication_date=1973-03;,citation_cover_date=1973-03;,citation_year=1973;,citation_fulltext_html_url=https://doi.org/10.1007/BF02291180;,citation_issue=1;,citation_doi=10.1007/BF02291180;,citation_issn=1860-0980;,citation_volume=38;,citation_journal_title=Psychometrika;">
<meta name="citation_reference" content="citation_title=Detecting and evaluating the impact of multidimensionality using item fit statistics and principal component analysis of residuals;,citation_abstract=The purpose of this research is twofold. First is to extend the work of Smith (1992, 1996) and Smith and Miao (1991, 1994) in comparing item fit statistics and principal component analysis as tools for assessing the unidimensionality requirement of Rasch models. Second is to demonstrate methods to explore how violations of the unidimensionality requirement influence person measurement. For the first study, rating scale data were simulated to represent varying degrees of multidimensionality and the proportion of items contributing to each component. The second study used responses to a 24 item Attention Deficit Hyperactivity Disorder scale obtained from 317 college undergraduates. The simulation study reveals both an iterative item fit approach and principal component analysis of standardized residuals are effective in detecting items simulated to contribute to multidimensionality. The methods presented in Study 2 demonstrate the potential impact of multidimensionality on norm and criterion-reference person measure interpretations. The results provide researchers with quantitative information to help assist with the qualitative judgment as to whether the impact of multidimensionality is severe enough to warrant removing items from the analysis.;,citation_author=Everett V Smith;,citation_publication_date=2002-01;,citation_cover_date=2002-01;,citation_year=2002;,citation_issue=2;,citation_issn=1529-7713;,citation_pmid=12011501;,citation_volume=3;,citation_journal_title=Journal of applied measurement;">
<meta name="citation_reference" content="citation_title=Checking Dimensionality in Item Response Models With Principal Component Analysis on Standardized Residuals;,citation_abstract=Dimensionality is an important assumption in item response theory (IRT). Principal component analysis on standardized residuals has been used to check dimensionality, especially under the family of Rasch models. It has been suggested that an eigenvalue greater than 1.5 for the first eigenvalue signifies a violation of unidimensionality when there are 500 persons and 30 items. The cut-point of 1.5 is often used beyond this specific condition of sample size and test length. This study argues that a fixed cut-point is not applicable because the distribution of eigenvalues or their ratios depends on sample size and test length, just like other statistics. The authors conducted a series of simulations to verify this argument. They then proposed three chi-square statistics for multivariate independence to test the correlation matrix obtained from the standardized residuals. Through simulations, it was found that Steiger’s statistic behaved fairly like a chi-square distribution, when its degrees of freedom were adjusted.;,citation_author=Yeh-Tai Chou;,citation_author=Wen-Chung Wang;,citation_publication_date=2010-10;,citation_cover_date=2010-10;,citation_year=2010;,citation_fulltext_html_url=https://doi.org/10.1177/0013164410379322;,citation_issue=5;,citation_doi=10.1177/0013164410379322;,citation_issn=0013-1644;,citation_volume=70;,citation_journal_title=Educational and Psychological Measurement;">
<meta name="citation_reference" content="citation_title=Analysis of Local Dependence and Multidimensionality in Graphical Loglinear Rasch Models;,citation_abstract=This paper proposes a procedure for analysis of multidimensionality in graphical loglinear Rasch models. The procedure combines exploratory techniques based on analysis of local dependence by coefficients measuring conditional item association and confirmatory techniques fitting and testing the adequacy of graphical loglinear Rasch models. The course of action is motivated by the observation that evidence of conditional item association suggesting multidimensionality may be generated by very different phenomena having nothing to do with multidimensionality. This means that an analysis of conditional association is never enough in itself: additional procedures are required to distinguish between multidimensionality and other causes of local dependence. The procedure for analysis of conditional item association may be regarded as a variation of well-known procedures for analysis of local dependence. Compared to these methods the techniques for the family of Rasch models described in this paper eliminate the bias inherent in conventional methods for analysis of conditional item association.;,citation_author=Svend Kreiner;,citation_author=Karl Bang Christensen;,citation_publication_date=2004-12;,citation_cover_date=2004-12;,citation_year=2004;,citation_fulltext_html_url=https://doi.org/10.1081/STA-120030148;,citation_issue=6;,citation_doi=10.1081/STA-120030148;,citation_issn=0361-0926;,citation_volume=33;,citation_journal_title=Communications in Statistics - Theory and Methods;">
<meta name="citation_reference" content="citation_title=A Note on Item–Restscore Association in Rasch Models;,citation_author=Svend Kreiner;,citation_publication_date=2011-10;,citation_cover_date=2011-10;,citation_year=2011;,citation_fulltext_html_url=https://doi.org/10.1177/0146621611410227;,citation_issue=7;,citation_doi=10.1177/0146621611410227;,citation_issn=0146-6216;,citation_volume=35;,citation_journal_title=Applied Psychological Measurement;">
<meta name="citation_reference" content="citation_title=Using item mean squares to evaluate fit to the Rasch model;,citation_abstract=Throughout the mid to late 1970’s considerable research was conducted on the properties of Rasch fit mean squares. This work culminated in a variety of transformations to convert the mean squares into approximate t-statistics. This work was primarily motivated by the influence sample size has on the magnitude of the mean squares and the desire to have a single critical value that can generally be applied to most cases. In the late 1980’s and the early 1990’s the trend seems to have reversed, with numerous researchers using the untransformed fit mean squares as a means of testing fit to the Rasch measurement models. The principal motivation is cited as the influence sample size has on the sensitivity of the t-converted mean squares. The purpose of this paper is to present the historical development of these fit indices and the various transformations and to examine the impact of sample size on both the fit mean squares and the t-transformations of those mean squares. Because the sample size problem has little influence on the person mean square problem, due to the relatively short length (100 items or less), this paper focuses on the item fit mean squares, where it is common to find the statistics used with sample sizes ranging from 30 to 10,000.;,citation_author=R. M. Smith;,citation_author=R. E. Schumacker;,citation_author=M. J. Bush;,citation_publication_date=1998;,citation_cover_date=1998;,citation_year=1998;,citation_issue=1;,citation_issn=1090-655X;,citation_pmid=9661732;,citation_volume=2;,citation_journal_title=Journal of Outcome Measurement;">
<meta name="citation_reference" content="citation_title=Differential Item Functioning in the Danish Translation of the SF-36;,citation_abstract=Statistical analyses of Differential Item Functioning (DIF) can be used for rigorous translation evaluations. DIF techniques test whether each item functions in the same way, irrespective of the country, language, or culture of the respondents. For a given level of health, the score on any item should be independent of nationality. This requirement can be tested through contingency-table methods, which are efficient for analyzing all types of items. We investigated DIF in the Danish translation of the SF-36 Health Survey, using two general population samples (USA, n = 1,506; Denmark, n = 3,950). DIF was identified for 12 out of 35 items. These results agreed with independent ratings of translation quality, but the statistical techniques were more sensitive. When included in scales, the items exhibiting DIF had only a little impact on conclusions about cross-national differences in health in the general population. However, if used as single items, the DIF items could seriously bias results from cross-national comparisons. Also, the DIF items might have larger impact on cross-national comparison of groups with poorer health status. We conclude that analysis of DIF is useful for evaluating questionnaire translations.;,citation_author=Jakob B. Bjorner;,citation_author=Svend Kreiner;,citation_author=John E. Ware;,citation_author=Mogens T. Damsgaard;,citation_author=Per Bech;,citation_publication_date=1998-11;,citation_cover_date=1998-11;,citation_year=1998;,citation_fulltext_html_url=https://www.sciencedirect.com/science/article/pii/S0895435698001115;,citation_issue=11;,citation_doi=10.1016/S0895-4356(98)00111-5;,citation_issn=0895-4356;,citation_volume=51;,citation_journal_title=Journal of Clinical Epidemiology;">
<meta name="citation_reference" content="citation_title=Rasch fit statistics and sample size considerations for polytomous data;,citation_abstract=Previous research on educational data has demonstrated that Rasch fit statistics (mean squares and t-statistics) are highly susceptible to sample size variation for dichotomously scored rating data, although little is known about this relationship for polytomous data. These statistics help inform researchers about how well items fit to a unidimensional latent trait, and are an important adjunct to modern psychometrics. Given the increasing use of Rasch models in health research the purpose of this study was therefore to explore the relationship between fit statistics and sample size for polytomous data.;,citation_author=Adam B. Smith;,citation_author=Robert Rush;,citation_author=Lesley J. Fallowfield;,citation_author=Galina Velikova;,citation_author=Michael Sharpe;,citation_publication_date=2008-05;,citation_cover_date=2008-05;,citation_year=2008;,citation_fulltext_html_url=https://doi.org/10.1186/1471-2288-8-33;,citation_issue=1;,citation_doi=10.1186/1471-2288-8-33;,citation_issn=1471-2288;,citation_volume=8;,citation_journal_title=BMC Medical Research Methodology;">
<meta name="citation_reference" content="citation_title=Iarm: Item Analysis in Rasch Models;,citation_abstract=Tools to assess model fit and identify misfitting items for Rasch models (RM) and partial credit models (PCM). Included are item fit statistics, item characteristic curves, item-restscore association, conditional likelihood ratio tests, assessment of measurement error, estimates of the reliability and test targeting as described in Christensen et al. (Eds.) (2013, ISBN:978-1-84821-222-0).;,citation_author=Marianne Mueller;,citation_author=Pedro Henrique Ribeiro Santiago;,citation_publication_date=2022-08;,citation_cover_date=2022-08;,citation_year=2022;,citation_fulltext_html_url=https://cran.r-project.org/web/packages/iarm/index.html;">
<meta name="citation_reference" content="citation_title=Visualizing Rasch item fit using conditional item characteristic curves in R;,citation_abstract=New R computer routines that support rigorous statistical validation of psychological tests have recently appeared. We illustrate how Rasch item fit can be evaluated visually and propose an extension of existing implementations in R. We illustrate the utility using two short psychological tests.;,citation_author=Ann-Sophie Buchardt;,citation_author=Karl Bang Christensen;,citation_author=Normann Jensen;,citation_publication_date=2023;,citation_cover_date=2023;,citation_year=2023;,citation_issue=2;,citation_volume=65;,citation_journal_title=Psychological Test and Assessment Modeling;">
<meta name="citation_reference" content="citation_title=Item fit statistics for Rasch analysis: Can we trust them?;,citation_author=Marianne Müller;,citation_publication_date=2020-08;,citation_cover_date=2020-08;,citation_year=2020;,citation_fulltext_html_url=https://doi.org/10.1186/s40488-020-00108-7;,citation_issue=1;,citation_doi=10.1186/s40488-020-00108-7;,citation_issn=2195-5832;,citation_volume=7;,citation_journal_title=Journal of Statistical Distributions and Applications;">
<meta name="citation_reference" content="citation_title=A simulation study of person-fit in the Rasch model;,citation_author=Richard Artner;,citation_publication_date=2016;,citation_cover_date=2016;,citation_year=2016;,citation_issue=3;,citation_volume=58;,citation_journal_title=Psychological Test and Assessment Modeling;">
<meta name="citation_reference" content="citation_title=Lordif: An R Package for Detecting Differential Item Functioning Using Iterative Hybrid Ordinal Logistic Regression/Item Response Theory and Monte Carlo Simulations;,citation_author=Seung W. Choi;,citation_author=Laura E. Gibbons;,citation_author=Paul K. Crane;,citation_publication_date=2011-03;,citation_cover_date=2011-03;,citation_year=2011;,citation_fulltext_html_url=https://doi.org/10.18637/jss.v039.i08;,citation_issue=1;,citation_doi=10.18637/jss.v039.i08;,citation_issn=1548-7660;,citation_volume=39;,citation_journal_title=Journal of Statistical Software;">
<meta name="citation_reference" content="citation_title=Nonparametric Person-Fit Analysis of Polytomous Item Scores;,citation_author=Wilco H. M. Emons;,citation_publication_date=2008-05;,citation_cover_date=2008-05;,citation_year=2008;,citation_fulltext_html_url=https://doi.org/10.1177/0146621607302479;,citation_issue=3;,citation_doi=10.1177/0146621607302479;,citation_issn=0146-6216;,citation_volume=32;,citation_journal_title=Applied Psychological Measurement;">
<meta name="citation_reference" content="citation_title=Partial credit trees meet the partial gamma coefficient for quantifying DIF and DSF in polytomous items;,citation_author=Mirka Henninger;,citation_author=Jan Radek;,citation_author=Marie-Ann Sengewald;,citation_author=Carolin Strobl;,citation_publication_date=2024-05;,citation_cover_date=2024-05;,citation_year=2024;,citation_fulltext_html_url=https://osf.io/47sah;,citation_doi=10.31234/osf.io/47sah;,citation_publisher=OSF;">
<meta name="citation_reference" content="citation_title=Bias in Self-Reports: An Initial Elevation Phenomenon;,citation_author=Farid Anvari;,citation_author=Emir Efendić;,citation_author=Jerome Olsen;,citation_author=Ruben C. Arslan;,citation_author=Malte Elson;,citation_author=Iris K. Schneider;,citation_publication_date=2022-10-07;,citation_cover_date=2022-10-07;,citation_year=2022;,citation_fulltext_html_url=https://doi.org/10.1177/19485506221129160;,citation_doi=10.1177/19485506221129160;,citation_language=en;,citation_journal_title=Social Psychological and Personality Science;">
<meta name="citation_reference" content="citation_title=Sample size and statistical conclusions from tests of fit to the rasch model according to the rasch unidimensional measurement model (RUMM) program in health outcome measurement;,citation_author=Peter Hagell;,citation_author=Albert Westergren;,citation_publication_date=2016;,citation_cover_date=2016;,citation_year=2016;,citation_issue=4;,citation_volume=17;,citation_journal_title=Journal of Applied Measurement;">
<meta name="citation_reference" content="citation_title=Critical Values for Yen’s Q3: Identification of Local Dependence in the Rasch Model Using Residual Correlations;,citation_author=Karl Bang Christensen;,citation_author=Guido Makransky;,citation_author=Mike Horton;,citation_publication_date=2017-05-01;,citation_cover_date=2017-05-01;,citation_year=2017;,citation_fulltext_html_url=https://doi.org/10.1177/0146621616677520;,citation_issue=3;,citation_doi=10.1177/0146621616677520;,citation_volume=41;,citation_language=en;,citation_journal_title=Applied Psychological Measurement;">
<meta name="citation_reference" content="citation_title=Valid and reliable? Basic and expanded recommendations for psychometric reporting and quality assessment.;,citation_author=Magnus Johansson;,citation_author=Marit Preuter;,citation_author=Simon Karlsson;,citation_author=Marie-Louise Möllerberg;,citation_author=Hanna Svensson;,citation_author=Jeanette Melin;,citation_publication_date=2023;,citation_cover_date=2023;,citation_year=2023;,citation_doi=10.31219/osf.io/3htzc;,citation_language=en-us;">
<meta name="citation_reference" content="citation_title=Weighted likelihood estimation of ability in item response theory;,citation_author=Thomas A. Warm;,citation_publication_date=1989-09-01;,citation_cover_date=1989-09-01;,citation_year=1989;,citation_fulltext_html_url=https://doi.org/10.1007/BF02294627;,citation_issue=3;,citation_doi=10.1007/BF02294627;,citation_volume=54;,citation_language=en;,citation_journal_title=Psychometrika;">
<meta name="citation_reference" content="citation_title=Rasch Trees: A New Method for Detecting Differential Item Functioning in the Rasch Model;,citation_author=Carolin Strobl;,citation_author=Julia Kopf;,citation_author=Achim Zeileis;,citation_publication_date=2015-06-01;,citation_cover_date=2015-06-01;,citation_year=2015;,citation_fulltext_html_url=https://doi.org/10.1007/s11336-013-9388-3;,citation_issue=2;,citation_doi=10.1007/s11336-013-9388-3;,citation_volume=80;,citation_language=en;,citation_journal_title=Psychometrika;">
<meta name="citation_reference" content="citation_title=Using the raschtree function for detecting differential item functioning in the Rasch model;,citation_author=Carolin Strobl;,citation_author=Lennart Schneider;,citation_author=Julia Kopf;,citation_author=Achim Zeileis;,citation_publication_date=2021;,citation_cover_date=2021;,citation_year=2021;,citation_language=en;">
<meta name="citation_reference" content="citation_title=Polytomous Item Response Theory Models;,citation_author=Remo Ostini;,citation_author=Michael Nering;,citation_publication_date=2006;,citation_cover_date=2006;,citation_year=2006;,citation_fulltext_html_url=https://methods.sagepub.com/book/polytomous-item-response-theory-models;,citation_doi=10.4135/9781412985413;,citation_isbn=978-0-7619-3068-6 978-1-4129-8541-3;">
<meta name="citation_reference" content="citation_title=R: A language and environment for statistical computing;,citation_author=R Core Team;,citation_publication_date=2025;,citation_cover_date=2025;,citation_year=2025;,citation_fulltext_html_url=https://www.R-project.org/;">
<meta name="citation_reference" content="citation_title=An R companion to applied regression;,citation_author=John Fox;,citation_author=Sanford Weisberg;,citation_publication_date=2019;,citation_cover_date=2019;,citation_year=2019;,citation_fulltext_html_url=https://www.john-fox.ca/Companion/;">
<meta name="citation_reference" content="citation_title=easyRasch: Psychometric analysis in r with rasch measurement theory;,citation_author=Magnus Johansson;,citation_publication_date=2025;,citation_cover_date=2025;,citation_year=2025;,citation_fulltext_html_url=https://github.com/pgmj/easyRasch;">
<meta name="citation_reference" content="citation_title=Extended rasch modeling: The eRm package for the application of IRT models in r;,citation_author=Patrick Mair;,citation_author=Reinhold Hatzinger;,citation_publication_date=2007;,citation_cover_date=2007;,citation_year=2007;,citation_doi=10.18637/jss.v020.i09;,citation_volume=20;,citation_journal_title=Journal of Statistical Software;">
<meta name="citation_reference" content="citation_title=CML based estimation of extended rasch models with the eRm package in r;,citation_author=Patrick Mair;,citation_author=Reinhold Hatzinger;,citation_publication_date=2007;,citation_cover_date=2007;,citation_year=2007;,citation_doi=10.18637/jss.v020.i09;,citation_volume=49;,citation_journal_title=Psychology Science;">
<meta name="citation_reference" content="citation_title=IRT models with relaxed assumptions in eRm: A manual-like instruction;,citation_author=Reinhold Hatzinger;,citation_author=Thomas Rusch;,citation_publication_date=2009;,citation_cover_date=2009;,citation_year=2009;,citation_volume=51;,citation_journal_title=Psychology Science Quarterly;">
<meta name="citation_reference" content="citation_title=Linear logistic models with relaxed assumptions in r;,citation_author=Thomas Rusch;,citation_author=Marco Maier;,citation_author=Reinhold Hatzinger;,citation_editor=Berthold Lausen;,citation_editor=Dirk Poel;,citation_editor=Alfred Ultsch;,citation_publication_date=2013;,citation_cover_date=2013;,citation_year=2013;,citation_doi=10.1007/978-3-319-00035-0_34;,citation_conference_title=Algorithms from and for nature and life;,citation_conference=Springer;,citation_series_title=Studies in classification, data analysis, and knowledge organization;">
<meta name="citation_reference" content="citation_title=An empirical power analysis of quasi-exact tests for the rasch model: Measurement invariance in small samples;,citation_author=Ingrid Koller;,citation_author=Marco Maier;,citation_author=Reinhold Hatzinger;,citation_publication_date=2015;,citation_cover_date=2015;,citation_year=2015;,citation_doi=10.1027/1614-2241/a000090;,citation_volume=11;,citation_journal_title=Methodology;">
<meta name="citation_reference" content="citation_title=Testing the local independence assumption of the rasch model with Q3-based nonparametric model tests;,citation_author=Rudolf Debelak;,citation_author=Ingrid Koller;,citation_publication_date=2019;,citation_cover_date=2019;,citation_year=2019;,citation_doi=10.1177/0146621619835501;,citation_volume=44;,citation_journal_title=Applied Psychological Measurement;">
<meta name="citation_reference" content="citation_title=foreach: Provides foreach looping construct;,citation_author=Microsoft;,citation_author=Steve Weston;,citation_publication_date=2022;,citation_cover_date=2022;,citation_year=2022;,citation_fulltext_html_url=https://CRAN.R-project.org/package=foreach;,citation_doi=10.32614/CRAN.package.foreach;">
<meta name="citation_reference" content="citation_title=formattable: Create “Formattable” data structures;,citation_author=Kun Ren;,citation_author=Kenton Russell;,citation_publication_date=2021;,citation_cover_date=2021;,citation_year=2021;,citation_fulltext_html_url=https://CRAN.R-project.org/package=formattable;,citation_doi=10.32614/CRAN.package.formattable;">
<meta name="citation_reference" content="citation_title=ggrepel: Automatically position non-overlapping text labels with “ggplot2”;,citation_author=Kamil Slowikowski;,citation_publication_date=2024;,citation_cover_date=2024;,citation_year=2024;,citation_fulltext_html_url=https://CRAN.R-project.org/package=ggrepel;,citation_doi=10.32614/CRAN.package.ggrepel;">
<meta name="citation_reference" content="citation_title=glue: Interpreted string literals;,citation_author=Jim Hester;,citation_author=Jennifer Bryan;,citation_publication_date=2024;,citation_cover_date=2024;,citation_year=2024;,citation_fulltext_html_url=https://CRAN.R-project.org/package=glue;,citation_doi=10.32614/CRAN.package.glue;">
<meta name="citation_reference" content="citation_title=Reproducible summary tables with the gtsummary package;,citation_author=Daniel D. Sjoberg;,citation_author=Karissa Whiting;,citation_author=Michael Curry;,citation_author=Jessica A. Lavery;,citation_author=Joseph Larmarange;,citation_publication_date=2021;,citation_cover_date=2021;,citation_year=2021;,citation_fulltext_html_url=https://doi.org/10.32614/RJ-2021-053;,citation_doi=10.32614/RJ-2021-053;,citation_volume=13;,citation_journal_title=The R Journal;">
<meta name="citation_reference" content="citation_title=iarm: Item analysis in rasch models;,citation_author=Marianne Mueller;,citation_publication_date=2022;,citation_cover_date=2022;,citation_year=2022;,citation_fulltext_html_url=https://CRAN.R-project.org/package=iarm;,citation_doi=10.32614/CRAN.package.iarm;">
<meta name="citation_reference" content="citation_title=kableExtra: Construct complex table with “kable” and pipe syntax;,citation_author=Hao Zhu;,citation_publication_date=2024;,citation_cover_date=2024;,citation_year=2024;,citation_fulltext_html_url=https://CRAN.R-project.org/package=kableExtra;,citation_doi=10.32614/CRAN.package.kableExtra;">
<meta name="citation_reference" content="citation_title=knitr: A general-purpose package for dynamic report generation in R;,citation_author=Yihui Xie;,citation_publication_date=2025;,citation_cover_date=2025;,citation_year=2025;,citation_fulltext_html_url=https://yihui.org/knitr/;">
<meta name="citation_reference" content="citation_title=Dynamic documents with R and knitr;,citation_author=Yihui Xie;,citation_publication_date=2015;,citation_cover_date=2015;,citation_year=2015;,citation_fulltext_html_url=https://yihui.org/knitr/;">
<meta name="citation_reference" content="citation_title=knitr: A comprehensive tool for reproducible research in R;,citation_author=Yihui Xie;,citation_editor=Victoria Stodden;,citation_editor=Friedrich Leisch;,citation_editor=Roger D. Peng;,citation_publication_date=2014;,citation_cover_date=2014;,citation_year=2014;,citation_inbook_title=Implementing reproducible computational research;">
<meta name="citation_reference" content="citation_title=lordif: An r package for detecting differential item functioning using iterative hybrid ordinal logistic regression/item response theory and monte carlo simulations;,citation_author=Seung W. Choi;,citation_author=Laura E. Gibbons;,citation_author=Paul K. Crane;,citation_publication_date=2011;,citation_cover_date=2011;,citation_year=2011;,citation_doi=10.18637/jss.v039.i08;,citation_journal_title=Journal of Statistical Software;">
<meta name="citation_reference" content="citation_title=matrixStats: Functions that apply to rows and columns of matrices (and to vectors);,citation_author=Henrik Bengtsson;,citation_publication_date=2025;,citation_cover_date=2025;,citation_year=2025;,citation_fulltext_html_url=https://CRAN.R-project.org/package=matrixStats;,citation_doi=10.32614/CRAN.package.matrixStats;">
<meta name="citation_reference" content="citation_title=mice: Multivariate imputation by chained equations in r;,citation_author=Stef Buuren;,citation_author=Karin Groothuis-Oudshoorn;,citation_publication_date=2011;,citation_cover_date=2011;,citation_year=2011;,citation_issue=3;,citation_doi=10.18637/jss.v045.i03;,citation_volume=45;,citation_journal_title=Journal of Statistical Software;">
<meta name="citation_reference" content="citation_title=mirt: A multidimensional item response theory package for the R environment;,citation_author=R. Philip Chalmers;,citation_publication_date=2012;,citation_cover_date=2012;,citation_year=2012;,citation_issue=6;,citation_doi=10.18637/jss.v048.i06;,citation_volume=48;,citation_journal_title=Journal of Statistical Software;">
<meta name="citation_reference" content="citation_title=patchwork: The composer of plots;,citation_author=Thomas Lin Pedersen;,citation_publication_date=2025;,citation_cover_date=2025;,citation_year=2025;,citation_fulltext_html_url=https://CRAN.R-project.org/package=patchwork;,citation_doi=10.32614/CRAN.package.patchwork;">
<meta name="citation_reference" content="citation_title=PerFit: An R package for person-fit analysis in IRT;,citation_author=Jorge N. Tendeiro;,citation_author=Rob R. Meijer;,citation_author=A. Susan M. Niessen;,citation_publication_date=2016;,citation_cover_date=2016;,citation_year=2016;,citation_issue=5;,citation_doi=10.18637/jss.v074.i05;,citation_volume=74;,citation_journal_title=Journal of Statistical Software;">
<meta name="citation_reference" content="citation_title=psych: Procedures for psychological, psychometric, and personality research;,citation_author=William Revelle;,citation_publication_date=2025;,citation_cover_date=2025;,citation_year=2025;,citation_fulltext_html_url=https://CRAN.R-project.org/package=psych;">
<meta name="citation_reference" content="citation_title=Accounting for individual differences in Bradley-Terry models by means of recursive partitioning;,citation_author=Carolin Strobl;,citation_author=Florian Wickelmaier;,citation_author=Achim Zeileis;,citation_publication_date=2011;,citation_cover_date=2011;,citation_year=2011;,citation_issue=2;,citation_doi=10.3102/1076998609359791;,citation_volume=36;,citation_journal_title=Journal of Educational and Behavioral Statistics;">
<meta name="citation_reference" content="citation_title=Rasch trees: A new method for detecting differential item functioning in the Rasch model;,citation_author=Carolin Strobl;,citation_author=Julia Kopf;,citation_author=Achim Zeileis;,citation_publication_date=2015;,citation_cover_date=2015;,citation_year=2015;,citation_issue=2;,citation_doi=10.1007/s11336-013-9388-3;,citation_volume=80;,citation_journal_title=Psychometrika;">
<meta name="citation_reference" content="citation_title=Tree-based global model tests for polytomous Rasch models;,citation_author=Basil Komboz;,citation_author=Achim Zeileis;,citation_author=Carolin Strobl;,citation_publication_date=2018;,citation_cover_date=2018;,citation_year=2018;,citation_issue=1;,citation_doi=10.1177/0013164416664394;,citation_volume=78;,citation_journal_title=Educational and Psychological Measurement;">
<meta name="citation_reference" content="citation_title=Using recursive partitioning to account for parameter heterogeneity in multinomial processing tree models;,citation_author=Florian Wickelmaier;,citation_author=Achim Zeileis;,citation_publication_date=2018;,citation_cover_date=2018;,citation_year=2018;,citation_issue=3;,citation_doi=10.3758/s13428-017-0937-z;,citation_volume=50;,citation_journal_title=Behavior Research Methods;">
<meta name="citation_reference" content="citation_title=Allgemeinbildung in Deutschland – erkenntnisse aus dem SPIEGEL Studentenpisa-Test;,citation_editor=Sabine Trepte;,citation_editor=Markus Verbeet;,citation_publication_date=2010;,citation_cover_date=2010;,citation_year=2010;,citation_doi=10.1007/978-3-531-92543-1;">
<meta name="citation_reference" content="citation_title=RASCHplot: Visualisation tool for validity of rasch models;,citation_author=Ann-Sophie Buchardt;,citation_author=Sidsel Normann Jensen;,citation_author=Karl Bang Christensen;,citation_publication_date=2022;,citation_cover_date=2022;,citation_year=2022;,citation_fulltext_html_url=https://github.com/ERRTG/RASCHplot;">
<meta name="citation_reference" content="citation_title=Reshaping data with the reshape package;,citation_author=Hadley Wickham;,citation_publication_date=2007;,citation_cover_date=2007;,citation_year=2007;,citation_fulltext_html_url=https://www.jstatsoft.org/v21/i12/;,citation_issue=12;,citation_volume=21;,citation_journal_title=Journal of Statistical Software;">
<meta name="citation_reference" content="citation_title=rmarkdown: Dynamic documents for r;,citation_author=JJ Allaire;,citation_author=Yihui Xie;,citation_author=Christophe Dervieux;,citation_author=Jonathan McPherson;,citation_author=Javier Luraschi;,citation_author=Kevin Ushey;,citation_author=Aron Atkins;,citation_author=Hadley Wickham;,citation_author=Joe Cheng;,citation_author=Winston Chang;,citation_author=Richard Iannone;,citation_publication_date=2025;,citation_cover_date=2025;,citation_year=2025;,citation_fulltext_html_url=https://github.com/rstudio/rmarkdown;">
<meta name="citation_reference" content="citation_title=R markdown: The definitive guide;,citation_author=Yihui Xie;,citation_author=J. J. Allaire;,citation_author=Garrett Grolemund;,citation_publication_date=2018;,citation_cover_date=2018;,citation_year=2018;,citation_fulltext_html_url=https://bookdown.org/yihui/rmarkdown;,citation_isbn=9781138359338;">
<meta name="citation_reference" content="citation_title=R markdown cookbook;,citation_author=Yihui Xie;,citation_author=Christophe Dervieux;,citation_author=Emily Riederer;,citation_publication_date=2020;,citation_cover_date=2020;,citation_year=2020;,citation_fulltext_html_url=https://bookdown.org/yihui/rmarkdown-cookbook;,citation_isbn=9780367563837;">
<meta name="citation_reference" content="citation_title=Welcome to the tidyverse;,citation_author=Hadley Wickham;,citation_author=Mara Averick;,citation_author=Jennifer Bryan;,citation_author=Winston Chang;,citation_author=Lucy D’Agostino McGowan;,citation_author=Romain François;,citation_author=Garrett Grolemund;,citation_author=Alex Hayes;,citation_author=Lionel Henry;,citation_author=Jim Hester;,citation_author=Max Kuhn;,citation_author=Thomas Lin Pedersen;,citation_author=Evan Miller;,citation_author=Stephan Milton Bache;,citation_author=Kirill Müller;,citation_author=Jeroen Ooms;,citation_author=David Robinson;,citation_author=Dana Paige Seidel;,citation_author=Vitalie Spinu;,citation_author=Kohske Takahashi;,citation_author=Davis Vaughan;,citation_author=Claus Wilke;,citation_author=Kara Woo;,citation_author=Hiroaki Yutani;,citation_publication_date=2019;,citation_cover_date=2019;,citation_year=2019;,citation_issue=43;,citation_doi=10.21105/joss.01686;,citation_volume=4;,citation_journal_title=Journal of Open Source Software;">
</head>
<body class="nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="navbar navbar-expand-lg " data-bs-theme="dark"><div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">R, Rasch, etc</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
<li class="nav-item">
    <a class="nav-link" href="../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="../raschrvignette/RaschRvign.html" aria-current="page"> 
<span class="menu-text">easyRasch vignette</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-blog" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Blog</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-blog">
<li>
    <a class="dropdown-item" href="../reliability.html">
 <span class="dropdown-text">RMU — relative measurement uncertainty</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../parameterizedQ.html">
 <span class="dropdown-text">Automating reports with Quarto</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../latentResp/LatentResponse.html">
 <span class="dropdown-text">What’s in a latent trait score?</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../SkolverketAPI/skolverketapi.html">
 <span class="dropdown-text">Data retrieval with R using API calls</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../powerviz.html">
 <span class="dropdown-text">Power analysis for multilevel models</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../datawrangling.html">
 <span class="dropdown-text">Data wrangling for psychometrics in R</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../simcutoffs.html">
 <span class="dropdown-text">Simulation based cutoff values for Rasch item fit and residual correlations</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../est_comp.html">
 <span class="dropdown-text">Comparing Rasch packages/estimators</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../dif_magnitude.html">
 <span class="dropdown-text">Rasch DIF magnitude &amp; item split</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../clrt.html">
 <span class="dropdown-text">Conditional Likelihood Ratio Test and sample size</span></a>
  </li>  
    </ul>
</li>
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/pgmj/pgmj.github.io"> <i class="bi bi-github" role="img" aria-label="GitHub">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
</div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav><div id="quarto-announcement" data-announcement-id="1330bc4b660363ec42da79384be05f58" class="alert alert-primary hidden">
<i class="bi bi-info-circle quarto-announcement-icon"></i><div class="quarto-announcement-content">
<p><strong>Note:</strong> easyRasch has new functions, check <a href="https://pgmj.github.io/easyRasch/news/index.html" class="uri">https://pgmj.github.io/easyRasch/news/index.html</a></p>
</div>
<i class="bi bi-x-lg quarto-announcement-action"></i>
</div>
</header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Table of contents</h2>
   
  <ul>
<li>
<a href="#getting-started" id="toc-getting-started" class="nav-link active" data-scroll-target="#getting-started"><span class="header-section-number">1</span> Getting started</a>
  <ul class="collapse">
<li><a href="#loading-data" id="toc-loading-data" class="nav-link" data-scroll-target="#loading-data"><span class="header-section-number">1.1</span> Loading data</a></li>
  <li><a href="#itemlabels" id="toc-itemlabels" class="nav-link" data-scroll-target="#itemlabels"><span class="header-section-number">1.2</span> Itemlabels</a></li>
  <li><a href="#demographics" id="toc-demographics" class="nav-link" data-scroll-target="#demographics"><span class="header-section-number">1.3</span> Demographics</a></li>
  </ul>
</li>
  <li>
<a href="#descriptives" id="toc-descriptives" class="nav-link" data-scroll-target="#descriptives"><span class="header-section-number">2</span> Descriptives</a>
  <ul class="collapse">
<li><a href="#missing-data" id="toc-missing-data" class="nav-link" data-scroll-target="#missing-data"><span class="header-section-number">2.1</span> Missing data</a></li>
  <li><a href="#overall-responses" id="toc-overall-responses" class="nav-link" data-scroll-target="#overall-responses"><span class="header-section-number">2.2</span> Overall responses</a></li>
  <li><a href="#item-level-descriptives" id="toc-item-level-descriptives" class="nav-link" data-scroll-target="#item-level-descriptives"><span class="header-section-number">2.3</span> Item level descriptives</a></li>
  </ul>
</li>
  <li>
<a href="#sec-rasch" id="toc-sec-rasch" class="nav-link" data-scroll-target="#sec-rasch"><span class="header-section-number">3</span> Rasch analysis 1</a>
  <ul class="collapse">
<li><a href="#analysis-1-comments" id="toc-analysis-1-comments" class="nav-link" data-scroll-target="#analysis-1-comments"><span class="header-section-number">3.1</span> Analysis 1 comments</a></li>
  </ul>
</li>
  <li>
<a href="#rasch-analysis-2" id="toc-rasch-analysis-2" class="nav-link" data-scroll-target="#rasch-analysis-2"><span class="header-section-number">4</span> Rasch analysis 2</a>
  <ul class="collapse">
<li><a href="#analysis-2-comments" id="toc-analysis-2-comments" class="nav-link" data-scroll-target="#analysis-2-comments"><span class="header-section-number">4.1</span> Analysis 2 comments</a></li>
  </ul>
</li>
  <li>
<a href="#dif---differential-item-functioning" id="toc-dif---differential-item-functioning" class="nav-link" data-scroll-target="#dif---differential-item-functioning"><span class="header-section-number">5</span> DIF - differential item functioning</a>
  <ul class="collapse">
<li><a href="#sex" id="toc-sex" class="nav-link" data-scroll-target="#sex"><span class="header-section-number">5.1</span> Sex</a></li>
  <li><a href="#age" id="toc-age" class="nav-link" data-scroll-target="#age"><span class="header-section-number">5.2</span> Age</a></li>
  <li><a href="#group" id="toc-group" class="nav-link" data-scroll-target="#group"><span class="header-section-number">5.3</span> Group</a></li>
  <li><a href="#sex-and-age" id="toc-sex-and-age" class="nav-link" data-scroll-target="#sex-and-age"><span class="header-section-number">5.4</span> Sex and age</a></li>
  <li><a href="#sec-diflrt" id="toc-sec-diflrt" class="nav-link" data-scroll-target="#sec-diflrt"><span class="header-section-number">5.5</span> LRT-based DIF</a></li>
  <li><a href="#conditional-icc" id="toc-conditional-icc" class="nav-link" data-scroll-target="#conditional-icc"><span class="header-section-number">5.6</span> Conditional ICC</a></li>
  <li><a href="#sec-lordif" id="toc-sec-lordif" class="nav-link" data-scroll-target="#sec-lordif"><span class="header-section-number">5.7</span> Logistic Ordinal Regression DIF</a></li>
  <li><a href="#partial-gamma-dif" id="toc-partial-gamma-dif" class="nav-link" data-scroll-target="#partial-gamma-dif"><span class="header-section-number">5.8</span> Partial gamma DIF</a></li>
  </ul>
</li>
  <li>
<a href="#rasch-analysis-3" id="toc-rasch-analysis-3" class="nav-link" data-scroll-target="#rasch-analysis-3"><span class="header-section-number">6</span> Rasch analysis 3</a>
  <ul class="collapse">
<li><a href="#analysis-3-comments" id="toc-analysis-3-comments" class="nav-link" data-scroll-target="#analysis-3-comments"><span class="header-section-number">6.1</span> Analysis 3 comments</a></li>
  </ul>
</li>
  <li>
<a href="#reliability" id="toc-reliability" class="nav-link" data-scroll-target="#reliability"><span class="header-section-number">7</span> Reliability</a>
  <ul class="collapse">
<li><a href="#rmu-relative-measurement-uncertainty" id="toc-rmu-relative-measurement-uncertainty" class="nav-link" data-scroll-target="#rmu-relative-measurement-uncertainty"><span class="header-section-number">7.1</span> RMU — Relative Measurement Uncertainty</a></li>
  <li><a href="#conditional-reliability" id="toc-conditional-reliability" class="nav-link" data-scroll-target="#conditional-reliability"><span class="header-section-number">7.2</span> Conditional reliability</a></li>
  </ul>
</li>
  <li>
<a href="#person-fit" id="toc-person-fit" class="nav-link" data-scroll-target="#person-fit"><span class="header-section-number">8</span> Person fit</a>
  <ul class="collapse">
<li><a href="#perfit-sample-code" id="toc-perfit-sample-code" class="nav-link" data-scroll-target="#perfit-sample-code"><span class="header-section-number">8.1</span> <code>PerFit</code> sample code</a></li>
  <li><a href="#item-fit-without-aberrant-responses" id="toc-item-fit-without-aberrant-responses" class="nav-link" data-scroll-target="#item-fit-without-aberrant-responses"><span class="header-section-number">8.2</span> Item fit without aberrant responses</a></li>
  </ul>
</li>
  <li><a href="#item-parameters" id="toc-item-parameters" class="nav-link" data-scroll-target="#item-parameters"><span class="header-section-number">9</span> Item parameters</a></li>
  <li>
<a href="#ordinal-sum-score-to-interval-score" id="toc-ordinal-sum-score-to-interval-score" class="nav-link" data-scroll-target="#ordinal-sum-score-to-interval-score"><span class="header-section-number">10</span> Ordinal sum score to interval score</a>
  <ul class="collapse">
<li><a href="#ordinalinterval-figure" id="toc-ordinalinterval-figure" class="nav-link" data-scroll-target="#ordinalinterval-figure"><span class="header-section-number">10.1</span> Ordinal/interval figure</a></li>
  <li><a href="#estimating-interval-level-person-scores" id="toc-estimating-interval-level-person-scores" class="nav-link" data-scroll-target="#estimating-interval-level-person-scores"><span class="header-section-number">10.2</span> Estimating interval level person scores</a></li>
  </ul>
</li>
  <li><a href="#figure-design" id="toc-figure-design" class="nav-link" data-scroll-target="#figure-design"><span class="header-section-number">11</span> Figure design</a></li>
  <li><a href="#sec-grateful" id="toc-sec-grateful" class="nav-link" data-scroll-target="#sec-grateful"><span class="header-section-number">12</span> Software used</a></li>
  <li><a href="#additional-credits" id="toc-additional-credits" class="nav-link" data-scroll-target="#additional-credits"><span class="header-section-number">13</span> Additional credits</a></li>
  <li><a href="#session-info" id="toc-session-info" class="nav-link" data-scroll-target="#session-info"><span class="header-section-number">14</span> Session info</a></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references"><span class="header-section-number">15</span> References</a></li>
  </ul></nav>
    </div>
<!-- main -->
<main class="content page-columns page-full column-page-left" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">easyRasch vignette</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
<p class="subtitle lead">R package for Rasch analysis</p>
</div>


<div class="quarto-title-meta-author column-page-left">
  <div class="quarto-title-meta-heading">Author</div>
  <div class="quarto-title-meta-heading">Affiliation</div>
  
    <div class="quarto-title-meta-contents">
    <p class="author">Magnus Johansson <a href="https://orcid.org/0000-0003-1669-592X" class="quarto-title-author-orcid"> <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg=="></a></p>
  </div>
  <div class="quarto-title-meta-contents">
        <p class="affiliation">
            <a href="https://www.ri.se/en/person/magnus-p-johansson">
            RISE Research Institutes of Sweden
            </a>
          </p>
      </div>
  </div>

<div class="quarto-title-meta column-page-left">

      
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">November 6, 2025</p>
    </div>
  </div>
  
    
  </div>
  


</header><p>This is an introduction to using the <a href="https://pgmj.github.io/easyRasch/"><code>easyRasch</code> R package</a>. A changelog for package updates is available <a href="https://pgmj.github.io/easyRasch/news/index.html">here</a>.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>This packages was previously known as <code>RISEkbmRasch</code>.</p>
</div>
</div>
<p>Details on package installation are available at the <a href="https://pgmj.github.io/easyRasch">package GitHub page</a>.</p>
<p>If you are new to Rasch Measurement Theory, you may find this intro presentation useful: <a href="https://pgmj.github.io/RaschIRTlecture/slides.html" class="uri">https://pgmj.github.io/RaschIRTlecture/slides.html</a></p>
<p>This vignette will walk through a sample analysis using an open dataset with polytomous questionnaire data. This will include some data wrangling to structure the item data and itemlabels, then provide examples of the different functions. The full source code of this document can be found either <a href="https://github.com/pgmj/pgmj.github.io/blob/main/raschrvignette/RaschRvign.qmd">in this repository</a> or by clicking on <strong>&lt;/&gt; CODE</strong> at the top of this page. You should be able to use the source code “as is” and reproduce this document locally, as long as you have the required packages installed. This page and this website are built using the open source publishing tool <a href="https://www.quarto.org">Quarto</a>.</p>
<p>One of the aims with this package is to simplify reproducible psychometric analysis to shed light on the measurement properties of a scale, questionnaire or test. In line with others <span class="citation" data-cites="kreiner_validity_2007 christensen_rasch_2013">(<a href="#ref-christensen_rasch_2013" role="doc-biblioref">Christensen et al., 2013</a>; <a href="#ref-kreiner_validity_2007" role="doc-biblioref">Kreiner, 2007</a>)</span>, I propose that the basic psychometric criteria for a set of items to be used as a measure of a latent variable are:</p>
<ul>
<li>Unidimensionality (for each subscale, if there are multiple)</li>
<li>Local independence of items</li>
<li>Ordered response categories</li>
<li>Invariance (differential item functioning)</li>
</ul>
<p>And that we should also report information regarding:</p>
<ul>
<li>Targeting</li>
<li>Measurement uncertainties (reliability)</li>
<li>Person fit</li>
</ul>
<p>We’ll include several ways to investigate these measurement properties, using Rasch Measurement Theory. There are also functions in the package less directly related to the criteria above, that will be demonstrated in this vignette.</p>
<p>Please note that this is just a sample analysis to showcase the R package. It is not intended as a “best practice” psychometric analysis example.</p>
<p>You can skip ahead to the Rasch analysis part in <a href="#sec-rasch" class="quarto-xref">Section&nbsp;3</a> if you are eager to look at the package output :)</p>
<p>There is a separate GitHub repository containing a template R-project to simplify using the <code>easyRasch</code> package when conducting a reproducible Rasch analysis in R: <a href="https://github.com/pgmj/RISEraschTemplate" class="uri">https://github.com/pgmj/RISEraschTemplate</a></p>
<section id="getting-started" class="level2" data-number="1"><h2 data-number="1" class="anchored" data-anchor-id="getting-started">
<span class="header-section-number">1</span> Getting started</h2>
<p>Since the package is intended for use with Quarto, this vignette has also been created with Quarto. A “template” .qmd file <a href="https://github.com/pgmj/RISEraschTemplate/blob/main/analysis.qmd">is available</a> that can be useful to have handy for copy&amp;paste when running a new analysis. You can also download a complete copy of the Quarto/R code to produce this document <a href="https://github.com/pgmj/pgmj.github.io/blob/main/raschrvignette/RaschRvign.qmd">here</a>.</p>
<p>Loading the <code>easyRasch</code> package will automatically load all the packages it depends on. However, it could be desirable to explicitly load all packages used, to simplify the automatic creation of citations for them, using the <code>grateful</code> package (see <a href="#sec-grateful" class="quarto-xref">Section&nbsp;12</a>).</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/pgmj/easyRasch">easyRasch</a></span><span class="op">)</span> <span class="co"># devtools::install_github("pgmj/easyRasch", dependencies = TRUE)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://pakillo.github.io/grateful/">grateful</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggrepel.slowkow.com/">ggrepel</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://r-forge.r-project.org/projects/car/">car</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://haozhu233.github.io/kableExtra/">kableExtra</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://readxl.tidyverse.org">readxl</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">eRm</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">iarm</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://philchalmers.github.io/mirt/">mirt</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://personality-project.org/r/psych/">psych</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">psychotree</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/HenrikBengtsson/matrixStats">matrixStats</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://had.co.nz/reshape">reshape</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://yihui.org/knitr/">knitr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://patchwork.data-imaginist.com">patchwork</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://renkun-ken.github.io/formattable/">formattable</a></span><span class="op">)</span> </span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://glue.tidyverse.org/">glue</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/RevolutionAnalytics/foreach">foreach</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co">### some commands exist in multiple packages, here we define preferred ones that are frequently used</span></span>
<span><span class="va">select</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="va"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span></span>
<span><span class="va">count</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="va"><a href="https://dplyr.tidyverse.org/reference/count.html">count</a></span></span>
<span><span class="va">recode</span> <span class="op">&lt;-</span> <span class="fu">car</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/car/man/recode.html">recode</a></span></span>
<span><span class="va">rename</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="va"><a href="https://dplyr.tidyverse.org/reference/rename.html">rename</a></span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Quarto automatically adds links to R packages and functions throughout this document. However, this feature only works properly for packages available on <a href="https://cran.r-project.org/">CRAN</a>. Since the <code>easyRasch</code> package is not on CRAN the links related to functions starting with <strong>RI</strong> will not work.</p>
</div>
</div>
<section id="loading-data" class="level3" data-number="1.1"><h3 data-number="1.1" class="anchored" data-anchor-id="loading-data">
<span class="header-section-number">1.1</span> Loading data</h3>
<p>We will use data from a recent paper investigating the “initial elevation effect” <span class="citation" data-cites="anvari2022">(<a href="#ref-anvari2022" role="doc-biblioref">Anvari et al., 2022</a>)</span>, and focus on the 10 negative items from the PANAS. The data is available at the OSF website.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">df.all</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv</a></span><span class="op">(</span><span class="st">"https://osf.io/download/6fbr5/"</span><span class="op">)</span></span>
<span><span class="co"># if you have issues with the link, please try downloading manually using the same URL as above</span></span>
<span><span class="co"># and read the file from your local drive.</span></span>
<span></span>
<span><span class="co"># subset items and demographic variables</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="va">df.all</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html">starts_with</a></span><span class="op">(</span><span class="st">"PANASD2_1"</span><span class="op">)</span>,</span>
<span>         <span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html">starts_with</a></span><span class="op">(</span><span class="st">"PANASD2_20"</span><span class="op">)</span>,</span>
<span>         <span class="va">age</span>,<span class="va">Sex</span>,<span class="va">Group</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="op">!</span><span class="va">PANASD2_10_Active</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="op">!</span><span class="va">PANASD2_1_Attentive</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>The <code><a href="https://pillar.r-lib.org/reference/glimpse.html">glimpse()</a></code> function provides a quick overview of our dataframe.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html">glimpse</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>Rows: 1,856
Columns: 13
$ PANASD2_11_Distressed &lt;dbl&gt; 2, 2, 2, 1, 2, 2, 4, 1, 1, 3, 1, 4, 2, 4, 4, 1, …
$ PANASD2_12_Upset      &lt;dbl&gt; 1, 1, 4, 1, 1, 5, 2, 1, 2, 2, 2, 3, 1, 3, 5, 1, …
$ PANASD2_13_Hostile    &lt;dbl&gt; 1, 1, 2, 1, 1, 3, 1, 1, 1, 4, 1, 1, 1, 1, 1, 1, …
$ PANASD2_14_Irritable  &lt;dbl&gt; 1, 1, 3, 1, 2, 5, 3, 1, 2, 4, 2, 3, 1, 2, 3, 1, …
$ PANASD2_15_Scared     &lt;dbl&gt; 1, 1, 3, 1, 1, 4, 1, 1, 1, 2, 2, 2, 1, 4, 4, 1, …
$ PANASD2_16_Afraid     &lt;dbl&gt; 1, 1, 4, 1, 1, 3, 1, 1, 1, 3, 1, 2, 1, 4, 4, 1, …
$ PANASD2_17_Ashamed    &lt;dbl&gt; 1, 1, 2, 1, 1, 3, 1, 1, 1, 2, 1, 4, 1, 1, 3, 1, …
$ PANASD2_18_Guilty     &lt;dbl&gt; 2, 1, 2, 1, 1, 3, 3, 1, 1, 3, 1, 4, 1, 1, 3, 1, …
$ PANASD2_19_Nervous    &lt;dbl&gt; 1, 1, 2, 1, 2, 4, 4, 1, 1, 4, 2, 4, 2, 1, 5, 1, …
$ PANASD2_20_Jittery    &lt;dbl&gt; 1, 2, 3, 1, 1, 2, 3, 3, 2, 1, 2, 2, 1, 1, 4, 1, …
$ age                   &lt;dbl&gt; 27, 32, 21, 27, 20, 22, 23, 25, 21, 26, 38, 36, …
$ Sex                   &lt;chr&gt; "Male", "Male", "Female", "Male", "Male", "Male"…
$ Group                 &lt;chr&gt; "Later Start", "Later Start", "Later Start", "La…</code></pre>
</div>
</div>
<p>We have 1856 rows, ie. respondents. All variables except Sex and Group are of class <code>dbl</code>, which means they are numeric and can have decimals. Integer (numeric with no decimals) would also be fine for our purposes. The two demographic variables currently of class <code>chr</code> (character) will need to be converted to factors (<code>fct</code>), and we will do that later on.</p>
<p>(If you import a dataset where item variables are of class character, you will need to recode to numeric.)</p>
</section><section id="itemlabels" class="level3" data-number="1.2"><h3 data-number="1.2" class="anchored" data-anchor-id="itemlabels">
<span class="header-section-number">1.2</span> Itemlabels</h3>
<p>Then we set up the itemlabels dataframe. This could also be done using the free <a href="https://www.libreoffice.org/download/download-libreoffice/">LibreOffice Calc</a> or MS Excel. Just make sure the file has the same structure, with two variables named <code>itemnr</code> and <code>item</code> that contain the item variable names and item description. The item variable names have to match the variable names in the item dataframe.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">itemlabels</span> <span class="op">&lt;-</span> <span class="va">df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html">starts_with</a></span><span class="op">(</span><span class="st">"PAN"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html">as_tibble</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/separate.html">separate</a></span><span class="op">(</span><span class="va">value</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="st">"item"</span><span class="op">)</span>, sep <span class="op">=</span><span class="st">"_[0-9][0-9]_"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>itemnr <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"PANAS_"</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">11</span><span class="op">:</span><span class="fl">20</span><span class="op">)</span><span class="op">)</span>, .before <span class="op">=</span> <span class="st">"item"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>The <code>itemlabels</code> dataframe looks like this.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">itemlabels</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 × 2
   itemnr   item      
   &lt;chr&gt;    &lt;chr&gt;     
 1 PANAS_11 Distressed
 2 PANAS_12 Upset     
 3 PANAS_13 Hostile   
 4 PANAS_14 Irritable 
 5 PANAS_15 Scared    
 6 PANAS_16 Afraid    
 7 PANAS_17 Ashamed   
 8 PANAS_18 Guilty    
 9 PANAS_19 Nervous   
10 PANAS_20 Jittery   </code></pre>
</div>
</div>
</section><section id="demographics" class="level3" data-number="1.3"><h3 data-number="1.3" class="anchored" data-anchor-id="demographics">
<span class="header-section-number">1.3</span> Demographics</h3>
<p>Variables for invariance tests such as Differential Item Functioning (DIF) need to be separated into vectors (ideally as factors with specified levels and labels) with the same length as the number of rows in the dataset. This means that any kind of removal of respondents/rows with missing data needs to be done before separating the DIF variables.</p>
<p>First, we’ll have a look at the class of our variables.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">Sex</span>,<span class="va">age</span>,<span class="va">Group</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html">glimpse</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>Rows: 1,856
Columns: 3
$ Sex   &lt;chr&gt; "Male", "Male", "Female", "Male", "Male", "Male", "Female", "Fem…
$ age   &lt;dbl&gt; 27, 32, 21, 27, 20, 22, 23, 25, 21, 26, 38, 36, 24, 21, 19, 26, …
$ Group &lt;chr&gt; "Later Start", "Later Start", "Later Start", "Later Start", "Ear…</code></pre>
</div>
</div>
<p><code>Sex</code> and <code>Group</code> are class character, while <code>age</code> is numeric. Below are the response categories represented in data.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">Sex</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
  CONSENT REVOKED      DATA EXPIRED            Female              Male 
                2                 1               896               955 
Prefer not to say 
                2 </code></pre>
</div>
</div>
<p>Since there are only 5 respondents using labels that are not Female or Male (too few for meaningful statistical analysis), we will remove them to have a complete dataset for all variables in this example.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="va">df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">Sex</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Female"</span>,<span class="st">"Male"</span><span class="op">)</span><span class="op">)</span> <span class="co"># filtering to only include those with Sex being either Female or Male.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Let’s make the variable a factor (instead of class “character”), since that will be helpful in our later analyses.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">df</span><span class="op">$</span><span class="va">Sex</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">Sex</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Sometimes age is provided in categories, but here we have a numeric variable with age in years. Let’s have a quick look at the age distribution using a histogram, and get some summary statistics.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb14"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">age</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  18.00   21.00   24.00   26.74   30.00   71.00 </code></pre>
</div>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb16"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">### simpler version of the ggplot below using base R function hist()</span></span>
<span><span class="co"># hist(df$age, col = "#009ca6")</span></span>
<span><span class="co"># abline(v = median(age, na.rm = TRUE))</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># df %&gt;% </span></span>
<span><span class="co">#   summarise(Mean = round(mean(age, na.rm = T),1),</span></span>
<span><span class="co">#             StDev = round(sd(age, na.rm = T),1)</span></span>
<span><span class="co">#             )</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">age</span><span class="op">)</span>, </span>
<span>                 fill <span class="op">=</span> <span class="st">"#009ca6"</span>,</span>
<span>                 col <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># add the average as a vertical line</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/median.html">median</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">age</span><span class="op">)</span>, </span>
<span>             linewidth <span class="op">=</span> <span class="fl">1.5</span>,</span>
<span>             linetype <span class="op">=</span> <span class="fl">2</span>,</span>
<span>             col <span class="op">=</span> <span class="st">"orange"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># add a light grey field indicating the standard deviation</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html">annotate</a></span><span class="op">(</span><span class="st">"rect"</span>, ymin <span class="op">=</span> <span class="fl">0</span>, ymax <span class="op">=</span> <span class="cn">Inf</span>, </span>
<span>           xmin <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">age</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, </span>
<span>           xmax <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">age</span><span class="op">)</span><span class="op">[</span><span class="fl">5</span><span class="op">]</span>, </span>
<span>           alpha <span class="op">=</span> <span class="fl">.2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">""</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"Age in years"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Number of respondents"</span>,</span>
<span>       caption <span class="op">=</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_wrap.html">str_wrap</a></span><span class="op">(</span><span class="fu"><a href="https://glue.tidyverse.org/reference/glue.html">glue</a></span><span class="op">(</span><span class="st">"Note. Median age is {round(median(df$age, na.rm = T),1)}, shown with the dashed vertical line. Age range is {min(df$age)} to {max(df$age)}. Interquartile range ({summary(df$age)[2]} to {summary(df$age)[5]}) is indicated with the grey area."</span><span class="op">)</span></span>
<span>       <span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_continuous</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">18</span>,<span class="fl">75</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>plot.caption <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>hjust <span class="op">=</span> <span class="fl">0</span>, face <span class="op">=</span> <span class="st">"italic"</span><span class="op">)</span><span class="op">)</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="RaschRvign_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="1050"></p>
</figure>
</div>
</div>
</div>
<p>Since the distribution of the age variable is clearly not following a gaussian (normal) distribution, the median seems like a better option than the mean.</p>
<p>There is also a grouping variable which needs to be converted to a factor.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb17"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">df</span><span class="op">$</span><span class="va">Group</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">Group</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Now our demographic data has been checked, and we need to move it to a separate dataframe from the item data.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb18"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">dif</span> <span class="op">&lt;-</span> <span class="va">df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">Sex</span>,<span class="va">age</span>,<span class="va">Group</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">rename</span><span class="op">(</span>Age <span class="op">=</span> <span class="va">age</span><span class="op">)</span> <span class="co"># just for consistency</span></span>
<span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="va">df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">Sex</span>,<span class="va">age</span>,<span class="va">Group</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>To create a “Table 1” containing participant demographic information, the <code>tbl_summary()</code> function from the <code>gtsummary</code> package is really handy to get a nice table.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb19"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">gtsummary</span><span class="fu">::</span><span class="fu"><a href="https://www.danieldsjoberg.com/gtsummary/reference/tbl_summary.html">tbl_summary</a></span><span class="op">(</span><span class="va">dif</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div id="agrkfguquf" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#agrkfguquf table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#agrkfguquf thead, #agrkfguquf tbody, #agrkfguquf tfoot, #agrkfguquf tr, #agrkfguquf td, #agrkfguquf th {
  border-style: none;
}

#agrkfguquf p {
  margin: 0;
  padding: 0;
}

#agrkfguquf .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#agrkfguquf .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#agrkfguquf .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#agrkfguquf .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#agrkfguquf .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#agrkfguquf .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#agrkfguquf .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#agrkfguquf .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#agrkfguquf .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#agrkfguquf .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#agrkfguquf .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#agrkfguquf .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#agrkfguquf .gt_spanner_row {
  border-bottom-style: hidden;
}

#agrkfguquf .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#agrkfguquf .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#agrkfguquf .gt_from_md > :first-child {
  margin-top: 0;
}

#agrkfguquf .gt_from_md > :last-child {
  margin-bottom: 0;
}

#agrkfguquf .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#agrkfguquf .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#agrkfguquf .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#agrkfguquf .gt_row_group_first td {
  border-top-width: 2px;
}

#agrkfguquf .gt_row_group_first th {
  border-top-width: 2px;
}

#agrkfguquf .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#agrkfguquf .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#agrkfguquf .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#agrkfguquf .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#agrkfguquf .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#agrkfguquf .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#agrkfguquf .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#agrkfguquf .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#agrkfguquf .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#agrkfguquf .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#agrkfguquf .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#agrkfguquf .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#agrkfguquf .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#agrkfguquf .gt_left {
  text-align: left;
}

#agrkfguquf .gt_center {
  text-align: center;
}

#agrkfguquf .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#agrkfguquf .gt_font_normal {
  font-weight: normal;
}

#agrkfguquf .gt_font_bold {
  font-weight: bold;
}

#agrkfguquf .gt_font_italic {
  font-style: italic;
}

#agrkfguquf .gt_super {
  font-size: 65%;
}

#agrkfguquf .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#agrkfguquf .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#agrkfguquf .gt_indent_1 {
  text-indent: 5px;
}

#agrkfguquf .gt_indent_2 {
  text-indent: 10px;
}

#agrkfguquf .gt_indent_3 {
  text-indent: 15px;
}

#agrkfguquf .gt_indent_4 {
  text-indent: 20px;
}

#agrkfguquf .gt_indent_5 {
  text-indent: 25px;
}

#agrkfguquf .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#agrkfguquf div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<colgroup>
<col style="width: 50%">
<col style="width: 50%">
</colgroup>
<thead><tr class="gt_col_headings header">
<th id="label" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col"><strong>Characteristic</strong></th>
<th id="stat_0" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">
<strong>N = 1,851</strong><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span>
</th>
</tr></thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="label">Sex</td>
<td class="gt_row gt_center" headers="stat_0"><br></td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Female</td>
<td class="gt_row gt_center" headers="stat_0">896 (48%)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Male</td>
<td class="gt_row gt_center" headers="stat_0">955 (52%)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">Age</td>
<td class="gt_row gt_center" headers="stat_0">24 (21, 30)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">Group</td>
<td class="gt_row gt_center" headers="stat_0"><br></td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Earlier Start</td>
<td class="gt_row gt_center" headers="stat_0">901 (49%)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Later Start</td>
<td class="gt_row gt_center" headers="stat_0">950 (51%)</td>
</tr>
</tbody>
<tfoot><tr class="gt_footnotes odd">
<td colspan="2" class="gt_footnote">
<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span> n (%); Median (Q1, Q3)</td>
</tr></tfoot>
</table>
</div>
</div>
</div>
<p>With only item data remaining in the <code>df</code> dataframe, we can easily rename the items in the item dataframe and make sure that they match the <code>itemlabels</code> variable <code>itemnr</code>. It will be useful to have short item labels to get less clutter in the tables and figures during analysis.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb20"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">itemlabels</span><span class="op">$</span><span class="va">itemnr</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Now we are all set for the psychometric analysis!</p>
</section></section><section id="descriptives" class="level2 page-columns page-full" data-number="2"><h2 data-number="2" class="anchored" data-anchor-id="descriptives">
<span class="header-section-number">2</span> Descriptives</h2>
<p>Let’s familiarize ourselves with the data before diving into the analysis.</p>
<section id="missing-data" class="level3" data-number="2.1"><h3 data-number="2.1" class="anchored" data-anchor-id="missing-data">
<span class="header-section-number">2.1</span> Missing data</h3>
<p>First, we visualize the proportion of missing data on item level.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb21"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://pgmj.github.io/easyRasch/reference/RImissing.html">RImissing</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "No missing data."</code></pre>
</div>
</div>
<p>No missing data in this dataset. If we had missing data, we could also use <code><a href="https://pgmj.github.io/easyRasch/reference/RImissingP.html">RImissingP()</a></code> to look at which respondents have missing data and how much. Just to show what the output of these functions looks like, we’ll use <code><a href="https://amices.org/mice/reference/ampute.html">mice::ampute()</a></code> to temporarily remove 10% of data.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb23"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://pgmj.github.io/easyRasch/reference/RImissing.html">RImissing</a></span><span class="op">(</span><span class="fu">mice</span><span class="fu">::</span><span class="fu"><a href="https://amices.org/mice/reference/ampute.html">ampute</a></span><span class="op">(</span><span class="va">df</span>, prop <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span><span class="op">$</span><span class="va">amp</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="RaschRvign_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid figure-img" width="1050"></p>
</figure>
</div>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb24"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://pgmj.github.io/easyRasch/reference/RImissingP.html">RImissingP</a></span><span class="op">(</span><span class="fu">mice</span><span class="fu">::</span><span class="fu"><a href="https://amices.org/mice/reference/ampute.html">ampute</a></span><span class="op">(</span><span class="va">df</span>, prop <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span><span class="op">$</span><span class="va">amp</span>, N <span class="op">=</span> <span class="fl">20</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="RaschRvign_files/figure-html/unnamed-chunk-17-2.png" class="img-fluid figure-img" width="1050"></p>
</figure>
</div>
</div>
</div>
</section><section id="overall-responses" class="level3" data-number="2.2"><h3 data-number="2.2" class="anchored" data-anchor-id="overall-responses">
<span class="header-section-number">2.2</span> Overall responses</h3>
<p>This provides us with an overall picture of the data distribution. As a bonus, any oddities/mistakes in recoding the item data from categories to numbers will be clearly visible.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb25"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://pgmj.github.io/easyRasch/reference/RIallresp.html">RIallresp</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table class="table table-striped" style="font-size: 15px;
                  font-family: Lato; width: 50%">
<thead><tr>
<th style="text-align:right;">
Response category
</th>
<th style="text-align:right;">
Number of responses
</th>
<th style="text-align:right;">
Percent
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:right;">
<span style="font-weight: bold">1</span>
</td>
<td style="text-align:right;">
9430
</td>
<td style="text-align:right;">
50.9
</td>
</tr>
<tr>
<td style="text-align:right;">
<span style="font-weight: bold">2</span>
</td>
<td style="text-align:right;">
4136
</td>
<td style="text-align:right;">
22.3
</td>
</tr>
<tr>
<td style="text-align:right;">
<span style="font-weight: bold">3</span>
</td>
<td style="text-align:right;">
2676
</td>
<td style="text-align:right;">
14.5
</td>
</tr>
<tr>
<td style="text-align:right;">
<span style="font-weight: bold">4</span>
</td>
<td style="text-align:right;">
1722
</td>
<td style="text-align:right;">
9.3
</td>
</tr>
<tr>
<td style="text-align:right;">
<span style="font-weight: bold">5</span>
</td>
<td style="text-align:right;">
546
</td>
<td style="text-align:right;">
2.9
</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Most R packages for Rasch analysis require the lowest response category to be coded as zero, which makes it necessary for us to recode our data, from the range of 1-5 to 0-4.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb26"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="va">df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html">across</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html">everything</a></span><span class="op">(</span><span class="op">)</span>, <span class="op">~</span> <span class="va">.x</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># always check that your recoding worked as intended.</span></span>
<span><span class="fu"><a href="https://pgmj.github.io/easyRasch/reference/RIallresp.html">RIallresp</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table class="table table-striped" style="font-size: 15px;
                  font-family: Lato; width: 50%">
<thead><tr>
<th style="text-align:right;">
Response category
</th>
<th style="text-align:right;">
Number of responses
</th>
<th style="text-align:right;">
Percent
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:right;">
<span style="font-weight: bold">0</span>
</td>
<td style="text-align:right;">
9430
</td>
<td style="text-align:right;">
50.9
</td>
</tr>
<tr>
<td style="text-align:right;">
<span style="font-weight: bold">1</span>
</td>
<td style="text-align:right;">
4136
</td>
<td style="text-align:right;">
22.3
</td>
</tr>
<tr>
<td style="text-align:right;">
<span style="font-weight: bold">2</span>
</td>
<td style="text-align:right;">
2676
</td>
<td style="text-align:right;">
14.5
</td>
</tr>
<tr>
<td style="text-align:right;">
<span style="font-weight: bold">3</span>
</td>
<td style="text-align:right;">
1722
</td>
<td style="text-align:right;">
9.3
</td>
</tr>
<tr>
<td style="text-align:right;">
<span style="font-weight: bold">4</span>
</td>
<td style="text-align:right;">
546
</td>
<td style="text-align:right;">
2.9
</td>
</tr>
</tbody>
</table>
</div>
</div>
<section id="floorceiling-effects" class="level4" data-number="2.2.1"><h4 data-number="2.2.1" class="anchored" data-anchor-id="floorceiling-effects">
<span class="header-section-number">2.2.1</span> Floor/ceiling effects</h4>
<p>We can also look at the raw distribution of ordinal sum scores. The <code><a href="https://pgmj.github.io/easyRasch/reference/RIrawdist.html">RIrawdist()</a></code> function is a bit crude, since it requires responses in all response categories to accurately calculate max and min scores.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb27"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://pgmj.github.io/easyRasch/reference/RIrawdist.html">RIrawdist</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="RaschRvign_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid figure-img" width="1050"></p>
</figure>
</div>
</div>
</div>
<p>There is a floor effect with 11.8% of participants responding in the lowest category for all items.</p>
</section><section id="guttman-structure" class="level4" data-number="2.2.2"><h4 data-number="2.2.2" class="anchored" data-anchor-id="guttman-structure">
<span class="header-section-number">2.2.2</span> Guttman structure</h4>
<p>While not really necessary, it can be interesting to see whether the response patterns follow a Guttman-like structure. Items and persons are sorted based on lower-&gt;higher responses, and we should see the color move from yellow in the lower left corner to blue in the upper right corner.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb28"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://pgmj.github.io/easyRasch/reference/RIheatmap.html">RIheatmap</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="RaschRvign_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid figure-img" width="1050"></p>
</figure>
</div>
</div>
</div>
<p>In this data, we see the floor effect on the left, with 11.8% of respondents all yellow, and a rather weak Guttman structure. This could also be due to a low variation in item locations/difficulties. Since we have a very large sample I added a <code><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme()</a></code> option to remove the x-axis text, which would anyway just be a blur of the 1851 respondent row numbers. Each thin vertical slice in the figure is one respondent.</p>
</section></section><section id="item-level-descriptives" class="level3 page-columns page-full" data-number="2.3"><h3 data-number="2.3" class="anchored" data-anchor-id="item-level-descriptives">
<span class="header-section-number">2.3</span> Item level descriptives</h3>
<p>There are many ways to look at the item level data, and we’ll get them all together in the tab-panel below. The <code><a href="https://pgmj.github.io/easyRasch/reference/RItileplot.html">RItileplot()</a></code> is probably most informative, since it provides the number of responses in each response category for each item. It is usually recommended to have at least ~10 responses in each category for psychometric analysis, no matter which methodology is used.</p>
<p>Kudos to <a href="https://solomonkurz.netlify.app/blog/2021-05-11-yes-you-can-fit-an-exploratory-factor-analysis-with-lavaan/">Solomon Kurz</a> for providing the idea and code on which the tile plot function is built!</p>
<p>Most people will be familiar with the barplot, and this is probably most intuitive to understand the response distribution within each item. However, if there are many items it will take a while to review, and does not provide the same overview as a tileplot or stacked bars.</p>
<div class="cell page-columns page-full">
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb29"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: margin</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a><span class="co"># This code chunk creates a small table in the margin beside the panel-tabset output below, showing all items currently in the df dataframe.</span></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a><span class="co"># The Quarto code chunk option "#| column: margin" is necessary for the layout to work as intended.</span></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a><span class="fu">RIlistItemsMargin</span>(df, <span class="at">fontsize =</span> <span class="dv">13</span>)</span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<table class="table table-striped" style="font-size: 13px; font-family: Lato">
<thead><tr>
<th style="text-align:center;">
itemnr
</th>
<th style="text-align:left;">
item
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:center;">
<span style="color: grey; font-weight: bold">PANAS_11</span>
</td>
<td style="text-align:left;">
Distressed
</td>
</tr>
<tr>
<td style="text-align:center;">
<span style="color: grey; font-weight: bold">PANAS_12</span>
</td>
<td style="text-align:left;">
Upset
</td>
</tr>
<tr>
<td style="text-align:center;">
<span style="color: grey; font-weight: bold">PANAS_13</span>
</td>
<td style="text-align:left;">
Hostile
</td>
</tr>
<tr>
<td style="text-align:center;">
<span style="color: grey; font-weight: bold">PANAS_14</span>
</td>
<td style="text-align:left;">
Irritable
</td>
</tr>
<tr>
<td style="text-align:center;">
<span style="color: grey; font-weight: bold">PANAS_15</span>
</td>
<td style="text-align:left;">
Scared
</td>
</tr>
<tr>
<td style="text-align:center;">
<span style="color: grey; font-weight: bold">PANAS_16</span>
</td>
<td style="text-align:left;">
Afraid
</td>
</tr>
<tr>
<td style="text-align:center;">
<span style="color: grey; font-weight: bold">PANAS_17</span>
</td>
<td style="text-align:left;">
Ashamed
</td>
</tr>
<tr>
<td style="text-align:center;">
<span style="color: grey; font-weight: bold">PANAS_18</span>
</td>
<td style="text-align:left;">
Guilty
</td>
</tr>
<tr>
<td style="text-align:center;">
<span style="color: grey; font-weight: bold">PANAS_19</span>
</td>
<td style="text-align:left;">
Nervous
</td>
</tr>
<tr>
<td style="text-align:center;">
<span style="color: grey; font-weight: bold">PANAS_20</span>
</td>
<td style="text-align:left;">
Jittery
</td>
</tr>
</tbody>
</table>
</div></div></div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true">Tile plot</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">Stacked bars</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-3" role="tab" aria-controls="tabset-1-3" aria-selected="false">Barplots</a></li>
</ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb30"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://pgmj.github.io/easyRasch/reference/RItileplot.html">RItileplot</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="RaschRvign_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid figure-img" width="1050"></p>
</figure>
</div>
</div>
</div>
<p>While response patterns are skewed for all items, there are more than 10 responses in each category for all items which is helpful for the analysis.</p>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb31"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://pgmj.github.io/easyRasch/reference/RIbarstack.html">RIbarstack</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="co"># theming is optional, see section 11 for more on this</span></span>
<span>  <span class="fu"><a href="https://pgmj.github.io/easyRasch/reference/theme_rise.html">theme_rise</a></span><span class="op">(</span><span class="op">)</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="RaschRvign_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid figure-img" width="1050"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-1-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-3-tab">
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb32"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://pgmj.github.io/easyRasch/reference/RIitemcols.html">RIitemcols</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="RaschRvign_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid figure-img" width="1050"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section></section><section id="sec-rasch" class="level2 page-columns page-full" data-number="3"><h2 data-number="3" class="anchored" data-anchor-id="sec-rasch">
<span class="header-section-number">3</span> Rasch analysis 1</h2>
<p>The eRm package and Conditional Maximum Likelihood (CML) estimation will be used primarily, with the Partial Credit Model since this is polytomous data. For more information about different estimation methods, see <span class="citation" data-cites="robitzsch_comprehensive_2021">(<a href="#ref-robitzsch_comprehensive_2021" role="doc-biblioref">Robitzsch, 2021</a>)</span>.</p>
<p>This is also where the basic psychometric aspects are good to recall.</p>
<ul>
<li>Unidimensionality</li>
<li>Local independence</li>
<li>Ordering of response categories</li>
<li>Invariance</li>
<li>Targeting</li>
<li>Measurement uncertainties (reliability)</li>
</ul>
<p>We will begin by looking at unidimensionality, response categories, and targeting in parallel below. For unidimensionality, we are mostly interested in item fit and residual correlations, as well as PCA of residuals and loadings on the first residual contrast. At the same time, disordered response categories can influence item fit to some extent (and vice versa), and knowledge about targeting can be useful if it is necessary to remove items due to residual correlations.</p>
<p>When unidimensionality and response categories are found to work adequately, we will move on to invariance testing (Differential Item Functioning, DIF). It should be noted that DIF should be evaluated in parallel with all other psychometric aspects, but since it is a more complex issue it is kept in a separate section in this vignette (as is person fit). Finally, when/if invariance/DIF also looks acceptable, we can investigate reliability/measurement uncertainties.</p>
<p>Since our sample is quite large (n &gt; 800), the sample size sensitive tests (item fit and item-restscore) that are likely to produce problematic false positive rates <span class="citation" data-cites="johansson_detecting_2025">(<a href="#ref-johansson_detecting_2025" role="doc-biblioref">Johansson, 2025a</a>)</span> will use a randomly selected smaller sample of n = 500 as examples. When analyzing large datasets, item-restscore bootstrap is recommended as the primary method of assessing item fit to the Rasch model. <strong>The use of one smaller subsample in this vignette is only for demonstration purposes, it is not a recommended method of analysis for large datasets.</strong></p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb33"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">df500</span> <span class="op">&lt;-</span> <span class="va">df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html">slice_sample</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">500</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>In the tabset-panel below, each tab contains explanatory text, which is sometimes a bit lengthy. Remember to <strong>scroll back up and click on all tabs</strong>.</p>
</div>
</div>
<div class="cell page-columns page-full">

<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<table class="table table-striped" style="font-size: 13px; font-family: Lato">
<thead><tr>
<th style="text-align:center;">
itemnr
</th>
<th style="text-align:left;">
item
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:center;">
<span style="color: grey; font-weight: bold">PANAS_11</span>
</td>
<td style="text-align:left;">
Distressed
</td>
</tr>
<tr>
<td style="text-align:center;">
<span style="color: grey; font-weight: bold">PANAS_12</span>
</td>
<td style="text-align:left;">
Upset
</td>
</tr>
<tr>
<td style="text-align:center;">
<span style="color: grey; font-weight: bold">PANAS_13</span>
</td>
<td style="text-align:left;">
Hostile
</td>
</tr>
<tr>
<td style="text-align:center;">
<span style="color: grey; font-weight: bold">PANAS_14</span>
</td>
<td style="text-align:left;">
Irritable
</td>
</tr>
<tr>
<td style="text-align:center;">
<span style="color: grey; font-weight: bold">PANAS_15</span>
</td>
<td style="text-align:left;">
Scared
</td>
</tr>
<tr>
<td style="text-align:center;">
<span style="color: grey; font-weight: bold">PANAS_16</span>
</td>
<td style="text-align:left;">
Afraid
</td>
</tr>
<tr>
<td style="text-align:center;">
<span style="color: grey; font-weight: bold">PANAS_17</span>
</td>
<td style="text-align:left;">
Ashamed
</td>
</tr>
<tr>
<td style="text-align:center;">
<span style="color: grey; font-weight: bold">PANAS_18</span>
</td>
<td style="text-align:left;">
Guilty
</td>
</tr>
<tr>
<td style="text-align:center;">
<span style="color: grey; font-weight: bold">PANAS_19</span>
</td>
<td style="text-align:left;">
Nervous
</td>
</tr>
<tr>
<td style="text-align:center;">
<span style="color: grey; font-weight: bold">PANAS_20</span>
</td>
<td style="text-align:left;">
Jittery
</td>
</tr>
</tbody>
</table>
</div></div></div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true">Conditional item fit</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false">Item-restscore</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-3" role="tab" aria-controls="tabset-2-3" aria-selected="false">Item-restscore bootstrap</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-4" role="tab" aria-controls="tabset-2-4" aria-selected="false">Conditional item characteristic curves</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-5" role="tab" aria-controls="tabset-2-5" aria-selected="false">PCA of residuals</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-6-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-6" role="tab" aria-controls="tabset-2-6" aria-selected="false">Conditional LRT</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-7-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-7" role="tab" aria-controls="tabset-2-7" aria-selected="false">Local dependence (Q<sub>3</sub>)</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-8-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-8" role="tab" aria-controls="tabset-2-8" aria-selected="false">Local dependence (G<sup>2</sup>)</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-9-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-9" role="tab" aria-controls="tabset-2-9" aria-selected="false">LD (partial gamma)</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-10-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-10" role="tab" aria-controls="tabset-2-10" aria-selected="false">1st contrast loadings</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-11-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-11" role="tab" aria-controls="tabset-2-11" aria-selected="false">Analysis of response categories</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-12-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-12" role="tab" aria-controls="tabset-2-12" aria-selected="false">Response categories MIRT</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-13-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-13" role="tab" aria-controls="tabset-2-13" aria-selected="false">Targeting</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-14-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-14" role="tab" aria-controls="tabset-2-14" aria-selected="false">Item hierarchy</a></li>
</ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb34"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">simfit1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://pgmj.github.io/easyRasch/reference/RIgetfit.html">RIgetfit</a></span><span class="op">(</span><span class="va">df500</span>, iterations <span class="op">=</span> <span class="fl">400</span>, cpu <span class="op">=</span> <span class="fl">8</span><span class="op">)</span> <span class="co"># save simulation output to object `simfit1`</span></span>
<span><span class="fu"><a href="https://pgmj.github.io/easyRasch/reference/RIitemfit.html">RIitemfit</a></span><span class="op">(</span><span class="va">df500</span>, <span class="va">simfit1</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table data-quarto-disable-processing="true" style="width:65%; font-size: 14px;  font-family: Arial; margin-left: auto; margin-right: auto;border-bottom: 0;" class="table table-striped table-hover lightable-classic">
<thead><tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> Item </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> InfitMSQ </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> Infit thresholds </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> Infit diff </th>
   <th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> Relative location </th>
  </tr></thead>
<tbody>
<tr>
<td style="text-align:left;"> PANAS_11 </td>
   <td style="text-align:left;"> <span style="     color: red !important;">1.199</span> </td>
   <td style="text-align:left;"> [0.881, 1.161] </td>
   <td style="text-align:left;"> 0.038 </td>
   <td style="text-align:right;"> 1.08 </td>
  </tr>
<tr>
<td style="text-align:left;"> PANAS_12 </td>
   <td style="text-align:left;"> <span style="     color: red !important;">0.781</span> </td>
   <td style="text-align:left;"> [0.856, 1.148] </td>
   <td style="text-align:left;"> 0.075 </td>
   <td style="text-align:right;"> 1.28 </td>
  </tr>
<tr>
<td style="text-align:left;"> PANAS_13 </td>
   <td style="text-align:left;"> <span style="     color: black !important;">1.008</span> </td>
   <td style="text-align:left;"> [0.853, 1.202] </td>
   <td style="text-align:left;"> no misfit </td>
   <td style="text-align:right;"> 1.75 </td>
  </tr>
<tr>
<td style="text-align:left;"> PANAS_14 </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0.968</span> </td>
   <td style="text-align:left;"> [0.85, 1.129] </td>
   <td style="text-align:left;"> no misfit </td>
   <td style="text-align:right;"> 1.00 </td>
  </tr>
<tr>
<td style="text-align:left;"> PANAS_15 </td>
   <td style="text-align:left;"> <span style="     color: red !important;">0.762</span> </td>
   <td style="text-align:left;"> [0.829, 1.18] </td>
   <td style="text-align:left;"> 0.067 </td>
   <td style="text-align:right;"> 1.59 </td>
  </tr>
<tr>
<td style="text-align:left;"> PANAS_16 </td>
   <td style="text-align:left;"> <span style="     color: red !important;">0.783</span> </td>
   <td style="text-align:left;"> [0.816, 1.156] </td>
   <td style="text-align:left;"> 0.033 </td>
   <td style="text-align:right;"> 1.59 </td>
  </tr>
<tr>
<td style="text-align:left;"> PANAS_17 </td>
   <td style="text-align:left;"> <span style="     color: black !important;">1.078</span> </td>
   <td style="text-align:left;"> [0.851, 1.226] </td>
   <td style="text-align:left;"> no misfit </td>
   <td style="text-align:right;"> 1.74 </td>
  </tr>
<tr>
<td style="text-align:left;"> PANAS_18 </td>
   <td style="text-align:left;"> <span style="     color: red !important;">1.263</span> </td>
   <td style="text-align:left;"> [0.809, 1.212] </td>
   <td style="text-align:left;"> 0.051 </td>
   <td style="text-align:right;"> 1.61 </td>
  </tr>
<tr>
<td style="text-align:left;"> PANAS_19 </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0.914</span> </td>
   <td style="text-align:left;"> [0.851, 1.159] </td>
   <td style="text-align:left;"> no misfit </td>
   <td style="text-align:right;"> 0.93 </td>
  </tr>
<tr>
<td style="text-align:left;"> PANAS_20 </td>
   <td style="text-align:left;"> <span style="     color: red !important;">1.279</span> </td>
   <td style="text-align:left;"> [0.865, 1.173] </td>
   <td style="text-align:left;"> 0.106 </td>
   <td style="text-align:right;"> 1.36 </td>
  </tr>
</tbody>
<tfoot>
<tr><td style="padding: 0; " colspan="100%"><span style="font-style: italic;">Note: </span></td></tr>
<tr><td style="padding: 0; " colspan="100%">
<sup></sup> MSQ values based on conditional calculations (n = 500 complete cases).<br>                                Simulation based thresholds from 400 simulated datasets.</td></tr>
</tfoot>
</table>
</div>
</div>
<p><code><a href="https://pgmj.github.io/easyRasch/reference/RIitemfit.html">RIitemfit()</a></code> and <code><a href="https://pgmj.github.io/easyRasch/reference/RIgetfit.html">RIgetfit()</a></code> both work with both dichotomous and polytomous data (using the partial credit model) and automatically selects the model based on the data structure.</p>
<p>It is important to note that the <code><a href="https://pgmj.github.io/easyRasch/reference/RIitemfit.html">RIitemfit()</a></code> function uses <strong>conditional</strong> infit, which is both robust to different sample sizes and makes ZSTD unnecessary <span class="citation" data-cites="muller_item_2020">(<a href="#ref-muller_item_2020" role="doc-biblioref">Müller, 2020</a>)</span>. Müller also questions the usefulness of outfit, and my simulation study <span class="citation" data-cites="johansson_detecting_2025">(<a href="#ref-johansson_detecting_2025" role="doc-biblioref">Johansson, 2025a</a>)</span> concluded the same. Thus, outfit is not reported any more.</p>
<p>Since the distribution of item fit statistics are not known, we need to use simulation to determine appropriate cutoff threshold values for the current sample and items. <code><a href="https://pgmj.github.io/easyRasch/reference/RIitemfit.html">RIitemfit()</a></code> can also use the simulation based cutoff values and use them for conditional highlighting of misfitting items. See the <a href="https://pgmj.github.io/simcutoffs.html">blog post on simulation based cutoffs</a> for some more details on this.</p>
<p>Briefly stated, the simulation uses the estimated properties of the current sample and items (your dataset), and simulates n iterations of data that fit the Rasch model to get an empirical distribution of item fit that we can use for comparison with the observed data. This is also known as “parametric bootstrapping”.</p>
<p>The simulations can take a bit of time to run if you have complex data/many items/many participants, and/or choose to use many iterations. Simulation experiments <span class="citation" data-cites="johansson_detecting_2025">(<a href="#ref-johansson_detecting_2025" role="doc-biblioref">Johansson, 2025a</a>)</span> indicate that 100-400 iterations should be a useful range, where smaller samples (n &lt; 300) should use 100 iterations, and 200-400 is more appropriate when one has larger samples. To improve speed, make good use of your CPU cores.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Another important finding from simulation studies is that there is a risk of false positive indication of misfit in samples larger than n = 800 or so when using item infit or item-restscore. The recommended primary method for determining item fit in large samples is the bootstrapped item-restscore <span class="citation" data-cites="johansson_detecting_2025">(<a href="#ref-johansson_detecting_2025" role="doc-biblioref">Johansson, 2025a</a>)</span>, as illustrated in an adjacent tab labeled “Item-restscore bootstrap” .</p>
</div>
</div>
<p>For reference, the simulation above, using 10 items with 5 response categories each and 1851 respondents, takes about 24 seconds to run on 8 cpu cores (Macbook Pro M1 Max) for 400 iterations.</p>
<p>I’ll cite Ostini &amp; Nering <span class="citation" data-cites="ostini_polytomous_2006">(<a href="#ref-ostini_polytomous_2006" role="doc-biblioref">2006</a>)</span> on the description of outfit and infit (pages 86-87):</p>
<blockquote class="blockquote">
<p>Response residuals can be summed over respondents to obtain an item fit measure. Generally, the accumulation is done with squared standardized residuals, which are then divided by the total number of respondents to obtain a mean square statistic. In this form, the statistic is referred to as an <strong>unweighted mean square</strong> (Masters &amp; Wright, 1997; Wright &amp; Masters, 1982) and has also come to be known as <strong>“outfit”</strong> (Smith, Schumacker, &amp; Bush, 1998; Wu, 1997) […]</p>
</blockquote>
<blockquote class="blockquote">
<p>A weighted version of this statistic was developed to counteract its sensitivity to outliers (Smith, 2000). In its weighted form, the squared standardized residual is multiplied by the observed response variance and then divided by the sum of the item response variances. This is sometimes referred to as an <strong>information weighted mean square</strong> and has become known as <strong>“infit”</strong> (Smith et al., 1998; Wu, 1997).</p>
</blockquote>
<p>A low item fit value (sometimes referred to as an item “overfitting” the Rasch model) indicates that responses may be too predictable. This is often the case for items that are very general/broad in scope in relation to the latent variable, for instance asking about feeling depressed in a depression questionnaire. You will often find overfitting items to also have residual correlations (local dependencies) with other items. Overfit may be likened to having a much stronger factor loading than other items in a confirmatory factor analysis.</p>
<p>A high item fit value (sometimes referred to as “underfitting” the Rasch model) can indicate several things, often multidimensionality or a question that is difficult to interpret and thus has noisy response data. The latter could for instance be caused by a question that asks about two things at the same time or is ambiguous for other reasons.</p>
<p>Outfit has been found to be a not very useful method to detect item misfit, infit should be relied upon when sample sizes are appropriate <span class="citation" data-cites="johansson_detecting_2025">(<a href="#ref-johansson_detecting_2025" role="doc-biblioref">Johansson, 2025a</a>)</span>. Outfit was removed from the output in version 0.3.9.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Remember to <strong>scroll back up and click on all tabs</strong>.</p>
</div>
</div>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<p>This is another useful function from the <code>iarm</code> package. It shows the expected and observed correlation between an item and a score based on the rest of the items <span class="citation" data-cites="kreiner_note_2011">(<a href="#ref-kreiner_note_2011" role="doc-biblioref">Kreiner, 2011</a>)</span>. Similarly, but inverted, to item fit, a lower observed correlation value than expected indicates underfit, that the item may not belong to the dimension. A higher than expected observed value indicates an overfitting and possibly redundant item. Overfitting items will often also show issues with residual correlations. Both of these problems can often be (at least partially) resolved by removing underfitting items.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb35"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://pgmj.github.io/easyRasch/reference/RIrestscore.html">RIrestscore</a></span><span class="op">(</span><span class="va">df500</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table data-quarto-disable-processing="true" style="width:65%; font-size: 14px;  font-family: Arial; margin-left: auto; margin-right: auto;" class="table table-striped table-hover lightable-classic">
<thead><tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> Item </th>
   <th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> Observed value </th>
   <th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> Model expected value </th>
   <th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> Absolute difference </th>
   <th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> Adjusted p-value (BH) </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> Statistical significance level </th>
   <th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> Location </th>
   <th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> Relative location </th>
  </tr></thead>
<tbody>
<tr>
<td style="text-align:left;"> PANAS_11 </td>
   <td style="text-align:right;"> 0.58 </td>
   <td style="text-align:right;"> 0.62 </td>
   <td style="text-align:right;"> 0.04 </td>
   <td style="text-align:right;"> 0.332 </td>
   <td style="text-align:left;">  </td>
   <td style="text-align:right;"> -0.32 </td>
   <td style="text-align:right;"> 1.08 </td>
  </tr>
<tr>
<td style="text-align:left;"> PANAS_12 </td>
   <td style="text-align:right;"> 0.72 </td>
   <td style="text-align:right;"> 0.62 </td>
   <td style="text-align:right;"> 0.10 </td>
   <td style="text-align:right;"> 0.000 </td>
   <td style="text-align:left;"> *** </td>
   <td style="text-align:right;"> -0.11 </td>
   <td style="text-align:right;"> 1.28 </td>
  </tr>
<tr>
<td style="text-align:left;"> PANAS_13 </td>
   <td style="text-align:right;"> 0.61 </td>
   <td style="text-align:right;"> 0.60 </td>
   <td style="text-align:right;"> 0.01 </td>
   <td style="text-align:right;"> 0.883 </td>
   <td style="text-align:left;">  </td>
   <td style="text-align:right;"> 0.35 </td>
   <td style="text-align:right;"> 1.75 </td>
  </tr>
<tr>
<td style="text-align:left;"> PANAS_14 </td>
   <td style="text-align:right;"> 0.63 </td>
   <td style="text-align:right;"> 0.63 </td>
   <td style="text-align:right;"> 0.00 </td>
   <td style="text-align:right;"> 0.883 </td>
   <td style="text-align:left;">  </td>
   <td style="text-align:right;"> -0.39 </td>
   <td style="text-align:right;"> 1.00 </td>
  </tr>
<tr>
<td style="text-align:left;"> PANAS_15 </td>
   <td style="text-align:right;"> 0.70 </td>
   <td style="text-align:right;"> 0.61 </td>
   <td style="text-align:right;"> 0.09 </td>
   <td style="text-align:right;"> 0.001 </td>
   <td style="text-align:left;"> ** </td>
   <td style="text-align:right;"> 0.20 </td>
   <td style="text-align:right;"> 1.59 </td>
  </tr>
<tr>
<td style="text-align:left;"> PANAS_16 </td>
   <td style="text-align:right;"> 0.71 </td>
   <td style="text-align:right;"> 0.62 </td>
   <td style="text-align:right;"> 0.09 </td>
   <td style="text-align:right;"> 0.001 </td>
   <td style="text-align:left;"> ** </td>
   <td style="text-align:right;"> 0.20 </td>
   <td style="text-align:right;"> 1.59 </td>
  </tr>
<tr>
<td style="text-align:left;"> PANAS_17 </td>
   <td style="text-align:right;"> 0.60 </td>
   <td style="text-align:right;"> 0.60 </td>
   <td style="text-align:right;"> 0.00 </td>
   <td style="text-align:right;"> 0.919 </td>
   <td style="text-align:left;">  </td>
   <td style="text-align:right;"> 0.34 </td>
   <td style="text-align:right;"> 1.74 </td>
  </tr>
<tr>
<td style="text-align:left;"> PANAS_18 </td>
   <td style="text-align:right;"> 0.55 </td>
   <td style="text-align:right;"> 0.61 </td>
   <td style="text-align:right;"> 0.06 </td>
   <td style="text-align:right;"> 0.264 </td>
   <td style="text-align:left;">  </td>
   <td style="text-align:right;"> 0.22 </td>
   <td style="text-align:right;"> 1.61 </td>
  </tr>
<tr>
<td style="text-align:left;"> PANAS_19 </td>
   <td style="text-align:right;"> 0.66 </td>
   <td style="text-align:right;"> 0.63 </td>
   <td style="text-align:right;"> 0.03 </td>
   <td style="text-align:right;"> 0.332 </td>
   <td style="text-align:left;">  </td>
   <td style="text-align:right;"> -0.46 </td>
   <td style="text-align:right;"> 0.93 </td>
  </tr>
<tr>
<td style="text-align:left;"> PANAS_20 </td>
   <td style="text-align:right;"> 0.50 </td>
   <td style="text-align:right;"> 0.61 </td>
   <td style="text-align:right;"> 0.11 </td>
   <td style="text-align:right;"> 0.003 </td>
   <td style="text-align:left;"> ** </td>
   <td style="text-align:right;"> -0.03 </td>
   <td style="text-align:right;"> 1.36 </td>
  </tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="tabset-2-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-3-tab">
<p>Both item-restscore and conditional item infit/outfit will indicate “false misfit” when sample sizes are large (even when using simulation/bootstrap based cutoff values). This behavior can occur from about n = 500, and certainly will occur at samples of 800 and above <span class="citation" data-cites="johansson_detecting_2025">(<a href="#ref-johansson_detecting_2025" role="doc-biblioref">Johansson, 2025a</a>)</span>. This “false misfit” is caused by truly misfitting items, which underlines the importance of removing one item at a time when one finds issues with misfit/multidimensionality. However, a useful way to get additional information about the probability of actual misfit is to use non-parametric bootstrapping. This function resamples with replacement from your response data and reports the percentage and type of misfit indicated by the item-restscore function. You will also get information about conditional MSQ infit (based on the full sample, using complete responders). Simulation studies indicate that a sample size of 800 results in 95+% detection rate of 1-3 misfitting items amongst 20 dichotomous items <span class="citation" data-cites="johansson_detecting_2025">(<a href="#ref-johansson_detecting_2025" role="doc-biblioref">Johansson, 2025a</a>)</span>.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb36"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://pgmj.github.io/easyRasch/reference/RIbootRestscore.html">RIbootRestscore</a></span><span class="op">(</span><span class="va">df</span>, iterations <span class="op">=</span> <span class="fl">250</span>, samplesize <span class="op">=</span> <span class="fl">800</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table data-quarto-disable-processing="true" style="width:65%; font-size: 14px;  font-family: Arial; margin-left: auto; margin-right: auto;border-bottom: 0;" class="table table-striped table-hover lightable-classic">
<thead><tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> Item </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> Item-restscore result </th>
   <th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> % of iterations </th>
   <th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> Conditional MSQ infit </th>
   <th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> Relative average item location </th>
  </tr></thead>
<tbody>
<tr>
<td style="text-align:left;"> PANAS_20 </td>
   <td style="text-align:left;"> underfit </td>
   <td style="text-align:right;"> 81.6 </td>
   <td style="text-align:right;"> 1.20 </td>
   <td style="text-align:right;"> 1.42 </td>
  </tr>
<tr>
<td style="text-align:left;"> PANAS_11 </td>
   <td style="text-align:left;"> underfit </td>
   <td style="text-align:right;"> 45.2 </td>
   <td style="text-align:right;"> 1.20 </td>
   <td style="text-align:right;"> 1.14 </td>
  </tr>
<tr>
<td style="text-align:left;"> PANAS_13 </td>
   <td style="text-align:left;"> underfit </td>
   <td style="text-align:right;"> 26.0 </td>
   <td style="text-align:right;"> 1.17 </td>
   <td style="text-align:right;"> 1.91 </td>
  </tr>
<tr>
<td style="text-align:left;"> PANAS_14 </td>
   <td style="text-align:left;"> underfit </td>
   <td style="text-align:right;"> 10.4 </td>
   <td style="text-align:right;"> 1.06 </td>
   <td style="text-align:right;"> 1.15 </td>
  </tr>
<tr>
<td style="text-align:left;"> PANAS_15 </td>
   <td style="text-align:left;"> overfit </td>
   <td style="text-align:right;"> 100.0 </td>
   <td style="text-align:right;"> 0.78 </td>
   <td style="text-align:right;"> 1.63 </td>
  </tr>
<tr>
<td style="text-align:left;"> PANAS_16 </td>
   <td style="text-align:left;"> overfit </td>
   <td style="text-align:right;"> 99.6 </td>
   <td style="text-align:right;"> 0.80 </td>
   <td style="text-align:right;"> 1.48 </td>
  </tr>
<tr>
<td style="text-align:left;"> PANAS_12 </td>
   <td style="text-align:left;"> overfit </td>
   <td style="text-align:right;"> 92.0 </td>
   <td style="text-align:right;"> 0.84 </td>
   <td style="text-align:right;"> 1.42 </td>
  </tr>
<tr>
<td style="text-align:left;"> PANAS_17 </td>
   <td style="text-align:left;"> overfit </td>
   <td style="text-align:right;"> 43.2 </td>
   <td style="text-align:right;"> 0.95 </td>
   <td style="text-align:right;"> 1.83 </td>
  </tr>
<tr>
<td style="text-align:left;"> PANAS_19 </td>
   <td style="text-align:left;"> overfit </td>
   <td style="text-align:right;"> 11.6 </td>
   <td style="text-align:right;"> 0.92 </td>
   <td style="text-align:right;"> 0.98 </td>
  </tr>
</tbody>
<tfoot>
<tr><td style="padding: 0; " colspan="100%"><span style="font-style: italic;">Note: </span></td></tr>
<tr><td style="padding: 0; " colspan="100%">
<sup></sup> Results based on 250 bootstrap iterations with n = 800 and 10 items. Conditional mean-square infit based on complete responders only (n = 1851).</td></tr>
</tfoot>
</table>
</div>
</div>
</div>
<div id="tabset-2-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-4-tab">
<p>The <a href="https://cran.r-project.org/web/packages/iarm/index.html"><code>iarm</code></a> package <span class="citation" data-cites="mueller_iarm_2022">(<a href="#ref-mueller_iarm_2022" role="doc-biblioref">Mueller &amp; Santiago, 2022</a>)</span> provides several interesting functions for assessing item fit, DIF and other things. Some of these functions have been implemented in simplified versions in <code>easyRasch</code>, and others may be included in a future version. Below are conditional item characteristic curves (ICC’s) using the estimated theta (factor score).</p>
<p>These curves indicate item fit on a group level, where respondents are split into “class intervals” based on their sum score/factor score.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb37"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://pgmj.github.io/easyRasch/reference/RIciccPlot.html">RIciccPlot</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/guide_area.html">guide_area</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># this relocates the legend/guide, which may produce a nicer output</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="RaschRvign_files/figure-html/unnamed-chunk-31-1.png" class="img-fluid figure-img" width="1050"></p>
</figure>
</div>
</div>
</div>
<p>A similar visualization, even more informative and flexible, has been made available in the <a href="https://github.com/ERRTG/RASCHplot/"><code>RASCHplot</code></a> package <span class="citation" data-cites="buchardt_visualizing_2023">(<a href="#ref-buchardt_visualizing_2023" role="doc-biblioref">Buchardt et al., 2023</a>)</span>. The package needs to be installed from GitHub (see commented code below). The linked paper is recommended reading, not least for descriptions of the useful options available. Below are some sample plots showing conditional ICC’s using the raw sum score.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb38"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/ERRTG/RASCHplot/">RASCHplot</a></span><span class="op">)</span> <span class="co"># devtools::install_github("ERRTG/RASCHplot")</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/RASCHplot/man/CICCplot.html">CICCplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/eRm/man/PCM.html">PCM</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span>,</span>
<span>         which.item <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span>,</span>
<span>         lower.groups <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">7</span>,<span class="fl">14</span>,<span class="fl">21</span>,<span class="fl">28</span><span class="op">)</span>,</span>
<span>         grid.items <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="RaschRvign_files/figure-html/unnamed-chunk-32-1.png" class="img-fluid figure-img" width="1050"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-2-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-5-tab">
<p>Principal Component Analysis of Rasch model residuals (PCAR).</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb39"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://pgmj.github.io/easyRasch/reference/RIpcmPCA.html">RIpcmPCA</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table data-quarto-disable-processing="true" style="width:65%; font-size: 14px;  font-family: Arial; margin-left: auto; margin-right: auto;" class="table table-striped table-hover lightable-classic">
<thead><tr>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> Eigenvalues </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> Proportion of variance </th>
  </tr></thead>
<tbody>
<tr>
<td style="text-align:right;"> 1.79 </td>
   <td style="text-align:left;"> 16.9% </td>
  </tr>
<tr>
<td style="text-align:right;"> 1.47 </td>
   <td style="text-align:left;"> 15.1% </td>
  </tr>
<tr>
<td style="text-align:right;"> 1.28 </td>
   <td style="text-align:left;"> 13.6% </td>
  </tr>
<tr>
<td style="text-align:right;"> 1.14 </td>
   <td style="text-align:left;"> 13.3% </td>
  </tr>
<tr>
<td style="text-align:right;"> 1.06 </td>
   <td style="text-align:left;"> 11.9% </td>
  </tr>
</tbody>
</table>
</div>
</div>
<p>Based on an old rule-of-thumb, the first eigenvalue should be below 1.5 to support unidimensionality <span class="citation" data-cites="smith_detecting_2002">(<a href="#ref-smith_detecting_2002" role="doc-biblioref">Smith, 2002</a>)</span>. However, as with many other metrics the expected PCAR eigenvalue is also dependent on sample size and test length <span class="citation" data-cites="chou_checking_2010">(<a href="#ref-chou_checking_2010" role="doc-biblioref">Chou &amp; Wang, 2010</a>)</span>. To be clear, there is no single or easily calculated rule-of-thumb critical value for the largest PCA eigenvalue that will be generally applicable. A parametric bootstrap function has been implemented in <code>easyRasch</code> to determine a potentially appropriate cutoff value for the largest PCAR eigenvalue, but it has not been systematically evaluated yet. Below is an example, illustrated with a histogram of the simulated distribution of largest eigenvalues, the 99th percentile and the max value.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb40"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">pcasim</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://pgmj.github.io/easyRasch/reference/RIbootPCA.html">RIbootPCA</a></span><span class="op">(</span><span class="va">df</span>, iterations <span class="op">=</span> <span class="fl">500</span>, cpu <span class="op">=</span> <span class="fl">8</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">pcasim</span><span class="op">$</span><span class="va">results</span>, breaks <span class="op">=</span> <span class="fl">50</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="RaschRvign_files/figure-html/unnamed-chunk-34-1.png" class="img-fluid figure-img" width="1050"></p>
</figure>
</div>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb41"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">pcasim</span><span class="op">$</span><span class="va">p99</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>    99% 
1.27501 </code></pre>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb43"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">pcasim</span><span class="op">$</span><span class="va">max</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 1.306</code></pre>
</div>
</div>
<p>If the bootstrap turns out to provide an appropriate cutoff value, it still needs to be used together with checking item fit (or item-restscore) and residual correlations (local dependence) to evaluate unidimensionality.</p>
<p>The PCA eigenvalues are mostly included here for those coming from Winsteps who may be looking for this metric. Speaking of Winsteps, the “explained variance” generated by <code><a href="https://pgmj.github.io/easyRasch/reference/RIpcmPCA.html">RIpcmPCA()</a></code> will not be comparable to Winsteps corresponding metric, since this function only shows the results from the analysis of residuals and not the variance explained by the Rasch model itself. Additionally, it should be noted that the PCA rotation is set to “oblimin”.</p>
</div>
<div id="tabset-2-6" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-6-tab">
<p>The Conditional Likelihood Ratio Test <span class="citation" data-cites="andersen_goodness_1973">(CLRT, <a href="#ref-andersen_goodness_1973" role="doc-biblioref">Andersen, 1973</a>)</span> is a global test of fit and can be a useful addition to more informative item-level metrics <span class="citation" data-cites="johansson_detecting_2025">(<a href="#ref-johansson_detecting_2025" role="doc-biblioref">Johansson, 2025a</a>)</span>. CLRT compares the responses of those scoring below the median to those scoring above the median to assess the homogeneity of the test. Below, we run the test using the smaller sample with a function from the <code>iarm</code> package.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb45"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/iarm/man/clr_tests.html">clr_tests</a></span><span class="op">(</span><span class="va">df500</span>, model <span class="op">=</span> <span class="st">"PCM"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
Conditional Likelihood Ratio Tests:</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>        clr  df pvalue  sig 
overall 98.1 39 5.4e-07  ***</code></pre>
</div>
</div>
<p>The test is clearly statistically significant, even with the smaller sample, which indicates that unidimensionality does not hold. However, CLRT is sensitive to large sample sizes and number of items, and produces false positives above the nominal 5% level. See <a href="https://pgmj.github.io/clrt.html" class="uri">https://pgmj.github.io/clrt.html</a> for a very small simulation study. To minimize the sample size issue, a non-parametric bootstrap function has been implemented in <code>easyRasch</code>, where one can set the sample size manually. The function will then sample with replacement from the response data and conduct a separate CLRT for each sample drawn.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb48"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://pgmj.github.io/easyRasch/reference/RIbootLRT.html">RIbootLRT</a></span><span class="op">(</span><span class="va">df</span>, iterations <span class="op">=</span> <span class="fl">1000</span>, samplesize <span class="op">=</span> <span class="fl">400</span>, cpu <span class="op">=</span> <span class="fl">8</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<thead><tr class="header">
<th style="text-align: left;">Result</th>
<th style="text-align: right;">n</th>
<th style="text-align: right;">Percent</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Not statistically significant</td>
<td style="text-align: right;">13</td>
<td style="text-align: right;">1.3</td>
</tr>
<tr class="even">
<td style="text-align: left;">Statistically significant</td>
<td style="text-align: right;">987</td>
<td style="text-align: right;">98.7</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>The bootstrap method also shows a strong majority of statistically significant results.</p>
<p>Global tests do not provide any information about the reason for misfit. The <code>iarm</code> package has also implemented a function to get item specific information related to the CLRT, showing observed and expected values for each item.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb49"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/iarm/man/item_obsexp.html">item_obsexp</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/eRm/man/PCM.html">PCM</a></span><span class="op">(</span><span class="va">df500</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>Score group 1: 
         mean obs mean exp std.res sig
PANAS_11  0.721    0.657    1.341     
PANAS_12  0.298    0.368   -1.770     
PANAS_13  0.274    0.252    0.639     
PANAS_14  0.688    0.661    0.526     
PANAS_15  0.279    0.360   -2.045  -  
PANAS_16  0.279    0.341   -1.521     
PANAS_17  0.207    0.214   -0.215     
PANAS_18  0.255    0.226    0.845     
PANAS_19  0.692    0.698   -0.105     
PANAS_20  0.659    0.535    2.717  +  

Score group 2: 
         mean obs mean exp std.res sig
PANAS_11  1.8922   1.9495  -0.8812    
PANAS_12  1.8190   1.7232   1.3896    
PANAS_13  1.1940   1.2141  -0.3166    
PANAS_14  2.0302   2.0539  -0.3624    
PANAS_15  1.5129   1.4396   1.1415    
PANAS_16  1.6207   1.5638   0.8545    
PANAS_17  1.1422   1.1359   0.0994    
PANAS_18  1.2198   1.2453  -0.3799    
PANAS_19  2.1767   2.1720   0.0716    
PANAS_20  1.5690   1.6795  -1.7907    </code></pre>
</div>
</div>
</div>
<div id="tabset-2-7" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-7-tab">
<p>In order to support unidimensionality, items should only be related to each other through the latent variable, and otherwise be independent of each other. This is called “local independence” when fulfilled and “local dependence” (LD) when there are issues. The extreme case of dependence is when all respondents give the same response for two items. Two aspects of LD are often described <span class="citation" data-cites="chen_local_1997">(<a href="#ref-chen_local_1997" role="doc-biblioref">Chen &amp; Thissen, 1997</a>)</span>:</p>
<ol type="1">
<li>Underlying local dependence (ULD), which is when the locally dependent items are measuring a different latent variable than the other items.</li>
<li>Surface local dependence (SLD), when item content is very similar.</li>
</ol>
<p>By investigating patterns in model residuals, we can determine whether items are independent or not. There are several tests that can be used to assess LD, of which Yen’s Q<sub>3</sub> generally has good properties. Please see <span class="citation" data-cites="edwards_diagnostic_2018">(<a href="#ref-edwards_diagnostic_2018" role="doc-biblioref">Edwards et al., 2018</a>)</span> for an overview of different methods. It is recommended to use multiple methods, since they may perform differently with different types of LD. For instance, Chen &amp; Thissen <span class="citation" data-cites="chen_local_1997">(<a href="#ref-chen_local_1997" role="doc-biblioref">1997</a>)</span> report that G<sup>2</sup> is slightly more powerful than Yen’s Q<sub>3</sub> in detecting SLD, while the reverse is true for ULD.</p>
<p>Similarly to item fit, we need to run simulations based on the observed data to get a useful cutoff threshold value for when residual correlations amongst item pairs are larger than would be expected from items that fit a unidimensional Rasch model <span class="citation" data-cites="christensen2017">(<a href="#ref-christensen2017" role="doc-biblioref">Christensen et al., 2017</a>)</span>.</p>
<p>The simulation/bootstrap procedure can take some time to run, depending on the complexity of your data, but it is necessary to set the appropriate cutoff value. The number of iterations to use has yet to be systematically evaluated, but I recommend no less than 500, and at least 1000 as a starting point.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb51"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">simcor1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://pgmj.github.io/easyRasch/reference/RIgetResidCor.html">RIgetResidCor</a></span><span class="op">(</span><span class="va">df</span>, iterations <span class="op">=</span> <span class="fl">500</span>, cpu <span class="op">=</span> <span class="fl">8</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://pgmj.github.io/easyRasch/reference/RIresidcorr.html">RIresidcorr</a></span><span class="op">(</span><span class="va">df</span>, cutoff <span class="op">=</span> <span class="va">simcor1</span><span class="op">$</span><span class="va">p995</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table data-quarto-disable-processing="true" style="width:65%; font-size: 14px;  font-family: Arial; margin-left: auto; margin-right: auto;border-bottom: 0;" class="table table-striped table-hover lightable-classic">
<thead><tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;">   </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> PANAS_11 </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> PANAS_12 </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> PANAS_13 </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> PANAS_14 </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> PANAS_15 </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> PANAS_16 </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> PANAS_17 </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> PANAS_18 </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> PANAS_19 </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> PANAS_20 </th>
  </tr></thead>
<tbody>
<tr>
<td style="text-align:left;"> PANAS_11 </td>
   <td style="text-align:left;">  </td>
   <td style="text-align:left;">  </td>
   <td style="text-align:left;">  </td>
   <td style="text-align:left;">  </td>
   <td style="text-align:left;">  </td>
   <td style="text-align:left;">  </td>
   <td style="text-align:left;">  </td>
   <td style="text-align:left;">  </td>
   <td style="text-align:left;">  </td>
   <td style="text-align:left;">  </td>
  </tr>
<tr>
<td style="text-align:left;"> PANAS_12 </td>
   <td style="text-align:left;"> <span style="     color: black !important;">-0.1</span> </td>
   <td style="text-align:left;">  </td>
   <td style="text-align:left;">  </td>
   <td style="text-align:left;">  </td>
   <td style="text-align:left;">  </td>
   <td style="text-align:left;">  </td>
   <td style="text-align:left;">  </td>
   <td style="text-align:left;">  </td>
   <td style="text-align:left;">  </td>
   <td style="text-align:left;">  </td>
  </tr>
<tr>
<td style="text-align:left;"> PANAS_13 </td>
   <td style="text-align:left;"> <span style="     color: black !important;">-0.05</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">-0.01</span> </td>
   <td style="text-align:left;">  </td>
   <td style="text-align:left;">  </td>
   <td style="text-align:left;">  </td>
   <td style="text-align:left;">  </td>
   <td style="text-align:left;">  </td>
   <td style="text-align:left;">  </td>
   <td style="text-align:left;">  </td>
   <td style="text-align:left;">  </td>
  </tr>
<tr>
<td style="text-align:left;"> PANAS_14 </td>
   <td style="text-align:left;"> <span style="     color: black !important;">-0.11</span> </td>
   <td style="text-align:left;"> <span style="     color: red !important;">0.09</span> </td>
   <td style="text-align:left;"> <span style="     color: red !important;">0.07</span> </td>
   <td style="text-align:left;">  </td>
   <td style="text-align:left;">  </td>
   <td style="text-align:left;">  </td>
   <td style="text-align:left;">  </td>
   <td style="text-align:left;">  </td>
   <td style="text-align:left;">  </td>
   <td style="text-align:left;">  </td>
  </tr>
<tr>
<td style="text-align:left;"> PANAS_15 </td>
   <td style="text-align:left;"> <span style="     color: black !important;">-0.14</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">-0.13</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">-0.22</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">-0.29</span> </td>
   <td style="text-align:left;">  </td>
   <td style="text-align:left;">  </td>
   <td style="text-align:left;">  </td>
   <td style="text-align:left;">  </td>
   <td style="text-align:left;">  </td>
   <td style="text-align:left;">  </td>
  </tr>
<tr>
<td style="text-align:left;"> PANAS_16 </td>
   <td style="text-align:left;"> <span style="     color: black !important;">-0.17</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">-0.1</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">-0.25</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">-0.27</span> </td>
   <td style="text-align:left;"> <span style="     color: red !important;">0.38</span> </td>
   <td style="text-align:left;">  </td>
   <td style="text-align:left;">  </td>
   <td style="text-align:left;">  </td>
   <td style="text-align:left;">  </td>
   <td style="text-align:left;">  </td>
  </tr>
<tr>
<td style="text-align:left;"> PANAS_17 </td>
   <td style="text-align:left;"> <span style="     color: black !important;">-0.18</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">-0.09</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">-0.09</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">-0.19</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">-0.13</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">-0.08</span> </td>
   <td style="text-align:left;">  </td>
   <td style="text-align:left;">  </td>
   <td style="text-align:left;">  </td>
   <td style="text-align:left;">  </td>
  </tr>
<tr>
<td style="text-align:left;"> PANAS_18 </td>
   <td style="text-align:left;"> <span style="     color: black !important;">-0.19</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">-0.15</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">-0.16</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">-0.18</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">-0.15</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">-0.13</span> </td>
   <td style="text-align:left;"> <span style="     color: red !important;">0.32</span> </td>
   <td style="text-align:left;">  </td>
   <td style="text-align:left;">  </td>
   <td style="text-align:left;">  </td>
  </tr>
<tr>
<td style="text-align:left;"> PANAS_19 </td>
   <td style="text-align:left;"> <span style="     color: black !important;">-0.13</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">-0.13</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">-0.25</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">-0.14</span> </td>
   <td style="text-align:left;"> <span style="     color: red !important;">0.1</span> </td>
   <td style="text-align:left;"> <span style="     color: red !important;">0.08</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">-0.21</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">-0.12</span> </td>
   <td style="text-align:left;">  </td>
   <td style="text-align:left;">  </td>
  </tr>
<tr>
<td style="text-align:left;"> PANAS_20 </td>
   <td style="text-align:left;"> <span style="     color: black !important;">-0.06</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">-0.22</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">-0.07</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">-0.05</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">-0.13</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">-0.19</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">-0.16</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">-0.15</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">-0.07</span> </td>
   <td style="text-align:left;">  </td>
  </tr>
</tbody>
<tfoot>
<tr><td style="padding: 0; " colspan="100%"><span style="font-style: italic;">Note: </span></td></tr>
<tr><td style="padding: 0; " colspan="100%">
<sup></sup> Relative cut-off value is -0.002, which is 0.1 above the average correlation (-0.102).<br>                                Correlations above the cut-off are highlighted in red text.</td></tr>
</tfoot>
</table>
</div>
</div>
<p>The matrix above shows item-pair correlations of item residuals, with highlights in red showing correlations crossing the threshold compared to the average item-pair correlation (for all item-pairs) <span class="citation" data-cites="christensen2017">(<a href="#ref-christensen2017" role="doc-biblioref">Christensen et al., 2017</a>)</span>. The threshold used in the example above has selected the 99.5th percentile from the simulations. The <code>simcor1</code> object also pre-calculates values for the 95th, 99th, 99.5th and 99.9th percentiles as well as the maximum. If you desire another percentile, you can manually calculate it from the results in the <code>simcor1</code> object using <code><a href="https://rdrr.io/r/stats/quantile.html">quantile()</a></code>.</p>
<p>Rasch model residual correlations using Yen’s Q<sub>3</sub> are calculated using the <a href="https://cran.r-project.org/web/packages/mirt/index.html">mirt</a> package.</p>
</div>
<div id="tabset-2-8" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-8-tab">
<p>Rasch model residual correlations using Chen &amp; Thissen’s G<sup>2</sup> are calculated using the <a href="https://cran.r-project.org/web/packages/mirt/index.html">mirt</a> package.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb52"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">simcor_g2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://pgmj.github.io/easyRasch/reference/RIgetResidCorG2.html">RIgetResidCorG2</a></span><span class="op">(</span><span class="va">df</span>, iterations <span class="op">=</span> <span class="fl">500</span>, cpu <span class="op">=</span> <span class="fl">8</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://pgmj.github.io/easyRasch/reference/RIresidcorrG2.html">RIresidcorrG2</a></span><span class="op">(</span><span class="va">df</span>, cutoff <span class="op">=</span> <span class="va">simcor_g2</span><span class="op">$</span><span class="va">p995</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table data-quarto-disable-processing="true" style="width:65%; font-size: 14px;  font-family: Arial; margin-left: auto; margin-right: auto;border-bottom: 0;" class="table table-striped table-hover lightable-classic">
<thead><tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;">   </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> PANAS_11 </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> PANAS_12 </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> PANAS_13 </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> PANAS_14 </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> PANAS_15 </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> PANAS_16 </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> PANAS_17 </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> PANAS_18 </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> PANAS_19 </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> PANAS_20 </th>
  </tr></thead>
<tbody>
<tr>
<td style="text-align:left;"> PANAS_11 </td>
   <td style="text-align:left;">  </td>
   <td style="text-align:left;"> <span style="     color: black !important;">-0.14</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">-0.13</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">-0.11</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">-0.1</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">-0.11</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">-0.12</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">-0.14</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">-0.13</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">-0.12</span> </td>
  </tr>
<tr>
<td style="text-align:left;"> PANAS_12 </td>
   <td style="text-align:left;">  </td>
   <td style="text-align:left;">  </td>
   <td style="text-align:left;"> <span style="     color: red !important;">0.1</span> </td>
   <td style="text-align:left;"> <span style="     color: red !important;">0.13</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0.09</span> </td>
   <td style="text-align:left;"> <span style="     color: red !important;">0.1</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0.09</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">-0.12</span> </td>
   <td style="text-align:left;"> <span style="     color: red !important;">0.1</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">-0.12</span> </td>
  </tr>
<tr>
<td style="text-align:left;"> PANAS_13 </td>
   <td style="text-align:left;">  </td>
   <td style="text-align:left;">  </td>
   <td style="text-align:left;">  </td>
   <td style="text-align:left;"> <span style="     color: red !important;">0.1</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">-0.1</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">-0.12</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">-0.1</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">-0.12</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">-0.12</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">-0.13</span> </td>
  </tr>
<tr>
<td style="text-align:left;"> PANAS_14 </td>
   <td style="text-align:left;">  </td>
   <td style="text-align:left;">  </td>
   <td style="text-align:left;">  </td>
   <td style="text-align:left;">  </td>
   <td style="text-align:left;"> <span style="     color: black !important;">-0.09</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">-0.1</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">-0.09</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">-0.11</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">-0.09</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">-0.09</span> </td>
  </tr>
<tr>
<td style="text-align:left;"> PANAS_15 </td>
   <td style="text-align:left;">  </td>
   <td style="text-align:left;">  </td>
   <td style="text-align:left;">  </td>
   <td style="text-align:left;">  </td>
   <td style="text-align:left;">  </td>
   <td style="text-align:left;"> <span style="     color: red !important;">0.24</span> </td>
   <td style="text-align:left;"> <span style="     color: red !important;">0.1</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">-0.08</span> </td>
   <td style="text-align:left;"> <span style="     color: red !important;">0.14</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">-0.1</span> </td>
  </tr>
<tr>
<td style="text-align:left;"> PANAS_16 </td>
   <td style="text-align:left;">  </td>
   <td style="text-align:left;">  </td>
   <td style="text-align:left;">  </td>
   <td style="text-align:left;">  </td>
   <td style="text-align:left;">  </td>
   <td style="text-align:left;">  </td>
   <td style="text-align:left;"> <span style="     color: red !important;">0.1</span> </td>
   <td style="text-align:left;"> <span style="     color: red !important;">0.1</span> </td>
   <td style="text-align:left;"> <span style="     color: red !important;">0.14</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">-0.1</span> </td>
  </tr>
<tr>
<td style="text-align:left;"> PANAS_17 </td>
   <td style="text-align:left;">  </td>
   <td style="text-align:left;">  </td>
   <td style="text-align:left;">  </td>
   <td style="text-align:left;">  </td>
   <td style="text-align:left;">  </td>
   <td style="text-align:left;">  </td>
   <td style="text-align:left;">  </td>
   <td style="text-align:left;"> <span style="     color: red !important;">0.17</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">-0.11</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">-0.11</span> </td>
  </tr>
<tr>
<td style="text-align:left;"> PANAS_18 </td>
   <td style="text-align:left;">  </td>
   <td style="text-align:left;">  </td>
   <td style="text-align:left;">  </td>
   <td style="text-align:left;">  </td>
   <td style="text-align:left;">  </td>
   <td style="text-align:left;">  </td>
   <td style="text-align:left;">  </td>
   <td style="text-align:left;">  </td>
   <td style="text-align:left;"> <span style="     color: black !important;">-0.11</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">-0.13</span> </td>
  </tr>
<tr>
<td style="text-align:left;"> PANAS_19 </td>
   <td style="text-align:left;">  </td>
   <td style="text-align:left;">  </td>
   <td style="text-align:left;">  </td>
   <td style="text-align:left;">  </td>
   <td style="text-align:left;">  </td>
   <td style="text-align:left;">  </td>
   <td style="text-align:left;">  </td>
   <td style="text-align:left;">  </td>
   <td style="text-align:left;">  </td>
   <td style="text-align:left;"> <span style="     color: black !important;">-0.12</span> </td>
  </tr>
<tr>
<td style="text-align:left;"> PANAS_20 </td>
   <td style="text-align:left;">  </td>
   <td style="text-align:left;">  </td>
   <td style="text-align:left;">  </td>
   <td style="text-align:left;">  </td>
   <td style="text-align:left;">  </td>
   <td style="text-align:left;">  </td>
   <td style="text-align:left;">  </td>
   <td style="text-align:left;">  </td>
   <td style="text-align:left;">  </td>
   <td style="text-align:left;">  </td>
  </tr>
</tbody>
<tfoot>
<tr><td style="padding: 0; " colspan="100%"><span style="font-style: italic;">Note: </span></td></tr>
<tr><td style="padding: 0; " colspan="100%">
<sup></sup> Relative cut-off value is 0.099, which is 0.138 above the average correlation (-0.039).<br>                                Correlations above the cut-off are highlighted in red text.</td></tr>
</tfoot>
</table>
</div>
</div>
</div>
<div id="tabset-2-9" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-9-tab">
<p>Another way to assess local (in)dependence is by partial gamma coefficients <span class="citation" data-cites="kreiner_analysis_2004">(<a href="#ref-kreiner_analysis_2004" role="doc-biblioref">Kreiner &amp; Christensen, 2004</a>)</span>. This is also a function from the <code>iarm</code> package. See <code><a href="https://rdrr.io/pkg/iarm/man/partgam_LD.html">?iarm::partgam_LD</a></code> for details.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb53"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://pgmj.github.io/easyRasch/reference/RIpartgamLD.html">RIpartgamLD</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table data-quarto-disable-processing="true" style="width:65%; font-size: 14px;  font-family: Arial; margin-left: auto; margin-right: auto;" class="table table-striped table-hover lightable-classic">
<thead><tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> Item 1 </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> Item 2 </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> Partial gamma </th>
   <th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> SE </th>
   <th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> Lower CI </th>
   <th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> Upper CI </th>
   <th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> Adjusted p-value (BH) </th>
  </tr></thead>
<tbody>
<tr>
<td style="text-align:left;"> PANAS_15 </td>
   <td style="text-align:left;"> PANAS_16 </td>
   <td style="text-align:left;"> <span style="     color: red !important;">0.634</span> </td>
   <td style="text-align:right;"> 0.030 </td>
   <td style="text-align:right;"> 0.576 </td>
   <td style="text-align:right;"> 0.693 </td>
   <td style="text-align:right;"> 0.000 </td>
  </tr>
<tr>
<td style="text-align:left;"> PANAS_16 </td>
   <td style="text-align:left;"> PANAS_15 </td>
   <td style="text-align:left;"> <span style="     color: red !important;">0.634</span> </td>
   <td style="text-align:right;"> 0.030 </td>
   <td style="text-align:right;"> 0.576 </td>
   <td style="text-align:right;"> 0.692 </td>
   <td style="text-align:right;"> 0.000 </td>
  </tr>
<tr>
<td style="text-align:left;"> PANAS_17 </td>
   <td style="text-align:left;"> PANAS_18 </td>
   <td style="text-align:left;"> <span style="     color: red !important;">0.577</span> </td>
   <td style="text-align:right;"> 0.033 </td>
   <td style="text-align:right;"> 0.512 </td>
   <td style="text-align:right;"> 0.642 </td>
   <td style="text-align:right;"> 0.000 </td>
  </tr>
<tr>
<td style="text-align:left;"> PANAS_18 </td>
   <td style="text-align:left;"> PANAS_17 </td>
   <td style="text-align:left;"> <span style="     color: red !important;">0.551</span> </td>
   <td style="text-align:right;"> 0.034 </td>
   <td style="text-align:right;"> 0.484 </td>
   <td style="text-align:right;"> 0.619 </td>
   <td style="text-align:right;"> 0.000 </td>
  </tr>
<tr>
<td style="text-align:left;"> PANAS_12 </td>
   <td style="text-align:left;"> PANAS_14 </td>
   <td style="text-align:left;"> <span style="     color: red !important;">0.341</span> </td>
   <td style="text-align:right;"> 0.037 </td>
   <td style="text-align:right;"> 0.269 </td>
   <td style="text-align:right;"> 0.413 </td>
   <td style="text-align:right;"> 0.000 </td>
  </tr>
<tr>
<td style="text-align:left;"> PANAS_16 </td>
   <td style="text-align:left;"> PANAS_19 </td>
   <td style="text-align:left;"> <span style="     color: red !important;">0.297</span> </td>
   <td style="text-align:right;"> 0.040 </td>
   <td style="text-align:right;"> 0.219 </td>
   <td style="text-align:right;"> 0.375 </td>
   <td style="text-align:right;"> 0.000 </td>
  </tr>
<tr>
<td style="text-align:left;"> PANAS_14 </td>
   <td style="text-align:left;"> PANAS_12 </td>
   <td style="text-align:left;"> <span style="     color: red !important;">0.293</span> </td>
   <td style="text-align:right;"> 0.038 </td>
   <td style="text-align:right;"> 0.217 </td>
   <td style="text-align:right;"> 0.368 </td>
   <td style="text-align:right;"> 0.000 </td>
  </tr>
<tr>
<td style="text-align:left;"> PANAS_15 </td>
   <td style="text-align:left;"> PANAS_19 </td>
   <td style="text-align:left;"> <span style="     color: red !important;">0.287</span> </td>
   <td style="text-align:right;"> 0.040 </td>
   <td style="text-align:right;"> 0.208 </td>
   <td style="text-align:right;"> 0.366 </td>
   <td style="text-align:right;"> 0.000 </td>
  </tr>
<tr>
<td style="text-align:left;"> PANAS_19 </td>
   <td style="text-align:left;"> PANAS_16 </td>
   <td style="text-align:left;"> <span style="     color: red !important;">0.274</span> </td>
   <td style="text-align:right;"> 0.040 </td>
   <td style="text-align:right;"> 0.197 </td>
   <td style="text-align:right;"> 0.352 </td>
   <td style="text-align:right;"> 0.000 </td>
  </tr>
<tr>
<td style="text-align:left;"> PANAS_19 </td>
   <td style="text-align:left;"> PANAS_15 </td>
   <td style="text-align:left;"> <span style="     color: red !important;">0.261</span> </td>
   <td style="text-align:right;"> 0.041 </td>
   <td style="text-align:right;"> 0.181 </td>
   <td style="text-align:right;"> 0.340 </td>
   <td style="text-align:right;"> 0.000 </td>
  </tr>
<tr>
<td style="text-align:left;"> PANAS_14 </td>
   <td style="text-align:left;"> PANAS_13 </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0.209</span> </td>
   <td style="text-align:right;"> 0.042 </td>
   <td style="text-align:right;"> 0.127 </td>
   <td style="text-align:right;"> 0.291 </td>
   <td style="text-align:right;"> 0.000 </td>
  </tr>
<tr>
<td style="text-align:left;"> PANAS_13 </td>
   <td style="text-align:left;"> PANAS_14 </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0.202</span> </td>
   <td style="text-align:right;"> 0.041 </td>
   <td style="text-align:right;"> 0.121 </td>
   <td style="text-align:right;"> 0.283 </td>
   <td style="text-align:right;"> 0.000 </td>
  </tr>
<tr>
<td style="text-align:left;"> PANAS_12 </td>
   <td style="text-align:left;"> PANAS_13 </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0.191</span> </td>
   <td style="text-align:right;"> 0.044 </td>
   <td style="text-align:right;"> 0.105 </td>
   <td style="text-align:right;"> 0.278 </td>
   <td style="text-align:right;"> 0.001 </td>
  </tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="tabset-2-10" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-10-tab">
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb54"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://pgmj.github.io/easyRasch/reference/RIloadLoc.html">RIloadLoc</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="RaschRvign_files/figure-html/unnamed-chunk-41-1.png" class="img-fluid figure-img" width="1050"></p>
</figure>
</div>
</div>
</div>
<p>Here we see item locations and their loadings on the first residual contrast. This figure can be helpful to identify clusters in data or multidimensionality. You can get a table with standardized factor loadings using <code>RIloadLoc(df, output = "table")</code>.</p>
</div>
<div id="tabset-2-11" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-11-tab">
<p>The <code>xlims</code> setting changes the x-axis limits for the plots. The default values usually make sense, and we mostly add this option to point out the possibility of doing so. You can also choose to only show plots for only specific items.</p>
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb55"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://pgmj.github.io/easyRasch/reference/RIitemCats.html">RIitemCats</a></span><span class="op">(</span><span class="va">df</span>, xlims <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">5</span>,<span class="fl">5</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell quarto-layout-panel" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="RaschRvign_files/figure-html/unnamed-chunk-42-1.png" class="img-fluid" width="1050"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="RaschRvign_files/figure-html/unnamed-chunk-42-2.png" class="img-fluid" width="1050"></p>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="RaschRvign_files/figure-html/unnamed-chunk-42-3.png" class="img-fluid" width="1050"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="RaschRvign_files/figure-html/unnamed-chunk-42-4.png" class="img-fluid" width="1050"></p>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="RaschRvign_files/figure-html/unnamed-chunk-42-5.png" class="img-fluid" width="1050"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="RaschRvign_files/figure-html/unnamed-chunk-42-6.png" class="img-fluid" width="1050"></p>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="RaschRvign_files/figure-html/unnamed-chunk-42-7.png" class="img-fluid" width="1050"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="RaschRvign_files/figure-html/unnamed-chunk-42-8.png" class="img-fluid" width="1050"></p>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="RaschRvign_files/figure-html/unnamed-chunk-42-9.png" class="img-fluid" width="1050"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="RaschRvign_files/figure-html/unnamed-chunk-42-10.png" class="img-fluid" width="1050"></p>
</div>
</div>
</div>
<p>Each response category for each item should have a curve that indicates it to be the most probably response at some point on the latent variable (x axis in the figure).</p>
</div>
<div id="tabset-2-12" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-12-tab">
<p>This produces a single figure with all items. Note that <code><a href="https://philchalmers.github.io/mirt/reference/mirt.html">mirt()</a></code> uses marginal maximum likelihood (MML) estimation which may produce slightly different results compared to eRm/CML when the distribution of person locations/scores are non-normal.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb56"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://philchalmers.github.io/mirt/reference/mirt.html">mirt</a></span><span class="op">(</span><span class="va">df</span>, model<span class="op">=</span><span class="fl">1</span>, itemtype<span class="op">=</span><span class="st">'Rasch'</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span>type<span class="op">=</span><span class="st">"trace"</span>, as.table <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>       theta_lim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">5</span>,<span class="fl">5</span><span class="op">)</span><span class="op">)</span> <span class="co"># changes x axis limits</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="RaschRvign_files/figure-html/unnamed-chunk-43-1.png" class="img-fluid figure-img" width="1050"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-2-13" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-13-tab">
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb57"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># increase fig-height in the chunk option above if you have many items</span></span>
<span><span class="fu"><a href="https://pgmj.github.io/easyRasch/reference/RItargeting.html">RItargeting</a></span><span class="op">(</span><span class="va">df</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">5</span>,<span class="fl">4</span><span class="op">)</span><span class="op">)</span> <span class="co"># xlim defaults to c(-4,4) if you omit this option</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="RaschRvign_files/figure-html/unnamed-chunk-44-1.png" class="img-fluid figure-img" width="1050"></p>
</figure>
</div>
</div>
</div>
<p>This figure shows how well the items fit the respondents/persons. It is a sort of <a href="https://www.rasch.org/rmt/rmt253b.htm">Wright Map</a> that shows person locations and item threshold locations on the same logit scale.</p>
<p>The top part shows person location histogram, the middle part an inverted histogram of item threshold locations, and the bottom part shows individual item threshold locations. The histograms also show means and standard deviations.</p>
</div>
<div id="tabset-2-14" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-14-tab">
<p>Here the items are sorted on their average threshold location (black diamonds). 84% confidence intervals are shown around each item threshold location. For further details, see the caption text below the figure.</p>
<p>The numbers displayed in the plot can be disabled using the option <code>numbers = FALSE</code>.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb58"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://pgmj.github.io/easyRasch/reference/RIitemHierarchy.html">RIitemHierarchy</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="RaschRvign_files/figure-html/unnamed-chunk-45-1.png" class="img-fluid figure-img" width="1050"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
<section id="analysis-1-comments" class="level3" data-number="3.1"><h3 data-number="3.1" class="anchored" data-anchor-id="analysis-1-comments">
<span class="header-section-number">3.1</span> Analysis 1 comments</h3>
<p>Item fit shows a lot of issues.</p>
<p>Item 18 has issues with the second lowest category being disordered. Several other items have very short distances between thresholds 1 and 2, which is also clearly seen in the Item Hierarchy figure above.</p>
<p>Two item-pairs show residual correlations far above the cutoff value:</p>
<ul>
<li>15 and 16 (scared and afraid)</li>
<li>17 and 18 (ashamed and guilty)</li>
</ul>
<p>Since item 15 also has a residual correlation with item 19, we will remove it. In the second pair, item 18 will be removed since it also has problems with disordered response categories.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>We have multiple “diagnostics” to review when deciding which item to remove if there are strong residual correlations between two items. Here is a list of commonly used criteria:</p>
<ul>
<li>item fit</li>
<li>item threshold locations compared to sample locations (targeting)</li>
<li>ordering of response categories</li>
<li>DIF</li>
<li>and whether there are residual correlations between one item and multiple other items</li>
</ul>
</div>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb59"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">removed.items</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"PANAS_15"</span>,<span class="st">"PANAS_18"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">df_backup</span> <span class="op">&lt;-</span> <span class="va">df</span></span>
<span><span class="va">df500_backup</span> <span class="op">&lt;-</span> <span class="va">df500</span></span>
<span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="va">df_backup</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/all_of.html">any_of</a></span><span class="op">(</span><span class="va">removed.items</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">df500</span> <span class="op">&lt;-</span> <span class="va">df500_backup</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/all_of.html">any_of</a></span><span class="op">(</span><span class="va">removed.items</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>As seen in the code above, I chose to create a backup copy of the original dataframes, then removing the items. This can be useful if, at a later stage in the analysis, I want to be able to quickly “go back” and reinstate an item or undo any other change I have made.</p>
</section></section><section id="rasch-analysis-2" class="level2 page-columns page-full" data-number="4"><h2 data-number="4" class="anchored" data-anchor-id="rasch-analysis-2">
<span class="header-section-number">4</span> Rasch analysis 2</h2>
<p>With items 15 and 18 removed.</p>
<div class="cell page-columns page-full">

<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<table class="table table-striped" style="font-size: 13px; font-family: Lato">
<thead><tr>
<th style="text-align:center;">
itemnr
</th>
<th style="text-align:left;">
item
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:center;">
<span style="color: grey; font-weight: bold">PANAS_11</span>
</td>
<td style="text-align:left;">
Distressed
</td>
</tr>
<tr>
<td style="text-align:center;">
<span style="color: grey; font-weight: bold">PANAS_12</span>
</td>
<td style="text-align:left;">
Upset
</td>
</tr>
<tr>
<td style="text-align:center;">
<span style="color: grey; font-weight: bold">PANAS_13</span>
</td>
<td style="text-align:left;">
Hostile
</td>
</tr>
<tr>
<td style="text-align:center;">
<span style="color: grey; font-weight: bold">PANAS_14</span>
</td>
<td style="text-align:left;">
Irritable
</td>
</tr>
<tr>
<td style="text-align:center;">
<span style="color: grey; font-weight: bold">PANAS_16</span>
</td>
<td style="text-align:left;">
Afraid
</td>
</tr>
<tr>
<td style="text-align:center;">
<span style="color: grey; font-weight: bold">PANAS_17</span>
</td>
<td style="text-align:left;">
Ashamed
</td>
</tr>
<tr>
<td style="text-align:center;">
<span style="color: grey; font-weight: bold">PANAS_19</span>
</td>
<td style="text-align:left;">
Nervous
</td>
</tr>
<tr>
<td style="text-align:center;">
<span style="color: grey; font-weight: bold">PANAS_20</span>
</td>
<td style="text-align:left;">
Jittery
</td>
</tr>
</tbody>
</table>
</div></div></div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-3-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-1" role="tab" aria-controls="tabset-3-1" aria-selected="true">Item-restscore bootstrap</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-2" role="tab" aria-controls="tabset-3-2" aria-selected="false">Conditional item fit</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-3" role="tab" aria-controls="tabset-3-3" aria-selected="false">PCA of residuals</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-4" role="tab" aria-controls="tabset-3-4" aria-selected="false">Residual correlations</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-5" role="tab" aria-controls="tabset-3-5" aria-selected="false">1st contrast loadings</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-6-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-6" role="tab" aria-controls="tabset-3-6" aria-selected="false">Targeting</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-7-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-7" role="tab" aria-controls="tabset-3-7" aria-selected="false">Item hierarchy</a></li>
</ul>
<div class="tab-content">
<div id="tabset-3-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-3-1-tab">
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb60"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://pgmj.github.io/easyRasch/reference/RIbootRestscore.html">RIbootRestscore</a></span><span class="op">(</span><span class="va">df</span>, iterations <span class="op">=</span> <span class="fl">250</span>, samplesize <span class="op">=</span> <span class="fl">800</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table data-quarto-disable-processing="true" style="width:65%; font-size: 14px;  font-family: Arial; margin-left: auto; margin-right: auto;border-bottom: 0;" class="table table-striped table-hover lightable-classic">
<thead><tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> Item </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> Item-restscore result </th>
   <th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> % of iterations </th>
   <th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> Conditional MSQ infit </th>
   <th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> Relative average item location </th>
  </tr></thead>
<tbody>
<tr>
<td style="text-align:left;"> PANAS_20 </td>
   <td style="text-align:left;"> underfit </td>
   <td style="text-align:right;"> 41.6 </td>
   <td style="text-align:right;"> 1.16 </td>
   <td style="text-align:right;"> 1.39 </td>
  </tr>
<tr>
<td style="text-align:left;"> PANAS_11 </td>
   <td style="text-align:left;"> underfit </td>
   <td style="text-align:right;"> 14.8 </td>
   <td style="text-align:right;"> 1.14 </td>
   <td style="text-align:right;"> 1.11 </td>
  </tr>
<tr>
<td style="text-align:left;"> PANAS_12 </td>
   <td style="text-align:left;"> overfit </td>
   <td style="text-align:right;"> 98.4 </td>
   <td style="text-align:right;"> 0.80 </td>
   <td style="text-align:right;"> 1.38 </td>
  </tr>
<tr>
<td style="text-align:left;"> PANAS_16 </td>
   <td style="text-align:left;"> overfit </td>
   <td style="text-align:right;"> 66.4 </td>
   <td style="text-align:right;"> 0.88 </td>
   <td style="text-align:right;"> 1.44 </td>
  </tr>
<tr>
<td style="text-align:left;"> PANAS_17 </td>
   <td style="text-align:left;"> overfit </td>
   <td style="text-align:right;"> 7.2 </td>
   <td style="text-align:right;"> 1.04 </td>
   <td style="text-align:right;"> 1.79 </td>
  </tr>
<tr>
<td style="text-align:left;"> PANAS_19 </td>
   <td style="text-align:left;"> overfit </td>
   <td style="text-align:right;"> 5.2 </td>
   <td style="text-align:right;"> 0.94 </td>
   <td style="text-align:right;"> 0.95 </td>
  </tr>
</tbody>
<tfoot>
<tr><td style="padding: 0; " colspan="100%"><span style="font-style: italic;">Note: </span></td></tr>
<tr><td style="padding: 0; " colspan="100%">
<sup></sup> Results based on 250 bootstrap iterations with n = 800 and 8 items. Conditional mean-square infit based on complete responders only (n = 1851).</td></tr>
</tfoot>
</table>
</div>
</div>
</div>
<div id="tabset-3-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-2-tab">
<p>Still using the smaller sample of n = 500.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb61"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">simfit2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://pgmj.github.io/easyRasch/reference/RIgetfit.html">RIgetfit</a></span><span class="op">(</span><span class="va">df500</span>, iterations <span class="op">=</span> <span class="fl">400</span>, cpu <span class="op">=</span> <span class="fl">8</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://pgmj.github.io/easyRasch/reference/RIitemfit.html">RIitemfit</a></span><span class="op">(</span><span class="va">df500</span>, simcut <span class="op">=</span> <span class="va">simfit2</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table data-quarto-disable-processing="true" style="width:65%; font-size: 14px;  font-family: Arial; margin-left: auto; margin-right: auto;border-bottom: 0;" class="table table-striped table-hover lightable-classic">
<thead><tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> Item </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> InfitMSQ </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> Infit thresholds </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> Infit diff </th>
   <th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> Relative location </th>
  </tr></thead>
<tbody>
<tr>
<td style="text-align:left;"> PANAS_11 </td>
   <td style="text-align:left;"> <span style="     color: black !important;">1.162</span> </td>
   <td style="text-align:left;"> [0.859, 1.182] </td>
   <td style="text-align:left;"> no misfit </td>
   <td style="text-align:right;"> 1.05 </td>
  </tr>
<tr>
<td style="text-align:left;"> PANAS_12 </td>
   <td style="text-align:left;"> <span style="     color: red !important;">0.771</span> </td>
   <td style="text-align:left;"> [0.844, 1.158] </td>
   <td style="text-align:left;"> 0.073 </td>
   <td style="text-align:right;"> 1.26 </td>
  </tr>
<tr>
<td style="text-align:left;"> PANAS_13 </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0.957</span> </td>
   <td style="text-align:left;"> [0.856, 1.188] </td>
   <td style="text-align:left;"> no misfit </td>
   <td style="text-align:right;"> 1.72 </td>
  </tr>
<tr>
<td style="text-align:left;"> PANAS_14 </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0.912</span> </td>
   <td style="text-align:left;"> [0.823, 1.173] </td>
   <td style="text-align:left;"> no misfit </td>
   <td style="text-align:right;"> 0.98 </td>
  </tr>
<tr>
<td style="text-align:left;"> PANAS_16 </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0.869</span> </td>
   <td style="text-align:left;"> [0.845, 1.166] </td>
   <td style="text-align:left;"> no misfit </td>
   <td style="text-align:right;"> 1.58 </td>
  </tr>
<tr>
<td style="text-align:left;"> PANAS_17 </td>
   <td style="text-align:left;"> <span style="     color: red !important;">1.184</span> </td>
   <td style="text-align:left;"> [0.819, 1.182] </td>
   <td style="text-align:left;"> 0.002 </td>
   <td style="text-align:right;"> 1.71 </td>
  </tr>
<tr>
<td style="text-align:left;"> PANAS_19 </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0.92</span> </td>
   <td style="text-align:left;"> [0.841, 1.169] </td>
   <td style="text-align:left;"> no misfit </td>
   <td style="text-align:right;"> 0.91 </td>
  </tr>
<tr>
<td style="text-align:left;"> PANAS_20 </td>
   <td style="text-align:left;"> <span style="     color: red !important;">1.236</span> </td>
   <td style="text-align:left;"> [0.868, 1.193] </td>
   <td style="text-align:left;"> 0.043 </td>
   <td style="text-align:right;"> 1.34 </td>
  </tr>
</tbody>
<tfoot>
<tr><td style="padding: 0; " colspan="100%"><span style="font-style: italic;">Note: </span></td></tr>
<tr><td style="padding: 0; " colspan="100%">
<sup></sup> MSQ values based on conditional calculations (n = 500 complete cases).<br>                                Simulation based thresholds from 400 simulated datasets.</td></tr>
</tfoot>
</table>
</div>
</div>
</div>
<div id="tabset-3-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-3-tab">
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb62"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://pgmj.github.io/easyRasch/reference/RIpcmPCA.html">RIpcmPCA</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table data-quarto-disable-processing="true" style="width:65%; font-size: 14px;  font-family: Arial; margin-left: auto; margin-right: auto;" class="table table-striped table-hover lightable-classic">
<thead><tr>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> Eigenvalues </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> Proportion of variance </th>
  </tr></thead>
<tbody>
<tr>
<td style="text-align:right;"> 1.52 </td>
   <td style="text-align:left;"> 18.9% </td>
  </tr>
<tr>
<td style="text-align:right;"> 1.33 </td>
   <td style="text-align:left;"> 17.1% </td>
  </tr>
<tr>
<td style="text-align:right;"> 1.19 </td>
   <td style="text-align:left;"> 16.6% </td>
  </tr>
<tr>
<td style="text-align:right;"> 1.15 </td>
   <td style="text-align:left;"> 14.6% </td>
  </tr>
<tr>
<td style="text-align:right;"> 1.00 </td>
   <td style="text-align:left;"> 13.1% </td>
  </tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="tabset-3-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-4-tab">
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb63"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">simcor2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://pgmj.github.io/easyRasch/reference/RIgetResidCor.html">RIgetResidCor</a></span><span class="op">(</span><span class="va">df</span>, iterations <span class="op">=</span> <span class="fl">400</span>, cpu <span class="op">=</span> <span class="fl">8</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://pgmj.github.io/easyRasch/reference/RIresidcorr.html">RIresidcorr</a></span><span class="op">(</span><span class="va">df</span>, cutoff <span class="op">=</span> <span class="va">simcor2</span><span class="op">$</span><span class="va">p99</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table data-quarto-disable-processing="true" style="width:65%; font-size: 14px;  font-family: Arial; margin-left: auto; margin-right: auto;border-bottom: 0;" class="table table-striped table-hover lightable-classic">
<thead><tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;">   </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> PANAS_11 </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> PANAS_12 </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> PANAS_13 </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> PANAS_14 </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> PANAS_16 </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> PANAS_17 </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> PANAS_19 </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> PANAS_20 </th>
  </tr></thead>
<tbody>
<tr>
<td style="text-align:left;"> PANAS_11 </td>
   <td style="text-align:left;">  </td>
   <td style="text-align:left;">  </td>
   <td style="text-align:left;">  </td>
   <td style="text-align:left;">  </td>
   <td style="text-align:left;">  </td>
   <td style="text-align:left;">  </td>
   <td style="text-align:left;">  </td>
   <td style="text-align:left;">  </td>
  </tr>
<tr>
<td style="text-align:left;"> PANAS_12 </td>
   <td style="text-align:left;"> <span style="     color: black !important;">-0.16</span> </td>
   <td style="text-align:left;">  </td>
   <td style="text-align:left;">  </td>
   <td style="text-align:left;">  </td>
   <td style="text-align:left;">  </td>
   <td style="text-align:left;">  </td>
   <td style="text-align:left;">  </td>
   <td style="text-align:left;">  </td>
  </tr>
<tr>
<td style="text-align:left;"> PANAS_13 </td>
   <td style="text-align:left;"> <span style="     color: black !important;">-0.11</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">-0.06</span> </td>
   <td style="text-align:left;">  </td>
   <td style="text-align:left;">  </td>
   <td style="text-align:left;">  </td>
   <td style="text-align:left;">  </td>
   <td style="text-align:left;">  </td>
   <td style="text-align:left;">  </td>
  </tr>
<tr>
<td style="text-align:left;"> PANAS_14 </td>
   <td style="text-align:left;"> <span style="     color: black !important;">-0.19</span> </td>
   <td style="text-align:left;"> <span style="     color: red !important;">0.03</span> </td>
   <td style="text-align:left;"> <span style="     color: red !important;">0.01</span> </td>
   <td style="text-align:left;">  </td>
   <td style="text-align:left;">  </td>
   <td style="text-align:left;">  </td>
   <td style="text-align:left;">  </td>
   <td style="text-align:left;">  </td>
  </tr>
<tr>
<td style="text-align:left;"> PANAS_16 </td>
   <td style="text-align:left;"> <span style="     color: black !important;">-0.16</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">-0.08</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">-0.25</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">-0.28</span> </td>
   <td style="text-align:left;">  </td>
   <td style="text-align:left;">  </td>
   <td style="text-align:left;">  </td>
   <td style="text-align:left;">  </td>
  </tr>
<tr>
<td style="text-align:left;"> PANAS_17 </td>
   <td style="text-align:left;"> <span style="     color: black !important;">-0.18</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">-0.06</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">-0.09</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">-0.19</span> </td>
   <td style="text-align:left;"> <span style="     color: red !important;">0</span> </td>
   <td style="text-align:left;">  </td>
   <td style="text-align:left;">  </td>
   <td style="text-align:left;">  </td>
  </tr>
<tr>
<td style="text-align:left;"> PANAS_19 </td>
   <td style="text-align:left;"> <span style="     color: black !important;">-0.15</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">-0.15</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">-0.28</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">-0.18</span> </td>
   <td style="text-align:left;"> <span style="     color: red !important;">0.12</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">-0.16</span> </td>
   <td style="text-align:left;">  </td>
   <td style="text-align:left;">  </td>
  </tr>
<tr>
<td style="text-align:left;"> PANAS_20 </td>
   <td style="text-align:left;"> <span style="     color: black !important;">-0.1</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">-0.27</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">-0.13</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">-0.11</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">-0.18</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">-0.15</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">-0.09</span> </td>
   <td style="text-align:left;">  </td>
  </tr>
</tbody>
<tfoot>
<tr><td style="padding: 0; " colspan="100%"><span style="font-style: italic;">Note: </span></td></tr>
<tr><td style="padding: 0; " colspan="100%">
<sup></sup> Relative cut-off value is -0.025, which is 0.104 above the average correlation (-0.129).<br>                                Correlations above the cut-off are highlighted in red text.</td></tr>
</tfoot>
</table>
</div>
</div>
</div>
<div id="tabset-3-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-5-tab">
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb64"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://pgmj.github.io/easyRasch/reference/RIloadLoc.html">RIloadLoc</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="RaschRvign_files/figure-html/unnamed-chunk-52-1.png" class="img-fluid figure-img" width="1050"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-3-6" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-6-tab">
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb65"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://pgmj.github.io/easyRasch/reference/RItargeting.html">RItargeting</a></span><span class="op">(</span><span class="va">df</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">4</span>,<span class="fl">4</span><span class="op">)</span>, bins <span class="op">=</span> <span class="fl">45</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="RaschRvign_files/figure-html/unnamed-chunk-53-1.png" class="img-fluid figure-img" width="1050"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-3-7" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-7-tab">
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb66"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://pgmj.github.io/easyRasch/reference/RIitemHierarchy.html">RIitemHierarchy</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="RaschRvign_files/figure-html/unnamed-chunk-54-1.png" class="img-fluid figure-img" width="1050"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
<section id="analysis-2-comments" class="level3" data-number="4.1"><h3 data-number="4.1" class="anchored" data-anchor-id="analysis-2-comments">
<span class="header-section-number">4.1</span> Analysis 2 comments</h3>
<p>Items 16 &amp; 19, and 12 &amp; 14 show problematic residual correlations.</p>
<p>Let’s look at DIF before taking action upon this information. <strong>While we are keeping DIF as a separate section in this vignette, it is recommended to include DIF-analysis in the <code>panel-tabset</code> above (on item fit, residual correlations, etc).</strong></p>
</section></section><section id="dif---differential-item-functioning" class="level2 page-columns page-full" data-number="5"><h2 data-number="5" class="anchored" data-anchor-id="dif---differential-item-functioning">
<span class="header-section-number">5</span> DIF - differential item functioning</h2>
<p>DIF is a complex topic, which is why it gets a separate section here. Even so, this vignette will just brush the surface. For an historical overview, which also includes recent developments, see Thissen <span class="citation" data-cites="thissen_review_2025">(<a href="#ref-thissen_review_2025" role="doc-biblioref">2025</a>)</span>.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>While we are keeping DIF as a separate section in this vignette, it is recommended to include DIF-analysis in the parallel analysis above (on item fit, targeting, residual correlations, etc) since DIF tests will help you understand or evaluate item functioning together with the other tests.</p>
</div>
</div>
<p>We’ll be looking at whether item (threshold) locations are stable between demographic subgroups. There are usually two key aspects to this analysis. One is whether we can detect DIF for one or more items. The other is the magnitude of DIF and how it affects the use of the overall test, if test scores are biased for any group. I recommend a paper by Chalmers et al. <span class="citation" data-cites="chalmers_it_2016">(<a href="#ref-chalmers_it_2016" role="doc-biblioref">2016</a>)</span> on the topic of DTF, differential test functioning.</p>
<p>There are several DIF analysis tools available. The first one uses the package <code>psychotree</code>, which relies on statistical significance at p &lt; .05 as an indicator for DIF. This is a criterion that is highly sample size sensitive, and we are always interested in the size/magnitude of DIF as well, since that will inform us about the impact of DIF on the estimated latent variable.</p>
<p>The structure of DIF is also important to assess, particularly for polytomous data. Uniform DIF means that the DIF is similar across the latent continuum. The <code><a href="https://pgmj.github.io/easyRasch/reference/RIciccPlot.html">RIciccPlot()</a></code> function can be used for DIF analysis and produces curves that show whether DIF is uniform or not. We can also test for uniformity formally in R using the <code>lordif</code> package, as demonstrated in <a href="#sec-lordif" class="quarto-xref">Section&nbsp;5.7</a>. However, it should be noted that the <code>lordif</code> package does not provide an option to use Rasch models, and there may be results that are caused by also allowing the discrimination parameter to vary across items.</p>
<p>A recent preprint <span class="citation" data-cites="henninger_partial_2024">(<a href="#ref-henninger_partial_2024" role="doc-biblioref">Henninger et al., 2024</a>)</span> does a great job illustrating “differential step functioning” (DSF), which is when item threshold locations in polytomous data show varying levels of DIF. It also describes a forthcoming development of the <code>psychotree</code> where one can use DIF effect size and purification functions to evaluate DIF/DSF. When the updated package is available, I will work to implement these new functions into the <code>easyRasch</code> package as well.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>It is important to ensure that no cells in the data are empty for subgroups when conducting a DIF analysis. Split the data using the DIF-variable and create separate tileplots to review the response distribution in the DIF-groups.</p>
</div>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb67"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://pgmj.github.io/easyRasch/reference/RIdifTileplot.html">RIdifTileplot</a></span><span class="op">(</span><span class="va">df</span>, <span class="va">dif</span><span class="op">$</span><span class="va">Sex</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="RaschRvign_files/figure-html/unnamed-chunk-55-1.png" class="img-fluid figure-img" width="1050"></p>
</figure>
</div>
</div>
</div>
<section id="sex" class="level3 page-columns page-full" data-number="5.1"><h3 data-number="5.1" class="anchored" data-anchor-id="sex">
<span class="header-section-number">5.1</span> Sex</h3>
<div class="cell page-columns page-full">

<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<table class="table table-striped" style="font-size: 13px; font-family: Lato">
<thead><tr>
<th style="text-align:center;">
itemnr
</th>
<th style="text-align:left;">
item
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:center;">
<span style="color: grey; font-weight: bold">PANAS_11</span>
</td>
<td style="text-align:left;">
Distressed
</td>
</tr>
<tr>
<td style="text-align:center;">
<span style="color: grey; font-weight: bold">PANAS_12</span>
</td>
<td style="text-align:left;">
Upset
</td>
</tr>
<tr>
<td style="text-align:center;">
<span style="color: grey; font-weight: bold">PANAS_13</span>
</td>
<td style="text-align:left;">
Hostile
</td>
</tr>
<tr>
<td style="text-align:center;">
<span style="color: grey; font-weight: bold">PANAS_14</span>
</td>
<td style="text-align:left;">
Irritable
</td>
</tr>
<tr>
<td style="text-align:center;">
<span style="color: grey; font-weight: bold">PANAS_16</span>
</td>
<td style="text-align:left;">
Afraid
</td>
</tr>
<tr>
<td style="text-align:center;">
<span style="color: grey; font-weight: bold">PANAS_17</span>
</td>
<td style="text-align:left;">
Ashamed
</td>
</tr>
<tr>
<td style="text-align:center;">
<span style="color: grey; font-weight: bold">PANAS_19</span>
</td>
<td style="text-align:left;">
Nervous
</td>
</tr>
<tr>
<td style="text-align:center;">
<span style="color: grey; font-weight: bold">PANAS_20</span>
</td>
<td style="text-align:left;">
Jittery
</td>
</tr>
</tbody>
</table>
</div></div></div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-4-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-1" role="tab" aria-controls="tabset-4-1" aria-selected="true">Table</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-2" role="tab" aria-controls="tabset-4-2" aria-selected="false">Figure items</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-3" role="tab" aria-controls="tabset-4-3" aria-selected="false">Figure thresholds</a></li>
</ul>
<div class="tab-content">
<div id="tabset-4-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-4-1-tab">
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb68"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://pgmj.github.io/easyRasch/reference/RIdifTable.html">RIdifTable</a></span><span class="op">(</span><span class="va">df</span>, <span class="va">dif</span><span class="op">$</span><span class="va">Sex</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="RaschRvign_files/figure-html/unnamed-chunk-57-1.png" class="img-fluid figure-img" width="1050"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<table class="table table-striped" style="font-size: 15px; font-family: Lato">
<thead><tr>
<th style="text-align:right;">
Item
</th>
<th style="text-align:right;">
2
</th>
<th style="text-align:right;">
3
</th>
<th style="text-align:right;">
Mean location
</th>
<th style="text-align:right;">
StDev
</th>
<th style="text-align:right;">
MaxDiff
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:right;">
PANAS_11
</td>
<td style="text-align:right;">
-0.314
</td>
<td style="text-align:right;">
-0.196
</td>
<td style="text-align:right;">
-0.255
</td>
<td style="text-align:right;">
0.083
</td>
<td style="text-align:right;">
<span style="color: black">0.117</span>
</td>
</tr>
<tr>
<td style="text-align:right;">
PANAS_12
</td>
<td style="text-align:right;">
0.028
</td>
<td style="text-align:right;">
-0.044
</td>
<td style="text-align:right;">
-0.008
</td>
<td style="text-align:right;">
0.051
</td>
<td style="text-align:right;">
<span style="color: black">0.073</span>
</td>
</tr>
<tr>
<td style="text-align:right;">
PANAS_13
</td>
<td style="text-align:right;">
0.553
</td>
<td style="text-align:right;">
0.402
</td>
<td style="text-align:right;">
0.478
</td>
<td style="text-align:right;">
0.107
</td>
<td style="text-align:right;">
<span style="color: black">0.151</span>
</td>
</tr>
<tr>
<td style="text-align:right;">
PANAS_14
</td>
<td style="text-align:right;">
-0.328
</td>
<td style="text-align:right;">
-0.183
</td>
<td style="text-align:right;">
-0.255
</td>
<td style="text-align:right;">
0.103
</td>
<td style="text-align:right;">
<span style="color: black">0.146</span>
</td>
</tr>
<tr>
<td style="text-align:right;">
PANAS_16
</td>
<td style="text-align:right;">
0.004
</td>
<td style="text-align:right;">
0.114
</td>
<td style="text-align:right;">
0.059
</td>
<td style="text-align:right;">
0.078
</td>
<td style="text-align:right;">
<span style="color: black">0.111</span>
</td>
</tr>
<tr>
<td style="text-align:right;">
PANAS_17
</td>
<td style="text-align:right;">
0.520
</td>
<td style="text-align:right;">
0.290
</td>
<td style="text-align:right;">
0.405
</td>
<td style="text-align:right;">
0.163
</td>
<td style="text-align:right;">
<span style="color: black">0.230</span>
</td>
</tr>
<tr>
<td style="text-align:right;">
PANAS_19
</td>
<td style="text-align:right;">
-0.495
</td>
<td style="text-align:right;">
-0.355
</td>
<td style="text-align:right;">
-0.425
</td>
<td style="text-align:right;">
0.099
</td>
<td style="text-align:right;">
<span style="color: black">0.140</span>
</td>
</tr>
<tr>
<td style="text-align:right;">
PANAS_20
</td>
<td style="text-align:right;">
0.032
</td>
<td style="text-align:right;">
-0.028
</td>
<td style="text-align:right;">
0.002
</td>
<td style="text-align:right;">
0.042
</td>
<td style="text-align:right;">
<span style="color: black">0.059</span>
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="tabset-4-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-2-tab">
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb69"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://pgmj.github.io/easyRasch/reference/RIdifFigure.html">RIdifFigure</a></span><span class="op">(</span><span class="va">df</span>, <span class="va">dif</span><span class="op">$</span><span class="va">Sex</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="RaschRvign_files/figure-html/unnamed-chunk-58-1.png" class="img-fluid figure-img" width="1050"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-4-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-3-tab">
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb70"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://pgmj.github.io/easyRasch/reference/RIdifFigThresh.html">RIdifFigThresh</a></span><span class="op">(</span><span class="va">df</span>, <span class="va">dif</span><span class="op">$</span><span class="va">Sex</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="RaschRvign_files/figure-html/unnamed-chunk-59-1.png" class="img-fluid figure-img" width="1050"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
<p>While no item shows problematic levels of DIF regarding item location, as shown by the table, there is an interesting pattern in the thresholds figure. The lowest threshold seems to be slightly lower for node 3 (Male) for all items. Also, item 11 shows a much wider spread of item locations for node 3 compared to node 2.</p>
<p>The results do not require any action since the difference is small.</p>
</section><section id="age" class="level3" data-number="5.2"><h3 data-number="5.2" class="anchored" data-anchor-id="age">
<span class="header-section-number">5.2</span> Age</h3>
<p>The <code>psychotree</code> package uses a model-based recursive partitioning that is particularly useful when you have a continuous variable such as age in years and a large enough sample. It will test different ways to partition the age variable to determine potential group differences <span class="citation" data-cites="strobl2015 strobl2021">(<a href="#ref-strobl2015" role="doc-biblioref">Strobl et al., 2015b</a>, <a href="#ref-strobl2021" role="doc-biblioref">2021</a>)</span>.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb71"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://pgmj.github.io/easyRasch/reference/RIdifTable.html">RIdifTable</a></span><span class="op">(</span><span class="va">df</span>, <span class="va">dif</span><span class="op">$</span><span class="va">Age</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "No statistically significant DIF found."</code></pre>
</div>
</div>
<p>No DIF found for age.</p>
</section><section id="group" class="level3" data-number="5.3"><h3 data-number="5.3" class="anchored" data-anchor-id="group">
<span class="header-section-number">5.3</span> Group</h3>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb73"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://pgmj.github.io/easyRasch/reference/RIdifTable.html">RIdifTable</a></span><span class="op">(</span><span class="va">df</span>, <span class="va">dif</span><span class="op">$</span><span class="va">Group</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "No statistically significant DIF found."</code></pre>
</div>
</div>
<p>And no DIF for group.</p>
</section><section id="sex-and-age" class="level3" data-number="5.4"><h3 data-number="5.4" class="anchored" data-anchor-id="sex-and-age">
<span class="header-section-number">5.4</span> Sex and age</h3>
<p>The <code>psychotree</code> package also allows for DIF interaction analysis with multiple DIF variables. We can use <code><a href="https://pgmj.github.io/easyRasch/reference/RIdifTable2.html">RIdifTable2()</a></code> to input two DIF variables.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb75"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://pgmj.github.io/easyRasch/reference/RIdifTable2.html">RIdifTable2</a></span><span class="op">(</span><span class="va">df</span>, <span class="va">dif</span><span class="op">$</span><span class="va">Sex</span>, <span class="va">dif</span><span class="op">$</span><span class="va">Age</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="RaschRvign_files/figure-html/unnamed-chunk-62-1.png" class="img-fluid figure-img" width="1050"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<table class="table table-striped" style="font-size: 15px; font-family: Lato">
<thead><tr>
<th style="text-align:right;">
Item
</th>
<th style="text-align:right;">
2
</th>
<th style="text-align:right;">
3
</th>
<th style="text-align:right;">
Mean location
</th>
<th style="text-align:right;">
StDev
</th>
<th style="text-align:right;">
MaxDiff
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:right;">
PANAS_11
</td>
<td style="text-align:right;">
-0.314
</td>
<td style="text-align:right;">
-0.196
</td>
<td style="text-align:right;">
-0.255
</td>
<td style="text-align:right;">
0.083
</td>
<td style="text-align:right;">
<span style="color: black">0.117</span>
</td>
</tr>
<tr>
<td style="text-align:right;">
PANAS_12
</td>
<td style="text-align:right;">
0.028
</td>
<td style="text-align:right;">
-0.044
</td>
<td style="text-align:right;">
-0.008
</td>
<td style="text-align:right;">
0.051
</td>
<td style="text-align:right;">
<span style="color: black">0.073</span>
</td>
</tr>
<tr>
<td style="text-align:right;">
PANAS_13
</td>
<td style="text-align:right;">
0.553
</td>
<td style="text-align:right;">
0.402
</td>
<td style="text-align:right;">
0.478
</td>
<td style="text-align:right;">
0.107
</td>
<td style="text-align:right;">
<span style="color: black">0.151</span>
</td>
</tr>
<tr>
<td style="text-align:right;">
PANAS_14
</td>
<td style="text-align:right;">
-0.328
</td>
<td style="text-align:right;">
-0.183
</td>
<td style="text-align:right;">
-0.255
</td>
<td style="text-align:right;">
0.103
</td>
<td style="text-align:right;">
<span style="color: black">0.146</span>
</td>
</tr>
<tr>
<td style="text-align:right;">
PANAS_16
</td>
<td style="text-align:right;">
0.004
</td>
<td style="text-align:right;">
0.114
</td>
<td style="text-align:right;">
0.059
</td>
<td style="text-align:right;">
0.078
</td>
<td style="text-align:right;">
<span style="color: black">0.111</span>
</td>
</tr>
<tr>
<td style="text-align:right;">
PANAS_17
</td>
<td style="text-align:right;">
0.520
</td>
<td style="text-align:right;">
0.290
</td>
<td style="text-align:right;">
0.405
</td>
<td style="text-align:right;">
0.163
</td>
<td style="text-align:right;">
<span style="color: black">0.230</span>
</td>
</tr>
<tr>
<td style="text-align:right;">
PANAS_19
</td>
<td style="text-align:right;">
-0.495
</td>
<td style="text-align:right;">
-0.355
</td>
<td style="text-align:right;">
-0.425
</td>
<td style="text-align:right;">
0.099
</td>
<td style="text-align:right;">
<span style="color: black">0.140</span>
</td>
</tr>
<tr>
<td style="text-align:right;">
PANAS_20
</td>
<td style="text-align:right;">
0.032
</td>
<td style="text-align:right;">
-0.028
</td>
<td style="text-align:right;">
0.002
</td>
<td style="text-align:right;">
0.042
</td>
<td style="text-align:right;">
<span style="color: black">0.059</span>
</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>No interaction effect found for sex and age. The analysis only shows the previously identified DIF for sex.</p>
</section><section id="sec-diflrt" class="level3 page-columns page-full" data-number="5.5"><h3 data-number="5.5" class="anchored" data-anchor-id="sec-diflrt">
<span class="header-section-number">5.5</span> LRT-based DIF</h3>
<p>We’ll use the group variable as an example. It’s always important to review the response distribution across DIF groups prior to running the DIF analysis. We need to make sure that there are responses in all cells in all subgroups.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb76"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://pgmj.github.io/easyRasch/reference/RIdifTileplot.html">RIdifTileplot</a></span><span class="op">(</span><span class="va">df</span>, <span class="va">dif</span><span class="op">$</span><span class="va">Group</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="RaschRvign_files/figure-html/unnamed-chunk-63-1.png" class="img-fluid figure-img" width="1050"></p>
</figure>
</div>
</div>
</div>
<p>First, we can simply run the test to get the overall result.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb77"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">erm.out</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/eRm/man/PCM.html">PCM</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/eRm/man/LRtest.html">LRtest</a></span><span class="op">(</span><span class="va">erm.out</span>, splitcr <span class="op">=</span> <span class="va">dif</span><span class="op">$</span><span class="va">Group</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
Andersen LR-test: 
LR-value: 46.864 
Chi-square df: 31 
p-value:  0.034 </code></pre>
</div>
</div>
<p>Review the documentation for further details, using <code><a href="https://rdrr.io/pkg/eRm/man/LRtest.html">?LRtest</a></code> in your R console panel in Rstudio. There is also a plotting function, <code><a href="https://rdrr.io/pkg/eRm/man/LRtest.html">plotGOF()</a></code> that may be of interest.</p>
<div class="cell page-columns page-full">

<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<table class="table table-striped" style="font-size: 13px; font-family: Lato">
<thead><tr>
<th style="text-align:center;">
itemnr
</th>
<th style="text-align:left;">
item
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:center;">
<span style="color: grey; font-weight: bold">PANAS_11</span>
</td>
<td style="text-align:left;">
Distressed
</td>
</tr>
<tr>
<td style="text-align:center;">
<span style="color: grey; font-weight: bold">PANAS_12</span>
</td>
<td style="text-align:left;">
Upset
</td>
</tr>
<tr>
<td style="text-align:center;">
<span style="color: grey; font-weight: bold">PANAS_13</span>
</td>
<td style="text-align:left;">
Hostile
</td>
</tr>
<tr>
<td style="text-align:center;">
<span style="color: grey; font-weight: bold">PANAS_14</span>
</td>
<td style="text-align:left;">
Irritable
</td>
</tr>
<tr>
<td style="text-align:center;">
<span style="color: grey; font-weight: bold">PANAS_16</span>
</td>
<td style="text-align:left;">
Afraid
</td>
</tr>
<tr>
<td style="text-align:center;">
<span style="color: grey; font-weight: bold">PANAS_17</span>
</td>
<td style="text-align:left;">
Ashamed
</td>
</tr>
<tr>
<td style="text-align:center;">
<span style="color: grey; font-weight: bold">PANAS_19</span>
</td>
<td style="text-align:left;">
Nervous
</td>
</tr>
<tr>
<td style="text-align:center;">
<span style="color: grey; font-weight: bold">PANAS_20</span>
</td>
<td style="text-align:left;">
Jittery
</td>
</tr>
</tbody>
</table>
</div></div></div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-5-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-1" role="tab" aria-controls="tabset-5-1" aria-selected="true">Item location table</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-2" role="tab" aria-controls="tabset-5-2" aria-selected="false">Item location figure</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-3" role="tab" aria-controls="tabset-5-3" aria-selected="false">Item threshold table</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-4" role="tab" aria-controls="tabset-5-4" aria-selected="false">Item threshold figure</a></li>
</ul>
<div class="tab-content">
<div id="tabset-5-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-5-1-tab">
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb79"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://pgmj.github.io/easyRasch/reference/RIdifTableLR.html">RIdifTableLR</a></span><span class="op">(</span><span class="va">df</span>, <span class="va">dif</span><span class="op">$</span><span class="va">Group</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table data-quarto-disable-processing="true" style="width:65%; font-size: 14px;  font-family: Arial; margin-left: auto; margin-right: auto;border-bottom: 0;" class="table table-striped table-hover lightable-classic">
<thead>
<tr>
<th style="empty-cells: hide;" colspan="1"></th>
<th style="padding-bottom:0; padding-left:5px;padding-right:5px;text-align: center; font-weight: bold; " colspan="4"><div style="border-bottom: 1px solid #111111; margin-bottom: -1px; ">Item locations</div></th>
<th style="padding-bottom:0; padding-left:5px;padding-right:5px;text-align: center; font-weight: bold; " colspan="3"><div style="border-bottom: 1px solid #111111; margin-bottom: -1px; ">Standard errors</div></th>
</tr>
<tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> Item </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> Earlier Start </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> Later Start </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> MaxDiff </th>
   <th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> All </th>
   <th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> SE_Earlier Start </th>
   <th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> SE_Later Start </th>
   <th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> SE_All </th>
  </tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;"> PANAS_11 </td>
   <td style="text-align:left;"> <span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: burlywood !important;">0.069</span> </td>
   <td style="text-align:left;"> <span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: lightblue !important;">0.072</span> </td>
   <td style="text-align:left;font-weight: bold;"> <span style="     color: black !important;">0.003</span> </td>
   <td style="text-align:right;font-style: italic;"> 0.073 </td>
   <td style="text-align:right;"> 0.140 </td>
   <td style="text-align:right;"> 0.124 </td>
   <td style="text-align:right;font-style: italic;"> 0.093 </td>
  </tr>
<tr>
<td style="text-align:left;"> PANAS_12 </td>
   <td style="text-align:left;"> <span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: burlywood !important;">0.33</span> </td>
   <td style="text-align:left;"> <span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: lightblue !important;">0.346</span> </td>
   <td style="text-align:left;font-weight: bold;"> <span style="     color: black !important;">0.016</span> </td>
   <td style="text-align:right;font-style: italic;"> 0.342 </td>
   <td style="text-align:right;"> 0.155 </td>
   <td style="text-align:right;"> 0.133 </td>
   <td style="text-align:right;font-style: italic;"> 0.101 </td>
  </tr>
<tr>
<td style="text-align:left;"> PANAS_13 </td>
   <td style="text-align:left;"> <span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: burlywood !important;">0.69</span> </td>
   <td style="text-align:left;"> <span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: lightblue !important;">0.966</span> </td>
   <td style="text-align:left;font-weight: bold;"> <span style="     color: black !important;">0.276</span> </td>
   <td style="text-align:right;font-style: italic;"> 0.826 </td>
   <td style="text-align:right;"> 0.185 </td>
   <td style="text-align:right;"> 0.189 </td>
   <td style="text-align:right;font-style: italic;"> 0.129 </td>
  </tr>
<tr>
<td style="text-align:left;"> PANAS_14 </td>
   <td style="text-align:left;"> <span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: lightblue !important;">0.118</span> </td>
   <td style="text-align:left;"> <span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: burlywood !important;">0.054</span> </td>
   <td style="text-align:left;font-weight: bold;"> <span style="     color: black !important;">0.064</span> </td>
   <td style="text-align:right;font-style: italic;"> 0.084 </td>
   <td style="text-align:right;"> 0.142 </td>
   <td style="text-align:right;"> 0.121 </td>
   <td style="text-align:right;font-style: italic;"> 0.092 </td>
  </tr>
<tr>
<td style="text-align:left;"> PANAS_16 </td>
   <td style="text-align:left;"> <span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: lightblue !important;">0.447</span> </td>
   <td style="text-align:left;"> <span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: burlywood !important;">0.362</span> </td>
   <td style="text-align:left;font-weight: bold;"> <span style="     color: black !important;">0.085</span> </td>
   <td style="text-align:right;font-style: italic;"> 0.401 </td>
   <td style="text-align:right;"> 0.160 </td>
   <td style="text-align:right;"> 0.134 </td>
   <td style="text-align:right;font-style: italic;"> 0.102 </td>
  </tr>
<tr>
<td style="text-align:left;"> PANAS_17 </td>
   <td style="text-align:left;"> <span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: burlywood !important;">0.66</span> </td>
   <td style="text-align:left;"> <span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: lightblue !important;">0.822</span> </td>
   <td style="text-align:left;font-weight: bold;"> <span style="     color: black !important;">0.162</span> </td>
   <td style="text-align:right;font-style: italic;"> 0.751 </td>
   <td style="text-align:right;"> 0.184 </td>
   <td style="text-align:right;"> 0.172 </td>
   <td style="text-align:right;font-style: italic;"> 0.125 </td>
  </tr>
<tr>
<td style="text-align:left;"> PANAS_19 </td>
   <td style="text-align:left;"> <span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: lightblue !important;">-0.028</span> </td>
   <td style="text-align:left;"> <span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: burlywood !important;">-0.122</span> </td>
   <td style="text-align:left;font-weight: bold;"> <span style="     color: black !important;">0.094</span> </td>
   <td style="text-align:right;font-style: italic;"> -0.083 </td>
   <td style="text-align:right;"> 0.136 </td>
   <td style="text-align:right;"> 0.117 </td>
   <td style="text-align:right;font-style: italic;"> 0.088 </td>
  </tr>
<tr>
<td style="text-align:left;"> PANAS_20 </td>
   <td style="text-align:left;"> <span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: lightblue !important;">0.351</span> </td>
   <td style="text-align:left;"> <span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: burlywood !important;">0.348</span> </td>
   <td style="text-align:left;font-weight: bold;"> <span style="     color: black !important;">0.003</span> </td>
   <td style="text-align:right;font-style: italic;"> 0.352 </td>
   <td style="text-align:right;"> 0.160 </td>
   <td style="text-align:right;"> 0.138 </td>
   <td style="text-align:right;font-style: italic;"> 0.104 </td>
  </tr>
</tbody>
<tfoot>
<tr><td style="padding: 0; " colspan="100%"><span style="font-style: italic;">Note: </span></td></tr>
<tr><td style="padding: 0; " colspan="100%">
<sup></sup> Values highlighted in red are above the chosen cutoff 0.5 logits. Background color brown and blue indicate the lowest and highest values among the DIF groups.</td></tr>
</tfoot>
</table>
</div>
</div>
</div>
<div id="tabset-5-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-2-tab">
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb80"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://pgmj.github.io/easyRasch/reference/RIdifFigureLR.html">RIdifFigureLR</a></span><span class="op">(</span><span class="va">df</span>, <span class="va">dif</span><span class="op">$</span><span class="va">Group</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://pgmj.github.io/easyRasch/reference/theme_rise.html">theme_rise</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="RaschRvign_files/figure-html/unnamed-chunk-67-1.png" class="img-fluid figure-img" width="1050"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-5-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-3-tab">
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb81"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://pgmj.github.io/easyRasch/reference/RIdifThreshTblLR.html">RIdifThreshTblLR</a></span><span class="op">(</span><span class="va">df</span>, <span class="va">dif</span><span class="op">$</span><span class="va">Group</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table data-quarto-disable-processing="true" style="width:65%; font-size: 14px;  font-family: Arial; margin-left: auto; margin-right: auto;border-bottom: 0;" class="table table-striped table-hover lightable-classic">
<thead>
<tr>
<th style="empty-cells: hide;" colspan="1"></th>
<th style="padding-bottom:0; padding-left:5px;padding-right:5px;text-align: center; font-weight: bold; " colspan="4"><div style="border-bottom: 1px solid #111111; margin-bottom: -1px; ">Threshold locations</div></th>
<th style="padding-bottom:0; padding-left:5px;padding-right:5px;text-align: center; font-weight: bold; " colspan="3"><div style="border-bottom: 1px solid #111111; margin-bottom: -1px; ">Standard errors</div></th>
</tr>
<tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> Item threshold </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> Earlier Start </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> Later Start </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> MaxDiff </th>
   <th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> All </th>
   <th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> SE_Earlier Start </th>
   <th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> SE_Later Start </th>
   <th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> SE_All </th>
  </tr>
</thead>
<tbody>
<tr grouplength="4"><td colspan="8" style="border-bottom: 0;"><strong>PANAS_11</strong></td></tr>
<tr>
<td style="text-align:left;padding-left: 2em;font-weight: bold;" indentlevel="1"> c1 </td>
   <td style="text-align:left;"> <span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: burlywood !important;">-1.245</span> </td>
   <td style="text-align:left;"> <span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: lightblue !important;">-1.241</span> </td>
   <td style="text-align:left;font-weight: bold;"> <span style="     color: black !important;">0.004</span> </td>
   <td style="text-align:right;font-style: italic;"> -1.240 </td>
   <td style="text-align:right;"> 0.098 </td>
   <td style="text-align:right;"> 0.094 </td>
   <td style="text-align:right;font-style: italic;"> 0.068 </td>
  </tr>
<tr>
<td style="text-align:left;padding-left: 2em;font-weight: bold;" indentlevel="1"> c2 </td>
   <td style="text-align:left;"> <span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: burlywood !important;">-0.365</span> </td>
   <td style="text-align:left;"> <span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: lightblue !important;">-0.221</span> </td>
   <td style="text-align:left;font-weight: bold;"> <span style="     color: black !important;">0.144</span> </td>
   <td style="text-align:right;font-style: italic;"> -0.284 </td>
   <td style="text-align:right;"> 0.107 </td>
   <td style="text-align:right;"> 0.100 </td>
   <td style="text-align:right;font-style: italic;"> 0.073 </td>
  </tr>
<tr>
<td style="text-align:left;padding-left: 2em;font-weight: bold;" indentlevel="1"> c3 </td>
   <td style="text-align:left;"> <span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: lightblue !important;">0.281</span> </td>
   <td style="text-align:left;"> <span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: burlywood !important;">0.096</span> </td>
   <td style="text-align:left;font-weight: bold;"> <span style="     color: black !important;">0.185</span> </td>
   <td style="text-align:right;font-style: italic;"> 0.180 </td>
   <td style="text-align:right;"> 0.131 </td>
   <td style="text-align:right;"> 0.114 </td>
   <td style="text-align:right;font-style: italic;"> 0.086 </td>
  </tr>
<tr>
<td style="text-align:left;padding-left: 2em;font-weight: bold;" indentlevel="1"> c4 </td>
   <td style="text-align:left;"> <span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: burlywood !important;">1.604</span> </td>
   <td style="text-align:left;"> <span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: lightblue !important;">1.655</span> </td>
   <td style="text-align:left;font-weight: bold;"> <span style="     color: black !important;">0.051</span> </td>
   <td style="text-align:right;font-style: italic;"> 1.637 </td>
   <td style="text-align:right;"> 0.224 </td>
   <td style="text-align:right;"> 0.188 </td>
   <td style="text-align:right;font-style: italic;"> 0.144 </td>
  </tr>
<tr grouplength="4"><td colspan="8" style="border-bottom: 0;"><strong>PANAS_12</strong></td></tr>
<tr>
<td style="text-align:left;padding-left: 2em;font-weight: bold;" indentlevel="1"> c1 </td>
   <td style="text-align:left;"> <span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: burlywood !important;">-0.484</span> </td>
   <td style="text-align:left;"> <span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: lightblue !important;">-0.362</span> </td>
   <td style="text-align:left;font-weight: bold;"> <span style="     color: black !important;">0.122</span> </td>
   <td style="text-align:right;font-style: italic;"> -0.418 </td>
   <td style="text-align:right;"> 0.092 </td>
   <td style="text-align:right;"> 0.091 </td>
   <td style="text-align:right;font-style: italic;"> 0.065 </td>
  </tr>
<tr>
<td style="text-align:left;padding-left: 2em;font-weight: bold;" indentlevel="1"> c2 </td>
   <td style="text-align:left;"> <span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: lightblue !important;">0.241</span> </td>
   <td style="text-align:left;"> <span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: burlywood !important;">-0.198</span> </td>
   <td style="text-align:left;font-weight: bold;"> <span style="     color: black !important;">0.439</span> </td>
   <td style="text-align:right;font-style: italic;"> -0.005 </td>
   <td style="text-align:right;"> 0.126 </td>
   <td style="text-align:right;"> 0.108 </td>
   <td style="text-align:right;font-style: italic;"> 0.082 </td>
  </tr>
<tr>
<td style="text-align:left;padding-left: 2em;font-weight: bold;" indentlevel="1"> c3 </td>
   <td style="text-align:left;"> <span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: lightblue !important;">0.479</span> </td>
   <td style="text-align:left;"> <span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: burlywood !important;">0.456</span> </td>
   <td style="text-align:left;font-weight: bold;"> <span style="     color: black !important;">0.023</span> </td>
   <td style="text-align:right;font-style: italic;"> 0.467 </td>
   <td style="text-align:right;"> 0.169 </td>
   <td style="text-align:right;"> 0.129 </td>
   <td style="text-align:right;font-style: italic;"> 0.103 </td>
  </tr>
<tr>
<td style="text-align:left;padding-left: 2em;font-weight: bold;" indentlevel="1"> c4 </td>
   <td style="text-align:left;"> <span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: burlywood !important;">1.086</span> </td>
   <td style="text-align:left;"> <span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: lightblue !important;">1.489</span> </td>
   <td style="text-align:left;font-weight: bold;"> <span style="     color: black !important;">0.403</span> </td>
   <td style="text-align:right;font-style: italic;"> 1.323 </td>
   <td style="text-align:right;"> 0.233 </td>
   <td style="text-align:right;"> 0.205 </td>
   <td style="text-align:right;font-style: italic;"> 0.153 </td>
  </tr>
<tr grouplength="4"><td colspan="8" style="border-bottom: 0;"><strong>PANAS_13</strong></td></tr>
<tr>
<td style="text-align:left;padding-left: 2em;font-weight: bold;" indentlevel="1"> c1 </td>
   <td style="text-align:left;"> <span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: burlywood !important;">-0.067</span> </td>
   <td style="text-align:left;"> <span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: lightblue !important;">0.23</span> </td>
   <td style="text-align:left;font-weight: bold;"> <span style="     color: black !important;">0.297</span> </td>
   <td style="text-align:right;font-style: italic;"> 0.093 </td>
   <td style="text-align:right;"> 0.092 </td>
   <td style="text-align:right;"> 0.089 </td>
   <td style="text-align:right;font-style: italic;"> 0.064 </td>
  </tr>
<tr>
<td style="text-align:left;padding-left: 2em;font-weight: bold;" indentlevel="1"> c2 </td>
   <td style="text-align:left;"> <span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: lightblue !important;">0.403</span> </td>
   <td style="text-align:left;"> <span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: burlywood !important;">0.115</span> </td>
   <td style="text-align:left;font-weight: bold;"> <span style="     color: black !important;">0.288</span> </td>
   <td style="text-align:right;font-style: italic;"> 0.248 </td>
   <td style="text-align:right;"> 0.135 </td>
   <td style="text-align:right;"> 0.118 </td>
   <td style="text-align:right;font-style: italic;"> 0.088 </td>
  </tr>
<tr>
<td style="text-align:left;padding-left: 2em;font-weight: bold;" indentlevel="1"> c3 </td>
   <td style="text-align:left;"> <span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: burlywood !important;">0.889</span> </td>
   <td style="text-align:left;"> <span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: lightblue !important;">1.042</span> </td>
   <td style="text-align:left;font-weight: bold;"> <span style="     color: black !important;">0.153</span> </td>
   <td style="text-align:right;font-style: italic;"> 0.983 </td>
   <td style="text-align:right;"> 0.197 </td>
   <td style="text-align:right;"> 0.164 </td>
   <td style="text-align:right;font-style: italic;"> 0.126 </td>
  </tr>
<tr>
<td style="text-align:left;padding-left: 2em;font-weight: bold;" indentlevel="1"> c4 </td>
   <td style="text-align:left;"> <span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: burlywood !important;">1.536</span> </td>
   <td style="text-align:left;"> <span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: lightblue !important;">2.476</span> </td>
   <td style="text-align:left;font-weight: bold;"> <span style="     color: red !important;">0.94</span> </td>
   <td style="text-align:right;font-style: italic;"> 1.979 </td>
   <td style="text-align:right;"> 0.316 </td>
   <td style="text-align:right;"> 0.384 </td>
   <td style="text-align:right;font-style: italic;"> 0.239 </td>
  </tr>
<tr grouplength="4"><td colspan="8" style="border-bottom: 0;"><strong>PANAS_14</strong></td></tr>
<tr>
<td style="text-align:left;padding-left: 2em;font-weight: bold;" indentlevel="1"> c1 </td>
   <td style="text-align:left;"> <span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: burlywood !important;">-1.017</span> </td>
   <td style="text-align:left;"> <span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: lightblue !important;">-0.972</span> </td>
   <td style="text-align:left;font-weight: bold;"> <span style="     color: black !important;">0.045</span> </td>
   <td style="text-align:right;font-style: italic;"> -0.990 </td>
   <td style="text-align:right;"> 0.095 </td>
   <td style="text-align:right;"> 0.094 </td>
   <td style="text-align:right;font-style: italic;"> 0.066 </td>
  </tr>
<tr>
<td style="text-align:left;padding-left: 2em;font-weight: bold;" indentlevel="1"> c2 </td>
   <td style="text-align:left;"> <span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: lightblue !important;">-0.134</span> </td>
   <td style="text-align:left;"> <span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: burlywood !important;">-0.272</span> </td>
   <td style="text-align:left;font-weight: bold;"> <span style="     color: black !important;">0.138</span> </td>
   <td style="text-align:right;font-style: italic;"> -0.205 </td>
   <td style="text-align:right;"> 0.111 </td>
   <td style="text-align:right;"> 0.103 </td>
   <td style="text-align:right;font-style: italic;"> 0.076 </td>
  </tr>
<tr>
<td style="text-align:left;padding-left: 2em;font-weight: bold;" indentlevel="1"> c3 </td>
   <td style="text-align:left;"> <span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: lightblue !important;">0.456</span> </td>
   <td style="text-align:left;"> <span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: burlywood !important;">0.095</span> </td>
   <td style="text-align:left;font-weight: bold;"> <span style="     color: black !important;">0.361</span> </td>
   <td style="text-align:right;font-style: italic;"> 0.239 </td>
   <td style="text-align:right;"> 0.146 </td>
   <td style="text-align:right;"> 0.116 </td>
   <td style="text-align:right;font-style: italic;"> 0.091 </td>
  </tr>
<tr>
<td style="text-align:left;padding-left: 2em;font-weight: bold;" indentlevel="1"> c4 </td>
   <td style="text-align:left;"> <span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: burlywood !important;">1.168</span> </td>
   <td style="text-align:left;"> <span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: lightblue !important;">1.366</span> </td>
   <td style="text-align:left;font-weight: bold;"> <span style="     color: black !important;">0.198</span> </td>
   <td style="text-align:right;font-style: italic;"> 1.294 </td>
   <td style="text-align:right;"> 0.216 </td>
   <td style="text-align:right;"> 0.173 </td>
   <td style="text-align:right;font-style: italic;"> 0.135 </td>
  </tr>
<tr grouplength="4"><td colspan="8" style="border-bottom: 0;"><strong>PANAS_16</strong></td></tr>
<tr>
<td style="text-align:left;padding-left: 2em;font-weight: bold;" indentlevel="1"> c1 </td>
   <td style="text-align:left;"> <span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: lightblue !important;">-0.156</span> </td>
   <td style="text-align:left;"> <span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: burlywood !important;">-0.25</span> </td>
   <td style="text-align:left;font-weight: bold;"> <span style="     color: black !important;">0.094</span> </td>
   <td style="text-align:right;font-style: italic;"> -0.202 </td>
   <td style="text-align:right;"> 0.097 </td>
   <td style="text-align:right;"> 0.091 </td>
   <td style="text-align:right;font-style: italic;"> 0.066 </td>
  </tr>
<tr>
<td style="text-align:left;padding-left: 2em;font-weight: bold;" indentlevel="1"> c2 </td>
   <td style="text-align:left;"> <span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: lightblue !important;">0.009</span> </td>
   <td style="text-align:left;"> <span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: burlywood !important;">-0.091</span> </td>
   <td style="text-align:left;font-weight: bold;"> <span style="     color: black !important;">0.1</span> </td>
   <td style="text-align:right;font-style: italic;"> -0.046 </td>
   <td style="text-align:right;"> 0.130 </td>
   <td style="text-align:right;"> 0.112 </td>
   <td style="text-align:right;font-style: italic;"> 0.085 </td>
  </tr>
<tr>
<td style="text-align:left;padding-left: 2em;font-weight: bold;" indentlevel="1"> c3 </td>
   <td style="text-align:left;"> <span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: burlywood !important;">0.324</span> </td>
   <td style="text-align:left;"> <span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: lightblue !important;">0.354</span> </td>
   <td style="text-align:left;font-weight: bold;"> <span style="     color: black !important;">0.03</span> </td>
   <td style="text-align:right;font-style: italic;"> 0.344 </td>
   <td style="text-align:right;"> 0.159 </td>
   <td style="text-align:right;"> 0.132 </td>
   <td style="text-align:right;font-style: italic;"> 0.102 </td>
  </tr>
<tr>
<td style="text-align:left;padding-left: 2em;font-weight: bold;" indentlevel="1"> c4 </td>
   <td style="text-align:left;"> <span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: lightblue !important;">1.611</span> </td>
   <td style="text-align:left;"> <span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: burlywood !important;">1.435</span> </td>
   <td style="text-align:left;font-weight: bold;"> <span style="     color: black !important;">0.176</span> </td>
   <td style="text-align:right;font-style: italic;"> 1.508 </td>
   <td style="text-align:right;"> 0.253 </td>
   <td style="text-align:right;"> 0.201 </td>
   <td style="text-align:right;font-style: italic;"> 0.157 </td>
  </tr>
<tr grouplength="4"><td colspan="8" style="border-bottom: 0;"><strong>PANAS_17</strong></td></tr>
<tr>
<td style="text-align:left;padding-left: 2em;font-weight: bold;" indentlevel="1"> c1 </td>
   <td style="text-align:left;"> <span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: burlywood !important;">0.264</span> </td>
   <td style="text-align:left;"> <span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: lightblue !important;">0.368</span> </td>
   <td style="text-align:left;font-weight: bold;"> <span style="     color: black !important;">0.104</span> </td>
   <td style="text-align:right;font-style: italic;"> 0.324 </td>
   <td style="text-align:right;"> 0.097 </td>
   <td style="text-align:right;"> 0.089 </td>
   <td style="text-align:right;font-style: italic;"> 0.066 </td>
  </tr>
<tr>
<td style="text-align:left;padding-left: 2em;font-weight: bold;" indentlevel="1"> c2 </td>
   <td style="text-align:left;"> <span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: burlywood !important;">0.389</span> </td>
   <td style="text-align:left;"> <span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: lightblue !important;">0.421</span> </td>
   <td style="text-align:left;font-weight: bold;"> <span style="     color: black !important;">0.032</span> </td>
   <td style="text-align:right;font-style: italic;"> 0.412 </td>
   <td style="text-align:right;"> 0.146 </td>
   <td style="text-align:right;"> 0.128 </td>
   <td style="text-align:right;font-style: italic;"> 0.096 </td>
  </tr>
<tr>
<td style="text-align:left;padding-left: 2em;font-weight: bold;" indentlevel="1"> c3 </td>
   <td style="text-align:left;"> <span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: burlywood !important;">0.804</span> </td>
   <td style="text-align:left;"> <span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: lightblue !important;">0.955</span> </td>
   <td style="text-align:left;font-weight: bold;"> <span style="     color: black !important;">0.151</span> </td>
   <td style="text-align:right;font-style: italic;"> 0.894 </td>
   <td style="text-align:right;"> 0.205 </td>
   <td style="text-align:right;"> 0.181 </td>
   <td style="text-align:right;font-style: italic;"> 0.136 </td>
  </tr>
<tr>
<td style="text-align:left;padding-left: 2em;font-weight: bold;" indentlevel="1"> c4 </td>
   <td style="text-align:left;"> <span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: burlywood !important;">1.182</span> </td>
   <td style="text-align:left;"> <span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: lightblue !important;">1.545</span> </td>
   <td style="text-align:left;font-weight: bold;"> <span style="     color: black !important;">0.363</span> </td>
   <td style="text-align:right;font-style: italic;"> 1.373 </td>
   <td style="text-align:right;"> 0.288 </td>
   <td style="text-align:right;"> 0.290 </td>
   <td style="text-align:right;font-style: italic;"> 0.204 </td>
  </tr>
<tr grouplength="4"><td colspan="8" style="border-bottom: 0;"><strong>PANAS_19</strong></td></tr>
<tr>
<td style="text-align:left;padding-left: 2em;font-weight: bold;" indentlevel="1"> c1 </td>
   <td style="text-align:left;"> <span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: burlywood !important;">-1.339</span> </td>
   <td style="text-align:left;"> <span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: lightblue !important;">-1.263</span> </td>
   <td style="text-align:left;font-weight: bold;"> <span style="     color: black !important;">0.076</span> </td>
   <td style="text-align:right;font-style: italic;"> -1.297 </td>
   <td style="text-align:right;"> 0.100 </td>
   <td style="text-align:right;"> 0.098 </td>
   <td style="text-align:right;font-style: italic;"> 0.070 </td>
  </tr>
<tr>
<td style="text-align:left;padding-left: 2em;font-weight: bold;" indentlevel="1"> c2 </td>
   <td style="text-align:left;"> <span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: burlywood !important;">-0.388</span> </td>
   <td style="text-align:left;"> <span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: lightblue !important;">-0.27</span> </td>
   <td style="text-align:left;font-weight: bold;"> <span style="     color: black !important;">0.118</span> </td>
   <td style="text-align:right;font-style: italic;"> -0.323 </td>
   <td style="text-align:right;"> 0.108 </td>
   <td style="text-align:right;"> 0.105 </td>
   <td style="text-align:right;font-style: italic;"> 0.075 </td>
  </tr>
<tr>
<td style="text-align:left;padding-left: 2em;font-weight: bold;" indentlevel="1"> c3 </td>
   <td style="text-align:left;"> <span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: lightblue !important;">0.101</span> </td>
   <td style="text-align:left;"> <span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: burlywood !important;">-0.333</span> </td>
   <td style="text-align:left;font-weight: bold;"> <span style="     color: black !important;">0.434</span> </td>
   <td style="text-align:right;font-style: italic;"> -0.143 </td>
   <td style="text-align:right;"> 0.127 </td>
   <td style="text-align:right;"> 0.111 </td>
   <td style="text-align:right;font-style: italic;"> 0.083 </td>
  </tr>
<tr>
<td style="text-align:left;padding-left: 2em;font-weight: bold;" indentlevel="1"> c4 </td>
   <td style="text-align:left;"> <span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: lightblue !important;">1.512</span> </td>
   <td style="text-align:left;"> <span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: burlywood !important;">1.378</span> </td>
   <td style="text-align:left;font-weight: bold;"> <span style="     color: black !important;">0.134</span> </td>
   <td style="text-align:right;font-style: italic;"> 1.430 </td>
   <td style="text-align:right;"> 0.207 </td>
   <td style="text-align:right;"> 0.156 </td>
   <td style="text-align:right;font-style: italic;"> 0.125 </td>
  </tr>
<tr grouplength="4"><td colspan="8" style="border-bottom: 0;"><strong>PANAS_20</strong></td></tr>
<tr>
<td style="text-align:left;padding-left: 2em;font-weight: bold;" indentlevel="1"> c1 </td>
   <td style="text-align:left;"> <span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: burlywood !important;">-0.906</span> </td>
   <td style="text-align:left;"> <span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: lightblue !important;">-0.877</span> </td>
   <td style="text-align:left;font-weight: bold;"> <span style="     color: black !important;">0.029</span> </td>
   <td style="text-align:right;font-style: italic;"> -0.887 </td>
   <td style="text-align:right;"> 0.093 </td>
   <td style="text-align:right;"> 0.090 </td>
   <td style="text-align:right;font-style: italic;"> 0.065 </td>
  </tr>
<tr>
<td style="text-align:left;padding-left: 2em;font-weight: bold;" indentlevel="1"> c2 </td>
   <td style="text-align:left;"> <span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: lightblue !important;">-0.189</span> </td>
   <td style="text-align:left;"> <span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: burlywood !important;">-0.257</span> </td>
   <td style="text-align:left;font-weight: bold;"> <span style="     color: black !important;">0.068</span> </td>
   <td style="text-align:right;font-style: italic;"> -0.223 </td>
   <td style="text-align:right;"> 0.108 </td>
   <td style="text-align:right;"> 0.099 </td>
   <td style="text-align:right;font-style: italic;"> 0.073 </td>
  </tr>
<tr>
<td style="text-align:left;padding-left: 2em;font-weight: bold;" indentlevel="1"> c3 </td>
   <td style="text-align:left;"> <span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: lightblue !important;">1.037</span> </td>
   <td style="text-align:left;"> <span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: burlywood !important;">0.585</span> </td>
   <td style="text-align:left;font-weight: bold;"> <span style="     color: black !important;">0.452</span> </td>
   <td style="text-align:right;font-style: italic;"> 0.760 </td>
   <td style="text-align:right;"> 0.162 </td>
   <td style="text-align:right;"> 0.123 </td>
   <td style="text-align:right;font-style: italic;"> 0.098 </td>
  </tr>
<tr>
<td style="text-align:left;padding-left: 2em;font-weight: bold;" indentlevel="1"> c4 </td>
   <td style="text-align:left;"> <span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: burlywood !important;">1.463</span> </td>
   <td style="text-align:left;"> <span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: lightblue !important;">1.941</span> </td>
   <td style="text-align:left;font-weight: bold;"> <span style="     color: black !important;">0.478</span> </td>
   <td style="text-align:right;font-style: italic;"> 1.756 </td>
   <td style="text-align:right;"> 0.277 </td>
   <td style="text-align:right;"> 0.238 </td>
   <td style="text-align:right;font-style: italic;"> 0.180 </td>
  </tr>
</tbody>
<tfoot>
<tr><td style="padding: 0; " colspan="100%"><span style="font-style: italic;">Note: </span></td></tr>
<tr><td style="padding: 0; " colspan="100%">
<sup></sup> Values highlighted in red are above the chosen cutoff 0.5 logits. Background color brown and blue indicate the lowest and highest values among the DIF groups.</td></tr>
</tfoot>
</table>
</div>
</div>
</div>
<div id="tabset-5-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-4-tab">
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb82"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://pgmj.github.io/easyRasch/reference/RIdifThreshFigLR.html">RIdifThreshFigLR</a></span><span class="op">(</span><span class="va">df</span>, <span class="va">dif</span><span class="op">$</span><span class="va">Group</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://pgmj.github.io/easyRasch/reference/theme_rise.html">theme_rise</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="RaschRvign_files/figure-html/unnamed-chunk-69-1.png" class="img-fluid figure-img" width="1050"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
<p>The item threshold table shows that the top threshold for item 13 differs more than 0.5 logits between groups. In this set of 8 items with 4 thresholds each, it is unlikely to result in problematic differences in estimated person scores.</p>
</section><section id="conditional-icc" class="level3" data-number="5.6"><h3 data-number="5.6" class="anchored" data-anchor-id="conditional-icc">
<span class="header-section-number">5.6</span> Conditional ICC</h3>
<p>The <code>iarm</code> package function for CICC plots also includes the option to use a DIF variable. This gives us information about DIF across the latent continuum when class intervals are created based on latent score groups. If your analysis contains two groups and the lines for the groups cross each other, DIF is non-uniform.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb83"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://pgmj.github.io/easyRasch/reference/RIciccPlot.html">RIciccPlot</a></span><span class="op">(</span><span class="va">df</span>, dif <span class="op">=</span> <span class="st">"yes"</span>, dif_var <span class="op">=</span> <span class="va">dif</span><span class="op">$</span><span class="va">Sex</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="RaschRvign_files/figure-html/unnamed-chunk-70-1.png" class="img-fluid figure-img" width="1050"></p>
</figure>
</div>
</div>
</div>
</section><section id="sec-lordif" class="level3" data-number="5.7"><h3 data-number="5.7" class="anchored" data-anchor-id="sec-lordif">
<span class="header-section-number">5.7</span> Logistic Ordinal Regression DIF</h3>
<p>The <code>lordif</code> package <span class="citation" data-cites="choi_lordif_2011">(<a href="#ref-choi_lordif_2011" role="doc-biblioref">Choi et al., 2011b</a>)</span> does not use a Rasch measurement model, it only offers a choice between the Graded Response Model (GRM) and the Generalized Partial Credit Model (GPCM). Both of these are 2PL models, meaning that they estimate a discrimination parameter for each item in addition to the item threshold parameters. <code>lordif</code> relies on the <code>mirt</code> package.</p>
<p>There are several nice features available in the <code>lordif</code> package. First, we get a χ2 test of uniform or non-uniform DIF. Second, there are three possible methods/criteria for flagging items with potential DIF. One of these uses a likelihood ratio (LR) χ2 test, while the other two are indicators of DIF size/magnitude, either using a pseudo R2 statistic (“McFadden”, “Nagelkerke”, or “CoxSnell”) or a Beta criterion. For further details, see <code><a href="https://rdrr.io/pkg/lordif/man/lordif.html">?lordif</a></code> in your R console or the paper describing the package <span class="citation" data-cites="choi_lordif_2011">(<a href="#ref-choi_lordif_2011" role="doc-biblioref">Choi et al., 2011b</a>)</span>.</p>
<p>Below is some sample code to get you started with <code>lordif</code>.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb84"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">lordif</span><span class="op">)</span></span>
<span></span>
<span><span class="va">g_dif</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lordif/man/lordif.html">lordif</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">dif</span><span class="op">$</span><span class="va">Sex</span><span class="op">)</span>, <span class="co"># make sure that the data is in a dataframe-object and that the DIF variable is numeric</span></span>
<span>                criterion <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Chisqr"</span><span class="op">)</span>, </span>
<span>                alpha <span class="op">=</span> <span class="fl">0.01</span>, </span>
<span>                beta.change <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>                model <span class="op">=</span> <span class="st">"GPCM"</span>,</span>
<span>                R2.change <span class="op">=</span> <span class="fl">0.02</span><span class="op">)</span></span>
<span></span>
<span><span class="va">g_dif_sum</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">g_dif</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb85"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># threshold values for colorizing the table below</span></span>
<span><span class="va">alpha</span> <span class="op">=</span> <span class="fl">0.01</span></span>
<span><span class="va">beta.change</span> <span class="op">=</span> <span class="fl">0.1</span></span>
<span><span class="va">R2.change</span> <span class="op">=</span> <span class="fl">0.02</span></span>
<span></span>
<span><span class="va">g_dif_sum</span><span class="op">$</span><span class="va">stats</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/all_of.html">all_of</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"item"</span>,<span class="st">"df12"</span>,<span class="st">"df13"</span>,<span class="st">"df23"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://tibble.tidyverse.org/reference/add_column.html">add_column</a></span><span class="op">(</span>itemnr <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span>, .before <span class="op">=</span> <span class="st">"ncat"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html">across</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">chi12</span>,<span class="va">chi13</span>,<span class="va">chi23</span><span class="op">)</span>, <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/cell_spec.html">cell_spec</a></span><span class="op">(</span><span class="va">.x</span>,</span>
<span>                               color <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html">case_when</a></span><span class="op">(</span></span>
<span>                                 <span class="va">.x</span> <span class="op">&lt;</span> <span class="va">alpha</span> <span class="op">~</span> <span class="st">"red"</span>,</span>
<span>                                 <span class="cn">TRUE</span> <span class="op">~</span> <span class="st">"black"</span></span>
<span>                               <span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html">across</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html">starts_with</a></span><span class="op">(</span><span class="st">"pseudo"</span><span class="op">)</span>, <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/cell_spec.html">cell_spec</a></span><span class="op">(</span><span class="va">.x</span>,</span>
<span>                               color <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html">case_when</a></span><span class="op">(</span></span>
<span>                                 <span class="va">.x</span> <span class="op">&gt;</span> <span class="va">R2.change</span> <span class="op">~</span> <span class="st">"red"</span>,</span>
<span>                                 <span class="cn">TRUE</span> <span class="op">~</span> <span class="st">"black"</span></span>
<span>                               <span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>beta12 <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/cell_spec.html">cell_spec</a></span><span class="op">(</span><span class="va">beta12</span>,</span>
<span>                               color <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html">case_when</a></span><span class="op">(</span></span>
<span>                                 <span class="va">beta12</span> <span class="op">&gt;</span> <span class="va">beta.change</span> <span class="op">~</span> <span class="st">"red"</span>,</span>
<span>                                 <span class="cn">TRUE</span> <span class="op">~</span> <span class="st">"black"</span></span>
<span>                               <span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://pgmj.github.io/easyRasch/reference/kbl_rise.html">kbl_rise</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table data-quarto-disable-processing="true" style="width:65%; font-size: 14px;  font-family: Arial; margin-left: auto; margin-right: auto;" class="table table-striped table-hover lightable-classic">
<thead><tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> itemnr </th>
   <th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> ncat </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> chi12 </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> chi13 </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> chi23 </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> beta12 </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> pseudo12.McFadden </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> pseudo13.McFadden </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> pseudo23.McFadden </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> pseudo12.Nagelkerke </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> pseudo13.Nagelkerke </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> pseudo23.Nagelkerke </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> pseudo12.CoxSnell </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> pseudo13.CoxSnell </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> pseudo23.CoxSnell </th>
  </tr></thead>
<tbody>
<tr>
<td style="text-align:left;"> PANAS_11 </td>
   <td style="text-align:right;"> 5 </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0.323</span> </td>
   <td style="text-align:left;"> <span style="     color: red !important;">0</span> </td>
   <td style="text-align:left;"> <span style="     color: red !important;">0</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0.002</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0.004</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0.003</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0.005</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0.005</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0.005</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0.005</span> </td>
  </tr>
<tr>
<td style="text-align:left;"> PANAS_12 </td>
   <td style="text-align:right;"> 5 </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0.013</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0.019</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0.192</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0.008</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0.001</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0.002</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0.001</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0.002</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0.001</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0.002</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0</span> </td>
  </tr>
<tr>
<td style="text-align:left;"> PANAS_13 </td>
   <td style="text-align:right;"> 5 </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0.106</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0.057</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0.077</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0.007</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0.001</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0.001</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0.001</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0.001</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0.002</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0.001</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0.001</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0.002</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0.001</span> </td>
  </tr>
<tr>
<td style="text-align:left;"> PANAS_14 </td>
   <td style="text-align:right;"> 5 </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0.182</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0.401</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0.83</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0.002</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0</span> </td>
  </tr>
<tr>
<td style="text-align:left;"> PANAS_16 </td>
   <td style="text-align:right;"> 5 </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0.64</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0.17</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0.068</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0.001</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0.001</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0.001</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0.001</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0.001</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0.001</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0.001</span> </td>
  </tr>
<tr>
<td style="text-align:left;"> PANAS_17 </td>
   <td style="text-align:right;"> 5 </td>
   <td style="text-align:left;"> <span style="     color: red !important;">0</span> </td>
   <td style="text-align:left;"> <span style="     color: red !important;">0</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0.32</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0.032</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0.008</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0.008</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0.011</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0.011</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0.01</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0.01</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0</span> </td>
  </tr>
<tr>
<td style="text-align:left;"> PANAS_19 </td>
   <td style="text-align:right;"> 5 </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0.178</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0.25</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0.33</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0.002</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0.001</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0.001</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0</span> </td>
  </tr>
<tr>
<td style="text-align:left;"> PANAS_20 </td>
   <td style="text-align:right;"> 5 </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0.68</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0.349</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0.164</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0.001</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0.001</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0.001</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0.001</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0.001</span> </td>
  </tr>
</tbody>
</table>
</div>
</div>
<p>We can review the results regarding uniform/non-uniform DIF by looking at the <code>chi*</code> columns. Uniform DIF is indicated by column <code>chi12</code> and non-uniform DIF by <code>chi23</code>, while column <code>chi13</code> represents “an overall test of”total DIF effect” <span class="citation" data-cites="choi_lordif_2011">(<a href="#ref-choi_lordif_2011" role="doc-biblioref">Choi et al., 2011b</a>)</span>.</p>
<p>While the table indicates significant chi2-tests for items 11 and 17, the magnitude estimates are low for these items.</p>
<p>There are some plots available as well, using the base R <code><a href="https://rdrr.io/r/graphics/plot.default.html">plot()</a></code> function. For some reason the plots won’t render in this Quarto document, so I will try to sort that out at some point.</p>
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb86"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">g_dif</span><span class="op">)</span> <span class="co"># use option `graphics.off()` to get the plots rendered one by one</span></span>
<span><span class="co">#plot(g_dif, graphics.off())</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell quarto-layout-panel" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="RaschRvign_files/figure-html/unnamed-chunk-73-1.png" class="img-fluid" width="1050"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="RaschRvign_files/figure-html/unnamed-chunk-73-2.png" class="img-fluid" width="1050"></p>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="RaschRvign_files/figure-html/unnamed-chunk-73-3.png" class="img-fluid" width="1050"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="RaschRvign_files/figure-html/unnamed-chunk-73-4.png" class="img-fluid" width="1050"></p>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="RaschRvign_files/figure-html/unnamed-chunk-73-5.png" class="img-fluid" width="1050"></p>
</div>
</div>
</div>
</section><section id="partial-gamma-dif" class="level3" data-number="5.8"><h3 data-number="5.8" class="anchored" data-anchor-id="partial-gamma-dif">
<span class="header-section-number">5.8</span> Partial gamma DIF</h3>
<p>The <code>iarm</code> package provides a function to assess DIF by partial gamma <span class="citation" data-cites="bjorner_differential_1998">(<a href="#ref-bjorner_differential_1998" role="doc-biblioref">Bjorner et al., 1998</a>)</span>. It should be noted that this function only shows a single partial gamma value per item, so if you have more than two groups in your comparison, you will want to also use other methods to understand your results better.</p>
<p>There are some recommended cutoff-values mentioned in the paper above:</p>
<p>No or negligible DIF:</p>
<ul>
<li>Gamma within the interval -0.21 to 0.21, <em>or</em>
</li>
<li>Gamma not significantly different from 0</li>
</ul>
<p>Slight to moderate DIF:</p>
<ul>
<li>Gamma within the interval -0.31 to 0.31 (and outside -0.21 to 0.21), <em>or</em>
</li>
<li>not significantly outside the interval -0.21 to 0.21</li>
</ul>
<p>Moderate to large DIF:</p>
<ul>
<li>Gamma outside the interval -0.31 to 0.31, <strong>and</strong>
</li>
<li>significantly outside the interval -0.21 to 0.21</li>
</ul>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb87"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://pgmj.github.io/easyRasch/reference/RIpartgamDIF.html">RIpartgamDIF</a></span><span class="op">(</span><span class="va">df</span>, <span class="va">dif</span><span class="op">$</span><span class="va">Sex</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table data-quarto-disable-processing="true" style="width:65%; font-size: 14px;  font-family: Arial; margin-left: auto; margin-right: auto;" class="table table-striped table-hover lightable-classic">
<thead><tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> Item </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> Partial gamma </th>
   <th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> SE </th>
   <th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> Lower CI </th>
   <th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> Upper CI </th>
   <th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> Adjusted p-value (BH) </th>
  </tr></thead>
<tbody><tr>
<td style="text-align:left;"> PANAS_17 </td>
   <td style="text-align:left;"> <span style="     color: red !important;">0.234</span> </td>
   <td style="text-align:right;"> 0.054 </td>
   <td style="text-align:right;"> 0.127 </td>
   <td style="text-align:right;"> 0.341 </td>
   <td style="text-align:right;"> 0 </td>
  </tr></tbody>
</table>
</div>
</div>
<p>We can see “slight” DIF for item 17, with a statistically significant gamma of .23.</p>
</section></section><section id="rasch-analysis-3" class="level2 page-columns page-full" data-number="6"><h2 data-number="6" class="anchored" data-anchor-id="rasch-analysis-3">
<span class="header-section-number">6</span> Rasch analysis 3</h2>
<p>While there were no significant issues with DIF for any item/subgroup combination, we need to address the previously identified problem:</p>
<ul>
<li>Items 16 and 19 have the largest residual correlation.</li>
</ul>
<p>We’ll remove item 19 since item 16 has better targeting.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb88"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">removed.items</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">removed.items</span>,<span class="st">"PANAS_19"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="va">df_backup</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/all_of.html">any_of</a></span><span class="op">(</span><span class="va">removed.items</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">df500</span> <span class="op">&lt;-</span> <span class="va">df500_backup</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/all_of.html">any_of</a></span><span class="op">(</span><span class="va">removed.items</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell page-columns page-full">

<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<table class="table table-striped" style="font-size: 13px; font-family: Lato">
<thead><tr>
<th style="text-align:center;">
itemnr
</th>
<th style="text-align:left;">
item
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:center;">
<span style="color: grey; font-weight: bold">PANAS_11</span>
</td>
<td style="text-align:left;">
Distressed
</td>
</tr>
<tr>
<td style="text-align:center;">
<span style="color: grey; font-weight: bold">PANAS_12</span>
</td>
<td style="text-align:left;">
Upset
</td>
</tr>
<tr>
<td style="text-align:center;">
<span style="color: grey; font-weight: bold">PANAS_13</span>
</td>
<td style="text-align:left;">
Hostile
</td>
</tr>
<tr>
<td style="text-align:center;">
<span style="color: grey; font-weight: bold">PANAS_14</span>
</td>
<td style="text-align:left;">
Irritable
</td>
</tr>
<tr>
<td style="text-align:center;">
<span style="color: grey; font-weight: bold">PANAS_16</span>
</td>
<td style="text-align:left;">
Afraid
</td>
</tr>
<tr>
<td style="text-align:center;">
<span style="color: grey; font-weight: bold">PANAS_17</span>
</td>
<td style="text-align:left;">
Ashamed
</td>
</tr>
<tr>
<td style="text-align:center;">
<span style="color: grey; font-weight: bold">PANAS_20</span>
</td>
<td style="text-align:left;">
Jittery
</td>
</tr>
</tbody>
</table>
</div></div></div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-6-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-1" role="tab" aria-controls="tabset-6-1" aria-selected="true">Item-restscore bootstrap</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-2" role="tab" aria-controls="tabset-6-2" aria-selected="false">Item fit</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-3" role="tab" aria-controls="tabset-6-3" aria-selected="false">CICC</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-4" role="tab" aria-controls="tabset-6-4" aria-selected="false">Residual correlations</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-5" role="tab" aria-controls="tabset-6-5" aria-selected="false">LRT</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-6-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-6" role="tab" aria-controls="tabset-6-6" aria-selected="false">Targeting</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-7-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-7" role="tab" aria-controls="tabset-6-7" aria-selected="false">Item hierarchy</a></li>
</ul>
<div class="tab-content">
<div id="tabset-6-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-6-1-tab">
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb89"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://pgmj.github.io/easyRasch/reference/RIbootRestscore.html">RIbootRestscore</a></span><span class="op">(</span><span class="va">df</span>, iterations <span class="op">=</span> <span class="fl">250</span>, samplesize <span class="op">=</span> <span class="fl">800</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table data-quarto-disable-processing="true" style="width:65%; font-size: 14px;  font-family: Arial; margin-left: auto; margin-right: auto;border-bottom: 0;" class="table table-striped table-hover lightable-classic">
<thead><tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> Item </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> Item-restscore result </th>
   <th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> % of iterations </th>
   <th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> Conditional MSQ infit </th>
   <th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> Relative average item location </th>
  </tr></thead>
<tbody>
<tr>
<td style="text-align:left;"> PANAS_20 </td>
   <td style="text-align:left;"> underfit </td>
   <td style="text-align:right;"> 47.2 </td>
   <td style="text-align:right;"> 1.16 </td>
   <td style="text-align:right;"> 1.35 </td>
  </tr>
<tr>
<td style="text-align:left;"> PANAS_11 </td>
   <td style="text-align:left;"> underfit </td>
   <td style="text-align:right;"> 12.4 </td>
   <td style="text-align:right;"> 1.13 </td>
   <td style="text-align:right;"> 1.07 </td>
  </tr>
<tr>
<td style="text-align:left;"> PANAS_12 </td>
   <td style="text-align:left;"> overfit </td>
   <td style="text-align:right;"> 99.6 </td>
   <td style="text-align:right;"> 0.78 </td>
   <td style="text-align:right;"> 1.34 </td>
  </tr>
<tr>
<td style="text-align:left;"> PANAS_16 </td>
   <td style="text-align:left;"> overfit </td>
   <td style="text-align:right;"> 8.0 </td>
   <td style="text-align:right;"> 0.94 </td>
   <td style="text-align:right;"> 1.40 </td>
  </tr>
<tr>
<td style="text-align:left;"> PANAS_17 </td>
   <td style="text-align:left;"> overfit </td>
   <td style="text-align:right;"> 8.0 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 1.74 </td>
  </tr>
</tbody>
<tfoot>
<tr><td style="padding: 0; " colspan="100%"><span style="font-style: italic;">Note: </span></td></tr>
<tr><td style="padding: 0; " colspan="100%">
<sup></sup> Results based on 250 bootstrap iterations with n = 800 and 7 items. Conditional mean-square infit based on complete responders only (n = 1851).</td></tr>
</tfoot>
</table>
</div>
</div>
</div>
<div id="tabset-6-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-2-tab">
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb90"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">simfit3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://pgmj.github.io/easyRasch/reference/RIgetfit.html">RIgetfit</a></span><span class="op">(</span><span class="va">df500</span>, iterations <span class="op">=</span> <span class="fl">200</span>, cpu <span class="op">=</span> <span class="fl">8</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://pgmj.github.io/easyRasch/reference/RIitemfit.html">RIitemfit</a></span><span class="op">(</span><span class="va">df500</span>, <span class="va">simfit3</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table data-quarto-disable-processing="true" style="width:65%; font-size: 14px;  font-family: Arial; margin-left: auto; margin-right: auto;border-bottom: 0;" class="table table-striped table-hover lightable-classic">
<thead><tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> Item </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> InfitMSQ </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> Infit thresholds </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> Infit diff </th>
   <th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> Relative location </th>
  </tr></thead>
<tbody>
<tr>
<td style="text-align:left;"> PANAS_11 </td>
   <td style="text-align:left;"> <span style="     color: black !important;">1.126</span> </td>
   <td style="text-align:left;"> [0.84, 1.147] </td>
   <td style="text-align:left;"> no misfit </td>
   <td style="text-align:right;"> 1.02 </td>
  </tr>
<tr>
<td style="text-align:left;"> PANAS_12 </td>
   <td style="text-align:left;"> <span style="     color: red !important;">0.737</span> </td>
   <td style="text-align:left;"> [0.859, 1.167] </td>
   <td style="text-align:left;"> 0.122 </td>
   <td style="text-align:right;"> 1.22 </td>
  </tr>
<tr>
<td style="text-align:left;"> PANAS_13 </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0.908</span> </td>
   <td style="text-align:left;"> [0.854, 1.167] </td>
   <td style="text-align:left;"> no misfit </td>
   <td style="text-align:right;"> 1.68 </td>
  </tr>
<tr>
<td style="text-align:left;"> PANAS_14 </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0.913</span> </td>
   <td style="text-align:left;"> [0.879, 1.145] </td>
   <td style="text-align:left;"> no misfit </td>
   <td style="text-align:right;"> 0.94 </td>
  </tr>
<tr>
<td style="text-align:left;"> PANAS_16 </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0.918</span> </td>
   <td style="text-align:left;"> [0.814, 1.162] </td>
   <td style="text-align:left;"> no misfit </td>
   <td style="text-align:right;"> 1.53 </td>
  </tr>
<tr>
<td style="text-align:left;"> PANAS_17 </td>
   <td style="text-align:left;"> <span style="     color: black !important;">1.155</span> </td>
   <td style="text-align:left;"> [0.8, 1.167] </td>
   <td style="text-align:left;"> no misfit </td>
   <td style="text-align:right;"> 1.66 </td>
  </tr>
<tr>
<td style="text-align:left;"> PANAS_20 </td>
   <td style="text-align:left;"> <span style="     color: red !important;">1.242</span> </td>
   <td style="text-align:left;"> [0.874, 1.241] </td>
   <td style="text-align:left;"> 0.001 </td>
   <td style="text-align:right;"> 1.30 </td>
  </tr>
</tbody>
<tfoot>
<tr><td style="padding: 0; " colspan="100%"><span style="font-style: italic;">Note: </span></td></tr>
<tr><td style="padding: 0; " colspan="100%">
<sup></sup> MSQ values based on conditional calculations (n = 500 complete cases).<br>                                Simulation based thresholds from 200 simulated datasets.</td></tr>
</tfoot>
</table>
</div>
</div>
</div>
<div id="tabset-6-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-3-tab">
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb91"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://pgmj.github.io/easyRasch/reference/RIciccPlot.html">RIciccPlot</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="RaschRvign_files/figure-html/unnamed-chunk-79-1.png" class="img-fluid figure-img" width="1050"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-6-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-4-tab">
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb92"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">simcor3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://pgmj.github.io/easyRasch/reference/RIgetResidCor.html">RIgetResidCor</a></span><span class="op">(</span><span class="va">df</span>, iterations <span class="op">=</span> <span class="fl">400</span>, cpu <span class="op">=</span> <span class="fl">8</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://pgmj.github.io/easyRasch/reference/RIresidcorr.html">RIresidcorr</a></span><span class="op">(</span><span class="va">df</span>, cutoff <span class="op">=</span> <span class="va">simcor3</span><span class="op">$</span><span class="va">p99</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table data-quarto-disable-processing="true" style="width:65%; font-size: 14px;  font-family: Arial; margin-left: auto; margin-right: auto;border-bottom: 0;" class="table table-striped table-hover lightable-classic">
<thead><tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;">   </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> PANAS_11 </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> PANAS_12 </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> PANAS_13 </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> PANAS_14 </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> PANAS_16 </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> PANAS_17 </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> PANAS_20 </th>
  </tr></thead>
<tbody>
<tr>
<td style="text-align:left;"> PANAS_11 </td>
   <td style="text-align:left;">  </td>
   <td style="text-align:left;">  </td>
   <td style="text-align:left;">  </td>
   <td style="text-align:left;">  </td>
   <td style="text-align:left;">  </td>
   <td style="text-align:left;">  </td>
   <td style="text-align:left;">  </td>
  </tr>
<tr>
<td style="text-align:left;"> PANAS_12 </td>
   <td style="text-align:left;"> <span style="     color: black !important;">-0.18</span> </td>
   <td style="text-align:left;">  </td>
   <td style="text-align:left;">  </td>
   <td style="text-align:left;">  </td>
   <td style="text-align:left;">  </td>
   <td style="text-align:left;">  </td>
   <td style="text-align:left;">  </td>
  </tr>
<tr>
<td style="text-align:left;"> PANAS_13 </td>
   <td style="text-align:left;"> <span style="     color: black !important;">-0.15</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">-0.11</span> </td>
   <td style="text-align:left;">  </td>
   <td style="text-align:left;">  </td>
   <td style="text-align:left;">  </td>
   <td style="text-align:left;">  </td>
   <td style="text-align:left;">  </td>
  </tr>
<tr>
<td style="text-align:left;"> PANAS_14 </td>
   <td style="text-align:left;"> <span style="     color: black !important;">-0.22</span> </td>
   <td style="text-align:left;"> <span style="     color: red !important;">0.01</span> </td>
   <td style="text-align:left;"> <span style="     color: red !important;">-0.04</span> </td>
   <td style="text-align:left;">  </td>
   <td style="text-align:left;">  </td>
   <td style="text-align:left;">  </td>
   <td style="text-align:left;">  </td>
  </tr>
<tr>
<td style="text-align:left;"> PANAS_16 </td>
   <td style="text-align:left;"> <span style="     color: black !important;">-0.14</span> </td>
   <td style="text-align:left;"> <span style="     color: red !important;">-0.06</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">-0.26</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">-0.26</span> </td>
   <td style="text-align:left;">  </td>
   <td style="text-align:left;">  </td>
   <td style="text-align:left;">  </td>
  </tr>
<tr>
<td style="text-align:left;"> PANAS_17 </td>
   <td style="text-align:left;"> <span style="     color: black !important;">-0.2</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">-0.09</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">-0.14</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">-0.22</span> </td>
   <td style="text-align:left;"> <span style="     color: red !important;">0</span> </td>
   <td style="text-align:left;">  </td>
   <td style="text-align:left;">  </td>
  </tr>
<tr>
<td style="text-align:left;"> PANAS_20 </td>
   <td style="text-align:left;"> <span style="     color: black !important;">-0.12</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">-0.29</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">-0.16</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">-0.13</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">-0.15</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">-0.17</span> </td>
   <td style="text-align:left;">  </td>
  </tr>
</tbody>
<tfoot>
<tr><td style="padding: 0; " colspan="100%"><span style="font-style: italic;">Note: </span></td></tr>
<tr><td style="padding: 0; " colspan="100%">
<sup></sup> Relative cut-off value is -0.064, which is 0.083 above the average correlation (-0.147).<br>                                Correlations above the cut-off are highlighted in red text.</td></tr>
</tfoot>
</table>
</div>
</div>
</div>
<div id="tabset-6-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-5-tab">
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb93"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://pgmj.github.io/easyRasch/reference/RIbootLRT.html">RIbootLRT</a></span><span class="op">(</span><span class="va">df</span>, iterations <span class="op">=</span> <span class="fl">1000</span>, samplesize <span class="op">=</span> <span class="fl">400</span>, cpu <span class="op">=</span> <span class="fl">8</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<thead><tr class="header">
<th style="text-align: left;">Result</th>
<th style="text-align: right;">n</th>
<th style="text-align: right;">Percent</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Not statistically significant</td>
<td style="text-align: right;">84</td>
<td style="text-align: right;">8.4</td>
</tr>
<tr class="even">
<td style="text-align: left;">Statistically significant</td>
<td style="text-align: right;">916</td>
<td style="text-align: right;">91.6</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="tabset-6-6" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-6-tab">
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb94"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://pgmj.github.io/easyRasch/reference/RItargeting.html">RItargeting</a></span><span class="op">(</span><span class="va">df</span>, bins <span class="op">=</span> <span class="fl">45</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="RaschRvign_files/figure-html/unnamed-chunk-82-1.png" class="img-fluid figure-img" width="1050"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-6-7" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-7-tab">
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb95"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://pgmj.github.io/easyRasch/reference/RIitemHierarchy.html">RIitemHierarchy</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="RaschRvign_files/figure-html/unnamed-chunk-83-1.png" class="img-fluid figure-img" width="1050"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
<section id="analysis-3-comments" class="level3" data-number="6.1"><h3 data-number="6.1" class="anchored" data-anchor-id="analysis-3-comments">
<span class="header-section-number">6.1</span> Analysis 3 comments</h3>
<p>There are still problematic residual correlations and some items show misfit (most notably item 12 being overfit), but we will end this sample analysis here and move on to show other functions.</p>
<p>There are several item thresholds that are very closely located, as shown in the item hierarchy figure. This is not ideal, since it will inflate reliability estimates. However, we will not modify the response categories for this analysis, we only note that this is not workable and should be dealt with by trying variations of merged response categories to achieve better separation of threshold locations without disordering.</p>
</section></section><section id="reliability" class="level2" data-number="7"><h2 data-number="7" class="anchored" data-anchor-id="reliability">
<span class="header-section-number">7</span> Reliability</h2>
<p>Reliability (or measurement uncertainty) is often reported as a point estimate only, which implies constant reliability across the latent variable. This does not reflect the targeting aspect and the limitations of reliability often found at the lower and upper regions of the latent continuum. One way to try to better describe the varying reliability is by using the Test Information Function (TIF), which is a curve. I have previously advocated for reporting the TIF curve, but have also found some unexpected results when using it. When I finally sat down to figure out the issues with TIF, I found a paper showing that it behaves quite erratically, especially with fewer than six or so items <span class="citation" data-cites="milanzi_reliability_2015">(<a href="#ref-milanzi_reliability_2015" role="doc-biblioref">Milanzi et al., 2015</a>)</span>. While the <code><a href="https://pgmj.github.io/easyRasch/reference/RItif.html">RItif()</a></code> function remains, I recommend careful use of it, or perhaps not using it at all.</p>
<p>The most commonly used reliability metric in Rasch analysis is the PSI, person separation index. It is however important to note that the PSI excludes extreme values (min/max scores), which explains why it is sometimes quite different from other metrics. The reason for excluding participants is that extreme scores cannot be estimated, they need to be imputed/interpolated along with their corresponding measurement error, which is what is used in the PSI metric.</p>
<section id="rmu-relative-measurement-uncertainty" class="level3" data-number="7.1"><h3 data-number="7.1" class="anchored" data-anchor-id="rmu-relative-measurement-uncertainty">
<span class="header-section-number">7.1</span> RMU — Relative Measurement Uncertainty</h3>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb96"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">rel</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://pgmj.github.io/easyRasch/reference/RIreliability.html">RIreliability</a></span><span class="op">(</span><span class="va">df</span>, draws <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></span>
<span><span class="va">rel</span><span class="op">$</span><span class="va">PSI</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>Separation Reliability: 0.7028</code></pre>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb98"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">rel</span><span class="op">$</span><span class="va">RMU</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "WLE-RMU = 0.806 (95% HDCI [0.792, 0.819]) (1000 draws) using package mirt and 50 RMU iterations."</code></pre>
</div>
</div>
<p>The new (since <code>easyRasch</code> 0.4.0) function <code><a href="https://pgmj.github.io/easyRasch/reference/RIreliability.html">RIreliability()</a></code> will produce several estimates of reliability. The potentially most useful metric is a new one, based on a recent preprint <span class="citation" data-cites="bignardi_general_2025">(<a href="#ref-bignardi_general_2025" role="doc-biblioref">Bignardi et al., 2025</a>)</span> which describes a general reliability metric that includes uncertainty around the point estimate, called <em>RMU, “Relative Measurement Uncertainty”</em>. Bignardi and colleagues use Bayesian estimation and posterior draws of each respondents latent scores (thetas/locations) to determine the mean and 95% highest density continuous interval (HDCI) of the distribution of correlations between draws <span class="citation" data-cites="bignardi_general_2025">(<a href="#ref-bignardi_general_2025" role="doc-biblioref">Bignardi et al., 2025</a>)</span>. I have borrowed code that the authors made available, and adapted it to simplify the use by grace of the <code>mirt</code> package and its function to generate plausible values <span class="citation" data-cites="mislevy_randomization-based_1991 wu_role_2005">(PVs, <a href="#ref-mislevy_randomization-based_1991" role="doc-biblioref">Mislevy, 1991</a>; <a href="#ref-wu_role_2005" role="doc-biblioref">Wu, 2005</a>)</span> instead of having to learn to specify Bayesian models. Preliminary investigations indicate similar results for PVs and fully Bayesian model posteriors, see the example code in the documentation <code><a href="https://pgmj.github.io/easyRasch/reference/RIreliability.html">?RIreliability</a></code> for an example, and <a href="https://pgmj.github.io/reliability.html">this blog post</a> for a more extensive investigation. The 95% HDCI is a useful addition, and by using PVs, respondents with extreme values are included in a reasonable way. <code><a href="https://pgmj.github.io/easyRasch/reference/RIreliability.html">RIreliability()</a></code> has the setting <code>estim</code> to choose method of estimation for thetas/latent scores used for the RMU, which uses “WLE” (weighted likelihood estimation) as default to minimize bias, which may be an improvement over the fully Bayesian modeling method <span class="citation" data-cites="warm1989 kreiner_specific_2025">(<a href="#ref-kreiner_specific_2025" role="doc-biblioref">Kreiner, 2025</a>; <a href="#ref-warm1989" role="doc-biblioref">Warm, 1989</a>)</span>, but this has not been evaluated. Other possible methods are specified in <code><a href="https://philchalmers.github.io/mirt/reference/fscores.html">?mirt::fscores</a></code>. The output from <code><a href="https://pgmj.github.io/easyRasch/reference/RIreliability.html">RIreliability()</a></code> indicates which method was used.</p>
<p>In addition to the RMU, <code><a href="https://pgmj.github.io/easyRasch/reference/RIreliability.html">RIreliability()</a></code> outputs the Person Separation Index (PSI), the empirical reliability (as estimated by <code><a href="https://philchalmers.github.io/mirt/reference/empirical_rxx.html">mirt::empirical_rxx()</a></code> using WLE, see <a href="https://stats.stackexchange.com/questions/427631/difference-between-empirical-and-marginal-reliability-of-an-irt-model">this post</a>), and a table with values from the WL estimation (using <code><a href="https://rdrr.io/pkg/iarm/man/person_estimates.html">iarm::person_estimates()</a></code>). I suggest reporting RMU in publications. Also, the default setting is to use 1000 plausible values, and I think it would be prudent to use something like 4000 for a publication.</p>
<p>An addition made to <code><a href="https://pgmj.github.io/easyRasch/reference/RIreliability.html">RIreliability()</a></code> in <code>easyRasch</code> version 0.4.1.2 was the option <code>iter = 50</code>, which refers to the number of times RMU is estimated from the draws generated, to achieve more stable values compared to a single estimation.</p>
</section><section id="conditional-reliability" class="level3" data-number="7.2"><h3 data-number="7.2" class="anchored" data-anchor-id="conditional-reliability">
<span class="header-section-number">7.2</span> Conditional reliability</h3>
<p>Another recent paper <span class="citation" data-cites="mcneish_reliability_2025">(<a href="#ref-mcneish_reliability_2025" role="doc-biblioref">McNeish &amp; Dumas, 2025</a>)</span> advocates for the relevance of a conditional reliability, which I think is a useful addition to the RMU metric presented above. I have again borrowed code from another open source project, namely the <a href="https://github.com/melissagwolf/dynamic/"><code>dynamic</code> R package</a>. <code><a href="https://pgmj.github.io/easyRasch/reference/RelRep.html">RIrelRep()</a></code> produces a Cronbach’s alpha point estimate with a confidence interval and a conditional reliability curve showing varying levels of alpha across the ordinal sum score range. Alpha is a criticized metric <span class="citation" data-cites="sijtsma_use_2008 mcneish_thanks_2018">(<a href="#ref-mcneish_thanks_2018" role="doc-biblioref">McNeish, 2018</a>; e.g <a href="#ref-sijtsma_use_2008" role="doc-biblioref">Sijtsma, 2008</a>)</span>, so again interpret this with care. One of alpha’s issues is the assumption of tau-equivalence (equal factor loadings or discrimination parameters across all items), which is only fulfilled by the Rasch model, and also requires local independence of item. Alpha is a metric for ordinal sum scores, not estimated interval scores. The <code><a href="https://pgmj.github.io/easyRasch/reference/RelRep.html">RIrelRep()</a></code> function also has an option for using omega instead of alpha, see the tab “Omega” below.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-7-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-1" role="tab" aria-controls="tabset-7-1" aria-selected="true">Figure</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-2" role="tab" aria-controls="tabset-7-2" aria-selected="false">Table</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-3" role="tab" aria-controls="tabset-7-3" aria-selected="false">Omega</a></li>
</ul>
<div class="tab-content">
<div id="tabset-7-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-7-1-tab">
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb100"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">relrep</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://pgmj.github.io/easyRasch/reference/RelRep.html">RIrelRep</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>Coefficient Alpha:                  0.85
Coefficient Alpha 95% CI:          [0.83,0.86]

People above Alpha interval:    54.35%
People within Alpha interval   :    0.11%
People below  Alpha interval:    45.54%</code></pre>
</div>
</div>
</div>
<div id="tabset-7-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-2-tab">
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb102"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">relrep</span><span class="op">$</span><span class="va">stat</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>                             X1          X2
1            Coefficient Alpha:        0.85
2     Coefficient Alpha 95% CI: [0.83,0.86]
3                                          
4  People above Alpha interval:      54.35%
5 People within Alpha interval:       0.11%
6 People below Alpha interval :      45.54%</code></pre>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb104"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">relrep</span><span class="op">$</span><span class="va">table</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>   Sum Score Conditional Reliability Count
1          0                   0.554   268
2          1                   0.671   151
3          2                   0.747   177
4          3                   0.798   127
5          4                   0.832   117
6          5                   0.856   122
7          6                   0.873   124
8          7                   0.886   107
9          8                   0.895    88
10         9                   0.902    86
11        10                   0.907    62
12        11                   0.911    60
13        12                   0.913    71
14        13                   0.915    52
15        14                   0.915    48
16        15                   0.915    43
17        16                   0.914    34
18        17                   0.912    28
19        18                   0.909    23
20        19                   0.906    22
21        20                   0.900    17
22        21                   0.894     8
23        22                   0.885     7
24        23                   0.875     1
25        24                   0.861     3
26        25                   0.844     2
27        26                   0.821     1
28        27                   0.790     1
29        28                   0.746     1</code></pre>
</div>
</div>
</div>
<div id="tabset-7-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-3-tab">
<p>As a comparison, we can also get conditional omega.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb106"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">rr_omega</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://pgmj.github.io/easyRasch/reference/RelRep.html">RIrelRep</a></span><span class="op">(</span><span class="va">df</span>, rel <span class="op">=</span> <span class="st">"omega"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>Coefficient Omega:                  0.85
Coefficient Omega 95% CI:          [0.84,0.86]

People above Omega interval:    47.76%
People within Omega interval   :    6.7%
People below  Omega interval:    45.54%</code></pre>
</div>
</div>
</div>
</div>
</div>
<p>To me, there is one outstanding issue with the reliability metrics discussed and presented above. The TIF curve was based on item parameters, describing the test reliability. All estimates above are sample specific, describing the sample reliability. I think both are relevant, depending on what you are doing. For validating a measure, it would be interesting to present the measure’s reliability.</p>
</section></section><section id="person-fit" class="level2" data-number="8"><h2 data-number="8" class="anchored" data-anchor-id="person-fit">
<span class="header-section-number">8</span> Person fit</h2>
<p>We can also look at how the respondents fit the Rasch model with these items. By default, <code><a href="https://pgmj.github.io/easyRasch/reference/RIpfit.html">RIpfit()</a></code> outputs a histogram and a hex heatmap with the person infit ZSTD statistic, using +/- 1.96 as cutoff values. This is currently the only person fit method implemented in the <code>easyRasch</code> package, and the curious analyst is suggested to look at the package <a href="https://www.rdocumentation.org/packages/PerFit/versions/1.4.6/topics/PerFit-package">PerFit</a> for more tools.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb108"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://pgmj.github.io/easyRasch/reference/RIpfit.html">RIpfit</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="RaschRvign_files/figure-html/unnamed-chunk-88-1.png" class="img-fluid figure-img" width="1050"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="RaschRvign_files/figure-html/unnamed-chunk-88-2.png" class="img-fluid figure-img" width="1050"></p>
</figure>
</div>
</div>
</div>
<p>You can export the person fit values to a new variable in the dataframe by specifying <code>output = "dataframe"</code>, or if you just want the row numbers for respondents with deviant infit values, <code>output = "rowid"</code>.</p>
<p>You can also specify a grouping variable to visualize the person fit for different groups.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb109"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://pgmj.github.io/easyRasch/reference/RIpfit.html">RIpfit</a></span><span class="op">(</span><span class="va">df</span>, group <span class="op">=</span> <span class="va">dif</span><span class="op">$</span><span class="va">Sex</span>, output <span class="op">=</span> <span class="st">"heatmap"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="RaschRvign_files/figure-html/unnamed-chunk-89-1.png" class="img-fluid figure-img" width="1050"></p>
</figure>
</div>
</div>
</div>
<p>Person fit is a useful way to identify respondents with unexpected response patterns and investigate this further.</p>
<section id="perfit-sample-code" class="level3" data-number="8.1"><h3 data-number="8.1" class="anchored" data-anchor-id="perfit-sample-code">
<span class="header-section-number">8.1</span> <code>PerFit</code> sample code</h3>
<p>While none of the functions in the <code>PerFit</code> package has been implemented in <code>easyRasch</code>, this is some code to get you started if you are interested in using it. There are multiple methods/functions available for polytomous and dichotomous data, see the package <a href="https://www.rdocumentation.org/packages/PerFit/versions/1.4.6/topics/PerFit-package">documentation</a>.</p>
<p>For this example, we’ll use the non-parametric U3 statistic generalized to polytomous items <span class="citation" data-cites="emons_nonparametric_2008">(<a href="#ref-emons_nonparametric_2008" role="doc-biblioref">Emons, 2008</a>)</span> and the smaller sample.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-8-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-1" role="tab" aria-controls="tabset-8-1" aria-selected="true">U3poly</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-8-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-2" role="tab" aria-controls="tabset-8-2" aria-selected="false">Cutoff information</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-8-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-3" role="tab" aria-controls="tabset-8-3" aria-selected="false">Flagged respondents</a></li>
</ul>
<div class="tab-content">
<div id="tabset-8-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-8-1-tab">
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb110"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">PerFit</span><span class="op">)</span></span>
<span><span class="va">pfit_u3poly</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/PerFit/man/U3poly.html">U3poly</a></span><span class="op">(</span>matrix <span class="op">=</span> <span class="va">df500</span>, </span>
<span>                      Ncat <span class="op">=</span> <span class="fl">5</span>, <span class="co"># make sure to input number of response categories, not thresholds</span></span>
<span>                      IRT.PModel <span class="op">=</span> <span class="st">"PCM"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-8-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-8-2-tab">
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb111"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/PerFit/man/cutoff.html">cutoff</a></span><span class="op">(</span><span class="va">pfit_u3poly</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>$Cutoff
[1] 0.4865

$Cutoff.SE
[1] 0.0298

$Prop.flagged
[1] 0.084

$Tail
[1] "upper"

$Cutoff.CI
  2.5%  97.5% 
0.4336 0.5515 

attr(,"class")
[1] "PerFit.cutoff"</code></pre>
</div>
</div>
</div>
<div id="tabset-8-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-8-3-tab">
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb113"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/PerFit/man/flagged.resp.html">flagged.resp</a></span><span class="op">(</span><span class="va">pfit_u3poly</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://purrr.tidyverse.org/reference/pluck.html">pluck</a></span><span class="op">(</span><span class="st">"Scores"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/desc.html">desc</a></span><span class="op">(</span><span class="va">PFscores</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>   FlaggedID It4 It1 It7 It2 It5 It3 It6 PFscores
1          6   0   0   0   0   0   0   1   1.0000
2        339   0   0   0   0   0   0   1   1.0000
3        389   0   0   0   0   0   0   1   1.0000
4         52   0   0   0   0   0   4   0   0.9835
5        479   0   0   0   0   0   4   0   0.9835
6        278   0   0   0   0   0   3   0   0.9402
7        460   0   0   0   0   0   2   0   0.9246
8         74   1   0   0   0   0   0   4   0.9106
9         23   4   0   2   4   4   4   4   0.8766
10       287   0   0   0   0   0   1   0   0.8712
11        67   0   4   0   0   0   0   4   0.7822
12       413   0   4   4   0   0   4   0   0.7736
13       116   0   0   4   0   0   0   0   0.7677
14       372   0   0   0   0   3   0   0   0.7196
15        30   3   0   0   4   1   4   4   0.7123
16       236   0   0   0   4   4   1   3   0.7051
17       124   4   4   0   4   0   4   0   0.6562
18       170   0   0   0   0   1   0   0   0.6167
19       375   0   0   0   0   1   0   0   0.6167
20       189   0   4   0   0   0   0   0   0.6166
21       313   0   4   0   0   0   0   0   0.6166
22        21   0   0   0   2   0   0   0   0.6144
23       203   2   4   0   4   4   0   0   0.5957
24       167   0   0   1   0   0   0   3   0.5917
25       207   2   0   0   4   0   0   0   0.5791
26       443   0   4   1   0   0   0   0   0.5573
27       289   4   4   4   4   4   0   0   0.5566
28       184   4   1   0   4   0   0   0   0.5318
29       318   0   1   0   2   0   0   3   0.5261
30       444   4   3   0   4   0   0   0   0.5185
31        34   0   0   2   0   0   0   0   0.5010
32        69   0   0   2   0   0   0   0   0.5010
33        80   0   0   2   0   0   0   0   0.5010
34       108   0   0   2   0   0   0   0   0.5010
35       272   0   0   2   0   0   0   0   0.5010
36       363   0   0   2   0   0   0   0   0.5010
37       472   0   0   2   0   0   0   0   0.5010
38       473   0   0   2   0   0   0   0   0.5010
39        12   0   3   0   0   0   0   0   0.4963
40        76   0   3   0   0   0   0   0   0.4963
41         3   3   4   0   0   0   0   0   0.4888
42        39   2   0   2   3   4   2   4   0.4882
43       125   0   0   1   0   0   2   0   0.4757
44        19   0   0   0   1   0   0   0   0.4742
45       425   2   1   2   0   0   0   4   0.4706
46       239   4   1   3   2   0   3   4   0.4676
47        95   0   0   0   1   0   1   0   0.4562
48        82   1   3   4   0   3   0   0   0.4479</code></pre>
</div>
</div>
</div>
</div>
</div>
<p>The dataframe shown under the tab <code>Flagged respondents</code> above contains a variable named <code>FlaggedID</code> which represents the row id’s. This variable is useful if one wants to filter out respondents with deviant response patterns (person misfit). There are indications that persons with misfit may affect results of Andersen’s LR-test for DIF <span class="citation" data-cites="artner_simulation_2016">(<a href="#ref-artner_simulation_2016" role="doc-biblioref">Artner, 2016</a>)</span>.</p>
</section><section id="item-fit-without-aberrant-responses" class="level3" data-number="8.2"><h3 data-number="8.2" class="anchored" data-anchor-id="item-fit-without-aberrant-responses">
<span class="header-section-number">8.2</span> Item fit without aberrant responses</h3>
<p>We can remove the misfitting persons to see how that affects item fit. Let’s also compare with the misfitting respondents identified by <code><a href="https://pgmj.github.io/easyRasch/reference/RIpfit.html">RIpfit()</a></code>, also using the smaller sample.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb115"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">misfits</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/PerFit/man/flagged.resp.html">flagged.resp</a></span><span class="op">(</span><span class="va">pfit_u3poly</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://purrr.tidyverse.org/reference/pluck.html">pluck</a></span><span class="op">(</span><span class="st">"Scores"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html">pull</a></span><span class="op">(</span><span class="va">FlaggedID</span><span class="op">)</span></span>
<span></span>
<span><span class="va">misfits2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://pgmj.github.io/easyRasch/reference/RIpfit.html">RIpfit</a></span><span class="op">(</span><span class="va">df500</span>, output <span class="op">=</span> <span class="st">"rowid"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-9-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-1" role="tab" aria-controls="tabset-9-1" aria-selected="true">All respondents</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-9-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-2" role="tab" aria-controls="tabset-9-2" aria-selected="false">U3 misfit removed</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-9-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-3" role="tab" aria-controls="tabset-9-3" aria-selected="false">ZSTD misfit removed</a></li>
</ul>
<div class="tab-content">
<div id="tabset-9-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-9-1-tab">
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb116"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://pgmj.github.io/easyRasch/reference/RIitemfit.html">RIitemfit</a></span><span class="op">(</span><span class="va">df500</span>, simcut <span class="op">=</span> <span class="va">simfit3</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table data-quarto-disable-processing="true" style="width:65%; font-size: 14px;  font-family: Arial; margin-left: auto; margin-right: auto;border-bottom: 0;" class="table table-striped table-hover lightable-classic">
<thead><tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> Item </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> InfitMSQ </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> Infit thresholds </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> Infit diff </th>
   <th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> Relative location </th>
  </tr></thead>
<tbody>
<tr>
<td style="text-align:left;"> PANAS_11 </td>
   <td style="text-align:left;"> <span style="     color: black !important;">1.126</span> </td>
   <td style="text-align:left;"> [0.84, 1.147] </td>
   <td style="text-align:left;"> no misfit </td>
   <td style="text-align:right;"> 1.02 </td>
  </tr>
<tr>
<td style="text-align:left;"> PANAS_12 </td>
   <td style="text-align:left;"> <span style="     color: red !important;">0.737</span> </td>
   <td style="text-align:left;"> [0.859, 1.167] </td>
   <td style="text-align:left;"> 0.122 </td>
   <td style="text-align:right;"> 1.22 </td>
  </tr>
<tr>
<td style="text-align:left;"> PANAS_13 </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0.908</span> </td>
   <td style="text-align:left;"> [0.854, 1.167] </td>
   <td style="text-align:left;"> no misfit </td>
   <td style="text-align:right;"> 1.68 </td>
  </tr>
<tr>
<td style="text-align:left;"> PANAS_14 </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0.913</span> </td>
   <td style="text-align:left;"> [0.879, 1.145] </td>
   <td style="text-align:left;"> no misfit </td>
   <td style="text-align:right;"> 0.94 </td>
  </tr>
<tr>
<td style="text-align:left;"> PANAS_16 </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0.918</span> </td>
   <td style="text-align:left;"> [0.814, 1.162] </td>
   <td style="text-align:left;"> no misfit </td>
   <td style="text-align:right;"> 1.53 </td>
  </tr>
<tr>
<td style="text-align:left;"> PANAS_17 </td>
   <td style="text-align:left;"> <span style="     color: black !important;">1.155</span> </td>
   <td style="text-align:left;"> [0.8, 1.167] </td>
   <td style="text-align:left;"> no misfit </td>
   <td style="text-align:right;"> 1.66 </td>
  </tr>
<tr>
<td style="text-align:left;"> PANAS_20 </td>
   <td style="text-align:left;"> <span style="     color: red !important;">1.242</span> </td>
   <td style="text-align:left;"> [0.874, 1.241] </td>
   <td style="text-align:left;"> 0.001 </td>
   <td style="text-align:right;"> 1.30 </td>
  </tr>
</tbody>
<tfoot>
<tr><td style="padding: 0; " colspan="100%"><span style="font-style: italic;">Note: </span></td></tr>
<tr><td style="padding: 0; " colspan="100%">
<sup></sup> MSQ values based on conditional calculations (n = 500 complete cases).<br>                                Simulation based thresholds from 200 simulated datasets.</td></tr>
</tfoot>
</table>
</div>
</div>
</div>
<div id="tabset-9-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-9-2-tab">
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb117"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://pgmj.github.io/easyRasch/reference/RIitemfit.html">RIitemfit</a></span><span class="op">(</span><span class="va">df500</span><span class="op">[</span><span class="op">-</span><span class="va">misfits</span>,<span class="op">]</span>, simcut <span class="op">=</span> <span class="va">simfit3</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table data-quarto-disable-processing="true" style="width:65%; font-size: 14px;  font-family: Arial; margin-left: auto; margin-right: auto;border-bottom: 0;" class="table table-striped table-hover lightable-classic">
<thead><tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> Item </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> InfitMSQ </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> Infit thresholds </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> Infit diff </th>
   <th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> Relative location </th>
  </tr></thead>
<tbody>
<tr>
<td style="text-align:left;"> PANAS_11 </td>
   <td style="text-align:left;"> <span style="     color: black !important;">1.051</span> </td>
   <td style="text-align:left;"> [0.84, 1.147] </td>
   <td style="text-align:left;"> no misfit </td>
   <td style="text-align:right;"> 1.23 </td>
  </tr>
<tr>
<td style="text-align:left;"> PANAS_12 </td>
   <td style="text-align:left;"> <span style="     color: red !important;">0.746</span> </td>
   <td style="text-align:left;"> [0.859, 1.167] </td>
   <td style="text-align:left;"> 0.113 </td>
   <td style="text-align:right;"> 1.49 </td>
  </tr>
<tr>
<td style="text-align:left;"> PANAS_13 </td>
   <td style="text-align:left;"> <span style="     color: red !important;">0.832</span> </td>
   <td style="text-align:left;"> [0.854, 1.167] </td>
   <td style="text-align:left;"> 0.022 </td>
   <td style="text-align:right;"> 2.26 </td>
  </tr>
<tr>
<td style="text-align:left;"> PANAS_14 </td>
   <td style="text-align:left;"> <span style="     color: black !important;">1.023</span> </td>
   <td style="text-align:left;"> [0.879, 1.145] </td>
   <td style="text-align:left;"> no misfit </td>
   <td style="text-align:right;"> 1.04 </td>
  </tr>
<tr>
<td style="text-align:left;"> PANAS_16 </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0.963</span> </td>
   <td style="text-align:left;"> [0.814, 1.162] </td>
   <td style="text-align:left;"> no misfit </td>
   <td style="text-align:right;"> 1.92 </td>
  </tr>
<tr>
<td style="text-align:left;"> PANAS_17 </td>
   <td style="text-align:left;"> <span style="     color: black !important;">1.128</span> </td>
   <td style="text-align:left;"> [0.8, 1.167] </td>
   <td style="text-align:left;"> no misfit </td>
   <td style="text-align:right;"> 2.22 </td>
  </tr>
<tr>
<td style="text-align:left;"> PANAS_20 </td>
   <td style="text-align:left;"> <span style="     color: red !important;">1.264</span> </td>
   <td style="text-align:left;"> [0.874, 1.241] </td>
   <td style="text-align:left;"> 0.023 </td>
   <td style="text-align:right;"> 1.53 </td>
  </tr>
</tbody>
<tfoot>
<tr><td style="padding: 0; " colspan="100%"><span style="font-style: italic;">Note: </span></td></tr>
<tr><td style="padding: 0; " colspan="100%">
<sup></sup> MSQ values based on conditional calculations (n = 452 complete cases).<br>                                Simulation based thresholds from 200 simulated datasets.</td></tr>
</tfoot>
</table>
</div>
</div>
</div>
<div id="tabset-9-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-9-3-tab">
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb118"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://pgmj.github.io/easyRasch/reference/RIitemfit.html">RIitemfit</a></span><span class="op">(</span><span class="va">df500</span><span class="op">[</span><span class="op">-</span><span class="va">misfits2</span>,<span class="op">]</span>, simcut <span class="op">=</span> <span class="va">simfit3</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table data-quarto-disable-processing="true" style="width:65%; font-size: 14px;  font-family: Arial; margin-left: auto; margin-right: auto;border-bottom: 0;" class="table table-striped table-hover lightable-classic">
<thead><tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> Item </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> InfitMSQ </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> Infit thresholds </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> Infit diff </th>
   <th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> Relative location </th>
  </tr></thead>
<tbody>
<tr>
<td style="text-align:left;"> PANAS_11 </td>
   <td style="text-align:left;"> <span style="     color: black !important;">1.082</span> </td>
   <td style="text-align:left;"> [0.84, 1.147] </td>
   <td style="text-align:left;"> no misfit </td>
   <td style="text-align:right;"> 1.16 </td>
  </tr>
<tr>
<td style="text-align:left;"> PANAS_12 </td>
   <td style="text-align:left;"> <span style="     color: red !important;">0.737</span> </td>
   <td style="text-align:left;"> [0.859, 1.167] </td>
   <td style="text-align:left;"> 0.122 </td>
   <td style="text-align:right;"> 1.43 </td>
  </tr>
<tr>
<td style="text-align:left;"> PANAS_13 </td>
   <td style="text-align:left;"> <span style="     color: red !important;">0.83</span> </td>
   <td style="text-align:left;"> [0.854, 1.167] </td>
   <td style="text-align:left;"> 0.024 </td>
   <td style="text-align:right;"> 2.13 </td>
  </tr>
<tr>
<td style="text-align:left;"> PANAS_14 </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0.946</span> </td>
   <td style="text-align:left;"> [0.879, 1.145] </td>
   <td style="text-align:left;"> no misfit </td>
   <td style="text-align:right;"> 1.02 </td>
  </tr>
<tr>
<td style="text-align:left;"> PANAS_16 </td>
   <td style="text-align:left;"> <span style="     color: black !important;">0.954</span> </td>
   <td style="text-align:left;"> [0.814, 1.162] </td>
   <td style="text-align:left;"> no misfit </td>
   <td style="text-align:right;"> 1.76 </td>
  </tr>
<tr>
<td style="text-align:left;"> PANAS_17 </td>
   <td style="text-align:left;"> <span style="     color: red !important;">1.185</span> </td>
   <td style="text-align:left;"> [0.8, 1.167] </td>
   <td style="text-align:left;"> 0.018 </td>
   <td style="text-align:right;"> 1.87 </td>
  </tr>
<tr>
<td style="text-align:left;"> PANAS_20 </td>
   <td style="text-align:left;"> <span style="     color: red !important;">1.255</span> </td>
   <td style="text-align:left;"> [0.874, 1.241] </td>
   <td style="text-align:left;"> 0.014 </td>
   <td style="text-align:right;"> 1.41 </td>
  </tr>
</tbody>
<tfoot>
<tr><td style="padding: 0; " colspan="100%"><span style="font-style: italic;">Note: </span></td></tr>
<tr><td style="padding: 0; " colspan="100%">
<sup></sup> MSQ values based on conditional calculations (n = 441 complete cases).<br>                                Simulation based thresholds from 200 simulated datasets.</td></tr>
</tfoot>
</table>
</div>
</div>
</div>
</div>
</div>
</section></section><section id="item-parameters" class="level2" data-number="9"><h2 data-number="9" class="anchored" data-anchor-id="item-parameters">
<span class="header-section-number">9</span> Item parameters</h2>
<p>To allow others (and oneself) to use the item parameters estimated for estimation of person locations/thetas, we should make the item parameters available. The function will also write a csv-file with the item threshold locations. Estimations of person locations/thetas can be done with the <code><a href="https://rdrr.io/pkg/catR/man/thetaEst.html">thetaEst()</a></code> function from the <code>catR</code> package. This is implemented in the function <code><a href="https://pgmj.github.io/easyRasch/reference/RIestThetasOLD.html">RIestThetasOLD()</a></code>, see below for details.</p>
<p>First, we’ll output the parameters into a table.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb119"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://pgmj.github.io/easyRasch/reference/RIitemparams.html">RIitemparams</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table data-quarto-disable-processing="true" style="width:90%; font-size: 15px; width: auto !important;  font-family: Lato; margin-left: auto; margin-right: auto; margin-left: auto; margin-right: auto;border-bottom: 0;" class="table table-striped table-hover lightable-classic table">
<thead><tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">   </th>
   <th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;"> Threshold 1 </th>
   <th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;"> Threshold 2 </th>
   <th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;"> Threshold 3 </th>
   <th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;"> Threshold 4 </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"> Item location </th>
  </tr></thead>
<tbody>
<tr>
<td style="text-align:left;font-weight: bold;"> PANAS_11 </td>
   <td style="text-align:right;"> -1.63 </td>
   <td style="text-align:right;"> -0.67 </td>
   <td style="text-align:right;"> -0.22 </td>
   <td style="text-align:right;"> 1.21 </td>
   <td style="text-align:left;"> <span style=" font-weight: bold;    text-align: right;">-0.33</span> </td>
  </tr>
<tr>
<td style="text-align:left;font-weight: bold;"> PANAS_12 </td>
   <td style="text-align:right;"> -0.80 </td>
   <td style="text-align:right;"> -0.39 </td>
   <td style="text-align:right;"> 0.06 </td>
   <td style="text-align:right;"> 0.89 </td>
   <td style="text-align:left;"> <span style=" font-weight: bold;    text-align: right;">-0.06</span> </td>
  </tr>
<tr>
<td style="text-align:left;font-weight: bold;"> PANAS_13 </td>
   <td style="text-align:right;"> -0.29 </td>
   <td style="text-align:right;"> -0.15 </td>
   <td style="text-align:right;"> 0.56 </td>
   <td style="text-align:right;"> 1.53 </td>
   <td style="text-align:left;"> <span style=" font-weight: bold;    text-align: right;">0.42</span> </td>
  </tr>
<tr>
<td style="text-align:left;font-weight: bold;"> PANAS_14 </td>
   <td style="text-align:right;"> -1.38 </td>
   <td style="text-align:right;"> -0.59 </td>
   <td style="text-align:right;"> -0.16 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:left;"> <span style=" font-weight: bold;    text-align: right;">-0.32</span> </td>
  </tr>
<tr>
<td style="text-align:left;font-weight: bold;"> PANAS_16 </td>
   <td style="text-align:right;"> -0.59 </td>
   <td style="text-align:right;"> -0.44 </td>
   <td style="text-align:right;"> -0.06 </td>
   <td style="text-align:right;"> 1.08 </td>
   <td style="text-align:left;"> <span style=" font-weight: bold;    text-align: right;">0</span> </td>
  </tr>
<tr>
<td style="text-align:left;font-weight: bold;"> PANAS_17 </td>
   <td style="text-align:right;"> -0.06 </td>
   <td style="text-align:right;"> 0.01 </td>
   <td style="text-align:right;"> 0.48 </td>
   <td style="text-align:right;"> 0.93 </td>
   <td style="text-align:left;"> <span style=" font-weight: bold;    text-align: right;">0.34</span> </td>
  </tr>
<tr>
<td style="text-align:left;font-weight: bold;"> PANAS_20 </td>
   <td style="text-align:right;"> -1.27 </td>
   <td style="text-align:right;"> -0.61 </td>
   <td style="text-align:right;"> 0.35 </td>
   <td style="text-align:right;"> 1.32 </td>
   <td style="text-align:left;"> <span style=" font-weight: bold;    text-align: right;">-0.05</span> </td>
  </tr>
</tbody>
<tfoot>
<tr><td style="padding: 0; " colspan="100%"><span style="font-style: italic;">Note: </span></td></tr>
<tr><td style="padding: 0; " colspan="100%">
<sup></sup> Item location is the average of the thresholds for each item.</td></tr>
</tfoot>
</table>
</div>
</div>
<p>The parameters can also be output to a dataframe or a file, using the option <code>output = "dataframe"</code> or <code>output = "file"</code>.</p>
</section><section id="ordinal-sum-score-to-interval-score" class="level2" data-number="10"><h2 data-number="10" class="anchored" data-anchor-id="ordinal-sum-score-to-interval-score">
<span class="header-section-number">10</span> Ordinal sum score to interval score</h2>
<p>This table shows the corresponding “raw” ordinal sum score values and logit scores, with standard errors for each logit value. Interval scores are estimated using WL based on a simulated dataset using the item parameters estimated from the input dataset. The choice of WL as default is due to the lower bias compared to ML estimation <span class="citation" data-cites="warm1989 kreiner_specific_2025">(<a href="#ref-kreiner_specific_2025" role="doc-biblioref">Kreiner, 2025</a>; <a href="#ref-warm1989" role="doc-biblioref">Warm, 1989</a>)</span>.</p>
<p>(An option will hopefully be added at some point to create this table based on only item parameters.)</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb120"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://pgmj.github.io/easyRasch/reference/RIscoreSE.html">RIscoreSE</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table data-quarto-disable-processing="true" style="width:65%; font-size: 14px;  font-family: Arial; margin-left: auto; margin-right: auto;" class="table table-striped table-hover lightable-classic">
<thead><tr>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> Ordinal sum score </th>
   <th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> Logit score </th>
   <th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;font-weight: bold;"> Logit std.error </th>
  </tr></thead>
<tbody>
<tr>
<td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> -3.642 </td>
   <td style="text-align:right;"> 0.620 </td>
  </tr>
<tr>
<td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> -2.543 </td>
   <td style="text-align:right;"> 0.716 </td>
  </tr>
<tr>
<td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> -2.032 </td>
   <td style="text-align:right;"> 0.653 </td>
  </tr>
<tr>
<td style="text-align:right;"> 3 </td>
   <td style="text-align:right;"> -1.693 </td>
   <td style="text-align:right;"> 0.578 </td>
  </tr>
<tr>
<td style="text-align:right;"> 4 </td>
   <td style="text-align:right;"> -1.437 </td>
   <td style="text-align:right;"> 0.515 </td>
  </tr>
<tr>
<td style="text-align:right;"> 5 </td>
   <td style="text-align:right;"> -1.228 </td>
   <td style="text-align:right;"> 0.468 </td>
  </tr>
<tr>
<td style="text-align:right;"> 6 </td>
   <td style="text-align:right;"> -1.050 </td>
   <td style="text-align:right;"> 0.432 </td>
  </tr>
<tr>
<td style="text-align:right;"> 7 </td>
   <td style="text-align:right;"> -0.893 </td>
   <td style="text-align:right;"> 0.406 </td>
  </tr>
<tr>
<td style="text-align:right;"> 8 </td>
   <td style="text-align:right;"> -0.750 </td>
   <td style="text-align:right;"> 0.386 </td>
  </tr>
<tr>
<td style="text-align:right;"> 9 </td>
   <td style="text-align:right;"> -0.618 </td>
   <td style="text-align:right;"> 0.371 </td>
  </tr>
<tr>
<td style="text-align:right;"> 10 </td>
   <td style="text-align:right;"> -0.493 </td>
   <td style="text-align:right;"> 0.361 </td>
  </tr>
<tr>
<td style="text-align:right;"> 11 </td>
   <td style="text-align:right;"> -0.373 </td>
   <td style="text-align:right;"> 0.353 </td>
  </tr>
<tr>
<td style="text-align:right;"> 12 </td>
   <td style="text-align:right;"> -0.258 </td>
   <td style="text-align:right;"> 0.348 </td>
  </tr>
<tr>
<td style="text-align:right;"> 13 </td>
   <td style="text-align:right;"> -0.144 </td>
   <td style="text-align:right;"> 0.346 </td>
  </tr>
<tr>
<td style="text-align:right;"> 14 </td>
   <td style="text-align:right;"> -0.031 </td>
   <td style="text-align:right;"> 0.346 </td>
  </tr>
<tr>
<td style="text-align:right;"> 15 </td>
   <td style="text-align:right;"> 0.083 </td>
   <td style="text-align:right;"> 0.348 </td>
  </tr>
<tr>
<td style="text-align:right;"> 16 </td>
   <td style="text-align:right;"> 0.198 </td>
   <td style="text-align:right;"> 0.352 </td>
  </tr>
<tr>
<td style="text-align:right;"> 17 </td>
   <td style="text-align:right;"> 0.317 </td>
   <td style="text-align:right;"> 0.359 </td>
  </tr>
<tr>
<td style="text-align:right;"> 18 </td>
   <td style="text-align:right;"> 0.441 </td>
   <td style="text-align:right;"> 0.368 </td>
  </tr>
<tr>
<td style="text-align:right;"> 19 </td>
   <td style="text-align:right;"> 0.572 </td>
   <td style="text-align:right;"> 0.381 </td>
  </tr>
<tr>
<td style="text-align:right;"> 20 </td>
   <td style="text-align:right;"> 0.712 </td>
   <td style="text-align:right;"> 0.397 </td>
  </tr>
<tr>
<td style="text-align:right;"> 21 </td>
   <td style="text-align:right;"> 0.866 </td>
   <td style="text-align:right;"> 0.418 </td>
  </tr>
<tr>
<td style="text-align:right;"> 22 </td>
   <td style="text-align:right;"> 1.037 </td>
   <td style="text-align:right;"> 0.447 </td>
  </tr>
<tr>
<td style="text-align:right;"> 23 </td>
   <td style="text-align:right;"> 1.233 </td>
   <td style="text-align:right;"> 0.484 </td>
  </tr>
<tr>
<td style="text-align:right;"> 24 </td>
   <td style="text-align:right;"> 1.464 </td>
   <td style="text-align:right;"> 0.534 </td>
  </tr>
<tr>
<td style="text-align:right;"> 25 </td>
   <td style="text-align:right;"> 1.747 </td>
   <td style="text-align:right;"> 0.601 </td>
  </tr>
<tr>
<td style="text-align:right;"> 26 </td>
   <td style="text-align:right;"> 2.118 </td>
   <td style="text-align:right;"> 0.681 </td>
  </tr>
<tr>
<td style="text-align:right;"> 27 </td>
   <td style="text-align:right;"> 2.666 </td>
   <td style="text-align:right;"> 0.745 </td>
  </tr>
<tr>
<td style="text-align:right;"> 28 </td>
   <td style="text-align:right;"> 3.804 </td>
   <td style="text-align:right;"> 0.638 </td>
  </tr>
</tbody>
</table>
</div>
</div>
<section id="ordinalinterval-figure" class="level3" data-number="10.1"><h3 data-number="10.1" class="anchored" data-anchor-id="ordinalinterval-figure">
<span class="header-section-number">10.1</span> Ordinal/interval figure</h3>
<p>The figure below can also be generated to illustrate the relationship between ordinal sum score and logit interval score. The errorbars default to show the standard error at each point, multiplied by 1.96.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb121"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://pgmj.github.io/easyRasch/reference/RIscoreSE.html">RIscoreSE</a></span><span class="op">(</span><span class="va">df</span>, output <span class="op">=</span> <span class="st">"figure"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="RaschRvign_files/figure-html/unnamed-chunk-99-1.png" class="img-fluid figure-img" width="1050"></p>
</figure>
</div>
</div>
</div>
</section><section id="estimating-interval-level-person-scores" class="level3" data-number="10.2"><h3 data-number="10.2" class="anchored" data-anchor-id="estimating-interval-level-person-scores">
<span class="header-section-number">10.2</span> Estimating interval level person scores</h3>
<p>Based on the Rasch analysis output of item parameters, we can estimate each individuals location or score (also known as “theta”). <code><a href="https://pgmj.github.io/easyRasch/reference/RIestThetas.html">RIestThetas()</a></code> estimates item parameters from a partial credit model (PCM) and as default uses WL estimation <span class="citation" data-cites="warm1989 kreiner_specific_2025">(<a href="#ref-kreiner_specific_2025" role="doc-biblioref">Kreiner, 2025</a>; <a href="#ref-warm1989" role="doc-biblioref">Warm, 1989</a>)</span> to output a dataframe with person locations and their measurement error (SEM) on the logit scale. However, this function is only appropriate if you have complete response data for all participants. If you have partial missingness, you need to use either <code><a href="https://pgmj.github.io/easyRasch/reference/RIestThetasOLD.html">RIestThetasOLD()</a></code> or <code><a href="https://pgmj.github.io/easyRasch/reference/RIestThetasCATr.html">RIestThetasCATr()</a></code>.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb122"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">thetas</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://pgmj.github.io/easyRasch/reference/RIestThetas.html">RIestThetas</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">thetas</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>         WLE       SEM
1 -2.5430673 0.7160122
2 -2.0319918 0.6533338
3 -0.1439296 0.3460439
4 -3.6420133 0.6202853
5 -2.0319918 0.6533338
6  0.1980813 0.3520345</code></pre>
</div>
</div>
<p>Each individual has a standard error of measurement (SEM) associated with their estimated location/score. This is included in the output of the <code><a href="https://pgmj.github.io/easyRasch/reference/RIestThetas.html">RIestThetas()</a></code> function as the <code>SEM</code> variable, as seen above. We can review the distribution of measurement error with a figure.</p>
<p>We can take a look at the distribution of person locations (thetas) using a histogram.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb124"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">thetas</span><span class="op">$</span><span class="va">WLE</span>, </span>
<span>     col <span class="op">=</span> <span class="st">"#009ca6"</span>, </span>
<span>     main <span class="op">=</span> <span class="st">"Histogram of person locations (thetas)"</span>, </span>
<span>     breaks <span class="op">=</span> <span class="fl">20</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="RaschRvign_files/figure-html/unnamed-chunk-101-1.png" class="img-fluid figure-img" width="1050"></p>
</figure>
</div>
</div>
</div>
<p><code><a href="https://pgmj.github.io/easyRasch/reference/RIestThetasOLD.html">RIestThetasOLD()</a></code> and <code><a href="https://pgmj.github.io/easyRasch/reference/RIestThetasCATr.html">RIestThetasCATr()</a></code> can be used with a pre-specified item (threshold) location matrix.</p>
<p>If you would like to use an existing item threshold location matrix, this code may be helpful:</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb125"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">itemParameters</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv</a></span><span class="op">(</span><span class="st">"itemParameters.csv"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">itemParameters</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>     Threshold 1 Threshold 2 Threshold 3 Threshold 4
[1,]     -1.2382     -0.3288      0.0666      1.4649
[2,]      0.0623      0.1480      0.8241      1.7680
[3,]     -0.9915     -0.2566      0.1231      1.1222
[4,]     -0.2179     -0.1217      0.2099      1.3248
[5,]      0.2868      0.3061      0.7319      1.1655
[6,]     -0.8929     -0.2860      0.6297      1.5673</code></pre>
</div>
</div>
<p>As you can see, this is a matrix object (not a dataframe), with each item as a row, and the threshold locations as columns.</p>
</section></section><section id="figure-design" class="level2" data-number="11"><h2 data-number="11" class="anchored" data-anchor-id="figure-design">
<span class="header-section-number">11</span> Figure design</h2>
<p>Most of the figures created by the functions can be styled (colors, fonts, etc) by adding theme settings to them. You can use the standard ggplot function <code><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme()</a></code> and related theme-functions. As usual it is possible to “stack” theme functions, as seen in the example below.</p>
<p>You can also change coloring, axis limits/breaks, etc, just by adding ggplot options with a <code>+</code> sign.</p>
<p>A custom theme function, <code><a href="https://pgmj.github.io/easyRasch/reference/theme_rise.html">theme_rise()</a></code>, is included in the <code>easyRasch</code> package. It might be easier to use if you are not familiar with <code><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme()</a></code>.</p>
<p>For instance, you might like to change the font to “Lato” for the item hierarchy figure, and make the background transparent.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb127"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://pgmj.github.io/easyRasch/reference/RIitemHierarchy.html">RIitemHierarchy</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="co"># first apply the minimal theme to make the background transparent</span></span>
<span>  <span class="fu"><a href="https://pgmj.github.io/easyRasch/reference/theme_rise.html">theme_rise</a></span><span class="op">(</span>fontfamily <span class="op">=</span> <span class="st">"Lato"</span><span class="op">)</span> <span class="co"># then apply theme_rise, which simplifies making changes to all plot elements</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="RaschRvign_files/figure-html/unnamed-chunk-103-1.png" class="img-fluid figure-img" width="1050"></p>
</figure>
</div>
</div>
</div>
<p>As of package version 0.1.30.0, the <code><a href="https://pgmj.github.io/easyRasch/reference/RItargeting.html">RItargeting()</a></code> function allows more flexibility in styling too, by having an option to return a list object with the three separate plots. See the <a href="https://github.com/pgmj/easyRasch/blob/main/NEWS.md#01300">NEWS</a> file for more details. Since the <code><a href="https://pgmj.github.io/easyRasch/reference/RItargeting.html">RItargeting()</a></code> function uses the <code>patchwork</code> library to combine plots, you can also make use of <a href="https://patchwork.data-imaginist.com/articles/patchwork.html">the many functions that <code>patchwork</code> includes</a>. For instance, you can set a title with a specific theme:</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb128"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://pgmj.github.io/easyRasch/reference/RItargeting.html">RItargeting</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_annotation.html">plot_annotation</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Targeting"</span>, theme <span class="op">=</span> <span class="fu"><a href="https://pgmj.github.io/easyRasch/reference/theme_rise.html">theme_rise</a></span><span class="op">(</span>fontfamily <span class="op">=</span> <span class="st">"Arial"</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="RaschRvign_files/figure-html/unnamed-chunk-104-1.png" class="img-fluid figure-img" width="1050"></p>
</figure>
</div>
</div>
</div>
<p>In order to change font for text <em>inside</em> plots (such as “t1” for thresholds) you will need to add an additional line of code.</p>
<div class="sourceCode" id="cb129"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/update_defaults.html">update_geom_defaults</a></span><span class="op">(</span><span class="st">"text"</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>family <span class="op">=</span> <span class="st">"Lato"</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Please note that the line of code above updates the default settings for <code><a href="https://ggplot2.tidyverse.org/reference/geom_text.html">geom_text()</a></code> for the whole session. Also, some functions, such as <code><a href="https://pgmj.github.io/easyRasch/reference/RIloadLoc.html">RIloadLoc()</a></code>, make use of <code><a href="https://ggrepel.slowkow.com/reference/geom_text_repel.html">geom_text_repel()</a></code>, for which you would need to change the code above from “text” to “text_repel”.</p>
<p>A simple way to only change font family and font size would be to use <code>theme_minimal(base_family = "Calibri", base_size = 14)</code>. Please see the <a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">reference page</a> for default ggplot themes for alternatives to <code><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal()</a></code>.</p>
</section><section id="sec-grateful" class="level2" data-number="12"><h2 data-number="12" class="anchored" data-anchor-id="sec-grateful">
<span class="header-section-number">12</span> Software used</h2>
<p>The <code>grateful</code> package is a nice way to give credit to the packages used in making the analysis. The package can create both a bibliography file and a table object, which is handy for automatically creating a reference list based on the packages used (or at least explicitly loaded).</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb130"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://pakillo.github.io/grateful/">grateful</a></span><span class="op">)</span></span>
<span><span class="va">pkgs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://pakillo.github.io/grateful/reference/cite_packages.html">cite_packages</a></span><span class="op">(</span>cite.tidyverse <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>                      output <span class="op">=</span> <span class="st">"table"</span>,</span>
<span>                      bib.file <span class="op">=</span> <span class="st">"grateful-refs.bib"</span>,</span>
<span>                      include.RStudio <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                      out.dir <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/getwd.html">getwd</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># If kbl() is used to generate this table, the references will not be added to the Reference list.</span></span>
<span><span class="fu"><a href="https://renkun-ken.github.io/formattable/reference/formattable.html">formattable</a></span><span class="op">(</span><span class="va">pkgs</span>, </span>
<span>            table.attr <span class="op">=</span> <span class="st">'class=\"table table-striped\" style="font-size: 13px; font-family: Lato; width: 80%"'</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table class="table table-striped" style="font-size: 13px; font-family: Lato; width: 80%">
<thead><tr>
<th style="text-align:right;">
Package
</th>
<th style="text-align:right;">
Version
</th>
<th style="text-align:right;">
Citation
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:right;">
base
</td>
<td style="text-align:right;">
4.5.2
</td>
<td style="text-align:right;">
<span class="citation" data-cites="base">R Core Team (<a href="#ref-base" role="doc-biblioref">2025</a>)</span>
</td>
</tr>
<tr>
<td style="text-align:right;">
car
</td>
<td style="text-align:right;">
3.1.3
</td>
<td style="text-align:right;">
<span class="citation" data-cites="car">Fox &amp; Weisberg (<a href="#ref-car" role="doc-biblioref">2019</a>)</span>
</td>
</tr>
<tr>
<td style="text-align:right;">
easyRasch
</td>
<td style="text-align:right;">
0.4.1.3
</td>
<td style="text-align:right;">
<span class="citation" data-cites="easyRasch">Johansson (<a href="#ref-easyRasch" role="doc-biblioref">2025b</a>)</span>
</td>
</tr>
<tr>
<td style="text-align:right;">
eRm
</td>
<td style="text-align:right;">
1.0.10
</td>
<td style="text-align:right;">
<span class="citation" data-cites="eRm2007a">Mair &amp; Hatzinger (<a href="#ref-eRm2007a" role="doc-biblioref">2007b</a>)</span>; <span class="citation" data-cites="eRm2007b">Mair &amp; Hatzinger (<a href="#ref-eRm2007b" role="doc-biblioref">2007a</a>)</span>; <span class="citation" data-cites="eRm2009c">Hatzinger &amp; Rusch (<a href="#ref-eRm2009c" role="doc-biblioref">2009</a>)</span>; <span class="citation" data-cites="eRm2013d">Rusch et al. (<a href="#ref-eRm2013d" role="doc-biblioref">2013</a>)</span>; <span class="citation" data-cites="eRm2015e">Koller et al. (<a href="#ref-eRm2015e" role="doc-biblioref">2015</a>)</span>; <span class="citation" data-cites="eRm2019f">Debelak &amp; Koller (<a href="#ref-eRm2019f" role="doc-biblioref">2019</a>)</span>
</td>
</tr>
<tr>
<td style="text-align:right;">
foreach
</td>
<td style="text-align:right;">
1.5.2
</td>
<td style="text-align:right;">
<span class="citation" data-cites="foreach">Microsoft &amp; Weston (<a href="#ref-foreach" role="doc-biblioref">2022</a>)</span>
</td>
</tr>
<tr>
<td style="text-align:right;">
formattable
</td>
<td style="text-align:right;">
0.2.1
</td>
<td style="text-align:right;">
<span class="citation" data-cites="formattable">Ren &amp; Russell (<a href="#ref-formattable" role="doc-biblioref">2021</a>)</span>
</td>
</tr>
<tr>
<td style="text-align:right;">
ggrepel
</td>
<td style="text-align:right;">
0.9.6
</td>
<td style="text-align:right;">
<span class="citation" data-cites="ggrepel">Slowikowski (<a href="#ref-ggrepel" role="doc-biblioref">2024</a>)</span>
</td>
</tr>
<tr>
<td style="text-align:right;">
glue
</td>
<td style="text-align:right;">
1.8.0
</td>
<td style="text-align:right;">
<span class="citation" data-cites="glue">Hester &amp; Bryan (<a href="#ref-glue" role="doc-biblioref">2024</a>)</span>
</td>
</tr>
<tr>
<td style="text-align:right;">
gtsummary
</td>
<td style="text-align:right;">
2.4.0
</td>
<td style="text-align:right;">
<span class="citation" data-cites="gtsummary">Sjoberg et al. (<a href="#ref-gtsummary" role="doc-biblioref">2021</a>)</span>
</td>
</tr>
<tr>
<td style="text-align:right;">
iarm
</td>
<td style="text-align:right;">
0.4.3
</td>
<td style="text-align:right;">
<span class="citation" data-cites="iarm">Mueller (<a href="#ref-iarm" role="doc-biblioref">2022</a>)</span>
</td>
</tr>
<tr>
<td style="text-align:right;">
kableExtra
</td>
<td style="text-align:right;">
1.4.0
</td>
<td style="text-align:right;">
<span class="citation" data-cites="kableExtra">Zhu (<a href="#ref-kableExtra" role="doc-biblioref">2024</a>)</span>
</td>
</tr>
<tr>
<td style="text-align:right;">
knitr
</td>
<td style="text-align:right;">
1.50
</td>
<td style="text-align:right;">
<span class="citation" data-cites="knitr2014">Xie (<a href="#ref-knitr2014" role="doc-biblioref">2014</a>)</span>; <span class="citation" data-cites="knitr2015">Xie (<a href="#ref-knitr2015" role="doc-biblioref">2015</a>)</span>; <span class="citation" data-cites="knitr2025">Xie (<a href="#ref-knitr2025" role="doc-biblioref">2025</a>)</span>
</td>
</tr>
<tr>
<td style="text-align:right;">
lordif
</td>
<td style="text-align:right;">
0.4.2
</td>
<td style="text-align:right;">
<span class="citation" data-cites="lordif">Choi et al. (<a href="#ref-lordif" role="doc-biblioref">2011a</a>)</span>
</td>
</tr>
<tr>
<td style="text-align:right;">
matrixStats
</td>
<td style="text-align:right;">
1.5.0
</td>
<td style="text-align:right;">
<span class="citation" data-cites="matrixStats">Bengtsson (<a href="#ref-matrixStats" role="doc-biblioref">2025</a>)</span>
</td>
</tr>
<tr>
<td style="text-align:right;">
mice
</td>
<td style="text-align:right;">
3.18.0
</td>
<td style="text-align:right;">
<span class="citation" data-cites="mice">van Buuren &amp; Groothuis-Oudshoorn (<a href="#ref-mice" role="doc-biblioref">2011</a>)</span>
</td>
</tr>
<tr>
<td style="text-align:right;">
mirt
</td>
<td style="text-align:right;">
1.45.1
</td>
<td style="text-align:right;">
<span class="citation" data-cites="mirt">Chalmers (<a href="#ref-mirt" role="doc-biblioref">2012</a>)</span>
</td>
</tr>
<tr>
<td style="text-align:right;">
patchwork
</td>
<td style="text-align:right;">
1.3.2
</td>
<td style="text-align:right;">
<span class="citation" data-cites="patchwork">Pedersen (<a href="#ref-patchwork" role="doc-biblioref">2025</a>)</span>
</td>
</tr>
<tr>
<td style="text-align:right;">
PerFit
</td>
<td style="text-align:right;">
1.4.7
</td>
<td style="text-align:right;">
<span class="citation" data-cites="PerFit">Tendeiro et al. (<a href="#ref-PerFit" role="doc-biblioref">2016</a>)</span>
</td>
</tr>
<tr>
<td style="text-align:right;">
psych
</td>
<td style="text-align:right;">
2.5.6
</td>
<td style="text-align:right;">
<span class="citation" data-cites="psych">William Revelle (<a href="#ref-psych" role="doc-biblioref">2025</a>)</span>
</td>
</tr>
<tr>
<td style="text-align:right;">
psychotree
</td>
<td style="text-align:right;">
0.16.2
</td>
<td style="text-align:right;">
<span class="citation" data-cites="psychotree2010e">Trepte &amp; Verbeet (<a href="#ref-psychotree2010e" role="doc-biblioref">2010</a>)</span>; <span class="citation" data-cites="psychotree2011a">Strobl et al. (<a href="#ref-psychotree2011a" role="doc-biblioref">2011</a>)</span>; <span class="citation" data-cites="psychotree2015b">Strobl et al. (<a href="#ref-psychotree2015b" role="doc-biblioref">2015a</a>)</span>; <span class="citation" data-cites="psychotree2018c">Komboz et al. (<a href="#ref-psychotree2018c" role="doc-biblioref">2018</a>)</span>; <span class="citation" data-cites="psychotree2018d">Wickelmaier &amp; Zeileis (<a href="#ref-psychotree2018d" role="doc-biblioref">2018</a>)</span>
</td>
</tr>
<tr>
<td style="text-align:right;">
RASCHplot
</td>
<td style="text-align:right;">
0.1.0
</td>
<td style="text-align:right;">
<span class="citation" data-cites="RASCHplot">Buchardt et al. (<a href="#ref-RASCHplot" role="doc-biblioref">2022</a>)</span>
</td>
</tr>
<tr>
<td style="text-align:right;">
reshape
</td>
<td style="text-align:right;">
0.8.10
</td>
<td style="text-align:right;">
<span class="citation" data-cites="reshape">Wickham (<a href="#ref-reshape" role="doc-biblioref">2007</a>)</span>
</td>
</tr>
<tr>
<td style="text-align:right;">
rmarkdown
</td>
<td style="text-align:right;">
2.30
</td>
<td style="text-align:right;">
<span class="citation" data-cites="rmarkdown2018">Xie et al. (<a href="#ref-rmarkdown2018" role="doc-biblioref">2018</a>)</span>; <span class="citation" data-cites="rmarkdown2020">Xie et al. (<a href="#ref-rmarkdown2020" role="doc-biblioref">2020</a>)</span>; <span class="citation" data-cites="rmarkdown2025">Allaire et al. (<a href="#ref-rmarkdown2025" role="doc-biblioref">2025</a>)</span>
</td>
</tr>
<tr>
<td style="text-align:right;">
tidyverse
</td>
<td style="text-align:right;">
2.0.0
</td>
<td style="text-align:right;">
<span class="citation" data-cites="tidyverse">Wickham et al. (<a href="#ref-tidyverse" role="doc-biblioref">2019</a>)</span>
</td>
</tr>
</tbody>
</table>
</div>
</div>
</section><section id="additional-credits" class="level2" data-number="13"><h2 data-number="13" class="anchored" data-anchor-id="additional-credits">
<span class="header-section-number">13</span> Additional credits</h2>
<p>Thanks to my <a href="https://www.ri.se/en/what-we-do/projects/center-for-category-based-measurements">colleagues at RISE</a> for providing feedback and testing the package on Windows and MacOS platforms. Also, thanks to <a href="https://www.winsteps.com/linacre.htm">Mike Linacre</a> and <a href="https://www.ri.se/en/person/jeanette-melin">Jeanette Melin</a> for providing useful feedback to improve this vignette.</p>
</section><section id="session-info" class="level2" data-number="14"><h2 data-number="14" class="anchored" data-anchor-id="session-info">
<span class="header-section-number">14</span> Session info</h2>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb131"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>R version 4.5.2 (2025-10-31)
Platform: aarch64-apple-darwin20
Running under: macOS Tahoe 26.1

Matrix products: default
BLAS:   /System/Library/Frameworks/Accelerate.framework/Versions/A/Frameworks/vecLib.framework/Versions/A/libBLAS.dylib 
LAPACK: /Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/lib/libRlapack.dylib;  LAPACK version 3.12.1

locale:
[1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8

time zone: Europe/Stockholm
tzcode source: internal

attached base packages:
 [1] parallel  grid      stats4    stats     graphics  grDevices utils    
 [8] datasets  methods   base     

other attached packages:
 [1] PerFit_1.4.7      ltm_1.2-0         polycor_0.8-1     msm_1.8.2        
 [5] MASS_7.3-65       lordif_0.4.2      doSNOW_1.0.20     snow_0.4-4       
 [9] rms_8.1-0         Hmisc_5.2-4       RASCHplot_0.1.0   knitr_1.50       
[13] readxl_1.4.5      car_3.1-3         carData_3.0-5     grateful_0.3.0   
[17] easyRasch_0.4.1.3 Bayesrel_0.7.8    doParallel_1.0.17 iterators_1.0.14 
[21] furrr_0.3.1       future_1.67.0     foreach_1.5.2     ggdist_3.3.3     
[25] janitor_2.2.1     iarm_0.4.3        hexbin_1.28.5     catR_3.17        
[29] glue_1.8.0        ggrepel_0.9.6     patchwork_1.3.2   reshape_0.8.10   
[33] matrixStats_1.5.0 psychotree_0.16-2 psychotools_0.7-5 partykit_1.2-24  
[37] mvtnorm_1.3-3     libcoin_1.0-10    psych_2.5.6       mirt_1.45.1      
[41] lattice_0.22-7    eRm_1.0-10        lubridate_1.9.4   forcats_1.0.1    
[45] stringr_1.6.0     dplyr_1.1.4       purrr_1.2.0       readr_2.1.5      
[49] tidyr_1.3.1       tibble_3.3.0      ggplot2_4.0.0     tidyverse_2.0.0  
[53] kableExtra_1.4.0  formattable_0.2.1

loaded via a namespace (and not attached):
  [1] bitops_1.0-9         RColorBrewer_1.1-3   tools_4.5.2         
  [4] backports_1.5.0      R6_2.6.1             DT_0.34.0           
  [7] vegan_2.7-2          sm_2.2-6.0           mgcv_1.9-3          
 [10] permute_0.9-8        withr_3.0.2          gridExtra_2.3       
 [13] progressr_0.17.0     quantreg_6.1         cli_3.6.5           
 [16] textshaping_1.0.4    sandwich_3.1-1       S7_0.2.0            
 [19] polspline_1.1.25     pbapply_1.7-4        systemfonts_1.3.1   
 [22] foreign_0.8-90       relimp_1.0-5         svglite_2.2.2       
 [25] R.utils_2.13.0       parallelly_1.45.1    sessioninfo_1.2.3   
 [28] rstudioapi_0.17.1    generics_0.1.4       distributional_0.5.0
 [31] qvcalc_1.0.4         Matrix_1.7-4         clipr_0.8.0         
 [34] abind_1.4-8          R.methodsS3_1.8.2    lifecycle_1.0.4     
 [37] multcomp_1.4-29      yaml_2.3.10          snakecase_0.11.1    
 [40] inum_1.0-5           ggstance_0.3.7       promises_1.5.0      
 [43] irtoys_0.2.2         pillar_1.11.1        fda_6.3.0           
 [46] vcdExtra_0.8-6       future.apply_1.20.0  admisc_0.39         
 [49] codetools_0.2-20     beepr_2.0            data.table_1.17.8   
 [52] vcd_1.4-13           vctrs_0.6.5          Rdpack_2.6.4        
 [55] testthat_3.2.3       cellranger_1.1.0     gtable_0.3.6        
 [58] cachem_1.1.0         ks_1.15.1            xfun_0.54           
 [61] rbibutils_2.3        mime_0.13            fds_1.8             
 [64] pracma_2.4.6         pcaPP_2.0-5          survival_3.8-3      
 [67] audio_0.1-11         TH.data_1.1-4        nlme_3.1-168        
 [70] rprojroot_2.1.1      Deriv_4.2.0          KernSmooth_2.23-26  
 [73] otel_0.2.0           rpart_4.1.24         colorspace_2.1-2    
 [76] gnm_1.1-5            nnet_7.3-20          mnormt_2.1.1        
 [79] tidyselect_1.2.1     compiler_4.5.2       htmlTable_2.4.3     
 [82] SparseM_1.84-2       expm_1.0-0           xml2_1.4.1          
 [85] checkmate_2.3.3      scales_1.4.0         lmtest_0.9-40       
 [88] digest_0.6.37        rainbow_3.8          rmarkdown_2.30      
 [91] ca_0.71.1            htmltools_0.5.8.1    pkgconfig_2.0.3     
 [94] base64enc_0.1-3      SimDesign_2.21       fastmap_1.2.0       
 [97] rlang_1.1.6          htmlwidgets_1.6.4    shiny_1.11.1        
[100] farver_2.1.2         zoo_1.8-14           jsonlite_2.0.0      
[103] mclust_6.1.2         dcurver_0.9.3        R.oo_1.27.1         
[106] RCurl_1.98-1.17      magrittr_2.0.4       Formula_1.2-5       
[109] Rcpp_1.1.0           stringi_1.8.7        brio_1.1.5          
[112] plyr_1.8.9           listenv_0.10.0       splines_4.5.2       
[115] hms_1.1.4            ggpubr_0.6.2         ggsignif_0.6.4      
[118] reshape2_1.4.4       GPArotation_2025.3-1 evaluate_1.0.5      
[121] renv_1.1.5           deSolve_1.40         tzdb_0.5.0          
[124] httpuv_1.6.16        MatrixModels_0.5-4   broom_1.0.10        
[127] xtable_1.8-4         rstatix_0.7.3        later_1.4.4         
[130] viridisLite_0.4.2    memoise_2.0.1        cluster_2.1.8.1     
[133] corrplot_0.95        timechange_0.3.0     globals_0.18.0      
[136] hdrcde_3.4           here_1.0.2          </code></pre>
</div>
</div>
</section><section id="references" class="level2" data-number="15">


<!-- -->


</section><div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">
15 References</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" data-line-spacing="2" role="list">
<div id="ref-rmarkdown2025" class="csl-entry" role="listitem">
Allaire, J., Xie, Y., Dervieux, C., McPherson, J., Luraschi, J., Ushey, K., Atkins, A., Wickham, H., Cheng, J., Chang, W., &amp; Iannone, R. (2025). <em><span class="nocase">rmarkdown</span>: Dynamic documents for r</em>. <a href="https://github.com/rstudio/rmarkdown">https://github.com/rstudio/rmarkdown</a>
</div>
<div id="ref-andersen_goodness_1973" class="csl-entry" role="listitem">
Andersen, E. B. (1973). A goodness of fit test for the rasch model. <em>Psychometrika</em>, <em>38</em>(1), 123–140. <a href="https://doi.org/10.1007/BF02291180">https://doi.org/10.1007/BF02291180</a>
</div>
<div id="ref-anvari2022" class="csl-entry" role="listitem">
Anvari, F., Efendić, E., Olsen, J., Arslan, R. C., Elson, M., &amp; Schneider, I. K. (2022). Bias in Self-Reports: An Initial Elevation Phenomenon. <em>Social Psychological and Personality Science</em>, 19485506221129160. <a href="https://doi.org/10.1177/19485506221129160">https://doi.org/10.1177/19485506221129160</a>
</div>
<div id="ref-artner_simulation_2016" class="csl-entry" role="listitem">
Artner, R. (2016). A simulation study of person-fit in the <span>Rasch</span> model. <em>Psychological Test and Assessment Modeling</em>, <em>58</em>(3), 531–563.
</div>
<div id="ref-matrixStats" class="csl-entry" role="listitem">
Bengtsson, H. (2025). <em><span class="nocase">matrixStats</span>: Functions that apply to rows and columns of matrices (and to vectors)</em>. <a href="https://doi.org/10.32614/CRAN.package.matrixStats">https://doi.org/10.32614/CRAN.package.matrixStats</a>
</div>
<div id="ref-bignardi_general_2025" class="csl-entry" role="listitem">
Bignardi, G., Kievit, R., &amp; Bürkner, P.-C. (2025). <em>A general method for estimating reliability using <span>Bayesian</span> <span>Measurement</span> <span>Uncertainty</span></em>. OSF. <a href="https://doi.org/10.31234/osf.io/h54k8_v1">https://doi.org/10.31234/osf.io/h54k8_v1</a>
</div>
<div id="ref-bjorner_differential_1998" class="csl-entry" role="listitem">
Bjorner, J. B., Kreiner, S., Ware, J. E., Damsgaard, M. T., &amp; Bech, P. (1998). Differential <span>Item</span> <span>Functioning</span> in the <span>Danish</span> <span>Translation</span> of the <span>SF</span>-36. <em>Journal of Clinical Epidemiology</em>, <em>51</em>(11), 1189–1202. <a href="https://doi.org/10.1016/S0895-4356(98)00111-5">https://doi.org/10.1016/S0895-4356(98)00111-5</a>
</div>
<div id="ref-buchardt_visualizing_2023" class="csl-entry" role="listitem">
Buchardt, A.-S., Christensen, K. B., &amp; Jensen, N. (2023). Visualizing <span>Rasch</span> item fit using conditional item characteristic curves in <span>R</span>. <em>Psychological Test and Assessment Modeling</em>, <em>65</em>(2), 206–219.
</div>
<div id="ref-RASCHplot" class="csl-entry" role="listitem">
Buchardt, A.-S., Jensen, S. N., &amp; Christensen, K. B. (2022). <em><span>RASCHplot</span>: Visualisation tool for validity of rasch models</em>. <a href="https://github.com/ERRTG/RASCHplot">https://github.com/ERRTG/RASCHplot</a>
</div>
<div id="ref-mirt" class="csl-entry" role="listitem">
Chalmers, R. P. (2012). <span class="nocase">mirt</span>: A multidimensional item response theory package for the <span>R</span> environment. <em>Journal of Statistical Software</em>, <em>48</em>(6), 1–29. <a href="https://doi.org/10.18637/jss.v048.i06">https://doi.org/10.18637/jss.v048.i06</a>
</div>
<div id="ref-chalmers_it_2016" class="csl-entry" role="listitem">
Chalmers, R. P., Counsell, A., &amp; Flora, D. B. (2016). It <span>Might</span> <span>Not</span> <span>Make</span> a <span>Big</span> <span>DIF</span>: <span>Improved</span> <span>Differential</span> <span>Test</span> <span>Functioning</span> <span>Statistics</span> <span>That</span> <span>Account</span> for <span>Sampling</span> <span>Variability</span>. <em>Educational and Psychological Measurement</em>, <em>76</em>(1), 114–140. <a href="https://doi.org/10.1177/0013164415584576">https://doi.org/10.1177/0013164415584576</a>
</div>
<div id="ref-chen_local_1997" class="csl-entry" role="listitem">
Chen, W.-H., &amp; Thissen, D. (1997). Local <span>Dependence</span> <span>Indexes</span> for <span>Item</span> <span>Pairs</span> <span>Using</span> <span>Item</span> <span>Response</span> <span>Theory</span>. <em>Journal of Educational and Behavioral Statistics</em>, <em>22</em>(3), 265–289. <a href="https://doi.org/10.2307/1165285">https://doi.org/10.2307/1165285</a>
</div>
<div id="ref-lordif" class="csl-entry" role="listitem">
Choi, S. W., Gibbons, L. E., &amp; Crane, P. K. (2011a). <span class="nocase">lordif</span>: An r package for detecting differential item functioning using iterative hybrid ordinal logistic regression/item response theory and monte carlo simulations. <em>Journal of Statistical Software</em>. <a href="https://doi.org/10.18637/jss.v039.i08">https://doi.org/10.18637/jss.v039.i08</a>
</div>
<div id="ref-choi_lordif_2011" class="csl-entry" role="listitem">
Choi, S. W., Gibbons, L. E., &amp; Crane, P. K. (2011b). Lordif: <span>An</span> <span>R</span> <span>Package</span> for <span>Detecting</span> <span>Differential</span> <span>Item</span> <span>Functioning</span> <span>Using</span> <span>Iterative</span> <span>Hybrid</span> <span>Ordinal</span> <span>Logistic</span> <span>Regression</span>/<span>Item</span> <span>Response</span> <span>Theory</span> and <span>Monte</span> <span>Carlo</span> <span>Simulations</span>. <em>Journal of Statistical Software</em>, <em>39</em>(1), 1–30. <a href="https://doi.org/10.18637/jss.v039.i08">https://doi.org/10.18637/jss.v039.i08</a>
</div>
<div id="ref-chou_checking_2010" class="csl-entry" role="listitem">
Chou, Y.-T., &amp; Wang, W.-C. (2010). Checking <span>Dimensionality</span> in <span>Item</span> <span>Response</span> <span>Models</span> <span>With</span> <span>Principal</span> <span>Component</span> <span>Analysis</span> on <span>Standardized</span> <span>Residuals</span>. <em>Educational and Psychological Measurement</em>, <em>70</em>(5), 717–731. <a href="https://doi.org/10.1177/0013164410379322">https://doi.org/10.1177/0013164410379322</a>
</div>
<div id="ref-christensen_rasch_2013" class="csl-entry" role="listitem">
Christensen, K. B., Kreiner, S., &amp; Mesbah, M. (Eds.). (2013). <em>Rasch models in health</em>. ISTE ; John Wiley &amp; Sons.
</div>
<div id="ref-christensen2017" class="csl-entry" role="listitem">
Christensen, K. B., Makransky, G., &amp; Horton, M. (2017). Critical Values for Yen<span>’</span>s Q3: Identification of Local Dependence in the Rasch Model Using Residual Correlations. <em>Applied Psychological Measurement</em>, <em>41</em>(3), 178–194. <a href="https://doi.org/10.1177/0146621616677520">https://doi.org/10.1177/0146621616677520</a>
</div>
<div id="ref-eRm2019f" class="csl-entry" role="listitem">
Debelak, R., &amp; Koller, I. (2019). Testing the local independence assumption of the rasch model with Q3-based nonparametric model tests. <em>Applied Psychological Measurement</em>, <em>44</em>. <a href="https://doi.org/10.1177/0146621619835501">https://doi.org/10.1177/0146621619835501</a>
</div>
<div id="ref-edwards_diagnostic_2018" class="csl-entry" role="listitem">
Edwards, M. C., Houts, C. R., &amp; Cai, L. (2018). A diagnostic procedure to detect departures from local independence in item response theory models. <em>Psychological Methods</em>, <em>23</em>(1), 138–149. <a href="https://doi.org/10.1037/met0000121">https://doi.org/10.1037/met0000121</a>
</div>
<div id="ref-emons_nonparametric_2008" class="csl-entry" role="listitem">
Emons, W. H. M. (2008). Nonparametric <span>Person</span>-<span>Fit</span> <span>Analysis</span> of <span>Polytomous</span> <span>Item</span> <span>Scores</span>. <em>Applied Psychological Measurement</em>, <em>32</em>(3), 224–247. <a href="https://doi.org/10.1177/0146621607302479">https://doi.org/10.1177/0146621607302479</a>
</div>
<div id="ref-car" class="csl-entry" role="listitem">
Fox, J., &amp; Weisberg, S. (2019). <em>An <span>R</span> companion to applied regression</em> (Third). Sage. <a href="https://www.john-fox.ca/Companion/">https://www.john-fox.ca/Companion/</a>
</div>
<div id="ref-eRm2009c" class="csl-entry" role="listitem">
Hatzinger, R., &amp; Rusch, T. (2009). IRT models with relaxed assumptions in eRm: A manual-like instruction. <em>Psychology Science Quarterly</em>, <em>51</em>.
</div>
<div id="ref-henninger_partial_2024" class="csl-entry" role="listitem">
Henninger, M., Radek, J., Sengewald, M.-A., &amp; Strobl, C. (2024). <em>Partial credit trees meet the partial gamma coefficient for quantifying <span>DIF</span> and <span>DSF</span> in polytomous items</em>. OSF. <a href="https://doi.org/10.31234/osf.io/47sah">https://doi.org/10.31234/osf.io/47sah</a>
</div>
<div id="ref-glue" class="csl-entry" role="listitem">
Hester, J., &amp; Bryan, J. (2024). <em><span class="nocase">glue</span>: Interpreted string literals</em>. <a href="https://doi.org/10.32614/CRAN.package.glue">https://doi.org/10.32614/CRAN.package.glue</a>
</div>
<div id="ref-johansson_detecting_2025" class="csl-entry" role="listitem">
Johansson, M. (2025a). Detecting <span>Item</span> <span>Misfit</span> in <span>Rasch</span> <span>Models</span>. <em>Educational Methods &amp; Psychometrics</em>, <em>3</em>(18). <a href="https://doi.org/10.61186/emp.2025.5">https://doi.org/10.61186/emp.2025.5</a>
</div>
<div id="ref-easyRasch" class="csl-entry" role="listitem">
Johansson, M. (2025b). <em><span class="nocase">easyRasch</span>: Psychometric analysis in r with rasch measurement theory</em>. <a href="https://github.com/pgmj/easyRasch">https://github.com/pgmj/easyRasch</a>
</div>
<div id="ref-eRm2015e" class="csl-entry" role="listitem">
Koller, I., Maier, M., &amp; Hatzinger, R. (2015). An empirical power analysis of quasi-exact tests for the rasch model: Measurement invariance in small samples. <em>Methodology</em>, <em>11</em>. <a href="https://doi.org/10.1027/1614-2241/a000090">https://doi.org/10.1027/1614-2241/a000090</a>
</div>
<div id="ref-psychotree2018c" class="csl-entry" role="listitem">
Komboz, B., Zeileis, A., &amp; Strobl, C. (2018). Tree-based global model tests for polytomous <span>R</span>asch models. <em>Educational and Psychological Measurement</em>, <em>78</em>(1), 128–166. <a href="https://doi.org/10.1177/0013164416664394">https://doi.org/10.1177/0013164416664394</a>
</div>
<div id="ref-kreiner_validity_2007" class="csl-entry" role="listitem">
Kreiner, S. (2007). Validity and objectivity: <span>Reflections</span> on the role and nature of <span>Rasch</span> models. <em>Nordic Psychology</em>, <em>59</em>(3), 268–298. <a href="https://doi.org/10.1027/1901-2276.59.3.268">https://doi.org/10.1027/1901-2276.59.3.268</a>
</div>
<div id="ref-kreiner_note_2011" class="csl-entry" role="listitem">
Kreiner, S. (2011). A <span>Note</span> on <span>Item</span>–<span>Restscore</span> <span>Association</span> in <span>Rasch</span> <span>Models</span>. <em>Applied Psychological Measurement</em>, <em>35</em>(7), 557–561. <a href="https://doi.org/10.1177/0146621611410227">https://doi.org/10.1177/0146621611410227</a>
</div>
<div id="ref-kreiner_specific_2025" class="csl-entry" role="listitem">
Kreiner, S. (2025). On <span>Specific</span> <span>Objectivity</span> and <span>Measurement</span> by <span>Rasch</span> <span>Models</span>: <span>A</span> <span>Statistical</span> <span>Viewpoint</span>. <em>Educational Methods &amp; Psychometrics</em>, <em>3</em>. <a href="https://doi.org/10.61186/emp.2025.7">https://doi.org/10.61186/emp.2025.7</a>
</div>
<div id="ref-kreiner_analysis_2004" class="csl-entry" role="listitem">
Kreiner, S., &amp; Christensen, K. B. (2004). Analysis of <span>Local</span> <span>Dependence</span> and <span>Multidimensionality</span> in <span>Graphical</span> <span>Loglinear</span> <span>Rasch</span> <span>Models</span>. <em>Communications in Statistics - Theory and Methods</em>, <em>33</em>(6), 1239–1276. <a href="https://doi.org/10.1081/STA-120030148">https://doi.org/10.1081/STA-120030148</a>
</div>
<div id="ref-eRm2007b" class="csl-entry" role="listitem">
Mair, P., &amp; Hatzinger, R. (2007a). CML based estimation of extended rasch models with the eRm package in r. <em>Psychology Science</em>, <em>49</em>. <a href="https://doi.org/10.18637/jss.v020.i09">https://doi.org/10.18637/jss.v020.i09</a>
</div>
<div id="ref-eRm2007a" class="csl-entry" role="listitem">
Mair, P., &amp; Hatzinger, R. (2007b). Extended rasch modeling: The eRm package for the application of IRT models in r. <em>Journal of Statistical Software</em>, <em>20</em>. <a href="https://doi.org/10.18637/jss.v020.i09">https://doi.org/10.18637/jss.v020.i09</a>
</div>
<div id="ref-mcneish_thanks_2018" class="csl-entry" role="listitem">
McNeish, D. (2018). Thanks coefficient alpha, we’ll take it from here. <em>Psychological Methods</em>, <em>23</em>(3), 412–433. <a href="https://doi.org/10.1037/met0000144">https://doi.org/10.1037/met0000144</a>
</div>
<div id="ref-mcneish_reliability_2025" class="csl-entry" role="listitem">
McNeish, D., &amp; Dumas, D. (2025). Reliability representativeness: <span>How</span> well does coefficient alpha summarize reliability across the score distribution? <em>Behavior Research Methods</em>, <em>57</em>(3), 93. <a href="https://doi.org/10.3758/s13428-025-02611-8">https://doi.org/10.3758/s13428-025-02611-8</a>
</div>
<div id="ref-foreach" class="csl-entry" role="listitem">
Microsoft, &amp; Weston, S. (2022). <em><span class="nocase">foreach</span>: Provides foreach looping construct</em>. <a href="https://doi.org/10.32614/CRAN.package.foreach">https://doi.org/10.32614/CRAN.package.foreach</a>
</div>
<div id="ref-milanzi_reliability_2015" class="csl-entry" role="listitem">
Milanzi, E., Molenberghs, G., Alonso, A., Verbeke, G., &amp; De Boeck, P. (2015). Reliability measures in item response theory: <span>Manifest</span> versus latent correlation functions. <em>British Journal of Mathematical and Statistical Psychology</em>, <em>68</em>(1), 43–64. <a href="https://doi.org/10.1111/bmsp.12033">https://doi.org/10.1111/bmsp.12033</a>
</div>
<div id="ref-mislevy_randomization-based_1991" class="csl-entry" role="listitem">
Mislevy, R. J. (1991). Randomization-<span>Based</span> <span>Inference</span> about <span>Latent</span> <span>Variables</span> from <span>Complex</span> <span>Samples</span>. <em>Psychometrika</em>, <em>56</em>(2), 177–196. <a href="https://doi.org/10.1007/BF02294457">https://doi.org/10.1007/BF02294457</a>
</div>
<div id="ref-iarm" class="csl-entry" role="listitem">
Mueller, M. (2022). <em><span class="nocase">iarm</span>: Item analysis in rasch models</em>. <a href="https://doi.org/10.32614/CRAN.package.iarm">https://doi.org/10.32614/CRAN.package.iarm</a>
</div>
<div id="ref-mueller_iarm_2022" class="csl-entry" role="listitem">
Mueller, M., &amp; Santiago, P. H. R. (2022). <em>Iarm: <span>Item</span> <span>Analysis</span> in <span>Rasch</span> <span>Models</span></em>. <a href="https://cran.r-project.org/web/packages/iarm/index.html">https://cran.r-project.org/web/packages/iarm/index.html</a>
</div>
<div id="ref-muller_item_2020" class="csl-entry" role="listitem">
Müller, M. (2020). Item fit statistics for <span>Rasch</span> analysis: Can we trust them? <em>Journal of Statistical Distributions and Applications</em>, <em>7</em>(1), 5. <a href="https://doi.org/10.1186/s40488-020-00108-7">https://doi.org/10.1186/s40488-020-00108-7</a>
</div>
<div id="ref-ostini_polytomous_2006" class="csl-entry" role="listitem">
Ostini, R., &amp; Nering, M. (2006). <em>Polytomous <span>Item</span> <span>Response</span> <span>Theory</span> <span>Models</span></em>. SAGE Publications, Inc. <a href="https://doi.org/10.4135/9781412985413">https://doi.org/10.4135/9781412985413</a>
</div>
<div id="ref-patchwork" class="csl-entry" role="listitem">
Pedersen, T. L. (2025). <em><span class="nocase">patchwork</span>: The composer of plots</em>. <a href="https://doi.org/10.32614/CRAN.package.patchwork">https://doi.org/10.32614/CRAN.package.patchwork</a>
</div>
<div id="ref-base" class="csl-entry" role="listitem">
R Core Team. (2025). <em><span>R</span>: A language and environment for statistical computing</em>. R Foundation for Statistical Computing. <a href="https://www.R-project.org/">https://www.R-project.org/</a>
</div>
<div id="ref-formattable" class="csl-entry" role="listitem">
Ren, K., &amp; Russell, K. (2021). <em><span class="nocase">formattable</span>: Create <span>“<span>Formattable</span>”</span> data structures</em>. <a href="https://doi.org/10.32614/CRAN.package.formattable">https://doi.org/10.32614/CRAN.package.formattable</a>
</div>
<div id="ref-robitzsch_comprehensive_2021" class="csl-entry" role="listitem">
Robitzsch, A. (2021). A <span>Comprehensive</span> <span>Simulation</span> <span>Study</span> of <span>Estimation</span> <span>Methods</span> for the <span>Rasch</span> <span>Model</span>. <em>Stats</em>, <em>4</em>(4), 814–836. <a href="https://doi.org/10.3390/stats4040048">https://doi.org/10.3390/stats4040048</a>
</div>
<div id="ref-eRm2013d" class="csl-entry" role="listitem">
Rusch, T., Maier, M., &amp; Hatzinger, R. (2013). Linear logistic models with relaxed assumptions in r. In B. Lausen, D. van den Poel, &amp; A. Ultsch (Eds.), <em>Algorithms from and for nature and life</em>. Springer. <a href="https://doi.org/10.1007/978-3-319-00035-0_34">https://doi.org/10.1007/978-3-319-00035-0_34</a>
</div>
<div id="ref-sijtsma_use_2008" class="csl-entry" role="listitem">
Sijtsma, K. (2008). On the <span>Use</span>, the <span>Misuse</span>, and the <span>Very</span> <span>Limited</span> <span>Usefulness</span> of&nbsp;<span>Cronbach</span>’s <span>Alpha</span>. <em>Psychometrika</em>, <em>74</em>(1), 107. <a href="https://doi.org/10.1007/s11336-008-9101-0">https://doi.org/10.1007/s11336-008-9101-0</a>
</div>
<div id="ref-gtsummary" class="csl-entry" role="listitem">
Sjoberg, D. D., Whiting, K., Curry, M., Lavery, J. A., &amp; Larmarange, J. (2021). Reproducible summary tables with the gtsummary package. <em><span>The R Journal</span></em>, <em>13</em>, 570–580. <a href="https://doi.org/10.32614/RJ-2021-053">https://doi.org/10.32614/RJ-2021-053</a>
</div>
<div id="ref-ggrepel" class="csl-entry" role="listitem">
Slowikowski, K. (2024). <em><span class="nocase">ggrepel</span>: Automatically position non-overlapping text labels with <span>“<span class="nocase">ggplot2</span>”</span></em>. <a href="https://doi.org/10.32614/CRAN.package.ggrepel">https://doi.org/10.32614/CRAN.package.ggrepel</a>
</div>
<div id="ref-smith_detecting_2002" class="csl-entry" role="listitem">
Smith, E. V. (2002). <a href="https://www.ncbi.nlm.nih.gov/pubmed/12011501">Detecting and evaluating the impact of multidimensionality using item fit statistics and principal component analysis of residuals</a>. <em>Journal of Applied Measurement</em>, <em>3</em>(2), 205–231.
</div>
<div id="ref-psychotree2015b" class="csl-entry" role="listitem">
Strobl, C., Kopf, J., &amp; Zeileis, A. (2015a). Rasch trees: A new method for detecting differential item functioning in the <span>R</span>asch model. <em>Psychometrika</em>, <em>80</em>(2), 289–316. <a href="https://doi.org/10.1007/s11336-013-9388-3">https://doi.org/10.1007/s11336-013-9388-3</a>
</div>
<div id="ref-strobl2015" class="csl-entry" role="listitem">
Strobl, C., Kopf, J., &amp; Zeileis, A. (2015b). Rasch Trees: A New Method for Detecting Differential Item Functioning in the Rasch Model. <em>Psychometrika</em>, <em>80</em>(2), 289–316. <a href="https://doi.org/10.1007/s11336-013-9388-3">https://doi.org/10.1007/s11336-013-9388-3</a>
</div>
<div id="ref-strobl2021" class="csl-entry" role="listitem">
Strobl, C., Schneider, L., Kopf, J., &amp; Zeileis, A. (2021). <em>Using the raschtree function for detecting differential item functioning in the Rasch model</em>. 12.
</div>
<div id="ref-psychotree2011a" class="csl-entry" role="listitem">
Strobl, C., Wickelmaier, F., &amp; Zeileis, A. (2011). Accounting for individual differences in <span>B</span>radley-<span>T</span>erry models by means of recursive partitioning. <em>Journal of Educational and Behavioral Statistics</em>, <em>36</em>(2), 135–153. <a href="https://doi.org/10.3102/1076998609359791">https://doi.org/10.3102/1076998609359791</a>
</div>
<div id="ref-PerFit" class="csl-entry" role="listitem">
Tendeiro, J. N., Meijer, R. R., &amp; Niessen, A. S. M. (2016). <span>PerFit</span>: An <span>R</span> package for person-fit analysis in <span>IRT</span>. <em>Journal of Statistical Software</em>, <em>74</em>(5), 1–27. <a href="https://doi.org/10.18637/jss.v074.i05">https://doi.org/10.18637/jss.v074.i05</a>
</div>
<div id="ref-thissen_review_2025" class="csl-entry" role="listitem">
Thissen, D. (2025). A <span>Review</span> of <span>Some</span> of the <span>History</span> of <span>Factorial</span> <span>Invariance</span> and <span>Differential</span> <span>Item</span> <span>Functioning</span>. <em>Multivariate Behavioral Research</em>, <em>60</em>(2), 211–235. <a href="https://doi.org/10.1080/00273171.2024.2396148">https://doi.org/10.1080/00273171.2024.2396148</a>
</div>
<div id="ref-psychotree2010e" class="csl-entry" role="listitem">
Trepte, S., &amp; Verbeet, M. (Eds.). (2010). <em><span>A</span>llgemeinbildung in <span>D</span>eutschland – erkenntnisse aus dem <span>SPIEGEL</span> <span>S</span>tudentenpisa-<span>T</span>est</em>. VS Verlag. <a href="https://doi.org/10.1007/978-3-531-92543-1">https://doi.org/10.1007/978-3-531-92543-1</a>
</div>
<div id="ref-mice" class="csl-entry" role="listitem">
van Buuren, S., &amp; Groothuis-Oudshoorn, K. (2011). <span class="nocase">mice</span>: Multivariate imputation by chained equations in r. <em>Journal of Statistical Software</em>, <em>45</em>(3), 1–67. <a href="https://doi.org/10.18637/jss.v045.i03">https://doi.org/10.18637/jss.v045.i03</a>
</div>
<div id="ref-warm1989" class="csl-entry" role="listitem">
Warm, T. A. (1989). Weighted likelihood estimation of ability in item response theory. <em>Psychometrika</em>, <em>54</em>(3), 427–450. <a href="https://doi.org/10.1007/BF02294627">https://doi.org/10.1007/BF02294627</a>
</div>
<div id="ref-psychotree2018d" class="csl-entry" role="listitem">
Wickelmaier, F., &amp; Zeileis, A. (2018). Using recursive partitioning to account for parameter heterogeneity in multinomial processing tree models. <em>Behavior Research Methods</em>, <em>50</em>(3), 1217–1233. <a href="https://doi.org/10.3758/s13428-017-0937-z">https://doi.org/10.3758/s13428-017-0937-z</a>
</div>
<div id="ref-reshape" class="csl-entry" role="listitem">
Wickham, H. (2007). Reshaping data with the reshape package. <em>Journal of Statistical Software</em>, <em>21</em>(12). <a href="https://www.jstatsoft.org/v21/i12/">https://www.jstatsoft.org/v21/i12/</a>
</div>
<div id="ref-tidyverse" class="csl-entry" role="listitem">
Wickham, H., Averick, M., Bryan, J., Chang, W., McGowan, L. D., François, R., Grolemund, G., Hayes, A., Henry, L., Hester, J., Kuhn, M., Pedersen, T. L., Miller, E., Bache, S. M., Müller, K., Ooms, J., Robinson, D., Seidel, D. P., Spinu, V., … Yutani, H. (2019). Welcome to the <span class="nocase">tidyverse</span>. <em>Journal of Open Source Software</em>, <em>4</em>(43), 1686. <a href="https://doi.org/10.21105/joss.01686">https://doi.org/10.21105/joss.01686</a>
</div>
<div id="ref-psych" class="csl-entry" role="listitem">
William Revelle. (2025). <em><span class="nocase">psych</span>: Procedures for psychological, psychometric, and personality research</em>. Northwestern University. <a href="https://CRAN.R-project.org/package=psych">https://CRAN.R-project.org/package=psych</a>
</div>
<div id="ref-wu_role_2005" class="csl-entry" role="listitem">
Wu, M. (2005). The role of plausible values in large-scale surveys. <em>Studies in Educational Evaluation</em>, <em>31</em>(2-3), 114–128. <a href="https://doi.org/10.1016/j.stueduc.2005.05.005">https://doi.org/10.1016/j.stueduc.2005.05.005</a>
</div>
<div id="ref-knitr2014" class="csl-entry" role="listitem">
Xie, Y. (2014). <span class="nocase">knitr</span>: A comprehensive tool for reproducible research in <span>R</span>. In V. Stodden, F. Leisch, &amp; R. D. Peng (Eds.), <em>Implementing reproducible computational research</em>. Chapman; Hall/CRC.
</div>
<div id="ref-knitr2015" class="csl-entry" role="listitem">
Xie, Y. (2015). <em>Dynamic documents with <span>R</span> and knitr</em> (2nd ed.). Chapman; Hall/CRC. <a href="https://yihui.org/knitr/">https://yihui.org/knitr/</a>
</div>
<div id="ref-knitr2025" class="csl-entry" role="listitem">
Xie, Y. (2025). <em><span class="nocase">knitr</span>: A general-purpose package for dynamic report generation in <span>R</span></em>. <a href="https://yihui.org/knitr/">https://yihui.org/knitr/</a>
</div>
<div id="ref-rmarkdown2018" class="csl-entry" role="listitem">
Xie, Y., Allaire, J. J., &amp; Grolemund, G. (2018). <em>R markdown: The definitive guide</em>. Chapman; Hall/CRC. <a href="https://bookdown.org/yihui/rmarkdown">https://bookdown.org/yihui/rmarkdown</a>
</div>
<div id="ref-rmarkdown2020" class="csl-entry" role="listitem">
Xie, Y., Dervieux, C., &amp; Riederer, E. (2020). <em>R markdown cookbook</em>. Chapman; Hall/CRC. <a href="https://bookdown.org/yihui/rmarkdown-cookbook">https://bookdown.org/yihui/rmarkdown-cookbook</a>
</div>
<div id="ref-kableExtra" class="csl-entry" role="listitem">
Zhu, H. (2024). <em><span class="nocase">kableExtra</span>: Construct complex table with <span>“<span class="nocase">kable</span>”</span> and pipe syntax</em>. <a href="https://doi.org/10.32614/CRAN.package.kableExtra">https://doi.org/10.32614/CRAN.package.kableExtra</a>
</div>
</div></section><section class="quarto-appendix-contents" id="quarto-reuse"><h2 class="anchored quarto-appendix-heading">Reuse</h2><div class="quarto-appendix-contents"><div><a rel="license" href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a></div></div></section><section class="quarto-appendix-contents" id="quarto-citation"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@online{johansson2025,
  author = {Johansson, Magnus},
  title = {easyRasch Vignette},
  date = {2025-11-06},
  url = {https://pgmj.github.io/raschrvignette/RaschRvign.html},
  langid = {en}
}
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-johansson2025" class="csl-entry quarto-appendix-citeas" role="listitem">
Johansson, M. (2025, November 6). <em>easyRasch vignette</em>. <a href="https://pgmj.github.io/raschrvignette/RaschRvign.html">https://pgmj.github.io/raschrvignette/RaschRvign.html</a>
</div></div></section></div></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
    const viewSource = window.document.getElementById('quarto-view-source') ||
                       window.document.getElementById('quarto-code-tools-source');
    if (viewSource) {
      const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
      viewSource.addEventListener("click", function(e) {
        if (sourceUrl) {
          // rstudio viewer pane
          if (/\bcapabilities=\b/.test(window.location)) {
            window.open(sourceUrl);
          } else {
            window.location.href = sourceUrl;
          }
        } else {
          const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
          modal.show();
        }
        return false;
      });
    }
    function toggleCodeHandler(show) {
      return function(e) {
        const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
        for (let i=0; i<detailsSrc.length; i++) {
          const details = detailsSrc[i].parentElement;
          if (show) {
            details.open = true;
          } else {
            details.removeAttribute("open");
          }
        }
        const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
        const fromCls = show ? "hidden" : "unhidden";
        const toCls = show ? "unhidden" : "hidden";
        for (let i=0; i<cellCodeDivs.length; i++) {
          const codeDiv = cellCodeDivs[i];
          if (codeDiv.classList.contains(fromCls)) {
            codeDiv.classList.remove(fromCls);
            codeDiv.classList.add(toCls);
          } 
        }
        return false;
      }
    }
    const hideAllCode = window.document.getElementById("quarto-hide-all-code");
    if (hideAllCode) {
      hideAllCode.addEventListener("click", toggleCodeHandler(false));
    }
    const showAllCode = window.document.getElementById("quarto-show-all-code");
    if (showAllCode) {
      showAllCode.addEventListener("click", toggleCodeHandler(true));
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/pgmj\.github\.io");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script><input type="hidden" id="giscus-base-theme" value="light"><input type="hidden" id="giscus-alt-theme" value="dark"><script>
  function loadGiscus() {
    // Function to get the theme based on body class
    const getTheme = () => {
      let baseTheme = document.getElementById('giscus-base-theme').value;
      let altTheme = document.getElementById('giscus-alt-theme').value;
      return document.body.classList.contains('quarto-dark') ? altTheme : baseTheme;
    };
    const script = document.createElement("script");
    script.src = "https://giscus.app/client.js";
    script.async = true;
    script.dataset.repo = "pgmj/pgmj.github.io";
    script.dataset.repoId = "R_kgDOGtKrEA";
    script.dataset.category = "General";
    script.dataset.categoryId = "DIC_kwDOGtKrEM4CdX5K";
    script.dataset.mapping = "title";
    script.dataset.reactionsEnabled = "1";
    script.dataset.emitMetadata = "0";
    script.dataset.inputPosition = "top";
    script.dataset.theme = getTheme();
    script.dataset.lang = "en";
    script.crossOrigin = "anonymous";
    // Append the script to the desired div instead of at the end of the body
    document.getElementById("quarto-content").appendChild(script);
  }
  loadGiscus();
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb133" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb133-2"><a href="#cb133-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "easyRasch vignette"</span></span>
<span id="cb133-3"><a href="#cb133-3" aria-hidden="true" tabindex="-1"></a><span class="an">subtitle:</span><span class="co"> "R package for Rasch analysis"</span></span>
<span id="cb133-4"><a href="#cb133-4" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span><span class="co"> </span></span>
<span id="cb133-5"><a href="#cb133-5" aria-hidden="true" tabindex="-1"></a><span class="co">  name: 'Magnus Johansson'</span></span>
<span id="cb133-6"><a href="#cb133-6" aria-hidden="true" tabindex="-1"></a><span class="co">  affiliation: 'RISE Research Institutes of Sweden'</span></span>
<span id="cb133-7"><a href="#cb133-7" aria-hidden="true" tabindex="-1"></a><span class="co">  affiliation-url: 'https://www.ri.se/en/person/magnus-p-johansson'</span></span>
<span id="cb133-8"><a href="#cb133-8" aria-hidden="true" tabindex="-1"></a><span class="co">  orcid: '0000-0003-1669-592X'</span></span>
<span id="cb133-9"><a href="#cb133-9" aria-hidden="true" tabindex="-1"></a><span class="an">date:</span><span class="co"> last-modified</span></span>
<span id="cb133-10"><a href="#cb133-10" aria-hidden="true" tabindex="-1"></a><span class="an">google-scholar:</span><span class="co"> true</span></span>
<span id="cb133-11"><a href="#cb133-11" aria-hidden="true" tabindex="-1"></a><span class="an">citation:</span><span class="co"> true</span></span>
<span id="cb133-12"><a href="#cb133-12" aria-hidden="true" tabindex="-1"></a><span class="an">website:</span></span>
<span id="cb133-13"><a href="#cb133-13" aria-hidden="true" tabindex="-1"></a><span class="co">  open-graph:</span></span>
<span id="cb133-14"><a href="#cb133-14" aria-hidden="true" tabindex="-1"></a><span class="co">    image: "/RaschRvign_files/figure-html/unnamed-chunk-34-1.png"</span></span>
<span id="cb133-15"><a href="#cb133-15" aria-hidden="true" tabindex="-1"></a><span class="an">execute:</span><span class="co"> </span></span>
<span id="cb133-16"><a href="#cb133-16" aria-hidden="true" tabindex="-1"></a><span class="co">  cache: true</span></span>
<span id="cb133-17"><a href="#cb133-17" aria-hidden="true" tabindex="-1"></a><span class="co">  warning: false</span></span>
<span id="cb133-18"><a href="#cb133-18" aria-hidden="true" tabindex="-1"></a><span class="co">  message: false</span></span>
<span id="cb133-19"><a href="#cb133-19" aria-hidden="true" tabindex="-1"></a><span class="an">bibliography:</span><span class="co"> </span></span>
<span id="cb133-20"><a href="#cb133-20" aria-hidden="true" tabindex="-1"></a><span class="co">  - references.bib</span></span>
<span id="cb133-21"><a href="#cb133-21" aria-hidden="true" tabindex="-1"></a><span class="co">  - grateful-refs.bib</span></span>
<span id="cb133-22"><a href="#cb133-22" aria-hidden="true" tabindex="-1"></a><span class="an">csl:</span><span class="co"> apa.csl</span></span>
<span id="cb133-23"><a href="#cb133-23" aria-hidden="true" tabindex="-1"></a><span class="an">editor_options:</span><span class="co"> </span></span>
<span id="cb133-24"><a href="#cb133-24" aria-hidden="true" tabindex="-1"></a><span class="co">  chunk_output_type: console</span></span>
<span id="cb133-25"><a href="#cb133-25" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb133-26"><a href="#cb133-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-27"><a href="#cb133-27" aria-hidden="true" tabindex="-1"></a>This is an introduction to using the <span class="co">[</span><span class="ot">`easyRasch` R package</span><span class="co">](https://pgmj.github.io/easyRasch/)</span>. A changelog for package updates is available <span class="co">[</span><span class="ot">here</span><span class="co">](https://pgmj.github.io/easyRasch/news/index.html)</span>.</span>
<span id="cb133-28"><a href="#cb133-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-29"><a href="#cb133-29" aria-hidden="true" tabindex="-1"></a>::: {.callout-note icon="true"}</span>
<span id="cb133-30"><a href="#cb133-30" aria-hidden="true" tabindex="-1"></a><span class="fu">## Note</span></span>
<span id="cb133-31"><a href="#cb133-31" aria-hidden="true" tabindex="-1"></a>This packages was previously known as <span class="in">`RISEkbmRasch`</span>.</span>
<span id="cb133-32"><a href="#cb133-32" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb133-33"><a href="#cb133-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-34"><a href="#cb133-34" aria-hidden="true" tabindex="-1"></a>Details on package installation are available at the <span class="co">[</span><span class="ot">package GitHub page</span><span class="co">](https://pgmj.github.io/easyRasch)</span>.</span>
<span id="cb133-35"><a href="#cb133-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-36"><a href="#cb133-36" aria-hidden="true" tabindex="-1"></a>If you are new to Rasch Measurement Theory, you may find this intro presentation useful:</span>
<span id="cb133-37"><a href="#cb133-37" aria-hidden="true" tabindex="-1"></a><span class="ot">&lt;https://pgmj.github.io/RaschIRTlecture/slides.html&gt;</span></span>
<span id="cb133-38"><a href="#cb133-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-39"><a href="#cb133-39" aria-hidden="true" tabindex="-1"></a>This vignette will walk through a sample analysis using an open dataset with polytomous questionnaire data. This will include some data wrangling to structure the item data and itemlabels, then provide examples of the different functions. The full source code of this document can be found either <span class="co">[</span><span class="ot">in this repository</span><span class="co">](https://github.com/pgmj/pgmj.github.io/blob/main/raschrvignette/RaschRvign.qmd)</span> or by clicking on **\&lt;/\&gt; CODE** at the top of this page. You should be able to use the source code "as is" and reproduce this document locally, as long as you have the required packages installed. This page and this website are built using the open source publishing tool <span class="co">[</span><span class="ot">Quarto</span><span class="co">](https://www.quarto.org)</span>.</span>
<span id="cb133-40"><a href="#cb133-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-41"><a href="#cb133-41" aria-hidden="true" tabindex="-1"></a>One of the aims with this package is to simplify reproducible psychometric analysis to shed light on the measurement properties of a scale, questionnaire or test. In line with others <span class="co">[</span><span class="ot">@kreiner_validity_2007;@christensen_rasch_2013</span><span class="co">]</span>, I propose that the basic psychometric criteria for a set of items to be used as a measure of a latent variable are:</span>
<span id="cb133-42"><a href="#cb133-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-43"><a href="#cb133-43" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Unidimensionality (for each subscale, if there are multiple)</span>
<span id="cb133-44"><a href="#cb133-44" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Local independence of items</span>
<span id="cb133-45"><a href="#cb133-45" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Ordered response categories</span>
<span id="cb133-46"><a href="#cb133-46" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Invariance (differential item functioning)</span>
<span id="cb133-47"><a href="#cb133-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-48"><a href="#cb133-48" aria-hidden="true" tabindex="-1"></a>And that we should also report information regarding:</span>
<span id="cb133-49"><a href="#cb133-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-50"><a href="#cb133-50" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Targeting</span>
<span id="cb133-51"><a href="#cb133-51" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Measurement uncertainties (reliability)</span>
<span id="cb133-52"><a href="#cb133-52" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Person fit</span>
<span id="cb133-53"><a href="#cb133-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-54"><a href="#cb133-54" aria-hidden="true" tabindex="-1"></a>We'll include several ways to investigate these measurement properties, using Rasch Measurement Theory. There are also functions in the package less directly related to the criteria above, that will be demonstrated in this vignette.</span>
<span id="cb133-55"><a href="#cb133-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-56"><a href="#cb133-56" aria-hidden="true" tabindex="-1"></a>Please note that this is just a sample analysis to showcase the R package. It is not intended as a "best practice" psychometric analysis example.</span>
<span id="cb133-57"><a href="#cb133-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-58"><a href="#cb133-58" aria-hidden="true" tabindex="-1"></a>You can skip ahead to the Rasch analysis part in @sec-rasch if you are eager to look at the package output :)</span>
<span id="cb133-59"><a href="#cb133-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-60"><a href="#cb133-60" aria-hidden="true" tabindex="-1"></a>There is a separate GitHub repository containing a template R-project to simplify using the <span class="in">`easyRasch`</span> package when conducting a reproducible Rasch analysis in R: <span class="ot">&lt;https://github.com/pgmj/RISEraschTemplate&gt;</span></span>
<span id="cb133-61"><a href="#cb133-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-62"><a href="#cb133-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-63"><a href="#cb133-63" aria-hidden="true" tabindex="-1"></a><span class="fu">## Getting started</span></span>
<span id="cb133-64"><a href="#cb133-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-65"><a href="#cb133-65" aria-hidden="true" tabindex="-1"></a>Since the package is intended for use with Quarto, this vignette has also been created with Quarto. A "template" .qmd file <span class="co">[</span><span class="ot">is available</span><span class="co">](https://github.com/pgmj/RISEraschTemplate/blob/main/analysis.qmd)</span> that can be useful to have handy for copy&amp;paste when running a new analysis.  You can also download a complete copy of the Quarto/R code to produce this document <span class="co">[</span><span class="ot">here</span><span class="co">](https://github.com/pgmj/pgmj.github.io/blob/main/raschrvignette/RaschRvign.qmd)</span>.</span>
<span id="cb133-66"><a href="#cb133-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-67"><a href="#cb133-67" aria-hidden="true" tabindex="-1"></a>Loading the <span class="in">`easyRasch`</span> package will automatically load all the packages it depends on. However, it could be desirable to explicitly load all packages used, to simplify the automatic creation of citations for them, using the <span class="in">`grateful`</span> package (see @sec-grateful).</span>
<span id="cb133-68"><a href="#cb133-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-71"><a href="#cb133-71" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb133-72"><a href="#cb133-72" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(easyRasch) <span class="co"># devtools::install_github("pgmj/easyRasch", dependencies = TRUE)</span></span>
<span id="cb133-73"><a href="#cb133-73" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(grateful)</span>
<span id="cb133-74"><a href="#cb133-74" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggrepel)</span>
<span id="cb133-75"><a href="#cb133-75" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)</span>
<span id="cb133-76"><a href="#cb133-76" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra)</span>
<span id="cb133-77"><a href="#cb133-77" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb133-78"><a href="#cb133-78" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb133-79"><a href="#cb133-79" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(eRm)</span>
<span id="cb133-80"><a href="#cb133-80" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(iarm)</span>
<span id="cb133-81"><a href="#cb133-81" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mirt)</span>
<span id="cb133-82"><a href="#cb133-82" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(psych)</span>
<span id="cb133-83"><a href="#cb133-83" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb133-84"><a href="#cb133-84" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(psychotree)</span>
<span id="cb133-85"><a href="#cb133-85" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(matrixStats)</span>
<span id="cb133-86"><a href="#cb133-86" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(reshape)</span>
<span id="cb133-87"><a href="#cb133-87" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb133-88"><a href="#cb133-88" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb133-89"><a href="#cb133-89" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(formattable) </span>
<span id="cb133-90"><a href="#cb133-90" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(glue)</span>
<span id="cb133-91"><a href="#cb133-91" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(foreach)</span>
<span id="cb133-92"><a href="#cb133-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-93"><a href="#cb133-93" aria-hidden="true" tabindex="-1"></a><span class="do">### some commands exist in multiple packages, here we define preferred ones that are frequently used</span></span>
<span id="cb133-94"><a href="#cb133-94" aria-hidden="true" tabindex="-1"></a>select <span class="ot">&lt;-</span> dplyr<span class="sc">::</span>select</span>
<span id="cb133-95"><a href="#cb133-95" aria-hidden="true" tabindex="-1"></a>count <span class="ot">&lt;-</span> dplyr<span class="sc">::</span>count</span>
<span id="cb133-96"><a href="#cb133-96" aria-hidden="true" tabindex="-1"></a>recode <span class="ot">&lt;-</span> car<span class="sc">::</span>recode</span>
<span id="cb133-97"><a href="#cb133-97" aria-hidden="true" tabindex="-1"></a>rename <span class="ot">&lt;-</span> dplyr<span class="sc">::</span>rename</span>
<span id="cb133-98"><a href="#cb133-98" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb133-99"><a href="#cb133-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-100"><a href="#cb133-100" aria-hidden="true" tabindex="-1"></a>::: {.callout-note icon="true"}</span>
<span id="cb133-101"><a href="#cb133-101" aria-hidden="true" tabindex="-1"></a><span class="fu">## Note</span></span>
<span id="cb133-102"><a href="#cb133-102" aria-hidden="true" tabindex="-1"></a>Quarto automatically adds links to R packages and functions throughout this document. However, this feature only works properly for packages available on <span class="co">[</span><span class="ot">CRAN</span><span class="co">](https://cran.r-project.org/)</span>. Since the <span class="in">`easyRasch`</span> package is not on CRAN the links related to functions starting with **RI** will not work.</span>
<span id="cb133-103"><a href="#cb133-103" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb133-104"><a href="#cb133-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-105"><a href="#cb133-105" aria-hidden="true" tabindex="-1"></a><span class="fu">### Loading data</span></span>
<span id="cb133-106"><a href="#cb133-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-107"><a href="#cb133-107" aria-hidden="true" tabindex="-1"></a>We will use data from a recent paper investigating the "initial elevation effect" <span class="co">[</span><span class="ot">@anvari2022</span><span class="co">]</span>, and focus on the 10 negative items from the PANAS. The data is available at the OSF website.</span>
<span id="cb133-108"><a href="#cb133-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-111"><a href="#cb133-111" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb133-112"><a href="#cb133-112" aria-hidden="true" tabindex="-1"></a>df.all <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"https://osf.io/download/6fbr5/"</span>)</span>
<span id="cb133-113"><a href="#cb133-113" aria-hidden="true" tabindex="-1"></a><span class="co"># if you have issues with the link, please try downloading manually using the same URL as above</span></span>
<span id="cb133-114"><a href="#cb133-114" aria-hidden="true" tabindex="-1"></a><span class="co"># and read the file from your local drive.</span></span>
<span id="cb133-115"><a href="#cb133-115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-116"><a href="#cb133-116" aria-hidden="true" tabindex="-1"></a><span class="co"># subset items and demographic variables</span></span>
<span id="cb133-117"><a href="#cb133-117" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df.all <span class="sc">%&gt;%</span> </span>
<span id="cb133-118"><a href="#cb133-118" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">starts_with</span>(<span class="st">"PANASD2_1"</span>),</span>
<span id="cb133-119"><a href="#cb133-119" aria-hidden="true" tabindex="-1"></a>         <span class="fu">starts_with</span>(<span class="st">"PANASD2_20"</span>),</span>
<span id="cb133-120"><a href="#cb133-120" aria-hidden="true" tabindex="-1"></a>         age,Sex,Group) <span class="sc">%&gt;%</span> </span>
<span id="cb133-121"><a href="#cb133-121" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">!</span>PANASD2_10_Active) <span class="sc">%&gt;%</span> </span>
<span id="cb133-122"><a href="#cb133-122" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">!</span>PANASD2_1_Attentive)</span>
<span id="cb133-123"><a href="#cb133-123" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb133-124"><a href="#cb133-124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-125"><a href="#cb133-125" aria-hidden="true" tabindex="-1"></a>The <span class="in">`glimpse()`</span> function provides a quick overview of our dataframe.</span>
<span id="cb133-126"><a href="#cb133-126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-129"><a href="#cb133-129" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb133-130"><a href="#cb133-130" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(df)</span>
<span id="cb133-131"><a href="#cb133-131" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb133-132"><a href="#cb133-132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-133"><a href="#cb133-133" aria-hidden="true" tabindex="-1"></a>We have <span class="in">`r nrow(df)`</span> rows, ie. respondents. All variables except Sex and Group are of class <span class="in">`dbl`</span>, which means they are numeric and can have decimals. Integer (numeric with no decimals) would also be fine for our purposes. The two demographic variables currently of class <span class="in">`chr`</span> (character) will need to be converted to factors (<span class="in">`fct`</span>), and we will do that later on.</span>
<span id="cb133-134"><a href="#cb133-134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-135"><a href="#cb133-135" aria-hidden="true" tabindex="-1"></a>(If you import a dataset where item variables are of class character, you will need to recode to numeric.)</span>
<span id="cb133-136"><a href="#cb133-136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-137"><a href="#cb133-137" aria-hidden="true" tabindex="-1"></a><span class="fu">### Itemlabels</span></span>
<span id="cb133-138"><a href="#cb133-138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-139"><a href="#cb133-139" aria-hidden="true" tabindex="-1"></a>Then we set up the itemlabels dataframe. This could also be done using the free <span class="co">[</span><span class="ot">LibreOffice Calc</span><span class="co">](https://www.libreoffice.org/download/download-libreoffice/)</span> or MS Excel. Just make sure the file has the same structure, with two variables named <span class="in">`itemnr`</span> and <span class="in">`item`</span> that contain the item variable names and item description. The item variable names have to match the variable names in the item dataframe.</span>
<span id="cb133-140"><a href="#cb133-140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-143"><a href="#cb133-143" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb133-144"><a href="#cb133-144" aria-hidden="true" tabindex="-1"></a>itemlabels <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> </span>
<span id="cb133-145"><a href="#cb133-145" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">starts_with</span>(<span class="st">"PAN"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb133-146"><a href="#cb133-146" aria-hidden="true" tabindex="-1"></a>  <span class="fu">names</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb133-147"><a href="#cb133-147" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb133-148"><a href="#cb133-148" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(value, <span class="fu">c</span>(<span class="cn">NA</span>, <span class="st">"item"</span>), <span class="at">sep =</span><span class="st">"_[0-9][0-9]_"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb133-149"><a href="#cb133-149" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">itemnr =</span> <span class="fu">paste0</span>(<span class="st">"PANAS_"</span>,<span class="fu">c</span>(<span class="dv">11</span><span class="sc">:</span><span class="dv">20</span>)), <span class="at">.before =</span> <span class="st">"item"</span>)</span>
<span id="cb133-150"><a href="#cb133-150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-151"><a href="#cb133-151" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb133-152"><a href="#cb133-152" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-153"><a href="#cb133-153" aria-hidden="true" tabindex="-1"></a>The <span class="in">`itemlabels`</span> dataframe looks like this.</span>
<span id="cb133-154"><a href="#cb133-154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-157"><a href="#cb133-157" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb133-158"><a href="#cb133-158" aria-hidden="true" tabindex="-1"></a>itemlabels</span>
<span id="cb133-159"><a href="#cb133-159" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb133-160"><a href="#cb133-160" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-161"><a href="#cb133-161" aria-hidden="true" tabindex="-1"></a><span class="fu">### Demographics</span></span>
<span id="cb133-162"><a href="#cb133-162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-163"><a href="#cb133-163" aria-hidden="true" tabindex="-1"></a>Variables for invariance tests such as Differential Item Functioning (DIF) need to be separated into vectors (ideally as factors with specified levels and labels) with the same length as the number of rows in the dataset. This means that any kind of removal of respondents/rows with missing data needs to be done before separating the DIF variables.</span>
<span id="cb133-164"><a href="#cb133-164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-165"><a href="#cb133-165" aria-hidden="true" tabindex="-1"></a>First, we'll have a look at the class of our variables.</span>
<span id="cb133-166"><a href="#cb133-166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-169"><a href="#cb133-169" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb133-170"><a href="#cb133-170" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span> </span>
<span id="cb133-171"><a href="#cb133-171" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Sex,age,Group) <span class="sc">%&gt;%</span> </span>
<span id="cb133-172"><a href="#cb133-172" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glimpse</span>()</span>
<span id="cb133-173"><a href="#cb133-173" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb133-174"><a href="#cb133-174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-175"><a href="#cb133-175" aria-hidden="true" tabindex="-1"></a><span class="in">`Sex`</span> and <span class="in">`Group`</span> are class character, while <span class="in">`age`</span> is numeric. Below are the response categories represented in data.</span>
<span id="cb133-176"><a href="#cb133-176" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-179"><a href="#cb133-179" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb133-180"><a href="#cb133-180" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(df<span class="sc">$</span>Sex)</span>
<span id="cb133-181"><a href="#cb133-181" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb133-182"><a href="#cb133-182" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-183"><a href="#cb133-183" aria-hidden="true" tabindex="-1"></a>Since there are only 5 respondents using labels that are not Female or Male (too few for meaningful statistical analysis), we will remove them to have a complete dataset for all variables in this example.</span>
<span id="cb133-184"><a href="#cb133-184" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-187"><a href="#cb133-187" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb133-188"><a href="#cb133-188" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> </span>
<span id="cb133-189"><a href="#cb133-189" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Sex <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Female"</span>,<span class="st">"Male"</span>)) <span class="co"># filtering to only include those with Sex being either Female or Male.</span></span>
<span id="cb133-190"><a href="#cb133-190" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb133-191"><a href="#cb133-191" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-192"><a href="#cb133-192" aria-hidden="true" tabindex="-1"></a>Let's make the variable a factor (instead of class "character"), since that will be helpful in our later analyses.</span>
<span id="cb133-193"><a href="#cb133-193" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-196"><a href="#cb133-196" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb133-197"><a href="#cb133-197" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>Sex <span class="ot">&lt;-</span> <span class="fu">factor</span>(df<span class="sc">$</span>Sex)</span>
<span id="cb133-198"><a href="#cb133-198" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb133-199"><a href="#cb133-199" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-200"><a href="#cb133-200" aria-hidden="true" tabindex="-1"></a>Sometimes age is provided in categories, but here we have a numeric variable with age in years. Let's have a quick look at the age distribution using a histogram, and get some summary statistics.</span>
<span id="cb133-201"><a href="#cb133-201" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-204"><a href="#cb133-204" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb133-205"><a href="#cb133-205" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(df<span class="sc">$</span>age)</span>
<span id="cb133-206"><a href="#cb133-206" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb133-207"><a href="#cb133-207" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-210"><a href="#cb133-210" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb133-211"><a href="#cb133-211" aria-hidden="true" tabindex="-1"></a><span class="do">### simpler version of the ggplot below using base R function hist()</span></span>
<span id="cb133-212"><a href="#cb133-212" aria-hidden="true" tabindex="-1"></a><span class="co"># hist(df$age, col = "#009ca6")</span></span>
<span id="cb133-213"><a href="#cb133-213" aria-hidden="true" tabindex="-1"></a><span class="co"># abline(v = median(age, na.rm = TRUE))</span></span>
<span id="cb133-214"><a href="#cb133-214" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb133-215"><a href="#cb133-215" aria-hidden="true" tabindex="-1"></a><span class="co"># df %&gt;% </span></span>
<span id="cb133-216"><a href="#cb133-216" aria-hidden="true" tabindex="-1"></a><span class="co">#   summarise(Mean = round(mean(age, na.rm = T),1),</span></span>
<span id="cb133-217"><a href="#cb133-217" aria-hidden="true" tabindex="-1"></a><span class="co">#             StDev = round(sd(age, na.rm = T),1)</span></span>
<span id="cb133-218"><a href="#cb133-218" aria-hidden="true" tabindex="-1"></a><span class="co">#             )</span></span>
<span id="cb133-219"><a href="#cb133-219" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-220"><a href="#cb133-220" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df) <span class="sc">+</span></span>
<span id="cb133-221"><a href="#cb133-221" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">x =</span> age), </span>
<span id="cb133-222"><a href="#cb133-222" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fill =</span> <span class="st">"#009ca6"</span>,</span>
<span id="cb133-223"><a href="#cb133-223" aria-hidden="true" tabindex="-1"></a>                 <span class="at">col =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb133-224"><a href="#cb133-224" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add the average as a vertical line</span></span>
<span id="cb133-225"><a href="#cb133-225" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">median</span>(df<span class="sc">$</span>age), </span>
<span id="cb133-226"><a href="#cb133-226" aria-hidden="true" tabindex="-1"></a>             <span class="at">linewidth =</span> <span class="fl">1.5</span>,</span>
<span id="cb133-227"><a href="#cb133-227" aria-hidden="true" tabindex="-1"></a>             <span class="at">linetype =</span> <span class="dv">2</span>,</span>
<span id="cb133-228"><a href="#cb133-228" aria-hidden="true" tabindex="-1"></a>             <span class="at">col =</span> <span class="st">"orange"</span>) <span class="sc">+</span></span>
<span id="cb133-229"><a href="#cb133-229" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add a light grey field indicating the standard deviation</span></span>
<span id="cb133-230"><a href="#cb133-230" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"rect"</span>, <span class="at">ymin =</span> <span class="dv">0</span>, <span class="at">ymax =</span> <span class="cn">Inf</span>, </span>
<span id="cb133-231"><a href="#cb133-231" aria-hidden="true" tabindex="-1"></a>           <span class="at">xmin =</span> <span class="fu">summary</span>(df<span class="sc">$</span>age)[<span class="dv">2</span>], </span>
<span id="cb133-232"><a href="#cb133-232" aria-hidden="true" tabindex="-1"></a>           <span class="at">xmax =</span> <span class="fu">summary</span>(df<span class="sc">$</span>age)[<span class="dv">5</span>], </span>
<span id="cb133-233"><a href="#cb133-233" aria-hidden="true" tabindex="-1"></a>           <span class="at">alpha =</span> .<span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb133-234"><a href="#cb133-234" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">""</span>,</span>
<span id="cb133-235"><a href="#cb133-235" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Age in years"</span>,</span>
<span id="cb133-236"><a href="#cb133-236" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Number of respondents"</span>,</span>
<span id="cb133-237"><a href="#cb133-237" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="fu">str_wrap</span>(<span class="fu">glue</span>(<span class="st">"Note. Median age is {round(median(df$age, na.rm = T),1)}, shown with the dashed vertical line. Age range is {min(df$age)} to {max(df$age)}. Interquartile range ({summary(df$age)[2]} to {summary(df$age)[5]}) is indicated with the grey area."</span>)</span>
<span id="cb133-238"><a href="#cb133-238" aria-hidden="true" tabindex="-1"></a>       )) <span class="sc">+</span></span>
<span id="cb133-239"><a href="#cb133-239" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">18</span>,<span class="dv">75</span>)) <span class="sc">+</span></span>
<span id="cb133-240"><a href="#cb133-240" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb133-241"><a href="#cb133-241" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">face =</span> <span class="st">"italic"</span>)) </span>
<span id="cb133-242"><a href="#cb133-242" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-243"><a href="#cb133-243" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb133-244"><a href="#cb133-244" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-245"><a href="#cb133-245" aria-hidden="true" tabindex="-1"></a>Since the distribution of the age variable is clearly not following a gaussian (normal) distribution, the median seems like a better option than the mean.</span>
<span id="cb133-246"><a href="#cb133-246" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-247"><a href="#cb133-247" aria-hidden="true" tabindex="-1"></a>There is also a grouping variable which needs to be converted to a factor.</span>
<span id="cb133-248"><a href="#cb133-248" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-251"><a href="#cb133-251" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb133-252"><a href="#cb133-252" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>Group <span class="ot">&lt;-</span> <span class="fu">factor</span>(df<span class="sc">$</span>Group)</span>
<span id="cb133-253"><a href="#cb133-253" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb133-254"><a href="#cb133-254" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-255"><a href="#cb133-255" aria-hidden="true" tabindex="-1"></a>Now our demographic data has been checked, and we need to move it to a separate dataframe from the item data.</span>
<span id="cb133-256"><a href="#cb133-256" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-259"><a href="#cb133-259" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb133-260"><a href="#cb133-260" aria-hidden="true" tabindex="-1"></a>dif <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> </span>
<span id="cb133-261"><a href="#cb133-261" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Sex,age,Group) <span class="sc">%&gt;%</span> </span>
<span id="cb133-262"><a href="#cb133-262" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">Age =</span> age) <span class="co"># just for consistency</span></span>
<span id="cb133-263"><a href="#cb133-263" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-264"><a href="#cb133-264" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> </span>
<span id="cb133-265"><a href="#cb133-265" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">!</span><span class="fu">c</span>(Sex,age,Group))</span>
<span id="cb133-266"><a href="#cb133-266" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb133-267"><a href="#cb133-267" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-268"><a href="#cb133-268" aria-hidden="true" tabindex="-1"></a>To create a "Table 1" containing participant demographic information, the <span class="in">`tbl_summary()`</span> function from the <span class="in">`gtsummary`</span> package is really handy to get a nice table.</span>
<span id="cb133-269"><a href="#cb133-269" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-272"><a href="#cb133-272" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb133-273"><a href="#cb133-273" aria-hidden="true" tabindex="-1"></a>gtsummary<span class="sc">::</span><span class="fu">tbl_summary</span>(dif)</span>
<span id="cb133-274"><a href="#cb133-274" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb133-275"><a href="#cb133-275" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-276"><a href="#cb133-276" aria-hidden="true" tabindex="-1"></a>With only item data remaining in the <span class="in">`df`</span> dataframe, we can easily rename the items in the item dataframe and make sure that they match the <span class="in">`itemlabels`</span> variable <span class="in">`itemnr`</span>. It will be useful to have short item labels to get less clutter in the tables and figures during analysis.</span>
<span id="cb133-277"><a href="#cb133-277" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-280"><a href="#cb133-280" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb133-281"><a href="#cb133-281" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(df) <span class="ot">&lt;-</span> itemlabels<span class="sc">$</span>itemnr</span>
<span id="cb133-282"><a href="#cb133-282" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb133-283"><a href="#cb133-283" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-284"><a href="#cb133-284" aria-hidden="true" tabindex="-1"></a>Now we are all set for the psychometric analysis!</span>
<span id="cb133-285"><a href="#cb133-285" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-286"><a href="#cb133-286" aria-hidden="true" tabindex="-1"></a><span class="fu">## Descriptives</span></span>
<span id="cb133-287"><a href="#cb133-287" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-288"><a href="#cb133-288" aria-hidden="true" tabindex="-1"></a>Let's familiarize ourselves with the data before diving into the analysis.</span>
<span id="cb133-289"><a href="#cb133-289" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-290"><a href="#cb133-290" aria-hidden="true" tabindex="-1"></a><span class="fu">### Missing data</span></span>
<span id="cb133-291"><a href="#cb133-291" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-292"><a href="#cb133-292" aria-hidden="true" tabindex="-1"></a>First, we visualize the proportion of missing data on item level.</span>
<span id="cb133-293"><a href="#cb133-293" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-296"><a href="#cb133-296" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb133-297"><a href="#cb133-297" aria-hidden="true" tabindex="-1"></a><span class="fu">RImissing</span>(df)</span>
<span id="cb133-298"><a href="#cb133-298" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb133-299"><a href="#cb133-299" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-300"><a href="#cb133-300" aria-hidden="true" tabindex="-1"></a>No missing data in this dataset. If we had missing data, we could also use <span class="in">`RImissingP()`</span> to look at which respondents have missing data and how much. Just to show what the output of these functions looks like, we'll use <span class="in">`mice::ampute()`</span> to temporarily remove 10% of data.</span>
<span id="cb133-301"><a href="#cb133-301" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-304"><a href="#cb133-304" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb133-305"><a href="#cb133-305" aria-hidden="true" tabindex="-1"></a><span class="fu">RImissing</span>(mice<span class="sc">::</span><span class="fu">ampute</span>(df, <span class="at">prop =</span> <span class="fl">0.1</span>)<span class="sc">$</span>amp)</span>
<span id="cb133-306"><a href="#cb133-306" aria-hidden="true" tabindex="-1"></a><span class="fu">RImissingP</span>(mice<span class="sc">::</span><span class="fu">ampute</span>(df, <span class="at">prop =</span> <span class="fl">0.1</span>)<span class="sc">$</span>amp, <span class="at">N =</span> <span class="dv">20</span>)</span>
<span id="cb133-307"><a href="#cb133-307" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb133-308"><a href="#cb133-308" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-309"><a href="#cb133-309" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-310"><a href="#cb133-310" aria-hidden="true" tabindex="-1"></a><span class="fu">### Overall responses</span></span>
<span id="cb133-311"><a href="#cb133-311" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-312"><a href="#cb133-312" aria-hidden="true" tabindex="-1"></a>This provides us with an overall picture of the data distribution. As a bonus, any oddities/mistakes in recoding the item data from categories to numbers will be clearly visible.</span>
<span id="cb133-313"><a href="#cb133-313" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-316"><a href="#cb133-316" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb133-317"><a href="#cb133-317" aria-hidden="true" tabindex="-1"></a><span class="fu">RIallresp</span>(df)</span>
<span id="cb133-318"><a href="#cb133-318" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb133-319"><a href="#cb133-319" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-320"><a href="#cb133-320" aria-hidden="true" tabindex="-1"></a>Most R packages for Rasch analysis require the lowest response category to be coded as zero, which makes it necessary for us to recode our data, from the range of 1-5 to 0-4.</span>
<span id="cb133-321"><a href="#cb133-321" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-324"><a href="#cb133-324" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb133-325"><a href="#cb133-325" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> </span>
<span id="cb133-326"><a href="#cb133-326" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">everything</span>(), <span class="sc">~</span> .x <span class="sc">-</span> <span class="dv">1</span>))</span>
<span id="cb133-327"><a href="#cb133-327" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-328"><a href="#cb133-328" aria-hidden="true" tabindex="-1"></a><span class="co"># always check that your recoding worked as intended.</span></span>
<span id="cb133-329"><a href="#cb133-329" aria-hidden="true" tabindex="-1"></a><span class="fu">RIallresp</span>(df)</span>
<span id="cb133-330"><a href="#cb133-330" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-331"><a href="#cb133-331" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb133-332"><a href="#cb133-332" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-333"><a href="#cb133-333" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Floor/ceiling effects</span></span>
<span id="cb133-334"><a href="#cb133-334" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-335"><a href="#cb133-335" aria-hidden="true" tabindex="-1"></a>We can also look at the raw distribution of ordinal sum scores. The <span class="in">`RIrawdist()`</span> function is a bit crude, since it requires responses in all response categories to accurately calculate max and min scores.</span>
<span id="cb133-336"><a href="#cb133-336" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-339"><a href="#cb133-339" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb133-340"><a href="#cb133-340" aria-hidden="true" tabindex="-1"></a><span class="fu">RIrawdist</span>(df)</span>
<span id="cb133-341"><a href="#cb133-341" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb133-342"><a href="#cb133-342" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-343"><a href="#cb133-343" aria-hidden="true" tabindex="-1"></a>There is a floor effect with 11.8% of participants responding in the lowest category for all items.</span>
<span id="cb133-344"><a href="#cb133-344" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-345"><a href="#cb133-345" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Guttman structure</span></span>
<span id="cb133-346"><a href="#cb133-346" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-347"><a href="#cb133-347" aria-hidden="true" tabindex="-1"></a>While not really necessary, it can be interesting to see whether the response patterns follow a Guttman-like structure. Items and persons are sorted based on lower-<span class="sc">\&gt;</span>higher responses, and we should see the color move from yellow in the lower left corner to blue in the upper right corner.</span>
<span id="cb133-348"><a href="#cb133-348" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-351"><a href="#cb133-351" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb133-352"><a href="#cb133-352" aria-hidden="true" tabindex="-1"></a><span class="fu">RIheatmap</span>(df) <span class="sc">+</span></span>
<span id="cb133-353"><a href="#cb133-353" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_blank</span>())</span>
<span id="cb133-354"><a href="#cb133-354" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb133-355"><a href="#cb133-355" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-356"><a href="#cb133-356" aria-hidden="true" tabindex="-1"></a>In this data, we see the floor effect on the left, with 11.8% of respondents all yellow, and a rather weak Guttman structure. This could also be due to a low variation in item locations/difficulties. Since we have a very large sample I added a <span class="in">`theme()`</span> option to remove the x-axis text, which would anyway just be a blur of the <span class="in">`r nrow(df)`</span> respondent row numbers. Each thin vertical slice in the figure is one respondent.</span>
<span id="cb133-357"><a href="#cb133-357" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-358"><a href="#cb133-358" aria-hidden="true" tabindex="-1"></a><span class="fu">### Item level descriptives</span></span>
<span id="cb133-359"><a href="#cb133-359" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-360"><a href="#cb133-360" aria-hidden="true" tabindex="-1"></a>There are many ways to look at the item level data, and we'll get them all together in the tab-panel below. The <span class="in">`RItileplot()`</span> is probably most informative, since it provides the number of responses in each response category for each item. It is usually recommended to have at least \~10 responses in each category for psychometric analysis, no matter which methodology is used.</span>
<span id="cb133-361"><a href="#cb133-361" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-362"><a href="#cb133-362" aria-hidden="true" tabindex="-1"></a>Kudos to <span class="co">[</span><span class="ot">Solomon Kurz</span><span class="co">](https://solomonkurz.netlify.app/blog/2021-05-11-yes-you-can-fit-an-exploratory-factor-analysis-with-lavaan/)</span> for providing the idea and code on which the tile plot function is built!</span>
<span id="cb133-363"><a href="#cb133-363" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-364"><a href="#cb133-364" aria-hidden="true" tabindex="-1"></a>Most people will be familiar with the barplot, and this is probably most intuitive to understand the response distribution within each item. However, if there are many items it will take a while to review, and does not provide the same overview as a tileplot or stacked bars.</span>
<span id="cb133-365"><a href="#cb133-365" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-368"><a href="#cb133-368" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb133-369"><a href="#cb133-369" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: margin</span></span>
<span id="cb133-370"><a href="#cb133-370" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb133-371"><a href="#cb133-371" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: fenced</span></span>
<span id="cb133-372"><a href="#cb133-372" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-373"><a href="#cb133-373" aria-hidden="true" tabindex="-1"></a><span class="co"># This code chunk creates a small table in the margin beside the panel-tabset output below, showing all items currently in the df dataframe.</span></span>
<span id="cb133-374"><a href="#cb133-374" aria-hidden="true" tabindex="-1"></a><span class="co"># The Quarto code chunk option "#| column: margin" is necessary for the layout to work as intended.</span></span>
<span id="cb133-375"><a href="#cb133-375" aria-hidden="true" tabindex="-1"></a><span class="fu">RIlistItemsMargin</span>(df, <span class="at">fontsize =</span> <span class="dv">13</span>)</span>
<span id="cb133-376"><a href="#cb133-376" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb133-377"><a href="#cb133-377" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-378"><a href="#cb133-378" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb133-379"><a href="#cb133-379" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Tile plot</span></span>
<span id="cb133-382"><a href="#cb133-382" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb133-383"><a href="#cb133-383" aria-hidden="true" tabindex="-1"></a><span class="fu">RItileplot</span>(df)</span>
<span id="cb133-384"><a href="#cb133-384" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb133-385"><a href="#cb133-385" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-386"><a href="#cb133-386" aria-hidden="true" tabindex="-1"></a>While response patterns are skewed for all items, there are more than 10 responses in each category for all items which is helpful for the analysis.</span>
<span id="cb133-387"><a href="#cb133-387" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-388"><a href="#cb133-388" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Stacked bars</span></span>
<span id="cb133-391"><a href="#cb133-391" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb133-392"><a href="#cb133-392" aria-hidden="true" tabindex="-1"></a><span class="fu">RIbarstack</span>(df) <span class="sc">+</span></span>
<span id="cb133-393"><a href="#cb133-393" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span> <span class="co"># theming is optional, see section 11 for more on this</span></span>
<span id="cb133-394"><a href="#cb133-394" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_rise</span>() </span>
<span id="cb133-395"><a href="#cb133-395" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb133-396"><a href="#cb133-396" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-397"><a href="#cb133-397" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Barplots</span></span>
<span id="cb133-400"><a href="#cb133-400" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb133-401"><a href="#cb133-401" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 9</span></span>
<span id="cb133-402"><a href="#cb133-402" aria-hidden="true" tabindex="-1"></a><span class="fu">RIitemcols</span>(df)</span>
<span id="cb133-403"><a href="#cb133-403" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-404"><a href="#cb133-404" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb133-405"><a href="#cb133-405" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb133-406"><a href="#cb133-406" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-407"><a href="#cb133-407" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-408"><a href="#cb133-408" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-409"><a href="#cb133-409" aria-hidden="true" tabindex="-1"></a><span class="fu">## Rasch analysis 1 {#sec-rasch}</span></span>
<span id="cb133-410"><a href="#cb133-410" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-411"><a href="#cb133-411" aria-hidden="true" tabindex="-1"></a>The eRm package and Conditional Maximum Likelihood (CML) estimation will be used primarily, with the Partial Credit Model since this is polytomous data. For more information about different estimation methods, see <span class="co">[</span><span class="ot">@robitzsch_comprehensive_2021</span><span class="co">]</span>.</span>
<span id="cb133-412"><a href="#cb133-412" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-413"><a href="#cb133-413" aria-hidden="true" tabindex="-1"></a>This is also where the basic psychometric aspects are good to recall.</span>
<span id="cb133-414"><a href="#cb133-414" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-415"><a href="#cb133-415" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Unidimensionality </span>
<span id="cb133-416"><a href="#cb133-416" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Local independence</span>
<span id="cb133-417"><a href="#cb133-417" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Ordering of response categories</span>
<span id="cb133-418"><a href="#cb133-418" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Invariance</span>
<span id="cb133-419"><a href="#cb133-419" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Targeting</span>
<span id="cb133-420"><a href="#cb133-420" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Measurement uncertainties (reliability)</span>
<span id="cb133-421"><a href="#cb133-421" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-422"><a href="#cb133-422" aria-hidden="true" tabindex="-1"></a>We will begin by looking at unidimensionality, response categories, and targeting in parallel below. For unidimensionality, we are mostly interested in item fit and residual correlations, as well as PCA of residuals and loadings on the first residual contrast. At the same time, disordered response categories can influence item fit to some extent (and vice versa), and knowledge about targeting can be useful if it is necessary to remove items due to residual correlations.</span>
<span id="cb133-423"><a href="#cb133-423" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-424"><a href="#cb133-424" aria-hidden="true" tabindex="-1"></a>When unidimensionality and response categories are found to work adequately, we will move on to invariance testing (Differential Item Functioning, DIF). It should be noted that DIF should be evaluated in parallel with all other psychometric aspects, but since it is a more complex issue it is kept in a separate section in this vignette (as is person fit). Finally, when/if invariance/DIF also looks acceptable, we can investigate reliability/measurement uncertainties.</span>
<span id="cb133-425"><a href="#cb133-425" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-426"><a href="#cb133-426" aria-hidden="true" tabindex="-1"></a>Since our sample is quite large (n &gt; 800), the sample size sensitive tests (item fit and item-restscore) that are likely to produce problematic false positive rates <span class="co">[</span><span class="ot">@johansson_detecting_2025</span><span class="co">]</span> will use a randomly selected smaller sample of n = 500 as examples. When analyzing large datasets, item-restscore bootstrap is recommended as the primary method of assessing item fit to the Rasch model. **The use of one smaller subsample in this vignette is only for demonstration purposes, it is not a recommended method of analysis for large datasets.**</span>
<span id="cb133-427"><a href="#cb133-427" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-430"><a href="#cb133-430" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb133-431"><a href="#cb133-431" aria-hidden="true" tabindex="-1"></a>df500 <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> </span>
<span id="cb133-432"><a href="#cb133-432" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_sample</span>(<span class="at">n =</span> <span class="dv">500</span>)</span>
<span id="cb133-433"><a href="#cb133-433" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb133-434"><a href="#cb133-434" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-435"><a href="#cb133-435" aria-hidden="true" tabindex="-1"></a>::: {.callout-note}</span>
<span id="cb133-436"><a href="#cb133-436" aria-hidden="true" tabindex="-1"></a>In the tabset-panel below, each tab contains explanatory text, which is sometimes a bit lengthy. Remember to **scroll back up and click on all tabs**.</span>
<span id="cb133-437"><a href="#cb133-437" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb133-438"><a href="#cb133-438" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-441"><a href="#cb133-441" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb133-442"><a href="#cb133-442" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: margin</span></span>
<span id="cb133-443"><a href="#cb133-443" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb133-444"><a href="#cb133-444" aria-hidden="true" tabindex="-1"></a><span class="fu">RIlistItemsMargin</span>(df, <span class="at">fontsize =</span> <span class="dv">13</span>)</span>
<span id="cb133-445"><a href="#cb133-445" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb133-446"><a href="#cb133-446" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-447"><a href="#cb133-447" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb133-448"><a href="#cb133-448" aria-hidden="true" tabindex="-1"></a><span class="fu">### Conditional item fit</span></span>
<span id="cb133-449"><a href="#cb133-449" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-452"><a href="#cb133-452" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb133-453"><a href="#cb133-453" aria-hidden="true" tabindex="-1"></a>simfit1 <span class="ot">&lt;-</span> <span class="fu">RIgetfit</span>(df500, <span class="at">iterations =</span> <span class="dv">400</span>, <span class="at">cpu =</span> <span class="dv">8</span>) <span class="co"># save simulation output to object `simfit1`</span></span>
<span id="cb133-454"><a href="#cb133-454" aria-hidden="true" tabindex="-1"></a><span class="fu">RIitemfit</span>(df500, simfit1)</span>
<span id="cb133-455"><a href="#cb133-455" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb133-456"><a href="#cb133-456" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-457"><a href="#cb133-457" aria-hidden="true" tabindex="-1"></a><span class="in">`RIitemfit()`</span> and <span class="in">`RIgetfit()`</span> both work with both dichotomous and polytomous data (using the partial credit model) and automatically selects the model based on the data structure.</span>
<span id="cb133-458"><a href="#cb133-458" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-459"><a href="#cb133-459" aria-hidden="true" tabindex="-1"></a>It is important to note that the <span class="in">`RIitemfit()`</span> function uses **conditional** infit, which is both robust to different sample sizes and makes ZSTD unnecessary <span class="co">[</span><span class="ot">@muller_item_2020</span><span class="co">]</span>. Müller also questions the usefulness of outfit, and my simulation study <span class="co">[</span><span class="ot">@johansson_detecting_2025</span><span class="co">]</span> concluded the same. Thus, outfit is not reported any more.</span>
<span id="cb133-460"><a href="#cb133-460" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-461"><a href="#cb133-461" aria-hidden="true" tabindex="-1"></a>Since the distribution of item fit statistics are not known, we need to use simulation to determine appropriate cutoff threshold values for the current sample and items. <span class="in">`RIitemfit()`</span> can also use the simulation based cutoff values and use them for conditional highlighting of misfitting items. See the <span class="co">[</span><span class="ot">blog post on simulation based cutoffs</span><span class="co">](https://pgmj.github.io/simcutoffs.html)</span> for some more details on this.</span>
<span id="cb133-462"><a href="#cb133-462" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-463"><a href="#cb133-463" aria-hidden="true" tabindex="-1"></a>Briefly stated, the simulation uses the estimated properties of the current sample and items (your dataset), and simulates n iterations of data that fit the Rasch model to get an empirical distribution of item fit that we can use for comparison with the observed data. This is also known as "parametric bootstrapping".</span>
<span id="cb133-464"><a href="#cb133-464" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-465"><a href="#cb133-465" aria-hidden="true" tabindex="-1"></a>The simulations can take a bit of time to run if you have complex data/many items/many participants, and/or choose to use many iterations. Simulation experiments <span class="co">[</span><span class="ot">@johansson_detecting_2025</span><span class="co">]</span> indicate that 100-400 iterations should be a useful range, where smaller samples (n &lt; 300) should use 100 iterations, and 200-400 is more appropriate when one has larger samples. To improve speed, make good use of your CPU cores.</span>
<span id="cb133-466"><a href="#cb133-466" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-467"><a href="#cb133-467" aria-hidden="true" tabindex="-1"></a>::: {.callout-note}</span>
<span id="cb133-468"><a href="#cb133-468" aria-hidden="true" tabindex="-1"></a>Another important finding from simulation studies is that there is a risk of false positive indication of misfit in samples larger than n = 800 or so when using item infit or item-restscore. The recommended primary method for determining item fit in large samples is the bootstrapped item-restscore <span class="co">[</span><span class="ot">@johansson_detecting_2025</span><span class="co">]</span>, as illustrated in an adjacent tab labeled "Item-restscore bootstrap" .</span>
<span id="cb133-469"><a href="#cb133-469" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb133-470"><a href="#cb133-470" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-471"><a href="#cb133-471" aria-hidden="true" tabindex="-1"></a>For reference, the simulation above, using 10 items with 5 response categories each and 1851 respondents, takes about 24 seconds to run on 8 cpu cores (Macbook Pro M1 Max) for 400 iterations.</span>
<span id="cb133-472"><a href="#cb133-472" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-473"><a href="#cb133-473" aria-hidden="true" tabindex="-1"></a>I'll cite Ostini &amp; Nering <span class="co">[</span><span class="ot">-@ostini_polytomous_2006</span><span class="co">]</span> on the description of outfit and infit (pages 86-87):</span>
<span id="cb133-474"><a href="#cb133-474" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-475"><a href="#cb133-475" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; Response residuals can be summed over respondents to obtain an item fit measure. Generally, the accumulation is done with squared standardized residuals, which are then divided by the total number of respondents to obtain a mean square statistic. In this form, the statistic is referred to as an **unweighted mean square** (Masters &amp; Wright, 1997; Wright &amp; Masters, 1982) and has also come to be known as **“outfit”** (Smith, Schumacker, &amp; Bush, 1998; Wu, 1997) </span><span class="co">[</span><span class="ot">...</span><span class="co">]</span></span>
<span id="cb133-476"><a href="#cb133-476" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-477"><a href="#cb133-477" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; A weighted version of this statistic was developed to counteract its sensitivity to outliers (Smith, 2000). In its weighted form, the squared standardized residual is multiplied by the observed response variance and then divided by the sum of the item response variances. This is sometimes referred to as an **information weighted mean square** and has become known as **“infit”** (Smith et al., 1998; Wu, 1997).</span></span>
<span id="cb133-478"><a href="#cb133-478" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-479"><a href="#cb133-479" aria-hidden="true" tabindex="-1"></a>A low item fit value (sometimes referred to as an item "overfitting" the Rasch model) indicates that responses may be too predictable. This is often the case for items that are very general/broad in scope in relation to the latent variable, for instance asking about feeling depressed in a depression questionnaire. You will often find overfitting items to also have residual correlations (local dependencies) with other items. Overfit may be likened to having a much stronger factor loading than other items in a confirmatory factor analysis.</span>
<span id="cb133-480"><a href="#cb133-480" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-481"><a href="#cb133-481" aria-hidden="true" tabindex="-1"></a>A high item fit value (sometimes referred to as "underfitting" the Rasch model) can indicate several things, often multidimensionality or a question that is difficult to interpret and thus has noisy response data. The latter could for instance be caused by a question that asks about two things at the same time or is ambiguous for other reasons.</span>
<span id="cb133-482"><a href="#cb133-482" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-483"><a href="#cb133-483" aria-hidden="true" tabindex="-1"></a>Outfit has been found to be a not very useful method to detect item misfit, infit should be relied upon when sample sizes are appropriate <span class="co">[</span><span class="ot">@johansson_detecting_2025</span><span class="co">]</span>. Outfit was removed from the output in version 0.3.9.</span>
<span id="cb133-484"><a href="#cb133-484" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-485"><a href="#cb133-485" aria-hidden="true" tabindex="-1"></a>::: {.callout-note}</span>
<span id="cb133-486"><a href="#cb133-486" aria-hidden="true" tabindex="-1"></a>Remember to **scroll back up and click on all tabs**.</span>
<span id="cb133-487"><a href="#cb133-487" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb133-488"><a href="#cb133-488" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-489"><a href="#cb133-489" aria-hidden="true" tabindex="-1"></a><span class="fu">### Item-restscore</span></span>
<span id="cb133-490"><a href="#cb133-490" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-491"><a href="#cb133-491" aria-hidden="true" tabindex="-1"></a>This is another useful function from the <span class="in">`iarm`</span> package. It shows the expected and observed correlation between an item and a score based on the rest of the items <span class="co">[</span><span class="ot">@kreiner_note_2011</span><span class="co">]</span>. Similarly, but inverted, to item fit, a lower observed correlation value than expected indicates underfit, that the item may not belong to the dimension. A higher than expected observed value indicates an overfitting and possibly redundant item. Overfitting items will often also show issues with residual correlations. Both of these problems can often be (at least partially) resolved by removing underfitting items.</span>
<span id="cb133-492"><a href="#cb133-492" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-495"><a href="#cb133-495" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb133-496"><a href="#cb133-496" aria-hidden="true" tabindex="-1"></a><span class="fu">RIrestscore</span>(df500)</span>
<span id="cb133-497"><a href="#cb133-497" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb133-498"><a href="#cb133-498" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-499"><a href="#cb133-499" aria-hidden="true" tabindex="-1"></a><span class="fu">### Item-restscore bootstrap</span></span>
<span id="cb133-500"><a href="#cb133-500" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-501"><a href="#cb133-501" aria-hidden="true" tabindex="-1"></a>Both item-restscore and conditional item infit/outfit will indicate "false misfit" when sample sizes are large (even when using simulation/bootstrap based cutoff values). This behavior can occur from about n = 500, and certainly will occur at samples of 800 and above <span class="co">[</span><span class="ot">@johansson_detecting_2025</span><span class="co">]</span>. This "false misfit" is caused by truly misfitting items, which underlines the importance of removing one item at a time when one finds issues with misfit/multidimensionality. However, a useful way to get additional information about the probability of actual misfit is to use non-parametric bootstrapping. This function resamples with replacement from your response data and reports the percentage and type of misfit indicated by the item-restscore function. You will also get information about conditional MSQ infit (based on the full sample, using complete responders). Simulation studies indicate that a sample size of 800 results in 95+% detection rate of 1-3 misfitting items amongst 20 dichotomous items <span class="co">[</span><span class="ot">@johansson_detecting_2025</span><span class="co">]</span>.</span>
<span id="cb133-502"><a href="#cb133-502" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-505"><a href="#cb133-505" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb133-506"><a href="#cb133-506" aria-hidden="true" tabindex="-1"></a><span class="fu">RIbootRestscore</span>(df, <span class="at">iterations =</span> <span class="dv">250</span>, <span class="at">samplesize =</span> <span class="dv">800</span>)</span>
<span id="cb133-507"><a href="#cb133-507" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb133-508"><a href="#cb133-508" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-509"><a href="#cb133-509" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-510"><a href="#cb133-510" aria-hidden="true" tabindex="-1"></a><span class="fu">### Conditional item characteristic curves</span></span>
<span id="cb133-511"><a href="#cb133-511" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-512"><a href="#cb133-512" aria-hidden="true" tabindex="-1"></a>The <span class="co">[</span><span class="ot">`iarm`</span><span class="co">](https://cran.r-project.org/web/packages/iarm/index.html)</span> package <span class="co">[</span><span class="ot">@mueller_iarm_2022</span><span class="co">]</span> provides several interesting functions for assessing item fit, DIF and other things. Some of these functions have been implemented in simplified versions in <span class="in">`easyRasch`</span>, and others may be included in a future version. Below are conditional item characteristic curves (ICC's) using the estimated theta (factor score).</span>
<span id="cb133-513"><a href="#cb133-513" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-514"><a href="#cb133-514" aria-hidden="true" tabindex="-1"></a>These curves indicate item fit on a group level, where respondents are split into "class intervals" based on their sum score/factor score.</span>
<span id="cb133-515"><a href="#cb133-515" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-518"><a href="#cb133-518" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb133-519"><a href="#cb133-519" aria-hidden="true" tabindex="-1"></a><span class="fu">RIciccPlot</span>(df) <span class="sc">+</span></span>
<span id="cb133-520"><a href="#cb133-520" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guide_area</span>() <span class="co"># this relocates the legend/guide, which may produce a nicer output</span></span>
<span id="cb133-521"><a href="#cb133-521" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb133-522"><a href="#cb133-522" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-523"><a href="#cb133-523" aria-hidden="true" tabindex="-1"></a>A similar visualization, even more informative and flexible, has been made available in the <span class="co">[</span><span class="ot">`RASCHplot`</span><span class="co">](https://github.com/ERRTG/RASCHplot/)</span> package <span class="co">[</span><span class="ot">@buchardt_visualizing_2023</span><span class="co">]</span>. The package needs to be installed from GitHub (see commented code below). The linked paper is recommended reading, not least for descriptions of the useful options available. Below are some sample plots showing conditional ICC's using the raw sum score.</span>
<span id="cb133-524"><a href="#cb133-524" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-527"><a href="#cb133-527" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb133-528"><a href="#cb133-528" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RASCHplot) <span class="co"># devtools::install_github("ERRTG/RASCHplot")</span></span>
<span id="cb133-529"><a href="#cb133-529" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-530"><a href="#cb133-530" aria-hidden="true" tabindex="-1"></a><span class="fu">CICCplot</span>(<span class="fu">PCM</span>(df),</span>
<span id="cb133-531"><a href="#cb133-531" aria-hidden="true" tabindex="-1"></a>         <span class="at">which.item =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>),</span>
<span id="cb133-532"><a href="#cb133-532" aria-hidden="true" tabindex="-1"></a>         <span class="at">lower.groups =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">7</span>,<span class="dv">14</span>,<span class="dv">21</span>,<span class="dv">28</span>),</span>
<span id="cb133-533"><a href="#cb133-533" aria-hidden="true" tabindex="-1"></a>         <span class="at">grid.items =</span> <span class="cn">TRUE</span>)</span>
<span id="cb133-534"><a href="#cb133-534" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb133-535"><a href="#cb133-535" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-536"><a href="#cb133-536" aria-hidden="true" tabindex="-1"></a><span class="fu">### PCA of residuals</span></span>
<span id="cb133-537"><a href="#cb133-537" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-538"><a href="#cb133-538" aria-hidden="true" tabindex="-1"></a>Principal Component Analysis of Rasch model residuals (PCAR).</span>
<span id="cb133-539"><a href="#cb133-539" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-542"><a href="#cb133-542" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb133-543"><a href="#cb133-543" aria-hidden="true" tabindex="-1"></a><span class="fu">RIpcmPCA</span>(df)</span>
<span id="cb133-544"><a href="#cb133-544" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb133-545"><a href="#cb133-545" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-546"><a href="#cb133-546" aria-hidden="true" tabindex="-1"></a>Based on an old rule-of-thumb, the first eigenvalue should be below 1.5 to support unidimensionality <span class="co">[</span><span class="ot">@smith_detecting_2002</span><span class="co">]</span>. However, as with many other metrics the expected PCAR eigenvalue is also dependent on sample size and test length <span class="co">[</span><span class="ot">@chou_checking_2010</span><span class="co">]</span>. To be clear, there is no single or easily calculated rule-of-thumb critical value for the largest PCA eigenvalue that will be generally applicable. A parametric bootstrap function has been implemented in <span class="in">`easyRasch`</span> to determine a potentially appropriate cutoff value for the largest PCAR eigenvalue, but it has not been systematically evaluated yet. Below is an example, illustrated with a histogram of the simulated distribution of largest eigenvalues, the 99th percentile and the max value.</span>
<span id="cb133-547"><a href="#cb133-547" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-550"><a href="#cb133-550" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb133-551"><a href="#cb133-551" aria-hidden="true" tabindex="-1"></a>pcasim <span class="ot">&lt;-</span> <span class="fu">RIbootPCA</span>(df, <span class="at">iterations =</span> <span class="dv">500</span>, <span class="at">cpu =</span> <span class="dv">8</span>)</span>
<span id="cb133-552"><a href="#cb133-552" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(pcasim<span class="sc">$</span>results, <span class="at">breaks =</span> <span class="dv">50</span>)</span>
<span id="cb133-553"><a href="#cb133-553" aria-hidden="true" tabindex="-1"></a>pcasim<span class="sc">$</span>p99</span>
<span id="cb133-554"><a href="#cb133-554" aria-hidden="true" tabindex="-1"></a>pcasim<span class="sc">$</span>max</span>
<span id="cb133-555"><a href="#cb133-555" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb133-556"><a href="#cb133-556" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-557"><a href="#cb133-557" aria-hidden="true" tabindex="-1"></a>If the bootstrap turns out to provide an appropriate cutoff value, it still needs to be used together with checking item fit (or item-restscore) and residual correlations (local dependence) to evaluate unidimensionality.</span>
<span id="cb133-558"><a href="#cb133-558" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-559"><a href="#cb133-559" aria-hidden="true" tabindex="-1"></a>The PCA eigenvalues are mostly included here for those coming from Winsteps who may be looking for this metric. Speaking of Winsteps, the "explained variance" generated by <span class="in">`RIpcmPCA()`</span> will not be comparable to Winsteps corresponding metric, since this function only shows the results from the analysis of residuals and not the variance explained by the Rasch model itself. Additionally, it should be noted that the PCA rotation is set to "oblimin".</span>
<span id="cb133-560"><a href="#cb133-560" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-561"><a href="#cb133-561" aria-hidden="true" tabindex="-1"></a><span class="fu">### Conditional LRT</span></span>
<span id="cb133-562"><a href="#cb133-562" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-563"><a href="#cb133-563" aria-hidden="true" tabindex="-1"></a>The Conditional Likelihood Ratio Test <span class="co">[</span><span class="ot">CLRT, @andersen_goodness_1973</span><span class="co">]</span> is a global test of fit and can be a useful addition to more informative item-level metrics <span class="co">[</span><span class="ot">@johansson_detecting_2025</span><span class="co">]</span>. CLRT compares the responses of those scoring below the median to those scoring above the median to assess the homogeneity of the test. Below, we run the test using the smaller sample with a function from the <span class="in">`iarm`</span> package. </span>
<span id="cb133-564"><a href="#cb133-564" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-567"><a href="#cb133-567" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb133-568"><a href="#cb133-568" aria-hidden="true" tabindex="-1"></a><span class="fu">clr_tests</span>(df500, <span class="at">model =</span> <span class="st">"PCM"</span>)</span>
<span id="cb133-569"><a href="#cb133-569" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb133-570"><a href="#cb133-570" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-571"><a href="#cb133-571" aria-hidden="true" tabindex="-1"></a>The test is clearly statistically significant, even with the smaller sample, which indicates that unidimensionality does not hold. However, CLRT is sensitive to large sample sizes and number of items, and produces false positives above the nominal 5% level. See <span class="ot">&lt;https://pgmj.github.io/clrt.html&gt;</span> for a very small simulation study. To minimize the sample size issue, a non-parametric bootstrap function has been implemented in <span class="in">`easyRasch`</span>, where one can set the sample size manually. The function will then sample with replacement from the response data and conduct a separate CLRT for each sample drawn. </span>
<span id="cb133-572"><a href="#cb133-572" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-575"><a href="#cb133-575" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb133-576"><a href="#cb133-576" aria-hidden="true" tabindex="-1"></a><span class="fu">RIbootLRT</span>(df, <span class="at">iterations =</span> <span class="dv">1000</span>, <span class="at">samplesize =</span> <span class="dv">400</span>, <span class="at">cpu =</span> <span class="dv">8</span>)</span>
<span id="cb133-577"><a href="#cb133-577" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb133-578"><a href="#cb133-578" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-579"><a href="#cb133-579" aria-hidden="true" tabindex="-1"></a>The bootstrap method also shows a strong majority of statistically significant results.</span>
<span id="cb133-580"><a href="#cb133-580" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-581"><a href="#cb133-581" aria-hidden="true" tabindex="-1"></a>Global tests do not provide any information about the reason for misfit. The <span class="in">`iarm`</span> package has also implemented a function to get item specific information related to the CLRT, showing observed and expected values for each item.</span>
<span id="cb133-582"><a href="#cb133-582" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-585"><a href="#cb133-585" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb133-586"><a href="#cb133-586" aria-hidden="true" tabindex="-1"></a><span class="fu">item_obsexp</span>(<span class="fu">PCM</span>(df500))</span>
<span id="cb133-587"><a href="#cb133-587" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb133-588"><a href="#cb133-588" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-589"><a href="#cb133-589" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-590"><a href="#cb133-590" aria-hidden="true" tabindex="-1"></a><span class="fu">### Local dependence (Q~3~)</span></span>
<span id="cb133-591"><a href="#cb133-591" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-592"><a href="#cb133-592" aria-hidden="true" tabindex="-1"></a>In order to support unidimensionality, items should only be related to each other through the latent variable, and otherwise be independent of each other. This is called "local independence" when fulfilled and "local dependence" (LD) when there are issues. The extreme case of dependence is when all respondents give the same response for two items. Two aspects of LD are often described <span class="co">[</span><span class="ot">@chen_local_1997</span><span class="co">]</span>:</span>
<span id="cb133-593"><a href="#cb133-593" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-594"><a href="#cb133-594" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Underlying local dependence (ULD), which is when the locally dependent items are measuring a different latent variable than the other items.</span>
<span id="cb133-595"><a href="#cb133-595" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>Surface local dependence (SLD), when item content is very similar.</span>
<span id="cb133-596"><a href="#cb133-596" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-597"><a href="#cb133-597" aria-hidden="true" tabindex="-1"></a>By investigating patterns in model residuals, we can determine whether items are independent or not. There are several tests that can be used to assess LD, of which Yen's Q~3~ generally has good properties. Please see <span class="co">[</span><span class="ot">@edwards_diagnostic_2018</span><span class="co">]</span> for an overview of different methods. It is recommended to use multiple methods, since they may perform differently with different types of LD. For instance, Chen &amp; Thissen <span class="co">[</span><span class="ot">-@chen_local_1997</span><span class="co">]</span> report that G^2^ is slightly more powerful than Yen's Q~3~ in detecting SLD, while the reverse is true for ULD.</span>
<span id="cb133-598"><a href="#cb133-598" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-599"><a href="#cb133-599" aria-hidden="true" tabindex="-1"></a>Similarly to item fit, we need to run simulations based on the observed data to get a useful cutoff threshold value for when residual correlations amongst item pairs are larger than would be expected from items that fit a unidimensional Rasch model <span class="co">[</span><span class="ot">@christensen2017</span><span class="co">]</span>.</span>
<span id="cb133-600"><a href="#cb133-600" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-601"><a href="#cb133-601" aria-hidden="true" tabindex="-1"></a>The simulation/bootstrap procedure can take some time to run, depending on the complexity of your data, but it is necessary to set the appropriate cutoff value. The number of iterations to use has yet to be systematically evaluated, but I recommend no less than 500, and at least 1000 as a starting point.</span>
<span id="cb133-602"><a href="#cb133-602" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-605"><a href="#cb133-605" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb133-606"><a href="#cb133-606" aria-hidden="true" tabindex="-1"></a>simcor1 <span class="ot">&lt;-</span> <span class="fu">RIgetResidCor</span>(df, <span class="at">iterations =</span> <span class="dv">500</span>, <span class="at">cpu =</span> <span class="dv">8</span>)</span>
<span id="cb133-607"><a href="#cb133-607" aria-hidden="true" tabindex="-1"></a><span class="fu">RIresidcorr</span>(df, <span class="at">cutoff =</span> simcor1<span class="sc">$</span>p995)</span>
<span id="cb133-608"><a href="#cb133-608" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb133-609"><a href="#cb133-609" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-610"><a href="#cb133-610" aria-hidden="true" tabindex="-1"></a>The matrix above shows item-pair correlations of item residuals, with highlights in red showing correlations crossing the threshold compared to the average item-pair correlation (for all item-pairs) <span class="co">[</span><span class="ot">@christensen2017</span><span class="co">]</span>. The threshold used in the example above has selected the 99.5th percentile from the simulations. The <span class="in">`simcor1`</span> object also pre-calculates values for the 95th, 99th, 99.5th and 99.9th percentiles as well as the maximum. If you desire another percentile, you can manually calculate it from the results in the <span class="in">`simcor1`</span> object using <span class="in">`quantile()`</span>.</span>
<span id="cb133-611"><a href="#cb133-611" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-612"><a href="#cb133-612" aria-hidden="true" tabindex="-1"></a>Rasch model residual correlations using Yen's Q~3~ are calculated using the <span class="co">[</span><span class="ot">mirt</span><span class="co">](https://cran.r-project.org/web/packages/mirt/index.html)</span> package.</span>
<span id="cb133-613"><a href="#cb133-613" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-614"><a href="#cb133-614" aria-hidden="true" tabindex="-1"></a><span class="fu">### Local dependence (G^2^)</span></span>
<span id="cb133-615"><a href="#cb133-615" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-616"><a href="#cb133-616" aria-hidden="true" tabindex="-1"></a>Rasch model residual correlations using Chen &amp; Thissen's G^2^ are calculated using the <span class="co">[</span><span class="ot">mirt</span><span class="co">](https://cran.r-project.org/web/packages/mirt/index.html)</span> package.</span>
<span id="cb133-617"><a href="#cb133-617" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-620"><a href="#cb133-620" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb133-621"><a href="#cb133-621" aria-hidden="true" tabindex="-1"></a>simcor_g2 <span class="ot">&lt;-</span> <span class="fu">RIgetResidCorG2</span>(df, <span class="at">iterations =</span> <span class="dv">500</span>, <span class="at">cpu =</span> <span class="dv">8</span>)</span>
<span id="cb133-622"><a href="#cb133-622" aria-hidden="true" tabindex="-1"></a><span class="fu">RIresidcorrG2</span>(df, <span class="at">cutoff =</span> simcor_g2<span class="sc">$</span>p995)</span>
<span id="cb133-623"><a href="#cb133-623" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb133-624"><a href="#cb133-624" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-625"><a href="#cb133-625" aria-hidden="true" tabindex="-1"></a><span class="fu">### LD (partial gamma)</span></span>
<span id="cb133-626"><a href="#cb133-626" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-627"><a href="#cb133-627" aria-hidden="true" tabindex="-1"></a>Another way to assess local (in)dependence is by partial gamma coefficients <span class="co">[</span><span class="ot">@kreiner_analysis_2004</span><span class="co">]</span>. This is also a function from the <span class="in">`iarm`</span> package. See <span class="in">`?iarm::partgam_LD`</span> for details.</span>
<span id="cb133-628"><a href="#cb133-628" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-631"><a href="#cb133-631" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb133-632"><a href="#cb133-632" aria-hidden="true" tabindex="-1"></a><span class="fu">RIpartgamLD</span>(df)</span>
<span id="cb133-633"><a href="#cb133-633" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb133-634"><a href="#cb133-634" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-635"><a href="#cb133-635" aria-hidden="true" tabindex="-1"></a><span class="fu">### 1st contrast loadings</span></span>
<span id="cb133-636"><a href="#cb133-636" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-639"><a href="#cb133-639" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb133-640"><a href="#cb133-640" aria-hidden="true" tabindex="-1"></a><span class="fu">RIloadLoc</span>(df)</span>
<span id="cb133-641"><a href="#cb133-641" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb133-642"><a href="#cb133-642" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-643"><a href="#cb133-643" aria-hidden="true" tabindex="-1"></a>Here we see item locations and their loadings on the first residual contrast. This figure can be helpful to identify clusters in data or multidimensionality. You can get a table with standardized factor loadings using <span class="in">`RIloadLoc(df, output = "table")`</span>.</span>
<span id="cb133-644"><a href="#cb133-644" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-645"><a href="#cb133-645" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-646"><a href="#cb133-646" aria-hidden="true" tabindex="-1"></a><span class="fu">### Analysis of response categories</span></span>
<span id="cb133-647"><a href="#cb133-647" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-648"><a href="#cb133-648" aria-hidden="true" tabindex="-1"></a>The <span class="in">`xlims`</span> setting changes the x-axis limits for the plots. The default values usually make sense, and we mostly add this option to point out the possibility of doing so. You can also choose to only show plots for only specific items.</span>
<span id="cb133-649"><a href="#cb133-649" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-652"><a href="#cb133-652" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb133-653"><a href="#cb133-653" aria-hidden="true" tabindex="-1"></a><span class="co">#| layout-ncol: 2</span></span>
<span id="cb133-654"><a href="#cb133-654" aria-hidden="true" tabindex="-1"></a><span class="fu">RIitemCats</span>(df, <span class="at">xlims =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">5</span>,<span class="dv">5</span>))</span>
<span id="cb133-655"><a href="#cb133-655" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb133-656"><a href="#cb133-656" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-657"><a href="#cb133-657" aria-hidden="true" tabindex="-1"></a>Each response category for each item should have a curve that indicates it to be the most probably response at some point on the latent variable (x axis in the figure).</span>
<span id="cb133-658"><a href="#cb133-658" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-659"><a href="#cb133-659" aria-hidden="true" tabindex="-1"></a><span class="fu">### Response categories MIRT</span></span>
<span id="cb133-660"><a href="#cb133-660" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-661"><a href="#cb133-661" aria-hidden="true" tabindex="-1"></a>This produces a single figure with all items. Note that <span class="in">`mirt()`</span> uses marginal maximum likelihood (MML) estimation which may produce slightly different results compared to eRm/CML when the distribution of person locations/scores are non-normal.</span>
<span id="cb133-662"><a href="#cb133-662" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-665"><a href="#cb133-665" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb133-666"><a href="#cb133-666" aria-hidden="true" tabindex="-1"></a><span class="fu">mirt</span>(df, <span class="at">model=</span><span class="dv">1</span>, <span class="at">itemtype=</span><span class="st">'Rasch'</span>, <span class="at">verbose =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb133-667"><a href="#cb133-667" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(<span class="at">type=</span><span class="st">"trace"</span>, <span class="at">as.table =</span> <span class="cn">TRUE</span>, </span>
<span id="cb133-668"><a href="#cb133-668" aria-hidden="true" tabindex="-1"></a>       <span class="at">theta_lim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">5</span>,<span class="dv">5</span>)) <span class="co"># changes x axis limits</span></span>
<span id="cb133-669"><a href="#cb133-669" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb133-670"><a href="#cb133-670" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-671"><a href="#cb133-671" aria-hidden="true" tabindex="-1"></a><span class="fu">### Targeting</span></span>
<span id="cb133-672"><a href="#cb133-672" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-675"><a href="#cb133-675" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb133-676"><a href="#cb133-676" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 7</span></span>
<span id="cb133-677"><a href="#cb133-677" aria-hidden="true" tabindex="-1"></a><span class="co"># increase fig-height in the chunk option above if you have many items</span></span>
<span id="cb133-678"><a href="#cb133-678" aria-hidden="true" tabindex="-1"></a><span class="fu">RItargeting</span>(df, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">5</span>,<span class="dv">4</span>)) <span class="co"># xlim defaults to c(-4,4) if you omit this option</span></span>
<span id="cb133-679"><a href="#cb133-679" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb133-680"><a href="#cb133-680" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-681"><a href="#cb133-681" aria-hidden="true" tabindex="-1"></a>This figure shows how well the items fit the respondents/persons. It is a sort of <span class="co">[</span><span class="ot">Wright Map</span><span class="co">](https://www.rasch.org/rmt/rmt253b.htm)</span> that shows person locations and item threshold locations on the same logit scale.</span>
<span id="cb133-682"><a href="#cb133-682" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-683"><a href="#cb133-683" aria-hidden="true" tabindex="-1"></a>The top part shows person location histogram, the middle part an inverted histogram of item threshold locations, and the bottom part shows individual item threshold locations. The histograms also show means and standard deviations.</span>
<span id="cb133-684"><a href="#cb133-684" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-685"><a href="#cb133-685" aria-hidden="true" tabindex="-1"></a><span class="fu">### Item hierarchy</span></span>
<span id="cb133-686"><a href="#cb133-686" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-687"><a href="#cb133-687" aria-hidden="true" tabindex="-1"></a>Here the items are sorted on their average threshold location (black diamonds). 84% confidence intervals are shown around each item threshold location. For further details, see the caption text below the figure.</span>
<span id="cb133-688"><a href="#cb133-688" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-689"><a href="#cb133-689" aria-hidden="true" tabindex="-1"></a>The numbers displayed in the plot can be disabled using the option <span class="in">`numbers = FALSE`</span>.</span>
<span id="cb133-690"><a href="#cb133-690" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-693"><a href="#cb133-693" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb133-694"><a href="#cb133-694" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 6</span></span>
<span id="cb133-695"><a href="#cb133-695" aria-hidden="true" tabindex="-1"></a><span class="fu">RIitemHierarchy</span>(df)</span>
<span id="cb133-696"><a href="#cb133-696" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb133-697"><a href="#cb133-697" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb133-698"><a href="#cb133-698" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-699"><a href="#cb133-699" aria-hidden="true" tabindex="-1"></a><span class="fu">### Analysis 1 comments</span></span>
<span id="cb133-700"><a href="#cb133-700" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-701"><a href="#cb133-701" aria-hidden="true" tabindex="-1"></a>Item fit shows a lot of issues.</span>
<span id="cb133-702"><a href="#cb133-702" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-703"><a href="#cb133-703" aria-hidden="true" tabindex="-1"></a>Item 18 has issues with the second lowest category being disordered. Several other items have very short distances between thresholds 1 and 2, which is also clearly seen in the Item Hierarchy figure above.</span>
<span id="cb133-704"><a href="#cb133-704" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-705"><a href="#cb133-705" aria-hidden="true" tabindex="-1"></a>Two item-pairs show residual correlations far above the cutoff value:</span>
<span id="cb133-706"><a href="#cb133-706" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-707"><a href="#cb133-707" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>15 and 16 (scared and afraid)</span>
<span id="cb133-708"><a href="#cb133-708" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>17 and 18 (ashamed and guilty)</span>
<span id="cb133-709"><a href="#cb133-709" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-710"><a href="#cb133-710" aria-hidden="true" tabindex="-1"></a>Since item 15 also has a residual correlation with item 19, we will remove it. In the second pair, item 18 will be removed since it also has problems with disordered response categories.</span>
<span id="cb133-711"><a href="#cb133-711" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-712"><a href="#cb133-712" aria-hidden="true" tabindex="-1"></a>::: {.callout-note icon="true"}</span>
<span id="cb133-713"><a href="#cb133-713" aria-hidden="true" tabindex="-1"></a>We have multiple "diagnostics" to review when deciding which item to remove if there are strong residual correlations between two items. Here is a list of commonly used criteria:</span>
<span id="cb133-714"><a href="#cb133-714" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-715"><a href="#cb133-715" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>item fit</span>
<span id="cb133-716"><a href="#cb133-716" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>item threshold locations compared to sample locations (targeting)</span>
<span id="cb133-717"><a href="#cb133-717" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>ordering of response categories</span>
<span id="cb133-718"><a href="#cb133-718" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>DIF</span>
<span id="cb133-719"><a href="#cb133-719" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>and whether there are residual correlations between one item and multiple other items</span>
<span id="cb133-720"><a href="#cb133-720" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb133-721"><a href="#cb133-721" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-724"><a href="#cb133-724" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb133-725"><a href="#cb133-725" aria-hidden="true" tabindex="-1"></a>removed.items <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"PANAS_15"</span>,<span class="st">"PANAS_18"</span>)</span>
<span id="cb133-726"><a href="#cb133-726" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-727"><a href="#cb133-727" aria-hidden="true" tabindex="-1"></a>df_backup <span class="ot">&lt;-</span> df</span>
<span id="cb133-728"><a href="#cb133-728" aria-hidden="true" tabindex="-1"></a>df500_backup <span class="ot">&lt;-</span> df500</span>
<span id="cb133-729"><a href="#cb133-729" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-730"><a href="#cb133-730" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df_backup <span class="sc">%&gt;%</span> </span>
<span id="cb133-731"><a href="#cb133-731" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">!</span><span class="fu">any_of</span>(removed.items))</span>
<span id="cb133-732"><a href="#cb133-732" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-733"><a href="#cb133-733" aria-hidden="true" tabindex="-1"></a>df500 <span class="ot">&lt;-</span> df500_backup <span class="sc">%&gt;%</span> </span>
<span id="cb133-734"><a href="#cb133-734" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">!</span><span class="fu">any_of</span>(removed.items))</span>
<span id="cb133-735"><a href="#cb133-735" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb133-736"><a href="#cb133-736" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-737"><a href="#cb133-737" aria-hidden="true" tabindex="-1"></a>As seen in the code above, I chose to create a backup copy of the original dataframes, then removing the items. This can be useful if, at a later stage in the analysis, I want to be able to quickly "go back" and reinstate an item or undo any other change I have made.</span>
<span id="cb133-738"><a href="#cb133-738" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-739"><a href="#cb133-739" aria-hidden="true" tabindex="-1"></a><span class="fu">## Rasch analysis 2</span></span>
<span id="cb133-740"><a href="#cb133-740" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-741"><a href="#cb133-741" aria-hidden="true" tabindex="-1"></a>With items 15 and 18 removed.</span>
<span id="cb133-742"><a href="#cb133-742" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-745"><a href="#cb133-745" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb133-746"><a href="#cb133-746" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: margin</span></span>
<span id="cb133-747"><a href="#cb133-747" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb133-748"><a href="#cb133-748" aria-hidden="true" tabindex="-1"></a><span class="fu">RIlistItemsMargin</span>(df, <span class="at">fontsize =</span> <span class="dv">13</span>)</span>
<span id="cb133-749"><a href="#cb133-749" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb133-750"><a href="#cb133-750" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-751"><a href="#cb133-751" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb133-752"><a href="#cb133-752" aria-hidden="true" tabindex="-1"></a><span class="fu">### Item-restscore bootstrap</span></span>
<span id="cb133-753"><a href="#cb133-753" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-756"><a href="#cb133-756" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb133-757"><a href="#cb133-757" aria-hidden="true" tabindex="-1"></a><span class="fu">RIbootRestscore</span>(df, <span class="at">iterations =</span> <span class="dv">250</span>, <span class="at">samplesize =</span> <span class="dv">800</span>)</span>
<span id="cb133-758"><a href="#cb133-758" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb133-759"><a href="#cb133-759" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-760"><a href="#cb133-760" aria-hidden="true" tabindex="-1"></a><span class="fu">### Conditional item fit</span></span>
<span id="cb133-761"><a href="#cb133-761" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-762"><a href="#cb133-762" aria-hidden="true" tabindex="-1"></a>Still using the smaller sample of n = 500.</span>
<span id="cb133-763"><a href="#cb133-763" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-766"><a href="#cb133-766" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb133-767"><a href="#cb133-767" aria-hidden="true" tabindex="-1"></a>simfit2 <span class="ot">&lt;-</span> <span class="fu">RIgetfit</span>(df500, <span class="at">iterations =</span> <span class="dv">400</span>, <span class="at">cpu =</span> <span class="dv">8</span>)</span>
<span id="cb133-768"><a href="#cb133-768" aria-hidden="true" tabindex="-1"></a><span class="fu">RIitemfit</span>(df500, <span class="at">simcut =</span> simfit2)</span>
<span id="cb133-769"><a href="#cb133-769" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb133-770"><a href="#cb133-770" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-771"><a href="#cb133-771" aria-hidden="true" tabindex="-1"></a><span class="fu">### PCA of residuals</span></span>
<span id="cb133-772"><a href="#cb133-772" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-775"><a href="#cb133-775" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb133-776"><a href="#cb133-776" aria-hidden="true" tabindex="-1"></a><span class="fu">RIpcmPCA</span>(df)</span>
<span id="cb133-777"><a href="#cb133-777" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb133-778"><a href="#cb133-778" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-779"><a href="#cb133-779" aria-hidden="true" tabindex="-1"></a><span class="fu">### Residual correlations</span></span>
<span id="cb133-780"><a href="#cb133-780" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-783"><a href="#cb133-783" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb133-784"><a href="#cb133-784" aria-hidden="true" tabindex="-1"></a>simcor2 <span class="ot">&lt;-</span> <span class="fu">RIgetResidCor</span>(df, <span class="at">iterations =</span> <span class="dv">400</span>, <span class="at">cpu =</span> <span class="dv">8</span>)</span>
<span id="cb133-785"><a href="#cb133-785" aria-hidden="true" tabindex="-1"></a><span class="fu">RIresidcorr</span>(df, <span class="at">cutoff =</span> simcor2<span class="sc">$</span>p99)</span>
<span id="cb133-786"><a href="#cb133-786" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb133-787"><a href="#cb133-787" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-788"><a href="#cb133-788" aria-hidden="true" tabindex="-1"></a><span class="fu">### 1st contrast loadings</span></span>
<span id="cb133-789"><a href="#cb133-789" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-792"><a href="#cb133-792" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb133-793"><a href="#cb133-793" aria-hidden="true" tabindex="-1"></a><span class="fu">RIloadLoc</span>(df)</span>
<span id="cb133-794"><a href="#cb133-794" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb133-795"><a href="#cb133-795" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-796"><a href="#cb133-796" aria-hidden="true" tabindex="-1"></a><span class="fu">### Targeting</span></span>
<span id="cb133-797"><a href="#cb133-797" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-800"><a href="#cb133-800" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb133-801"><a href="#cb133-801" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 5</span></span>
<span id="cb133-802"><a href="#cb133-802" aria-hidden="true" tabindex="-1"></a><span class="fu">RItargeting</span>(df, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">4</span>,<span class="dv">4</span>), <span class="at">bins =</span> <span class="dv">45</span>)</span>
<span id="cb133-803"><a href="#cb133-803" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb133-804"><a href="#cb133-804" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-805"><a href="#cb133-805" aria-hidden="true" tabindex="-1"></a><span class="fu">### Item hierarchy</span></span>
<span id="cb133-806"><a href="#cb133-806" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-809"><a href="#cb133-809" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb133-810"><a href="#cb133-810" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 5</span></span>
<span id="cb133-811"><a href="#cb133-811" aria-hidden="true" tabindex="-1"></a><span class="fu">RIitemHierarchy</span>(df)</span>
<span id="cb133-812"><a href="#cb133-812" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb133-813"><a href="#cb133-813" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb133-814"><a href="#cb133-814" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-815"><a href="#cb133-815" aria-hidden="true" tabindex="-1"></a><span class="fu">### Analysis 2 comments</span></span>
<span id="cb133-816"><a href="#cb133-816" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-817"><a href="#cb133-817" aria-hidden="true" tabindex="-1"></a>Items 16 &amp; 19, and 12 &amp; 14 show problematic residual correlations.</span>
<span id="cb133-818"><a href="#cb133-818" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-819"><a href="#cb133-819" aria-hidden="true" tabindex="-1"></a>Let's look at DIF before taking action upon this information. **While we are keeping DIF as a separate section in this vignette, it is recommended to include DIF-analysis in the `panel-tabset` above (on item fit, residual correlations, etc).**</span>
<span id="cb133-820"><a href="#cb133-820" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-821"><a href="#cb133-821" aria-hidden="true" tabindex="-1"></a><span class="fu">## DIF - differential item functioning</span></span>
<span id="cb133-822"><a href="#cb133-822" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-823"><a href="#cb133-823" aria-hidden="true" tabindex="-1"></a>DIF is a complex topic, which is why it gets a separate section here. Even so, this vignette will just brush the surface. For an historical overview, which also includes recent developments, see Thissen <span class="co">[</span><span class="ot">-@thissen_review_2025</span><span class="co">]</span>.</span>
<span id="cb133-824"><a href="#cb133-824" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-825"><a href="#cb133-825" aria-hidden="true" tabindex="-1"></a>::: {.callout-note icon="true"}</span>
<span id="cb133-826"><a href="#cb133-826" aria-hidden="true" tabindex="-1"></a>While we are keeping DIF as a separate section in this vignette, it is recommended to include DIF-analysis in the parallel analysis above (on item fit, targeting, residual correlations, etc) since DIF tests will help you understand or evaluate item functioning together with the other tests.</span>
<span id="cb133-827"><a href="#cb133-827" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb133-828"><a href="#cb133-828" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-829"><a href="#cb133-829" aria-hidden="true" tabindex="-1"></a>We'll be looking at whether item (threshold) locations are stable between demographic subgroups. There are usually two key aspects to this analysis. One is whether we can detect DIF for one or more items. The other is the magnitude of DIF and how it affects the use of the overall test, if test scores are biased for any group. I recommend a paper by Chalmers et al. <span class="co">[</span><span class="ot">-@chalmers_it_2016</span><span class="co">]</span> on the topic of DTF, differential test functioning.</span>
<span id="cb133-830"><a href="#cb133-830" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-831"><a href="#cb133-831" aria-hidden="true" tabindex="-1"></a>There are several DIF analysis tools available. The first one uses the package <span class="in">`psychotree`</span>, which relies on statistical significance at p &lt; .05 as an indicator for DIF. This is a criterion that is highly sample size sensitive, and we are always interested in the size/magnitude of DIF as well, since that will inform us about the impact of DIF on the estimated latent variable. </span>
<span id="cb133-832"><a href="#cb133-832" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-833"><a href="#cb133-833" aria-hidden="true" tabindex="-1"></a>The structure of DIF is also important to assess, particularly for polytomous data. Uniform DIF means that the DIF is similar across the latent continuum. The <span class="in">`RIciccPlot()`</span> function can be used for DIF analysis and produces curves that show whether DIF is uniform or not. We can also test for uniformity formally in R using the <span class="in">`lordif`</span> package, as demonstrated in @sec-lordif. However, it should be noted that the <span class="in">`lordif`</span> package does not provide an option to use Rasch models, and there may be results that are caused by also allowing the discrimination parameter to vary across items. </span>
<span id="cb133-834"><a href="#cb133-834" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-835"><a href="#cb133-835" aria-hidden="true" tabindex="-1"></a>A recent preprint <span class="co">[</span><span class="ot">@henninger_partial_2024</span><span class="co">]</span> does a great job illustrating "differential step functioning" (DSF), which is when item threshold locations in polytomous data show varying levels of DIF. It also describes a forthcoming development of the <span class="in">`psychotree`</span> where one can use DIF effect size and purification functions to evaluate DIF/DSF. When the updated package is available, I will work to implement these new functions into the <span class="in">`easyRasch`</span> package as well.</span>
<span id="cb133-836"><a href="#cb133-836" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-837"><a href="#cb133-837" aria-hidden="true" tabindex="-1"></a>::: {.callout-note icon="true"}</span>
<span id="cb133-838"><a href="#cb133-838" aria-hidden="true" tabindex="-1"></a>It is important to ensure that no cells in the data are empty for subgroups when conducting a DIF analysis. Split the data using the DIF-variable and create separate tileplots to review the response distribution in the DIF-groups.</span>
<span id="cb133-839"><a href="#cb133-839" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb133-840"><a href="#cb133-840" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-843"><a href="#cb133-843" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb133-844"><a href="#cb133-844" aria-hidden="true" tabindex="-1"></a><span class="fu">RIdifTileplot</span>(df, dif<span class="sc">$</span>Sex)</span>
<span id="cb133-845"><a href="#cb133-845" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb133-846"><a href="#cb133-846" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-847"><a href="#cb133-847" aria-hidden="true" tabindex="-1"></a><span class="fu">### Sex</span></span>
<span id="cb133-848"><a href="#cb133-848" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-851"><a href="#cb133-851" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb133-852"><a href="#cb133-852" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: margin</span></span>
<span id="cb133-853"><a href="#cb133-853" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb133-854"><a href="#cb133-854" aria-hidden="true" tabindex="-1"></a><span class="fu">RIlistItemsMargin</span>(df, <span class="at">fontsize =</span> <span class="dv">13</span>)</span>
<span id="cb133-855"><a href="#cb133-855" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb133-856"><a href="#cb133-856" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-857"><a href="#cb133-857" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb133-858"><a href="#cb133-858" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Table</span></span>
<span id="cb133-859"><a href="#cb133-859" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-862"><a href="#cb133-862" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb133-863"><a href="#cb133-863" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 3</span></span>
<span id="cb133-864"><a href="#cb133-864" aria-hidden="true" tabindex="-1"></a><span class="fu">RIdifTable</span>(df, dif<span class="sc">$</span>Sex)</span>
<span id="cb133-865"><a href="#cb133-865" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb133-866"><a href="#cb133-866" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-867"><a href="#cb133-867" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Figure items</span></span>
<span id="cb133-868"><a href="#cb133-868" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-871"><a href="#cb133-871" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb133-872"><a href="#cb133-872" aria-hidden="true" tabindex="-1"></a><span class="fu">RIdifFigure</span>(df, dif<span class="sc">$</span>Sex)</span>
<span id="cb133-873"><a href="#cb133-873" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb133-874"><a href="#cb133-874" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-875"><a href="#cb133-875" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Figure thresholds</span></span>
<span id="cb133-876"><a href="#cb133-876" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-879"><a href="#cb133-879" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb133-880"><a href="#cb133-880" aria-hidden="true" tabindex="-1"></a><span class="fu">RIdifFigThresh</span>(df, dif<span class="sc">$</span>Sex)</span>
<span id="cb133-881"><a href="#cb133-881" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb133-882"><a href="#cb133-882" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb133-883"><a href="#cb133-883" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-884"><a href="#cb133-884" aria-hidden="true" tabindex="-1"></a>While no item shows problematic levels of DIF regarding item location, as shown by the table, there is an interesting pattern in the thresholds figure. The lowest threshold seems to be slightly lower for node 3 (Male) for all items. Also, item 11 shows a much wider spread of item locations for node 3 compared to node 2.</span>
<span id="cb133-885"><a href="#cb133-885" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-886"><a href="#cb133-886" aria-hidden="true" tabindex="-1"></a>The results do not require any action since the difference is small.</span>
<span id="cb133-887"><a href="#cb133-887" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-888"><a href="#cb133-888" aria-hidden="true" tabindex="-1"></a><span class="fu">### Age</span></span>
<span id="cb133-889"><a href="#cb133-889" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-890"><a href="#cb133-890" aria-hidden="true" tabindex="-1"></a>The <span class="in">`psychotree`</span> package uses a model-based recursive partitioning that is particularly useful when you have a continuous variable such as age in years and a large enough sample. It will test different ways to partition the age variable to determine potential group differences <span class="co">[</span><span class="ot">@strobl2015; @strobl2021</span><span class="co">]</span>.</span>
<span id="cb133-891"><a href="#cb133-891" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-894"><a href="#cb133-894" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb133-895"><a href="#cb133-895" aria-hidden="true" tabindex="-1"></a><span class="fu">RIdifTable</span>(df, dif<span class="sc">$</span>Age)</span>
<span id="cb133-896"><a href="#cb133-896" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb133-897"><a href="#cb133-897" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-898"><a href="#cb133-898" aria-hidden="true" tabindex="-1"></a>No DIF found for age.</span>
<span id="cb133-899"><a href="#cb133-899" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-900"><a href="#cb133-900" aria-hidden="true" tabindex="-1"></a><span class="fu">### Group</span></span>
<span id="cb133-901"><a href="#cb133-901" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-904"><a href="#cb133-904" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb133-905"><a href="#cb133-905" aria-hidden="true" tabindex="-1"></a><span class="fu">RIdifTable</span>(df, dif<span class="sc">$</span>Group)</span>
<span id="cb133-906"><a href="#cb133-906" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb133-907"><a href="#cb133-907" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-908"><a href="#cb133-908" aria-hidden="true" tabindex="-1"></a>And no DIF for group.</span>
<span id="cb133-909"><a href="#cb133-909" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-910"><a href="#cb133-910" aria-hidden="true" tabindex="-1"></a><span class="fu">### Sex and age</span></span>
<span id="cb133-911"><a href="#cb133-911" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-912"><a href="#cb133-912" aria-hidden="true" tabindex="-1"></a>The <span class="in">`psychotree`</span> package also allows for DIF interaction analysis with multiple DIF variables. We can use <span class="in">`RIdifTable2()`</span> to input two DIF variables.</span>
<span id="cb133-913"><a href="#cb133-913" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-916"><a href="#cb133-916" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb133-917"><a href="#cb133-917" aria-hidden="true" tabindex="-1"></a><span class="fu">RIdifTable2</span>(df, dif<span class="sc">$</span>Sex, dif<span class="sc">$</span>Age)</span>
<span id="cb133-918"><a href="#cb133-918" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-919"><a href="#cb133-919" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb133-920"><a href="#cb133-920" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-921"><a href="#cb133-921" aria-hidden="true" tabindex="-1"></a>No interaction effect found for sex and age. The analysis only shows the previously identified DIF for sex.</span>
<span id="cb133-922"><a href="#cb133-922" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-923"><a href="#cb133-923" aria-hidden="true" tabindex="-1"></a><span class="fu">### LRT-based DIF {#sec-diflrt}</span></span>
<span id="cb133-924"><a href="#cb133-924" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-925"><a href="#cb133-925" aria-hidden="true" tabindex="-1"></a>We'll use the group variable as an example. It's always important to review the response distribution across DIF groups prior to running the DIF analysis. We need to make sure that there are responses in all cells in all subgroups.</span>
<span id="cb133-926"><a href="#cb133-926" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-929"><a href="#cb133-929" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb133-930"><a href="#cb133-930" aria-hidden="true" tabindex="-1"></a><span class="fu">RIdifTileplot</span>(df, dif<span class="sc">$</span>Group)</span>
<span id="cb133-931"><a href="#cb133-931" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb133-932"><a href="#cb133-932" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-933"><a href="#cb133-933" aria-hidden="true" tabindex="-1"></a>First, we can simply run the test to get the overall result.</span>
<span id="cb133-934"><a href="#cb133-934" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-937"><a href="#cb133-937" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb133-938"><a href="#cb133-938" aria-hidden="true" tabindex="-1"></a>erm.out <span class="ot">&lt;-</span> <span class="fu">PCM</span>(df)</span>
<span id="cb133-939"><a href="#cb133-939" aria-hidden="true" tabindex="-1"></a><span class="fu">LRtest</span>(erm.out, <span class="at">splitcr =</span> dif<span class="sc">$</span>Group)</span>
<span id="cb133-940"><a href="#cb133-940" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb133-941"><a href="#cb133-941" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-942"><a href="#cb133-942" aria-hidden="true" tabindex="-1"></a>Review the documentation for further details, using <span class="in">`?LRtest`</span> in your R console panel in Rstudio. There is also a plotting function, <span class="in">`plotGOF()`</span> that may be of interest.</span>
<span id="cb133-943"><a href="#cb133-943" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-946"><a href="#cb133-946" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb133-947"><a href="#cb133-947" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: margin</span></span>
<span id="cb133-948"><a href="#cb133-948" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb133-949"><a href="#cb133-949" aria-hidden="true" tabindex="-1"></a><span class="fu">RIlistItemsMargin</span>(df, <span class="at">fontsize =</span> <span class="dv">13</span>)</span>
<span id="cb133-950"><a href="#cb133-950" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb133-951"><a href="#cb133-951" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-952"><a href="#cb133-952" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb133-953"><a href="#cb133-953" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Item location table</span></span>
<span id="cb133-956"><a href="#cb133-956" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb133-957"><a href="#cb133-957" aria-hidden="true" tabindex="-1"></a><span class="fu">RIdifTableLR</span>(df, dif<span class="sc">$</span>Group)</span>
<span id="cb133-958"><a href="#cb133-958" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb133-959"><a href="#cb133-959" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Item location figure</span></span>
<span id="cb133-962"><a href="#cb133-962" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb133-963"><a href="#cb133-963" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 7</span></span>
<span id="cb133-964"><a href="#cb133-964" aria-hidden="true" tabindex="-1"></a><span class="fu">RIdifFigureLR</span>(df, dif<span class="sc">$</span>Group) <span class="sc">+</span> <span class="fu">theme_rise</span>()</span>
<span id="cb133-965"><a href="#cb133-965" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb133-966"><a href="#cb133-966" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Item threshold table</span></span>
<span id="cb133-969"><a href="#cb133-969" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb133-970"><a href="#cb133-970" aria-hidden="true" tabindex="-1"></a><span class="fu">RIdifThreshTblLR</span>(df, dif<span class="sc">$</span>Group)</span>
<span id="cb133-971"><a href="#cb133-971" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb133-972"><a href="#cb133-972" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Item threshold figure</span></span>
<span id="cb133-975"><a href="#cb133-975" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb133-976"><a href="#cb133-976" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 7</span></span>
<span id="cb133-977"><a href="#cb133-977" aria-hidden="true" tabindex="-1"></a><span class="fu">RIdifThreshFigLR</span>(df, dif<span class="sc">$</span>Group) <span class="sc">+</span> <span class="fu">theme_rise</span>()</span>
<span id="cb133-978"><a href="#cb133-978" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb133-979"><a href="#cb133-979" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb133-980"><a href="#cb133-980" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-981"><a href="#cb133-981" aria-hidden="true" tabindex="-1"></a>The item threshold table shows that the top threshold for item 13 differs more than 0.5 logits between groups. In this set of 8 items with 4 thresholds each, it is unlikely to result in problematic differences in estimated person scores.</span>
<span id="cb133-982"><a href="#cb133-982" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-983"><a href="#cb133-983" aria-hidden="true" tabindex="-1"></a><span class="fu">### Conditional ICC</span></span>
<span id="cb133-984"><a href="#cb133-984" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-985"><a href="#cb133-985" aria-hidden="true" tabindex="-1"></a>The <span class="in">`iarm`</span> package function for CICC plots also includes the option to use a DIF variable. This gives us information about DIF across the latent continuum when class intervals are created based on latent score groups. If your analysis contains two groups and the lines for the groups cross each other, DIF is non-uniform.</span>
<span id="cb133-986"><a href="#cb133-986" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-989"><a href="#cb133-989" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb133-990"><a href="#cb133-990" aria-hidden="true" tabindex="-1"></a><span class="fu">RIciccPlot</span>(df, <span class="at">dif =</span> <span class="st">"yes"</span>, <span class="at">dif_var =</span> dif<span class="sc">$</span>Sex)</span>
<span id="cb133-991"><a href="#cb133-991" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb133-992"><a href="#cb133-992" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-993"><a href="#cb133-993" aria-hidden="true" tabindex="-1"></a><span class="fu">### Logistic Ordinal Regression DIF {#sec-lordif}</span></span>
<span id="cb133-994"><a href="#cb133-994" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-995"><a href="#cb133-995" aria-hidden="true" tabindex="-1"></a>The <span class="in">`lordif`</span> package <span class="co">[</span><span class="ot">@choi_lordif_2011</span><span class="co">]</span> does not use a Rasch measurement model, it only offers a choice between the Graded Response Model (GRM) and the Generalized Partial Credit Model (GPCM). Both of these are 2PL models, meaning that they estimate a discrimination parameter for each item in addition to the item threshold parameters. <span class="in">`lordif`</span> relies on the <span class="in">`mirt`</span> package.</span>
<span id="cb133-996"><a href="#cb133-996" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-997"><a href="#cb133-997" aria-hidden="true" tabindex="-1"></a>There are several nice features available in the <span class="in">`lordif`</span> package. First, we get a χ2 test of uniform or non-uniform DIF. Second, there are three possible methods/criteria for flagging items with potential DIF. One of these uses a likelihood ratio (LR) χ2 test, while the other two are indicators of DIF size/magnitude, either using a pseudo R2 statistic ("McFadden", "Nagelkerke", or "CoxSnell") or a Beta criterion. For further details, see <span class="in">`?lordif`</span> in your R console or the paper describing the package <span class="co">[</span><span class="ot">@choi_lordif_2011</span><span class="co">]</span>.</span>
<span id="cb133-998"><a href="#cb133-998" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-999"><a href="#cb133-999" aria-hidden="true" tabindex="-1"></a>Below is some sample code to get you started with <span class="in">`lordif`</span>.</span>
<span id="cb133-1000"><a href="#cb133-1000" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-1003"><a href="#cb133-1003" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb133-1004"><a href="#cb133-1004" aria-hidden="true" tabindex="-1"></a><span class="co">#| results: hide</span></span>
<span id="cb133-1005"><a href="#cb133-1005" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lordif)</span>
<span id="cb133-1006"><a href="#cb133-1006" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-1007"><a href="#cb133-1007" aria-hidden="true" tabindex="-1"></a>g_dif <span class="ot">&lt;-</span> <span class="fu">lordif</span>(<span class="fu">as.data.frame</span>(df), <span class="fu">as.numeric</span>(dif<span class="sc">$</span>Sex), <span class="co"># make sure that the data is in a dataframe-object and that the DIF variable is numeric</span></span>
<span id="cb133-1008"><a href="#cb133-1008" aria-hidden="true" tabindex="-1"></a>                <span class="at">criterion =</span> <span class="fu">c</span>(<span class="st">"Chisqr"</span>), </span>
<span id="cb133-1009"><a href="#cb133-1009" aria-hidden="true" tabindex="-1"></a>                <span class="at">alpha =</span> <span class="fl">0.01</span>, </span>
<span id="cb133-1010"><a href="#cb133-1010" aria-hidden="true" tabindex="-1"></a>                <span class="at">beta.change =</span> <span class="fl">0.1</span>,</span>
<span id="cb133-1011"><a href="#cb133-1011" aria-hidden="true" tabindex="-1"></a>                <span class="at">model =</span> <span class="st">"GPCM"</span>,</span>
<span id="cb133-1012"><a href="#cb133-1012" aria-hidden="true" tabindex="-1"></a>                <span class="at">R2.change =</span> <span class="fl">0.02</span>)</span>
<span id="cb133-1013"><a href="#cb133-1013" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-1014"><a href="#cb133-1014" aria-hidden="true" tabindex="-1"></a>g_dif_sum <span class="ot">&lt;-</span> <span class="fu">summary</span>(g_dif)</span>
<span id="cb133-1015"><a href="#cb133-1015" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb133-1016"><a href="#cb133-1016" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-1019"><a href="#cb133-1019" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb133-1020"><a href="#cb133-1020" aria-hidden="true" tabindex="-1"></a><span class="co"># threshold values for colorizing the table below</span></span>
<span id="cb133-1021"><a href="#cb133-1021" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">=</span> <span class="fl">0.01</span></span>
<span id="cb133-1022"><a href="#cb133-1022" aria-hidden="true" tabindex="-1"></a>beta.change <span class="ot">=</span> <span class="fl">0.1</span></span>
<span id="cb133-1023"><a href="#cb133-1023" aria-hidden="true" tabindex="-1"></a>R2.change <span class="ot">=</span> <span class="fl">0.02</span></span>
<span id="cb133-1024"><a href="#cb133-1024" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-1025"><a href="#cb133-1025" aria-hidden="true" tabindex="-1"></a>g_dif_sum<span class="sc">$</span>stats <span class="sc">%&gt;%</span> </span>
<span id="cb133-1026"><a href="#cb133-1026" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb133-1027"><a href="#cb133-1027" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">!</span><span class="fu">all_of</span>(<span class="fu">c</span>(<span class="st">"item"</span>,<span class="st">"df12"</span>,<span class="st">"df13"</span>,<span class="st">"df23"</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb133-1028"><a href="#cb133-1028" aria-hidden="true" tabindex="-1"></a>  <span class="fu">round</span>(<span class="dv">3</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb133-1029"><a href="#cb133-1029" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_column</span>(<span class="at">itemnr =</span> <span class="fu">names</span>(df), <span class="at">.before =</span> <span class="st">"ncat"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb133-1030"><a href="#cb133-1030" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">c</span>(chi12,chi13,chi23), <span class="sc">~</span> <span class="fu">cell_spec</span>(.x,</span>
<span id="cb133-1031"><a href="#cb133-1031" aria-hidden="true" tabindex="-1"></a>                               <span class="at">color =</span> <span class="fu">case_when</span>(</span>
<span id="cb133-1032"><a href="#cb133-1032" aria-hidden="true" tabindex="-1"></a>                                 .x <span class="sc">&lt;</span> alpha <span class="sc">~</span> <span class="st">"red"</span>,</span>
<span id="cb133-1033"><a href="#cb133-1033" aria-hidden="true" tabindex="-1"></a>                                 <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"black"</span></span>
<span id="cb133-1034"><a href="#cb133-1034" aria-hidden="true" tabindex="-1"></a>                               )))) <span class="sc">%&gt;%</span></span>
<span id="cb133-1035"><a href="#cb133-1035" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">starts_with</span>(<span class="st">"pseudo"</span>), <span class="sc">~</span> <span class="fu">cell_spec</span>(.x,</span>
<span id="cb133-1036"><a href="#cb133-1036" aria-hidden="true" tabindex="-1"></a>                               <span class="at">color =</span> <span class="fu">case_when</span>(</span>
<span id="cb133-1037"><a href="#cb133-1037" aria-hidden="true" tabindex="-1"></a>                                 .x <span class="sc">&gt;</span> R2.change <span class="sc">~</span> <span class="st">"red"</span>,</span>
<span id="cb133-1038"><a href="#cb133-1038" aria-hidden="true" tabindex="-1"></a>                                 <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"black"</span></span>
<span id="cb133-1039"><a href="#cb133-1039" aria-hidden="true" tabindex="-1"></a>                               )))) <span class="sc">%&gt;%</span></span>
<span id="cb133-1040"><a href="#cb133-1040" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">beta12 =</span>  <span class="fu">cell_spec</span>(beta12,</span>
<span id="cb133-1041"><a href="#cb133-1041" aria-hidden="true" tabindex="-1"></a>                               <span class="at">color =</span> <span class="fu">case_when</span>(</span>
<span id="cb133-1042"><a href="#cb133-1042" aria-hidden="true" tabindex="-1"></a>                                 beta12 <span class="sc">&gt;</span> beta.change <span class="sc">~</span> <span class="st">"red"</span>,</span>
<span id="cb133-1043"><a href="#cb133-1043" aria-hidden="true" tabindex="-1"></a>                                 <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"black"</span></span>
<span id="cb133-1044"><a href="#cb133-1044" aria-hidden="true" tabindex="-1"></a>                               ))) <span class="sc">%&gt;%</span> </span>
<span id="cb133-1045"><a href="#cb133-1045" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl_rise</span>()</span>
<span id="cb133-1046"><a href="#cb133-1046" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb133-1047"><a href="#cb133-1047" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-1048"><a href="#cb133-1048" aria-hidden="true" tabindex="-1"></a>We can review the results regarding uniform/non-uniform DIF by looking at the <span class="in">`chi*`</span> columns. Uniform DIF is indicated by column <span class="in">`chi12`</span> and non-uniform DIF by <span class="in">`chi23`</span>, while column <span class="in">`chi13`</span> represents "an overall test of "total DIF effect" <span class="co">[</span><span class="ot">@choi_lordif_2011</span><span class="co">]</span>.</span>
<span id="cb133-1049"><a href="#cb133-1049" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-1050"><a href="#cb133-1050" aria-hidden="true" tabindex="-1"></a>While the table indicates significant chi2-tests for items 11 and 17, the magnitude estimates are low for these items.</span>
<span id="cb133-1051"><a href="#cb133-1051" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-1052"><a href="#cb133-1052" aria-hidden="true" tabindex="-1"></a>There are some plots available as well, using the base R <span class="in">`plot()`</span> function. For some reason the plots won't render in this Quarto document, so I will try to sort that out at some point.</span>
<span id="cb133-1053"><a href="#cb133-1053" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-1056"><a href="#cb133-1056" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb133-1057"><a href="#cb133-1057" aria-hidden="true" tabindex="-1"></a><span class="co">#| layout-ncol: 2</span></span>
<span id="cb133-1058"><a href="#cb133-1058" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(g_dif) <span class="co"># use option `graphics.off()` to get the plots rendered one by one</span></span>
<span id="cb133-1059"><a href="#cb133-1059" aria-hidden="true" tabindex="-1"></a><span class="co">#plot(g_dif, graphics.off())</span></span>
<span id="cb133-1060"><a href="#cb133-1060" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb133-1061"><a href="#cb133-1061" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-1062"><a href="#cb133-1062" aria-hidden="true" tabindex="-1"></a><span class="fu">### Partial gamma DIF</span></span>
<span id="cb133-1063"><a href="#cb133-1063" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-1064"><a href="#cb133-1064" aria-hidden="true" tabindex="-1"></a>The <span class="in">`iarm`</span> package provides a function to assess DIF by partial gamma <span class="co">[</span><span class="ot">@bjorner_differential_1998</span><span class="co">]</span>. It should be noted that this function only shows a single partial gamma value per item, so if you have more than two groups in your comparison, you will want to also use other methods to understand your results better.</span>
<span id="cb133-1065"><a href="#cb133-1065" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-1066"><a href="#cb133-1066" aria-hidden="true" tabindex="-1"></a>There are some recommended cutoff-values mentioned in the paper above:</span>
<span id="cb133-1067"><a href="#cb133-1067" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-1068"><a href="#cb133-1068" aria-hidden="true" tabindex="-1"></a>No or negligible DIF:</span>
<span id="cb133-1069"><a href="#cb133-1069" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-1070"><a href="#cb133-1070" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Gamma within the interval -0.21 to 0.21, *or*</span>
<span id="cb133-1071"><a href="#cb133-1071" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Gamma not significantly different from 0</span>
<span id="cb133-1072"><a href="#cb133-1072" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-1073"><a href="#cb133-1073" aria-hidden="true" tabindex="-1"></a>Slight to moderate DIF:</span>
<span id="cb133-1074"><a href="#cb133-1074" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-1075"><a href="#cb133-1075" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Gamma within the interval -0.31 to 0.31 (and outside -0.21 to 0.21), *or*</span>
<span id="cb133-1076"><a href="#cb133-1076" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>not significantly outside the interval -0.21 to 0.21</span>
<span id="cb133-1077"><a href="#cb133-1077" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-1078"><a href="#cb133-1078" aria-hidden="true" tabindex="-1"></a>Moderate to large DIF:</span>
<span id="cb133-1079"><a href="#cb133-1079" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-1080"><a href="#cb133-1080" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Gamma outside the interval -0.31 to 0.31, **and**</span>
<span id="cb133-1081"><a href="#cb133-1081" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>significantly outside the interval -0.21 to 0.21</span>
<span id="cb133-1082"><a href="#cb133-1082" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-1085"><a href="#cb133-1085" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb133-1086"><a href="#cb133-1086" aria-hidden="true" tabindex="-1"></a><span class="fu">RIpartgamDIF</span>(df, dif<span class="sc">$</span>Sex)</span>
<span id="cb133-1087"><a href="#cb133-1087" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb133-1088"><a href="#cb133-1088" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-1089"><a href="#cb133-1089" aria-hidden="true" tabindex="-1"></a>We can see "slight" DIF for item 17, with a statistically significant gamma of .23. </span>
<span id="cb133-1090"><a href="#cb133-1090" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-1091"><a href="#cb133-1091" aria-hidden="true" tabindex="-1"></a><span class="fu">## Rasch analysis 3</span></span>
<span id="cb133-1092"><a href="#cb133-1092" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-1093"><a href="#cb133-1093" aria-hidden="true" tabindex="-1"></a>While there were no significant issues with DIF for any item/subgroup combination, we need to address the previously identified problem:</span>
<span id="cb133-1094"><a href="#cb133-1094" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-1095"><a href="#cb133-1095" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Items 16 and 19 have the largest residual correlation.</span>
<span id="cb133-1096"><a href="#cb133-1096" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-1097"><a href="#cb133-1097" aria-hidden="true" tabindex="-1"></a>We'll remove item 19 since item 16 has better targeting.</span>
<span id="cb133-1098"><a href="#cb133-1098" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-1101"><a href="#cb133-1101" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb133-1102"><a href="#cb133-1102" aria-hidden="true" tabindex="-1"></a>removed.items <span class="ot">&lt;-</span> <span class="fu">c</span>(removed.items,<span class="st">"PANAS_19"</span>)</span>
<span id="cb133-1103"><a href="#cb133-1103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-1104"><a href="#cb133-1104" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df_backup <span class="sc">%&gt;%</span> </span>
<span id="cb133-1105"><a href="#cb133-1105" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">!</span><span class="fu">any_of</span>(removed.items))</span>
<span id="cb133-1106"><a href="#cb133-1106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-1107"><a href="#cb133-1107" aria-hidden="true" tabindex="-1"></a>df500 <span class="ot">&lt;-</span> df500_backup <span class="sc">%&gt;%</span> </span>
<span id="cb133-1108"><a href="#cb133-1108" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">!</span><span class="fu">any_of</span>(removed.items))</span>
<span id="cb133-1109"><a href="#cb133-1109" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb133-1110"><a href="#cb133-1110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-1113"><a href="#cb133-1113" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb133-1114"><a href="#cb133-1114" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: margin</span></span>
<span id="cb133-1115"><a href="#cb133-1115" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb133-1116"><a href="#cb133-1116" aria-hidden="true" tabindex="-1"></a><span class="fu">RIlistItemsMargin</span>(df, <span class="at">fontsize =</span> <span class="dv">13</span>)</span>
<span id="cb133-1117"><a href="#cb133-1117" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb133-1118"><a href="#cb133-1118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-1119"><a href="#cb133-1119" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb133-1120"><a href="#cb133-1120" aria-hidden="true" tabindex="-1"></a><span class="fu">### Item-restscore bootstrap</span></span>
<span id="cb133-1121"><a href="#cb133-1121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-1124"><a href="#cb133-1124" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb133-1125"><a href="#cb133-1125" aria-hidden="true" tabindex="-1"></a><span class="fu">RIbootRestscore</span>(df, <span class="at">iterations =</span> <span class="dv">250</span>, <span class="at">samplesize =</span> <span class="dv">800</span>)</span>
<span id="cb133-1126"><a href="#cb133-1126" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb133-1127"><a href="#cb133-1127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-1128"><a href="#cb133-1128" aria-hidden="true" tabindex="-1"></a><span class="fu">### Item fit</span></span>
<span id="cb133-1129"><a href="#cb133-1129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-1132"><a href="#cb133-1132" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb133-1133"><a href="#cb133-1133" aria-hidden="true" tabindex="-1"></a>simfit3 <span class="ot">&lt;-</span> <span class="fu">RIgetfit</span>(df500, <span class="at">iterations =</span> <span class="dv">200</span>, <span class="at">cpu =</span> <span class="dv">8</span>)</span>
<span id="cb133-1134"><a href="#cb133-1134" aria-hidden="true" tabindex="-1"></a><span class="fu">RIitemfit</span>(df500, simfit3)</span>
<span id="cb133-1135"><a href="#cb133-1135" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb133-1136"><a href="#cb133-1136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-1137"><a href="#cb133-1137" aria-hidden="true" tabindex="-1"></a><span class="fu">### CICC</span></span>
<span id="cb133-1138"><a href="#cb133-1138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-1141"><a href="#cb133-1141" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb133-1142"><a href="#cb133-1142" aria-hidden="true" tabindex="-1"></a><span class="fu">RIciccPlot</span>(df)</span>
<span id="cb133-1143"><a href="#cb133-1143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-1144"><a href="#cb133-1144" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb133-1145"><a href="#cb133-1145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-1146"><a href="#cb133-1146" aria-hidden="true" tabindex="-1"></a><span class="fu">### Residual correlations</span></span>
<span id="cb133-1147"><a href="#cb133-1147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-1150"><a href="#cb133-1150" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb133-1151"><a href="#cb133-1151" aria-hidden="true" tabindex="-1"></a>simcor3 <span class="ot">&lt;-</span> <span class="fu">RIgetResidCor</span>(df, <span class="at">iterations =</span> <span class="dv">400</span>, <span class="at">cpu =</span> <span class="dv">8</span>)</span>
<span id="cb133-1152"><a href="#cb133-1152" aria-hidden="true" tabindex="-1"></a><span class="fu">RIresidcorr</span>(df, <span class="at">cutoff =</span> simcor3<span class="sc">$</span>p99)</span>
<span id="cb133-1153"><a href="#cb133-1153" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb133-1154"><a href="#cb133-1154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-1155"><a href="#cb133-1155" aria-hidden="true" tabindex="-1"></a><span class="fu">### LRT</span></span>
<span id="cb133-1158"><a href="#cb133-1158" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb133-1159"><a href="#cb133-1159" aria-hidden="true" tabindex="-1"></a><span class="fu">RIbootLRT</span>(df, <span class="at">iterations =</span> <span class="dv">1000</span>, <span class="at">samplesize =</span> <span class="dv">400</span>, <span class="at">cpu =</span> <span class="dv">8</span>)</span>
<span id="cb133-1160"><a href="#cb133-1160" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb133-1161"><a href="#cb133-1161" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-1162"><a href="#cb133-1162" aria-hidden="true" tabindex="-1"></a><span class="fu">### Targeting</span></span>
<span id="cb133-1163"><a href="#cb133-1163" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-1166"><a href="#cb133-1166" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb133-1167"><a href="#cb133-1167" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 5</span></span>
<span id="cb133-1168"><a href="#cb133-1168" aria-hidden="true" tabindex="-1"></a><span class="fu">RItargeting</span>(df, <span class="at">bins =</span> <span class="dv">45</span>)</span>
<span id="cb133-1169"><a href="#cb133-1169" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb133-1170"><a href="#cb133-1170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-1171"><a href="#cb133-1171" aria-hidden="true" tabindex="-1"></a><span class="fu">### Item hierarchy</span></span>
<span id="cb133-1172"><a href="#cb133-1172" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-1175"><a href="#cb133-1175" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb133-1176"><a href="#cb133-1176" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 5</span></span>
<span id="cb133-1177"><a href="#cb133-1177" aria-hidden="true" tabindex="-1"></a><span class="fu">RIitemHierarchy</span>(df)</span>
<span id="cb133-1178"><a href="#cb133-1178" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb133-1179"><a href="#cb133-1179" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb133-1180"><a href="#cb133-1180" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-1181"><a href="#cb133-1181" aria-hidden="true" tabindex="-1"></a><span class="fu">### Analysis 3 comments</span></span>
<span id="cb133-1182"><a href="#cb133-1182" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-1183"><a href="#cb133-1183" aria-hidden="true" tabindex="-1"></a>There are still problematic residual correlations and some items show misfit (most notably item 12 being overfit), but we will end this sample analysis here and move on to show other functions.</span>
<span id="cb133-1184"><a href="#cb133-1184" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-1185"><a href="#cb133-1185" aria-hidden="true" tabindex="-1"></a>There are several item thresholds that are very closely located, as shown in the item hierarchy figure. This is not ideal, since it will inflate reliability estimates. However, we will not modify the response categories for this analysis, we only note that this is not workable and should be dealt with by trying variations of merged response categories to achieve better separation of threshold locations without disordering.</span>
<span id="cb133-1186"><a href="#cb133-1186" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-1187"><a href="#cb133-1187" aria-hidden="true" tabindex="-1"></a><span class="fu">## Reliability</span></span>
<span id="cb133-1188"><a href="#cb133-1188" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-1189"><a href="#cb133-1189" aria-hidden="true" tabindex="-1"></a>Reliability (or measurement uncertainty) is often reported as a point estimate only, which implies constant reliability across the latent variable. This does not reflect the targeting aspect and the limitations of reliability often found at the lower and upper regions of the latent continuum. One way to try to better describe the varying reliability is by using the Test Information Function (TIF), which is a curve. I have previously advocated for reporting the TIF curve, but have also found some unexpected results when using it. When I finally sat down to figure out the issues with TIF, I found a paper showing that it behaves quite erratically, especially with fewer than six or so items <span class="co">[</span><span class="ot">@milanzi_reliability_2015</span><span class="co">]</span>. While the <span class="in">`RItif()`</span> function remains, I recommend careful use of it, or perhaps not using it at all.</span>
<span id="cb133-1190"><a href="#cb133-1190" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-1191"><a href="#cb133-1191" aria-hidden="true" tabindex="-1"></a>The most commonly used reliability metric in Rasch analysis is the PSI, person separation index. It is however important to note that the PSI excludes extreme values (min/max scores), which explains why it is sometimes quite different from other metrics. The reason for excluding participants is that extreme scores cannot be estimated, they need to be imputed/interpolated along with their corresponding measurement error, which is what is used in the PSI metric.</span>
<span id="cb133-1192"><a href="#cb133-1192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-1193"><a href="#cb133-1193" aria-hidden="true" tabindex="-1"></a><span class="fu">### RMU --- Relative Measurement Uncertainty</span></span>
<span id="cb133-1194"><a href="#cb133-1194" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-1197"><a href="#cb133-1197" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb133-1198"><a href="#cb133-1198" aria-hidden="true" tabindex="-1"></a>rel <span class="ot">&lt;-</span> <span class="fu">RIreliability</span>(df, <span class="at">draws =</span> <span class="dv">1000</span>)</span>
<span id="cb133-1199"><a href="#cb133-1199" aria-hidden="true" tabindex="-1"></a>rel<span class="sc">$</span>PSI</span>
<span id="cb133-1200"><a href="#cb133-1200" aria-hidden="true" tabindex="-1"></a>rel<span class="sc">$</span>RMU</span>
<span id="cb133-1201"><a href="#cb133-1201" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb133-1202"><a href="#cb133-1202" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-1203"><a href="#cb133-1203" aria-hidden="true" tabindex="-1"></a>The new (since <span class="in">`easyRasch`</span> 0.4.0) function <span class="in">`RIreliability()`</span> will produce several estimates of reliability. The potentially most useful metric is a new one, based on a recent preprint <span class="co">[</span><span class="ot">@bignardi_general_2025</span><span class="co">]</span> which describes a general reliability metric that includes uncertainty around the point estimate, called *RMU, "Relative Measurement Uncertainty"*. Bignardi and colleagues use Bayesian estimation and posterior draws of each respondents latent scores (thetas/locations) to determine the mean and 95% highest density continuous interval (HDCI) of the distribution of correlations between draws <span class="co">[</span><span class="ot">@bignardi_general_2025</span><span class="co">]</span>. I have borrowed code that the authors made available, and adapted it to simplify the use by grace of the <span class="in">`mirt`</span> package and its function to generate plausible values <span class="co">[</span><span class="ot">PVs, @mislevy_randomization-based_1991;@wu_role_2005</span><span class="co">]</span> instead of having to learn to specify Bayesian models. Preliminary investigations indicate similar results for PVs and fully Bayesian model posteriors, see the example code in the documentation <span class="in">`?RIreliability`</span> for an example, and <span class="co">[</span><span class="ot">this blog post</span><span class="co">](https://pgmj.github.io/reliability.html)</span> for a more extensive investigation. The 95% HDCI is a useful addition, and by using PVs, respondents with extreme values are included in a reasonable way. <span class="in">`RIreliability()`</span> has the setting <span class="in">`estim`</span> to choose method of estimation for thetas/latent scores used for the RMU, which uses "WLE" (weighted likelihood estimation) as default to minimize bias, which may be an improvement over the fully Bayesian modeling method <span class="co">[</span><span class="ot">@warm1989;@kreiner_specific_2025</span><span class="co">]</span>, but this has not been evaluated. Other possible methods are specified in <span class="in">`?mirt::fscores`</span>. The output from <span class="in">`RIreliability()`</span> indicates which method was used.</span>
<span id="cb133-1204"><a href="#cb133-1204" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-1205"><a href="#cb133-1205" aria-hidden="true" tabindex="-1"></a>In addition to the RMU, <span class="in">`RIreliability()`</span> outputs the Person Separation Index (PSI), the empirical reliability (as estimated by <span class="in">`mirt::empirical_rxx()`</span> using WLE, see <span class="co">[</span><span class="ot">this post</span><span class="co">](https://stats.stackexchange.com/questions/427631/difference-between-empirical-and-marginal-reliability-of-an-irt-model)</span>), and a table with values from the WL estimation (using <span class="in">`iarm::person_estimates()`</span>). I suggest reporting RMU in publications. Also, the default setting is to use 1000 plausible values, and I think it would be prudent to use something like 4000 for a publication. </span>
<span id="cb133-1206"><a href="#cb133-1206" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-1207"><a href="#cb133-1207" aria-hidden="true" tabindex="-1"></a>An addition made to <span class="in">`RIreliability()`</span> in <span class="in">`easyRasch`</span> version 0.4.1.2 was the option <span class="in">`iter = 50`</span>, which refers to the number of times RMU is estimated from the draws generated, to achieve more stable values compared to a single estimation.</span>
<span id="cb133-1208"><a href="#cb133-1208" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-1209"><a href="#cb133-1209" aria-hidden="true" tabindex="-1"></a><span class="fu">### Conditional reliability</span></span>
<span id="cb133-1210"><a href="#cb133-1210" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-1211"><a href="#cb133-1211" aria-hidden="true" tabindex="-1"></a>Another recent paper <span class="co">[</span><span class="ot">@mcneish_reliability_2025</span><span class="co">]</span> advocates for the relevance of a conditional reliability, which I think is a useful addition to the RMU metric presented above. I have again borrowed code from another open source project, namely the <span class="co">[</span><span class="ot">`dynamic` R package</span><span class="co">](https://github.com/melissagwolf/dynamic/)</span>. <span class="in">`RIrelRep()`</span> produces a Cronbach's alpha point estimate with a confidence interval and a conditional reliability curve showing varying levels of alpha across the ordinal sum score range. Alpha is a criticized metric <span class="co">[</span><span class="ot">e.g @sijtsma_use_2008;@mcneish_thanks_2018</span><span class="co">]</span>, so again interpret this with care. One of alpha's issues is the assumption of tau-equivalence (equal factor loadings or discrimination parameters across all items), which is only fulfilled by the Rasch model, and also requires local independence of item. Alpha is a metric for ordinal sum scores, not estimated interval scores. The <span class="in">`RIrelRep()`</span> function also has an option for using omega instead of alpha, see the tab "Omega" below.</span>
<span id="cb133-1212"><a href="#cb133-1212" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-1213"><a href="#cb133-1213" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb133-1214"><a href="#cb133-1214" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Figure</span></span>
<span id="cb133-1217"><a href="#cb133-1217" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb133-1218"><a href="#cb133-1218" aria-hidden="true" tabindex="-1"></a>relrep <span class="ot">&lt;-</span> <span class="fu">RIrelRep</span>(df)</span>
<span id="cb133-1219"><a href="#cb133-1219" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb133-1220"><a href="#cb133-1220" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Table</span></span>
<span id="cb133-1223"><a href="#cb133-1223" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb133-1224"><a href="#cb133-1224" aria-hidden="true" tabindex="-1"></a>relrep<span class="sc">$</span>stat</span>
<span id="cb133-1225"><a href="#cb133-1225" aria-hidden="true" tabindex="-1"></a>relrep<span class="sc">$</span>table</span>
<span id="cb133-1226"><a href="#cb133-1226" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb133-1227"><a href="#cb133-1227" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Omega</span></span>
<span id="cb133-1228"><a href="#cb133-1228" aria-hidden="true" tabindex="-1"></a>As a comparison, we can also get conditional omega.</span>
<span id="cb133-1231"><a href="#cb133-1231" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb133-1232"><a href="#cb133-1232" aria-hidden="true" tabindex="-1"></a>rr_omega <span class="ot">&lt;-</span> <span class="fu">RIrelRep</span>(df, <span class="at">rel =</span> <span class="st">"omega"</span>)</span>
<span id="cb133-1233"><a href="#cb133-1233" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb133-1234"><a href="#cb133-1234" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb133-1235"><a href="#cb133-1235" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-1236"><a href="#cb133-1236" aria-hidden="true" tabindex="-1"></a>To me, there is one outstanding issue with the reliability metrics discussed and presented above. The TIF curve was based on item parameters, describing the test reliability. All estimates above are sample specific, describing the sample reliability. I think both are relevant, depending on what you are doing. For validating a measure, it would be interesting to present the measure's reliability.</span>
<span id="cb133-1237"><a href="#cb133-1237" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-1238"><a href="#cb133-1238" aria-hidden="true" tabindex="-1"></a><span class="fu">## Person fit</span></span>
<span id="cb133-1239"><a href="#cb133-1239" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-1240"><a href="#cb133-1240" aria-hidden="true" tabindex="-1"></a>We can also look at how the respondents fit the Rasch model with these items. By default, <span class="in">`RIpfit()`</span> outputs a histogram and a hex heatmap with the person infit ZSTD statistic, using +/- 1.96 as cutoff values. This is currently the only person fit method implemented in the <span class="in">`easyRasch`</span> package, and the curious analyst is suggested to look at the package <span class="co">[</span><span class="ot">PerFit</span><span class="co">](https://www.rdocumentation.org/packages/PerFit/versions/1.4.6/topics/PerFit-package)</span> for more tools.</span>
<span id="cb133-1241"><a href="#cb133-1241" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-1244"><a href="#cb133-1244" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb133-1245"><a href="#cb133-1245" aria-hidden="true" tabindex="-1"></a><span class="fu">RIpfit</span>(df)</span>
<span id="cb133-1246"><a href="#cb133-1246" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb133-1247"><a href="#cb133-1247" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-1248"><a href="#cb133-1248" aria-hidden="true" tabindex="-1"></a>You can export the person fit values to a new variable in the dataframe by specifying <span class="in">`output = "dataframe"`</span>, or if you just want the row numbers for respondents with deviant infit values, <span class="in">`output = "rowid"`</span>.</span>
<span id="cb133-1249"><a href="#cb133-1249" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-1250"><a href="#cb133-1250" aria-hidden="true" tabindex="-1"></a>You can also specify a grouping variable to visualize the person fit for different groups.</span>
<span id="cb133-1251"><a href="#cb133-1251" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-1254"><a href="#cb133-1254" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb133-1255"><a href="#cb133-1255" aria-hidden="true" tabindex="-1"></a><span class="fu">RIpfit</span>(df, <span class="at">group =</span> dif<span class="sc">$</span>Sex, <span class="at">output =</span> <span class="st">"heatmap"</span>)</span>
<span id="cb133-1256"><a href="#cb133-1256" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb133-1257"><a href="#cb133-1257" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-1258"><a href="#cb133-1258" aria-hidden="true" tabindex="-1"></a>Person fit is a useful way to identify respondents with unexpected response patterns and investigate this further.</span>
<span id="cb133-1259"><a href="#cb133-1259" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-1260"><a href="#cb133-1260" aria-hidden="true" tabindex="-1"></a><span class="fu">### `PerFit` sample code</span></span>
<span id="cb133-1261"><a href="#cb133-1261" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-1262"><a href="#cb133-1262" aria-hidden="true" tabindex="-1"></a>While none of the functions in the <span class="in">`PerFit`</span> package has been implemented in <span class="in">`easyRasch`</span>, this is some code to get you started if you are interested in using it. There are multiple methods/functions available for polytomous and dichotomous data, see the package <span class="co">[</span><span class="ot">documentation</span><span class="co">](https://www.rdocumentation.org/packages/PerFit/versions/1.4.6/topics/PerFit-package)</span>.</span>
<span id="cb133-1263"><a href="#cb133-1263" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-1264"><a href="#cb133-1264" aria-hidden="true" tabindex="-1"></a>For this example, we'll use the non-parametric U3 statistic generalized to polytomous items <span class="co">[</span><span class="ot">@emons_nonparametric_2008</span><span class="co">]</span> and the smaller sample.</span>
<span id="cb133-1265"><a href="#cb133-1265" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-1266"><a href="#cb133-1266" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb133-1267"><a href="#cb133-1267" aria-hidden="true" tabindex="-1"></a><span class="fu">#### U3poly</span></span>
<span id="cb133-1270"><a href="#cb133-1270" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb133-1271"><a href="#cb133-1271" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(PerFit)</span>
<span id="cb133-1272"><a href="#cb133-1272" aria-hidden="true" tabindex="-1"></a>pfit_u3poly <span class="ot">&lt;-</span> <span class="fu">U3poly</span>(<span class="at">matrix =</span> df500, </span>
<span id="cb133-1273"><a href="#cb133-1273" aria-hidden="true" tabindex="-1"></a>                      <span class="at">Ncat =</span> <span class="dv">5</span>, <span class="co"># make sure to input number of response categories, not thresholds</span></span>
<span id="cb133-1274"><a href="#cb133-1274" aria-hidden="true" tabindex="-1"></a>                      <span class="at">IRT.PModel =</span> <span class="st">"PCM"</span>)</span>
<span id="cb133-1275"><a href="#cb133-1275" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb133-1276"><a href="#cb133-1276" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Cutoff information</span></span>
<span id="cb133-1279"><a href="#cb133-1279" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb133-1280"><a href="#cb133-1280" aria-hidden="true" tabindex="-1"></a><span class="fu">cutoff</span>(pfit_u3poly)</span>
<span id="cb133-1281"><a href="#cb133-1281" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb133-1282"><a href="#cb133-1282" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Flagged respondents</span></span>
<span id="cb133-1285"><a href="#cb133-1285" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb133-1286"><a href="#cb133-1286" aria-hidden="true" tabindex="-1"></a><span class="fu">flagged.resp</span>(pfit_u3poly) <span class="sc">%&gt;%</span> </span>
<span id="cb133-1287"><a href="#cb133-1287" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pluck</span>(<span class="st">"Scores"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb133-1288"><a href="#cb133-1288" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb133-1289"><a href="#cb133-1289" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(PFscores))</span>
<span id="cb133-1290"><a href="#cb133-1290" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb133-1291"><a href="#cb133-1291" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb133-1292"><a href="#cb133-1292" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-1293"><a href="#cb133-1293" aria-hidden="true" tabindex="-1"></a>The dataframe shown under the tab <span class="in">`Flagged respondents`</span> above contains a variable named <span class="in">`FlaggedID`</span> which represents the row id's. This variable is useful if one wants to filter out respondents with deviant response patterns (person misfit). There are indications that persons with misfit may affect results of Andersen's LR-test for DIF <span class="co">[</span><span class="ot">@artner_simulation_2016</span><span class="co">]</span>.</span>
<span id="cb133-1294"><a href="#cb133-1294" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-1295"><a href="#cb133-1295" aria-hidden="true" tabindex="-1"></a><span class="fu">### Item fit without aberrant responses</span></span>
<span id="cb133-1296"><a href="#cb133-1296" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-1297"><a href="#cb133-1297" aria-hidden="true" tabindex="-1"></a>We can remove the misfitting persons to see how that affects item fit. Let's also compare with the misfitting respondents identified by <span class="in">`RIpfit()`</span>, also using the smaller sample.</span>
<span id="cb133-1298"><a href="#cb133-1298" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-1301"><a href="#cb133-1301" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb133-1302"><a href="#cb133-1302" aria-hidden="true" tabindex="-1"></a>misfits <span class="ot">&lt;-</span> <span class="fu">flagged.resp</span>(pfit_u3poly) <span class="sc">%&gt;%</span> </span>
<span id="cb133-1303"><a href="#cb133-1303" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pluck</span>(<span class="st">"Scores"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb133-1304"><a href="#cb133-1304" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb133-1305"><a href="#cb133-1305" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(FlaggedID)</span>
<span id="cb133-1306"><a href="#cb133-1306" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-1307"><a href="#cb133-1307" aria-hidden="true" tabindex="-1"></a>misfits2 <span class="ot">&lt;-</span> <span class="fu">RIpfit</span>(df500, <span class="at">output =</span> <span class="st">"rowid"</span>)</span>
<span id="cb133-1308"><a href="#cb133-1308" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb133-1309"><a href="#cb133-1309" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-1310"><a href="#cb133-1310" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb133-1311"><a href="#cb133-1311" aria-hidden="true" tabindex="-1"></a><span class="fu">#### All respondents</span></span>
<span id="cb133-1314"><a href="#cb133-1314" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb133-1315"><a href="#cb133-1315" aria-hidden="true" tabindex="-1"></a><span class="fu">RIitemfit</span>(df500, <span class="at">simcut =</span> simfit3)</span>
<span id="cb133-1316"><a href="#cb133-1316" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb133-1317"><a href="#cb133-1317" aria-hidden="true" tabindex="-1"></a><span class="fu">#### U3 misfit removed</span></span>
<span id="cb133-1320"><a href="#cb133-1320" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb133-1321"><a href="#cb133-1321" aria-hidden="true" tabindex="-1"></a><span class="fu">RIitemfit</span>(df500[<span class="sc">-</span>misfits,], <span class="at">simcut =</span> simfit3)</span>
<span id="cb133-1322"><a href="#cb133-1322" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb133-1323"><a href="#cb133-1323" aria-hidden="true" tabindex="-1"></a><span class="fu">#### ZSTD misfit removed</span></span>
<span id="cb133-1326"><a href="#cb133-1326" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb133-1327"><a href="#cb133-1327" aria-hidden="true" tabindex="-1"></a><span class="fu">RIitemfit</span>(df500[<span class="sc">-</span>misfits2,], <span class="at">simcut =</span> simfit3)</span>
<span id="cb133-1328"><a href="#cb133-1328" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb133-1329"><a href="#cb133-1329" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb133-1330"><a href="#cb133-1330" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-1331"><a href="#cb133-1331" aria-hidden="true" tabindex="-1"></a><span class="fu">## Item parameters</span></span>
<span id="cb133-1332"><a href="#cb133-1332" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-1333"><a href="#cb133-1333" aria-hidden="true" tabindex="-1"></a>To allow others (and oneself) to use the item parameters estimated for estimation of person locations/thetas, we should make the item parameters available. The function will also write a csv-file with the item threshold locations. Estimations of person locations/thetas can be done with the <span class="in">`thetaEst()`</span> function from the <span class="in">`catR`</span> package. This is implemented in the function <span class="in">`RIestThetasOLD()`</span>, see below for details.</span>
<span id="cb133-1334"><a href="#cb133-1334" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-1335"><a href="#cb133-1335" aria-hidden="true" tabindex="-1"></a>First, we'll output the parameters into a table.</span>
<span id="cb133-1336"><a href="#cb133-1336" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-1339"><a href="#cb133-1339" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb133-1340"><a href="#cb133-1340" aria-hidden="true" tabindex="-1"></a><span class="fu">RIitemparams</span>(df)</span>
<span id="cb133-1341"><a href="#cb133-1341" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb133-1342"><a href="#cb133-1342" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-1343"><a href="#cb133-1343" aria-hidden="true" tabindex="-1"></a>The parameters can also be output to a dataframe or a file, using the option <span class="in">`output = "dataframe"`</span> or <span class="in">`output = "file"`</span>.</span>
<span id="cb133-1344"><a href="#cb133-1344" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-1345"><a href="#cb133-1345" aria-hidden="true" tabindex="-1"></a><span class="fu">## Ordinal sum score to interval score</span></span>
<span id="cb133-1346"><a href="#cb133-1346" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-1347"><a href="#cb133-1347" aria-hidden="true" tabindex="-1"></a>This table shows the corresponding "raw" ordinal sum score values and logit scores, with standard errors for each logit value. Interval scores are estimated using WL based on a simulated dataset using the item parameters estimated from the input dataset. The choice of WL as default is due to the lower bias compared to ML estimation <span class="co">[</span><span class="ot">@warm1989;@kreiner_specific_2025</span><span class="co">]</span>.</span>
<span id="cb133-1348"><a href="#cb133-1348" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-1349"><a href="#cb133-1349" aria-hidden="true" tabindex="-1"></a>(An option will hopefully be added at some point to create this table based on only item parameters.)</span>
<span id="cb133-1350"><a href="#cb133-1350" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-1353"><a href="#cb133-1353" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb133-1354"><a href="#cb133-1354" aria-hidden="true" tabindex="-1"></a><span class="fu">RIscoreSE</span>(df)</span>
<span id="cb133-1355"><a href="#cb133-1355" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb133-1356"><a href="#cb133-1356" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-1357"><a href="#cb133-1357" aria-hidden="true" tabindex="-1"></a><span class="fu">### Ordinal/interval figure</span></span>
<span id="cb133-1358"><a href="#cb133-1358" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-1359"><a href="#cb133-1359" aria-hidden="true" tabindex="-1"></a>The figure below can also be generated to illustrate the relationship between ordinal sum score and logit interval score. The errorbars default to show the standard error at each point, multiplied by 1.96.</span>
<span id="cb133-1360"><a href="#cb133-1360" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-1363"><a href="#cb133-1363" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb133-1364"><a href="#cb133-1364" aria-hidden="true" tabindex="-1"></a><span class="fu">RIscoreSE</span>(df, <span class="at">output =</span> <span class="st">"figure"</span>)</span>
<span id="cb133-1365"><a href="#cb133-1365" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb133-1366"><a href="#cb133-1366" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-1367"><a href="#cb133-1367" aria-hidden="true" tabindex="-1"></a><span class="fu">### Estimating interval level person scores</span></span>
<span id="cb133-1368"><a href="#cb133-1368" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-1369"><a href="#cb133-1369" aria-hidden="true" tabindex="-1"></a>Based on the Rasch analysis output of item parameters, we can estimate each individuals location or score (also known as "theta"). <span class="in">`RIestThetas()`</span> estimates item parameters from a partial credit model (PCM) and as default uses WL estimation <span class="co">[</span><span class="ot">@warm1989;@kreiner_specific_2025</span><span class="co">]</span> to output a dataframe with person locations and their measurement error (SEM) on the logit scale. However, this function is only appropriate if you have complete response data for all participants. If you have partial missingness, you need to use either <span class="in">`RIestThetasOLD()`</span> or <span class="in">`RIestThetasCATr()`</span>.</span>
<span id="cb133-1370"><a href="#cb133-1370" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-1373"><a href="#cb133-1373" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb133-1374"><a href="#cb133-1374" aria-hidden="true" tabindex="-1"></a>thetas <span class="ot">&lt;-</span> <span class="fu">RIestThetas</span>(df)</span>
<span id="cb133-1375"><a href="#cb133-1375" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-1376"><a href="#cb133-1376" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(thetas)</span>
<span id="cb133-1377"><a href="#cb133-1377" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb133-1378"><a href="#cb133-1378" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-1379"><a href="#cb133-1379" aria-hidden="true" tabindex="-1"></a>Each individual has a standard error of measurement (SEM) associated with their estimated location/score. This is included in the output of the <span class="in">`RIestThetas()`</span> function as the <span class="in">`SEM`</span> variable, as seen above. We can review the distribution of measurement error with a figure.</span>
<span id="cb133-1380"><a href="#cb133-1380" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-1381"><a href="#cb133-1381" aria-hidden="true" tabindex="-1"></a>We can take a look at the distribution of person locations (thetas) using a histogram.</span>
<span id="cb133-1382"><a href="#cb133-1382" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-1385"><a href="#cb133-1385" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb133-1386"><a href="#cb133-1386" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(thetas<span class="sc">$</span>WLE, </span>
<span id="cb133-1387"><a href="#cb133-1387" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">"#009ca6"</span>, </span>
<span id="cb133-1388"><a href="#cb133-1388" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Histogram of person locations (thetas)"</span>, </span>
<span id="cb133-1389"><a href="#cb133-1389" aria-hidden="true" tabindex="-1"></a>     <span class="at">breaks =</span> <span class="dv">20</span>)</span>
<span id="cb133-1390"><a href="#cb133-1390" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb133-1391"><a href="#cb133-1391" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-1392"><a href="#cb133-1392" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-1393"><a href="#cb133-1393" aria-hidden="true" tabindex="-1"></a><span class="in">`RIestThetasOLD()`</span> and <span class="in">`RIestThetasCATr()`</span> can be used with a pre-specified item (threshold) location matrix.</span>
<span id="cb133-1394"><a href="#cb133-1394" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-1395"><a href="#cb133-1395" aria-hidden="true" tabindex="-1"></a>If you would like to use an existing item threshold location matrix, this code may be helpful:</span>
<span id="cb133-1396"><a href="#cb133-1396" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-1399"><a href="#cb133-1399" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb133-1400"><a href="#cb133-1400" aria-hidden="true" tabindex="-1"></a>itemParameters <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"itemParameters.csv"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb133-1401"><a href="#cb133-1401" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.matrix</span>()</span>
<span id="cb133-1402"><a href="#cb133-1402" aria-hidden="true" tabindex="-1"></a>itemParameters</span>
<span id="cb133-1403"><a href="#cb133-1403" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb133-1404"><a href="#cb133-1404" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-1405"><a href="#cb133-1405" aria-hidden="true" tabindex="-1"></a>As you can see, this is a matrix object (not a dataframe), with each item as a row, and the threshold locations as columns.</span>
<span id="cb133-1406"><a href="#cb133-1406" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-1407"><a href="#cb133-1407" aria-hidden="true" tabindex="-1"></a><span class="fu">## Figure design</span></span>
<span id="cb133-1408"><a href="#cb133-1408" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-1409"><a href="#cb133-1409" aria-hidden="true" tabindex="-1"></a>Most of the figures created by the functions can be styled (colors, fonts, etc) by adding theme settings to them. You can use the standard ggplot function <span class="in">`theme()`</span> and related theme-functions. As usual it is possible to "stack" theme functions, as seen in the example below.</span>
<span id="cb133-1410"><a href="#cb133-1410" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-1411"><a href="#cb133-1411" aria-hidden="true" tabindex="-1"></a>You can also change coloring, axis limits/breaks, etc, just by adding ggplot options with a <span class="in">`+`</span> sign.</span>
<span id="cb133-1412"><a href="#cb133-1412" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-1413"><a href="#cb133-1413" aria-hidden="true" tabindex="-1"></a>A custom theme function, <span class="in">`theme_rise()`</span>, is included in the <span class="in">`easyRasch`</span> package. It might be easier to use if you are not familiar with <span class="in">`theme()`</span>.</span>
<span id="cb133-1414"><a href="#cb133-1414" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-1415"><a href="#cb133-1415" aria-hidden="true" tabindex="-1"></a>For instance, you might like to change the font to "Lato" for the item hierarchy figure, and make the background transparent.</span>
<span id="cb133-1416"><a href="#cb133-1416" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-1419"><a href="#cb133-1419" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb133-1420"><a href="#cb133-1420" aria-hidden="true" tabindex="-1"></a><span class="fu">RIitemHierarchy</span>(df) <span class="sc">+</span></span>
<span id="cb133-1421"><a href="#cb133-1421" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span> <span class="co"># first apply the minimal theme to make the background transparent</span></span>
<span id="cb133-1422"><a href="#cb133-1422" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_rise</span>(<span class="at">fontfamily =</span> <span class="st">"Lato"</span>) <span class="co"># then apply theme_rise, which simplifies making changes to all plot elements</span></span>
<span id="cb133-1423"><a href="#cb133-1423" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb133-1424"><a href="#cb133-1424" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-1425"><a href="#cb133-1425" aria-hidden="true" tabindex="-1"></a>As of package version 0.1.30.0, the <span class="in">`RItargeting()`</span> function allows more flexibility in styling too, by having an option to return a list object with the three separate plots. See the <span class="co">[</span><span class="ot">NEWS</span><span class="co">](https://github.com/pgmj/easyRasch/blob/main/NEWS.md#01300)</span> file for more details. Since the <span class="in">`RItargeting()`</span> function uses the <span class="in">`patchwork`</span> library to combine plots, you can also make use of <span class="co">[</span><span class="ot">the many functions that `patchwork` includes</span><span class="co">](https://patchwork.data-imaginist.com/articles/patchwork.html)</span>. For instance, you can set a title with a specific theme:</span>
<span id="cb133-1426"><a href="#cb133-1426" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-1427"><a href="#cb133-1427" aria-hidden="true" tabindex="-1"></a><span class="in">``` {r}</span></span>
<span id="cb133-1428"><a href="#cb133-1428" aria-hidden="true" tabindex="-1"></a><span class="fu">RItargeting</span>(df) <span class="sc">+</span> <span class="fu">plot_annotation</span>(<span class="at">title =</span> <span class="st">"Targeting"</span>, <span class="at">theme =</span> <span class="fu">theme_rise</span>(<span class="at">fontfamily =</span> <span class="st">"Arial"</span>))</span>
<span id="cb133-1429"><a href="#cb133-1429" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb133-1430"><a href="#cb133-1430" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-1431"><a href="#cb133-1431" aria-hidden="true" tabindex="-1"></a>In order to change font for text *inside* plots (such as "t1" for thresholds) you will need to add an additional line of code.</span>
<span id="cb133-1432"><a href="#cb133-1432" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-1433"><a href="#cb133-1433" aria-hidden="true" tabindex="-1"></a><span class="in">``` r</span></span>
<span id="cb133-1434"><a href="#cb133-1434" aria-hidden="true" tabindex="-1"></a><span class="fu">update_geom_defaults</span>(<span class="st">"text"</span>, <span class="fu">list</span>(<span class="at">family =</span> <span class="st">"Lato"</span>))</span>
<span id="cb133-1435"><a href="#cb133-1435" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb133-1436"><a href="#cb133-1436" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-1437"><a href="#cb133-1437" aria-hidden="true" tabindex="-1"></a>Please note that the line of code above updates the default settings for <span class="in">`geom_text()`</span> for the whole session. Also, some functions, such as <span class="in">`RIloadLoc()`</span>, make use of <span class="in">`geom_text_repel()`</span>, for which you would need to change the code above from "text" to "text_repel".</span>
<span id="cb133-1438"><a href="#cb133-1438" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-1439"><a href="#cb133-1439" aria-hidden="true" tabindex="-1"></a>A simple way to only change font family and font size would be to use <span class="in">`theme_minimal(base_family = "Calibri", base_size = 14)`</span>. Please see the <span class="co">[</span><span class="ot">reference page</span><span class="co">](https://ggplot2.tidyverse.org/reference/ggtheme.html)</span> for default ggplot themes for alternatives to <span class="in">`theme_minimal()`</span>.</span>
<span id="cb133-1440"><a href="#cb133-1440" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-1441"><a href="#cb133-1441" aria-hidden="true" tabindex="-1"></a><span class="fu">## Software used {#sec-grateful}</span></span>
<span id="cb133-1442"><a href="#cb133-1442" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-1443"><a href="#cb133-1443" aria-hidden="true" tabindex="-1"></a>The <span class="in">`grateful`</span> package is a nice way to give credit to the packages used in making the analysis. The package can create both a bibliography file and a table object, which is handy for automatically creating a reference list based on the packages used (or at least explicitly loaded).</span>
<span id="cb133-1444"><a href="#cb133-1444" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-1447"><a href="#cb133-1447" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb133-1448"><a href="#cb133-1448" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(grateful)</span>
<span id="cb133-1449"><a href="#cb133-1449" aria-hidden="true" tabindex="-1"></a>pkgs <span class="ot">&lt;-</span> <span class="fu">cite_packages</span>(<span class="at">cite.tidyverse =</span> <span class="cn">TRUE</span>, </span>
<span id="cb133-1450"><a href="#cb133-1450" aria-hidden="true" tabindex="-1"></a>                      <span class="at">output =</span> <span class="st">"table"</span>,</span>
<span id="cb133-1451"><a href="#cb133-1451" aria-hidden="true" tabindex="-1"></a>                      <span class="at">bib.file =</span> <span class="st">"grateful-refs.bib"</span>,</span>
<span id="cb133-1452"><a href="#cb133-1452" aria-hidden="true" tabindex="-1"></a>                      <span class="at">include.RStudio =</span> <span class="cn">FALSE</span>,</span>
<span id="cb133-1453"><a href="#cb133-1453" aria-hidden="true" tabindex="-1"></a>                      <span class="at">out.dir =</span> <span class="fu">getwd</span>())</span>
<span id="cb133-1454"><a href="#cb133-1454" aria-hidden="true" tabindex="-1"></a><span class="co"># If kbl() is used to generate this table, the references will not be added to the Reference list.</span></span>
<span id="cb133-1455"><a href="#cb133-1455" aria-hidden="true" tabindex="-1"></a><span class="fu">formattable</span>(pkgs, </span>
<span id="cb133-1456"><a href="#cb133-1456" aria-hidden="true" tabindex="-1"></a>            <span class="at">table.attr =</span> <span class="st">'class=</span><span class="sc">\"</span><span class="st">table table-striped</span><span class="sc">\"</span><span class="st"> style="font-size: 13px; font-family: Lato; width: 80%"'</span>)</span>
<span id="cb133-1457"><a href="#cb133-1457" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb133-1458"><a href="#cb133-1458" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-1459"><a href="#cb133-1459" aria-hidden="true" tabindex="-1"></a><span class="fu">## Additional credits</span></span>
<span id="cb133-1460"><a href="#cb133-1460" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-1461"><a href="#cb133-1461" aria-hidden="true" tabindex="-1"></a>Thanks to my <span class="co">[</span><span class="ot">colleagues at RISE</span><span class="co">](https://www.ri.se/en/what-we-do/projects/center-for-category-based-measurements)</span> for providing feedback and testing the package on Windows and MacOS platforms. Also, thanks to <span class="co">[</span><span class="ot">Mike Linacre</span><span class="co">](https://www.winsteps.com/linacre.htm)</span> and <span class="co">[</span><span class="ot">Jeanette Melin</span><span class="co">](https://www.ri.se/en/person/jeanette-melin)</span> for providing useful feedback to improve this vignette.</span>
<span id="cb133-1462"><a href="#cb133-1462" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-1463"><a href="#cb133-1463" aria-hidden="true" tabindex="-1"></a><span class="fu">## Session info</span></span>
<span id="cb133-1464"><a href="#cb133-1464" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-1467"><a href="#cb133-1467" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb133-1468"><a href="#cb133-1468" aria-hidden="true" tabindex="-1"></a><span class="fu">sessionInfo</span>()</span>
<span id="cb133-1469"><a href="#cb133-1469" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-1470"><a href="#cb133-1470" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb133-1471"><a href="#cb133-1471" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-1472"><a href="#cb133-1472" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-1473"><a href="#cb133-1473" aria-hidden="true" tabindex="-1"></a><span class="fu">## References</span></span>
</code><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->



</body></html>